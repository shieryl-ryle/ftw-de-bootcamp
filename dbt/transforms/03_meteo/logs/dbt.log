[0m08:12:25.675608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16213f0310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f161e051af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f161e0519a0>]}


============================== 08:12:25.685682 | e061b0be-5b36-4441-8234-6cda140ba967 ==============================
[0m08:12:25.685682 [info ] [MainThread]: Running with dbt=1.8.9
[0m08:12:25.686740 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'empty': 'False', 'partial_parse': 'True', 'indirect_selection': 'eager', 'fail_fast': 'False', 'introspect': 'True', 'debug': 'False', 'log_path': '/workdir/transforms/02_chinook/logs', 'invocation_command': 'dbt build --profiles-dir . --target local', 'use_experimental_parser': 'False', 'warn_error': 'None', 'use_colors': 'True', 'quiet': 'False', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '.', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'version_check': 'True', 'printer_width': '80', 'log_format': 'default'}
[0m08:12:26.225884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e061b0be-5b36-4441-8234-6cda140ba967', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1620997fd0>]}
[0m08:12:26.414257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e061b0be-5b36-4441-8234-6cda140ba967', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f161e01abe0>]}
[0m08:12:26.416010 [info ] [MainThread]: Registered adapter: clickhouse=1.8.6
[0m08:12:26.886038 [debug] [MainThread]: checksum: 134c0f7b96382cc6938697739bc32fb1adc530b177e30f60cebddf61dbd7e979, vars: {}, profile: , target: local, version: 1.8.9
[0m08:12:26.887403 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m08:12:26.888099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e061b0be-5b36-4441-8234-6cda140ba967', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f161dcf31c0>]}
[0m08:12:31.808527 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.ex_01_mpg.stg_chinook__album.sql' (models/clean/stg_chinook__album.sql.sql) depends on a source named 'chinook.albums' which was not found
[0m08:12:31.810992 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 6.3323393, "process_in_blocks": "2816", "process_kernel_time": 0.545969, "process_mem_max_rss": "100432", "process_out_blocks": "6616", "process_user_time": 5.998663}
[0m08:12:31.811740 [debug] [MainThread]: Command `dbt build` failed at 08:12:31.811528 after 6.33 seconds
[0m08:12:31.812370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16213f0310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f161df36580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f161df369a0>]}
[0m08:12:31.812979 [debug] [MainThread]: Flushing usage events
[0m08:15:44.751396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c09ff80310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c09cbdea90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c09cbde940>]}


============================== 08:15:44.760627 | 9a85211f-b6ad-4538-81e1-ca33b1791f09 ==============================
[0m08:15:44.760627 [info ] [MainThread]: Running with dbt=1.8.9
[0m08:15:44.761801 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_cache_events': 'False', 'empty': 'False', 'static_parser': 'True', 'warn_error': 'None', 'profiles_dir': '.', 'partial_parse': 'True', 'printer_width': '80', 'use_experimental_parser': 'False', 'write_json': 'True', 'indirect_selection': 'eager', 'version_check': 'True', 'introspect': 'True', 'no_print': 'None', 'log_format': 'default', 'target_path': 'None', 'debug': 'False', 'log_path': '/workdir/transforms/02_chinook/logs', 'fail_fast': 'False', 'quiet': 'False', 'use_colors': 'True', 'cache_selected_only': 'False', 'invocation_command': 'dbt build --profiles-dir . --target local', 'send_anonymous_usage_stats': 'True'}
[0m08:15:45.373139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9a85211f-b6ad-4538-81e1-ca33b1791f09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c09cae1a30>]}
[0m08:15:45.566646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9a85211f-b6ad-4538-81e1-ca33b1791f09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c09d02f250>]}
[0m08:15:45.567889 [info ] [MainThread]: Registered adapter: clickhouse=1.8.6
[0m08:15:46.026707 [debug] [MainThread]: checksum: 134c0f7b96382cc6938697739bc32fb1adc530b177e30f60cebddf61dbd7e979, vars: {}, profile: , target: local, version: 1.8.9
[0m08:15:46.028122 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m08:15:46.028830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9a85211f-b6ad-4538-81e1-ca33b1791f09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c09c8807c0>]}
[0m08:15:50.341294 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.ex_02_chinook.dim_album' (models/mart/dim_album.sql) depends on a node named 'stg_chinook__album' which was not found
[0m08:15:50.342913 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 5.7825723, "process_in_blocks": "26968", "process_kernel_time": 0.616956, "process_mem_max_rss": "100444", "process_out_blocks": "6624", "process_user_time": 5.770411}
[0m08:15:50.343652 [debug] [MainThread]: Command `dbt build` failed at 08:15:50.343432 after 5.78 seconds
[0m08:15:50.344297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c09ff80310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c09bf64220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c09c5d3880>]}
[0m08:15:50.344888 [debug] [MainThread]: Flushing usage events
[0m08:16:16.719791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7090a69ab310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7090a360ba90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7090a360b940>]}


============================== 08:16:16.729086 | 44b6ec08-02b4-422e-b9e6-aaeb9fd15429 ==============================
[0m08:16:16.729086 [info ] [MainThread]: Running with dbt=1.8.9
[0m08:16:16.730200 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'indirect_selection': 'eager', 'version_check': 'True', 'log_format': 'default', 'write_json': 'True', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'target_path': 'None', 'warn_error': 'None', 'empty': 'False', 'use_colors': 'True', 'log_path': '/workdir/transforms/02_chinook/logs', 'no_print': 'None', 'printer_width': '80', 'introspect': 'True', 'fail_fast': 'False', 'quiet': 'False', 'profiles_dir': '.', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'invocation_command': 'dbt build --profiles-dir . --target local', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:16:17.317044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '44b6ec08-02b4-422e-b9e6-aaeb9fd15429', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7090a5f53fd0>]}
[0m08:16:17.508771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '44b6ec08-02b4-422e-b9e6-aaeb9fd15429', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7090a40f1430>]}
[0m08:16:17.510035 [info ] [MainThread]: Registered adapter: clickhouse=1.8.6
[0m08:16:17.931558 [debug] [MainThread]: checksum: 134c0f7b96382cc6938697739bc32fb1adc530b177e30f60cebddf61dbd7e979, vars: {}, profile: , target: local, version: 1.8.9
[0m08:16:17.933094 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m08:16:17.933798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '44b6ec08-02b4-422e-b9e6-aaeb9fd15429', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7090a32a0ee0>]}
[0m08:16:22.613563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '44b6ec08-02b4-422e-b9e6-aaeb9fd15429', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7090a32a0100>]}
[0m08:16:23.020605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '44b6ec08-02b4-422e-b9e6-aaeb9fd15429', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7090a28df430>]}
[0m08:16:23.021460 [info ] [MainThread]: Found 4 models, 2 sources, 471 macros
[0m08:16:23.024414 [info ] [MainThread]: 
[0m08:16:23.025440 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m08:16:23.038138 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m08:16:23.045093 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m08:16:23.201277 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:16:23.202900 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:16:23.768465 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m08:16:23.796168 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.03 seconds
[0m08:16:23.799628 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m08:16:23.807309 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m08:16:23.905579 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now create__staging)
[0m08:16:23.907226 [debug] [ThreadPool]: Creating schema "schema: "staging"
"
[0m08:16:23.922357 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create__staging, now list__mart)
[0m08:16:23.923981 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__staging)
[0m08:16:23.940565 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__mart: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list__mart"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'mart'
      

  ...
[0m08:16:24.002063 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__staging: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list__staging"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'staging'
      

  ...
[0m08:16:24.013872 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m08:16:24.016045 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m08:16:24.024554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '44b6ec08-02b4-422e-b9e6-aaeb9fd15429', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7090a5dc8940>]}
[0m08:16:24.026317 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m08:16:24.027394 [info ] [MainThread]: 
[0m08:16:24.099001 [debug] [Thread-1  ]: Began running node model.ex_02_chinook.stg_chinook__album
[0m08:16:24.100323 [info ] [Thread-1  ]: 1 of 4 START sql view model `staging`.`stg_chinook__album` ..................... [RUN]
[0m08:16:24.101329 [debug] [Thread-2  ]: Began running node model.ex_02_chinook.stg_chinook__artist
[0m08:16:24.102199 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list__mart, now model.ex_02_chinook.stg_chinook__album)
[0m08:16:24.103314 [info ] [Thread-2  ]: 2 of 4 START sql view model `staging`.`stg_chinook__artist` .................... [RUN]
[0m08:16:24.104282 [debug] [Thread-1  ]: Began compiling node model.ex_02_chinook.stg_chinook__album
[0m08:16:24.105385 [debug] [Thread-2  ]: Acquiring new clickhouse connection 'model.ex_02_chinook.stg_chinook__artist'
[0m08:16:24.125324 [debug] [Thread-1  ]: Writing injected SQL for node "model.ex_02_chinook.stg_chinook__album"
[0m08:16:24.126224 [debug] [Thread-2  ]: Began compiling node model.ex_02_chinook.stg_chinook__artist
[0m08:16:24.132324 [debug] [Thread-2  ]: Writing injected SQL for node "model.ex_02_chinook.stg_chinook__artist"
[0m08:16:24.133370 [debug] [Thread-1  ]: Began executing node model.ex_02_chinook.stg_chinook__album
[0m08:16:24.199793 [debug] [Thread-2  ]: Began executing node model.ex_02_chinook.stg_chinook__artist
[0m08:16:24.308784 [debug] [Thread-1  ]: Creating new relation stg_chinook__album
[0m08:16:24.422360 [debug] [Thread-2  ]: Creating new relation stg_chinook__artist
[0m08:16:24.512026 [debug] [Thread-1  ]: Writing runtime sql for node "model.ex_02_chinook.stg_chinook__album"
[0m08:16:24.514001 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m08:16:24.517250 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_02_chinook.stg_chinook__album: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.stg_chinook__album"} */


  create view `staging`.`stg_chinook__album` 
  
    
    
  as (
    

-- Keep album grain; standardize names/types.
select
  cast(album_id  as Nullable(Int64))      as album_id,
  cast(title     as Nullable(String))     as album_title,
  cast(artist_id as Nullable(Int64))      as artist_id
from `raw`.`albums`
    
  )
      
      
                    -- end_of_sql
                    
                    ...
[0m08:16:24.522964 [debug] [Thread-1  ]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.stg_chinook__album"} */


  create view `staging`.`stg_chinook__album` 
  
    
    
  as (
    

-- Keep album grain; standardize names/types.
select
  cast(album_id  as Nullable(Int64))      as album_id,
  cast(title     as Nullable(String))     as album_title,
  cast(artist_id as Nullable(Int64))      as artist_id
from `raw`.`albums`
    
  )
      
      
                    -- end_of_sql
                    
                    
[0m08:16:24.604943 [debug] [Thread-1  ]: Database Error in model stg_chinook__album (models/clean/stg_chinook__album.sql)
  HTTPDriver for http://clickhouse:8123 received ClickHouse error code 497
   Code: 497. DB::Exception: ftw_user: Not enough privileges. To execute this query, it's necessary to have the grant CREATE VIEW ON staging.stg_chinook__album. (ACCESS_DENIED) (version 23.12.6.19 (official build))
  compiled code at target/run/ex_02_chinook/models/clean/stg_chinook__album.sql
[0m08:16:24.610776 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44b6ec08-02b4-422e-b9e6-aaeb9fd15429', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7090a24903d0>]}
[0m08:16:24.613244 [error] [Thread-1  ]: 1 of 4 ERROR creating sql view model `staging`.`stg_chinook__album` ............ [[31mERROR[0m in 0.50s]
[0m08:16:24.616098 [debug] [Thread-1  ]: Finished running node model.ex_02_chinook.stg_chinook__album
[0m08:16:24.646038 [debug] [Thread-2  ]: Writing runtime sql for node "model.ex_02_chinook.stg_chinook__artist"
[0m08:16:24.648376 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_02_chinook.stg_chinook__artist: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.stg_chinook__artist"} */


  create view `staging`.`stg_chinook__artist` 
  
    
    
  as (
    

-- Standardize column names/types per table; no business logic.
select
  cast(artist_id as Nullable(Int64))      as artist_id,
  cast(name      as Nullable(String))     as artist_name
from `raw`.`artists`
    
  )
      
      
                    -- end_of_sql
                    
                    ...
[0m08:16:24.654667 [debug] [Thread-2  ]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.stg_chinook__artist"} */


  create view `staging`.`stg_chinook__artist` 
  
    
    
  as (
    

-- Standardize column names/types per table; no business logic.
select
  cast(artist_id as Nullable(Int64))      as artist_id,
  cast(name      as Nullable(String))     as artist_name
from `raw`.`artists`
    
  )
      
      
                    -- end_of_sql
                    
                    
[0m08:16:24.658343 [debug] [Thread-2  ]: Database Error in model stg_chinook__artist (models/clean/stg_chinook__artist.sql)
  HTTPDriver for http://clickhouse:8123 received ClickHouse error code 497
   Code: 497. DB::Exception: ftw_user: Not enough privileges. To execute this query, it's necessary to have the grant CREATE VIEW ON staging.stg_chinook__artist. (ACCESS_DENIED) (version 23.12.6.19 (official build))
  compiled code at target/run/ex_02_chinook/models/clean/stg_chinook__artist.sql
[0m08:16:24.659818 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44b6ec08-02b4-422e-b9e6-aaeb9fd15429', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7090a263a940>]}
[0m08:16:24.695519 [error] [Thread-2  ]: 2 of 4 ERROR creating sql view model `staging`.`stg_chinook__artist` ........... [[31mERROR[0m in 0.55s]
[0m08:16:24.697804 [debug] [Thread-2  ]: Finished running node model.ex_02_chinook.stg_chinook__artist
[0m08:16:24.699813 [debug] [Thread-4  ]: Began running node model.ex_02_chinook.dim_album
[0m08:16:24.700799 [debug] [Thread-3  ]: Began running node model.ex_02_chinook.dim_artist
[0m08:16:24.701963 [info ] [Thread-4  ]: 3 of 4 SKIP relation mart.dim_album ............................................ [[33mSKIP[0m]
[0m08:16:24.703164 [info ] [Thread-3  ]: 4 of 4 SKIP relation mart.dim_artist ........................................... [[33mSKIP[0m]
[0m08:16:24.704378 [debug] [Thread-4  ]: Finished running node model.ex_02_chinook.dim_album
[0m08:16:24.705496 [debug] [Thread-3  ]: Finished running node model.ex_02_chinook.dim_artist
[0m08:16:24.708055 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:16:24.708740 [debug] [MainThread]: Connection 'model.ex_02_chinook.stg_chinook__album' was left open.
[0m08:16:24.709328 [debug] [MainThread]: On model.ex_02_chinook.stg_chinook__album: Close
[0m08:16:24.709903 [debug] [MainThread]: Connection 'list__staging' was left open.
[0m08:16:24.710452 [debug] [MainThread]: On list__staging: Close
[0m08:16:24.711003 [debug] [MainThread]: Connection 'model.ex_02_chinook.stg_chinook__artist' was left open.
[0m08:16:24.711564 [debug] [MainThread]: On model.ex_02_chinook.stg_chinook__artist: Close
[0m08:16:24.712589 [info ] [MainThread]: 
[0m08:16:24.713298 [info ] [MainThread]: Finished running 2 view models, 2 table models in 0 hours 0 minutes and 1.69 seconds (1.69s).
[0m08:16:24.715524 [debug] [MainThread]: Command end result
[0m08:16:24.819373 [info ] [MainThread]: 
[0m08:16:24.820694 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m08:16:24.821676 [info ] [MainThread]: 
[0m08:16:24.823115 [error] [MainThread]:   Database Error in model stg_chinook__album (models/clean/stg_chinook__album.sql)
  HTTPDriver for http://clickhouse:8123 received ClickHouse error code 497
   Code: 497. DB::Exception: ftw_user: Not enough privileges. To execute this query, it's necessary to have the grant CREATE VIEW ON staging.stg_chinook__album. (ACCESS_DENIED) (version 23.12.6.19 (official build))
  compiled code at target/run/ex_02_chinook/models/clean/stg_chinook__album.sql
[0m08:16:24.823874 [info ] [MainThread]: 
[0m08:16:24.824828 [error] [MainThread]:   Database Error in model stg_chinook__artist (models/clean/stg_chinook__artist.sql)
  HTTPDriver for http://clickhouse:8123 received ClickHouse error code 497
   Code: 497. DB::Exception: ftw_user: Not enough privileges. To execute this query, it's necessary to have the grant CREATE VIEW ON staging.stg_chinook__artist. (ACCESS_DENIED) (version 23.12.6.19 (official build))
  compiled code at target/run/ex_02_chinook/models/clean/stg_chinook__artist.sql
[0m08:16:24.825654 [info ] [MainThread]: 
[0m08:16:24.826506 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=2 TOTAL=4
[0m08:16:24.828071 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 8.303202, "process_in_blocks": "6024", "process_kernel_time": 0.663966, "process_mem_max_rss": "114932", "process_out_blocks": "10536", "process_user_time": 6.875945}
[0m08:16:24.829117 [debug] [MainThread]: Command `dbt build` failed at 08:16:24.828903 after 8.30 seconds
[0m08:16:24.829810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7090a69ab310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7090a2834100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7090a5f53fd0>]}
[0m08:16:24.830395 [debug] [MainThread]: Flushing usage events
[0m08:19:17.613903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7def4f428310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7def4c087b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7def4c087a00>]}


============================== 08:19:17.673658 | 8c4bdebb-67b8-46b6-8115-8773f345dd57 ==============================
[0m08:19:17.673658 [info ] [MainThread]: Running with dbt=1.8.9
[0m08:19:17.674815 [debug] [MainThread]: running dbt with arguments {'empty': 'False', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'write_json': 'True', 'profiles_dir': '.', 'version_check': 'True', 'partial_parse': 'True', 'log_path': '/workdir/transforms/02_chinook/logs', 'log_format': 'default', 'static_parser': 'True', 'fail_fast': 'False', 'invocation_command': 'dbt build --profiles-dir . --target local', 'no_print': 'None', 'warn_error': 'None', 'quiet': 'False', 'introspect': 'True', 'log_cache_events': 'False', 'printer_width': '80', 'use_colors': 'True'}
[0m08:19:18.204478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8c4bdebb-67b8-46b6-8115-8773f345dd57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7def4f62a160>]}
[0m08:19:18.397593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8c4bdebb-67b8-46b6-8115-8773f345dd57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7def4c0788e0>]}
[0m08:19:18.398815 [info ] [MainThread]: Registered adapter: clickhouse=1.8.6
[0m08:19:18.877796 [debug] [MainThread]: checksum: 134c0f7b96382cc6938697739bc32fb1adc530b177e30f60cebddf61dbd7e979, vars: {}, profile: , target: local, version: 1.8.9
[0m08:19:19.294009 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m08:19:19.294981 [debug] [MainThread]: Partial parsing: updated file: ex_02_chinook://models/clean/stg_chinook__artist.sql
[0m08:19:19.295653 [debug] [MainThread]: Partial parsing: updated file: ex_02_chinook://models/clean/stg_chinook__album.sql
[0m08:19:20.170846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8c4bdebb-67b8-46b6-8115-8773f345dd57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7def4b458130>]}
[0m08:19:20.526413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8c4bdebb-67b8-46b6-8115-8773f345dd57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7def4b27d0a0>]}
[0m08:19:20.527278 [info ] [MainThread]: Found 4 models, 2 sources, 471 macros
[0m08:19:20.530252 [info ] [MainThread]: 
[0m08:19:20.531431 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m08:19:20.578367 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m08:19:20.590124 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m08:19:20.682830 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:19:20.681822 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:19:21.357610 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m08:19:21.375724 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m08:19:21.379754 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m08:19:21.384022 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m08:19:21.618177 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__mart)
[0m08:19:21.624581 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__clean)
[0m08:19:21.683940 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__mart: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list__mart"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'mart'
      

  ...
[0m08:19:21.689562 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list__clean"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'clean'
      

  ...
[0m08:19:21.698422 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m08:19:21.703874 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m08:19:21.709753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c4bdebb-67b8-46b6-8115-8773f345dd57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7def4e842970>]}
[0m08:19:21.711492 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m08:19:21.712890 [info ] [MainThread]: 
[0m08:19:21.787891 [debug] [Thread-1  ]: Began running node model.ex_02_chinook.stg_chinook__album
[0m08:19:21.788764 [debug] [Thread-2  ]: Began running node model.ex_02_chinook.stg_chinook__artist
[0m08:19:21.789846 [info ] [Thread-1  ]: 1 of 4 START sql view model `clean`.`stg_chinook__album` ....................... [RUN]
[0m08:19:21.790964 [info ] [Thread-2  ]: 2 of 4 START sql view model `clean`.`stg_chinook__artist` ...................... [RUN]
[0m08:19:21.792128 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.ex_02_chinook.stg_chinook__album'
[0m08:19:21.793096 [debug] [Thread-2  ]: Acquiring new clickhouse connection 'model.ex_02_chinook.stg_chinook__artist'
[0m08:19:21.793885 [debug] [Thread-1  ]: Began compiling node model.ex_02_chinook.stg_chinook__album
[0m08:19:21.794648 [debug] [Thread-2  ]: Began compiling node model.ex_02_chinook.stg_chinook__artist
[0m08:19:21.812780 [debug] [Thread-1  ]: Writing injected SQL for node "model.ex_02_chinook.stg_chinook__album"
[0m08:19:21.872382 [debug] [Thread-2  ]: Writing injected SQL for node "model.ex_02_chinook.stg_chinook__artist"
[0m08:19:21.874762 [debug] [Thread-1  ]: Began executing node model.ex_02_chinook.stg_chinook__album
[0m08:19:21.876600 [debug] [Thread-2  ]: Began executing node model.ex_02_chinook.stg_chinook__artist
[0m08:19:22.203849 [debug] [Thread-2  ]: Creating new relation stg_chinook__artist
[0m08:19:22.206353 [debug] [Thread-1  ]: Creating new relation stg_chinook__album
[0m08:19:22.374089 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m08:19:22.379606 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m08:19:22.547804 [debug] [Thread-1  ]: Writing runtime sql for node "model.ex_02_chinook.stg_chinook__album"
[0m08:19:22.571480 [debug] [Thread-2  ]: Writing runtime sql for node "model.ex_02_chinook.stg_chinook__artist"
[0m08:19:22.573197 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_02_chinook.stg_chinook__album: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.stg_chinook__album"} */


  create view `clean`.`stg_chinook__album` 
  
    
    
  as (
    

-- Keep album grain; standardize names/types.
select
  cast(album_id  as Nullable(Int64))      as album_id,
  cast(title     as Nullable(String))     as album_title,
  cast(artist_id as Nullable(Int64))      as artist_id
from `raw`.`albums`
    
  )
      
      
                    -- end_of_sql
                    
                    ...
[0m08:19:22.577101 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_02_chinook.stg_chinook__artist: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.stg_chinook__artist"} */


  create view `clean`.`stg_chinook__artist` 
  
    
    
  as (
    

-- Standardize column names/types per table; no business logic.
select
  cast(artist_id as Nullable(Int64))      as artist_id,
  cast(name      as Nullable(String))     as artist_name
from `raw`.`artists`
    
  )
      
      
                    -- end_of_sql
                    
                    ...
[0m08:19:22.581635 [debug] [Thread-1  ]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.stg_chinook__album"} */


  create view `clean`.`stg_chinook__album` 
  
    
    
  as (
    

-- Keep album grain; standardize names/types.
select
  cast(album_id  as Nullable(Int64))      as album_id,
  cast(title     as Nullable(String))     as album_title,
  cast(artist_id as Nullable(Int64))      as artist_id
from `raw`.`albums`
    
  )
      
      
                    -- end_of_sql
                    
                    
[0m08:19:22.585706 [debug] [Thread-2  ]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.stg_chinook__artist"} */


  create view `clean`.`stg_chinook__artist` 
  
    
    
  as (
    

-- Standardize column names/types per table; no business logic.
select
  cast(artist_id as Nullable(Int64))      as artist_id,
  cast(name      as Nullable(String))     as artist_name
from `raw`.`artists`
    
  )
      
      
                    -- end_of_sql
                    
                    
[0m08:19:22.595861 [debug] [Thread-2  ]: Database Error in model stg_chinook__artist (models/clean/stg_chinook__artist.sql)
  HTTPDriver for http://clickhouse:8123 received ClickHouse error code 60
   Code: 60. DB::Exception: Table raw.artists does not exist. (UNKNOWN_TABLE) (version 23.12.6.19 (official build))
  compiled code at target/run/ex_02_chinook/models/clean/stg_chinook__artist.sql
[0m08:19:22.597171 [debug] [Thread-1  ]: Database Error in model stg_chinook__album (models/clean/stg_chinook__album.sql)
  HTTPDriver for http://clickhouse:8123 received ClickHouse error code 60
   Code: 60. DB::Exception: Table raw.albums does not exist. (UNKNOWN_TABLE) (version 23.12.6.19 (official build))
  compiled code at target/run/ex_02_chinook/models/clean/stg_chinook__album.sql
[0m08:19:22.600523 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c4bdebb-67b8-46b6-8115-8773f345dd57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7def4c140550>]}
[0m08:19:22.601424 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c4bdebb-67b8-46b6-8115-8773f345dd57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7def4b82ae20>]}
[0m08:19:22.602824 [error] [Thread-2  ]: 2 of 4 ERROR creating sql view model `clean`.`stg_chinook__artist` ............. [[31mERROR[0m in 0.81s]
[0m08:19:22.604166 [error] [Thread-1  ]: 1 of 4 ERROR creating sql view model `clean`.`stg_chinook__album` .............. [[31mERROR[0m in 0.81s]
[0m08:19:22.605662 [debug] [Thread-2  ]: Finished running node model.ex_02_chinook.stg_chinook__artist
[0m08:19:22.607050 [debug] [Thread-1  ]: Finished running node model.ex_02_chinook.stg_chinook__album
[0m08:19:22.608443 [debug] [Thread-4  ]: Began running node model.ex_02_chinook.dim_artist
[0m08:19:22.609445 [debug] [Thread-2  ]: Began running node model.ex_02_chinook.dim_album
[0m08:19:22.610411 [info ] [Thread-4  ]: 3 of 4 SKIP relation mart.dim_artist ........................................... [[33mSKIP[0m]
[0m08:19:22.611459 [info ] [Thread-2  ]: 4 of 4 SKIP relation mart.dim_album ............................................ [[33mSKIP[0m]
[0m08:19:22.612578 [debug] [Thread-4  ]: Finished running node model.ex_02_chinook.dim_artist
[0m08:19:22.613736 [debug] [Thread-2  ]: Finished running node model.ex_02_chinook.dim_album
[0m08:19:22.616107 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:19:22.670286 [debug] [MainThread]: Connection 'list__mart' was left open.
[0m08:19:22.671608 [debug] [MainThread]: On list__mart: Close
[0m08:19:22.672673 [debug] [MainThread]: Connection 'list__clean' was left open.
[0m08:19:22.673820 [debug] [MainThread]: On list__clean: Close
[0m08:19:22.674868 [debug] [MainThread]: Connection 'model.ex_02_chinook.stg_chinook__album' was left open.
[0m08:19:22.675944 [debug] [MainThread]: On model.ex_02_chinook.stg_chinook__album: Close
[0m08:19:22.676987 [debug] [MainThread]: Connection 'model.ex_02_chinook.stg_chinook__artist' was left open.
[0m08:19:22.678103 [debug] [MainThread]: On model.ex_02_chinook.stg_chinook__artist: Close
[0m08:19:22.680196 [info ] [MainThread]: 
[0m08:19:22.681584 [info ] [MainThread]: Finished running 2 view models, 2 table models in 0 hours 0 minutes and 2.15 seconds (2.15s).
[0m08:19:22.685633 [debug] [MainThread]: Command end result
[0m08:19:22.890051 [info ] [MainThread]: 
[0m08:19:22.890909 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m08:19:22.891488 [info ] [MainThread]: 
[0m08:19:22.892299 [error] [MainThread]:   Database Error in model stg_chinook__artist (models/clean/stg_chinook__artist.sql)
  HTTPDriver for http://clickhouse:8123 received ClickHouse error code 60
   Code: 60. DB::Exception: Table raw.artists does not exist. (UNKNOWN_TABLE) (version 23.12.6.19 (official build))
  compiled code at target/run/ex_02_chinook/models/clean/stg_chinook__artist.sql
[0m08:19:22.892913 [info ] [MainThread]: 
[0m08:19:22.893672 [error] [MainThread]:   Database Error in model stg_chinook__album (models/clean/stg_chinook__album.sql)
  HTTPDriver for http://clickhouse:8123 received ClickHouse error code 60
   Code: 60. DB::Exception: Table raw.albums does not exist. (UNKNOWN_TABLE) (version 23.12.6.19 (official build))
  compiled code at target/run/ex_02_chinook/models/clean/stg_chinook__album.sql
[0m08:19:22.894285 [info ] [MainThread]: 
[0m08:19:22.894915 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=2 TOTAL=4
[0m08:19:22.896186 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 5.477993, "process_in_blocks": "0", "process_kernel_time": 0.673751, "process_mem_max_rss": "113764", "process_out_blocks": "10528", "process_user_time": 5.503464}
[0m08:19:22.896924 [debug] [MainThread]: Command `dbt build` failed at 08:19:22.896735 after 5.48 seconds
[0m08:19:22.897572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7def4f428310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7def4a5edb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7def4a5ed070>]}
[0m08:19:22.898169 [debug] [MainThread]: Flushing usage events
[0m08:20:40.300161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c00e2f4310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c00af54a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c00af54940>]}


============================== 08:20:40.309940 | ca3928e3-8b26-4980-8ffd-f2756d224eb2 ==============================
[0m08:20:40.309940 [info ] [MainThread]: Running with dbt=1.8.9
[0m08:20:40.311269 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'warn_error': 'None', 'profiles_dir': '.', 'use_experimental_parser': 'False', 'use_colors': 'True', 'write_json': 'True', 'log_format': 'default', 'version_check': 'True', 'indirect_selection': 'eager', 'empty': 'False', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_cache_events': 'False', 'quiet': 'False', 'debug': 'False', 'invocation_command': 'dbt build --profiles-dir . --target local', 'partial_parse': 'True', 'target_path': 'None', 'log_path': '/workdir/transforms/02_chinook/logs', 'no_print': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'static_parser': 'True'}
[0m08:20:40.891663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ca3928e3-8b26-4980-8ffd-f2756d224eb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c00af311f0>]}
[0m08:20:41.085867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ca3928e3-8b26-4980-8ffd-f2756d224eb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c00b052d00>]}
[0m08:20:41.087119 [info ] [MainThread]: Registered adapter: clickhouse=1.8.6
[0m08:20:41.502856 [debug] [MainThread]: checksum: 134c0f7b96382cc6938697739bc32fb1adc530b177e30f60cebddf61dbd7e979, vars: {}, profile: , target: local, version: 1.8.9
[0m08:20:41.972868 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m08:20:41.974362 [debug] [MainThread]: Partial parsing: updated file: ex_02_chinook://models/sources.yml
[0m08:20:41.974964 [debug] [MainThread]: Partial parsing: updated file: ex_02_chinook://models/clean/stg_chinook__artist.sql
[0m08:20:41.975523 [debug] [MainThread]: Partial parsing: updated file: ex_02_chinook://models/clean/stg_chinook__album.sql
[0m08:20:43.096278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ca3928e3-8b26-4980-8ffd-f2756d224eb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c00a01cee0>]}
[0m08:20:43.491702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ca3928e3-8b26-4980-8ffd-f2756d224eb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c009f18220>]}
[0m08:20:43.492543 [info ] [MainThread]: Found 4 models, 2 sources, 471 macros
[0m08:20:43.495455 [info ] [MainThread]: 
[0m08:20:43.496522 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m08:20:43.509564 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m08:20:43.510757 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m08:20:43.586583 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:20:43.588045 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:20:44.239470 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m08:20:44.244323 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m08:20:44.245862 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m08:20:44.249381 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:20:44.288974 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__clean)
[0m08:20:44.290020 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__mart)
[0m08:20:44.301653 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list__clean"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'clean'
      

  ...
[0m08:20:44.306180 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__mart: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list__mart"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'mart'
      

  ...
[0m08:20:44.312351 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m08:20:44.315750 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m08:20:44.320164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca3928e3-8b26-4980-8ffd-f2756d224eb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c009b1f130>]}
[0m08:20:44.371669 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m08:20:44.373138 [info ] [MainThread]: 
[0m08:20:44.400074 [debug] [Thread-1  ]: Began running node model.ex_02_chinook.stg_chinook__album
[0m08:20:44.400982 [debug] [Thread-2  ]: Began running node model.ex_02_chinook.stg_chinook__artist
[0m08:20:44.402006 [info ] [Thread-1  ]: 1 of 4 START sql view model `clean`.`stg_chinook__album` ....................... [RUN]
[0m08:20:44.403070 [info ] [Thread-2  ]: 2 of 4 START sql view model `clean`.`stg_chinook__artist` ...................... [RUN]
[0m08:20:44.404009 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list__clean, now model.ex_02_chinook.stg_chinook__album)
[0m08:20:44.405038 [debug] [Thread-2  ]: Acquiring new clickhouse connection 'model.ex_02_chinook.stg_chinook__artist'
[0m08:20:44.405809 [debug] [Thread-1  ]: Began compiling node model.ex_02_chinook.stg_chinook__album
[0m08:20:44.406684 [debug] [Thread-2  ]: Began compiling node model.ex_02_chinook.stg_chinook__artist
[0m08:20:44.474089 [debug] [Thread-1  ]: Writing injected SQL for node "model.ex_02_chinook.stg_chinook__album"
[0m08:20:44.486579 [debug] [Thread-2  ]: Writing injected SQL for node "model.ex_02_chinook.stg_chinook__artist"
[0m08:20:44.488377 [debug] [Thread-1  ]: Began executing node model.ex_02_chinook.stg_chinook__album
[0m08:20:44.510160 [debug] [Thread-2  ]: Began executing node model.ex_02_chinook.stg_chinook__artist
[0m08:20:44.609845 [debug] [Thread-1  ]: Creating new relation stg_chinook__album
[0m08:20:44.619888 [debug] [Thread-2  ]: Creating new relation stg_chinook__artist
[0m08:20:44.776702 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m08:20:44.775373 [debug] [Thread-1  ]: Writing runtime sql for node "model.ex_02_chinook.stg_chinook__album"
[0m08:20:44.781578 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_02_chinook.stg_chinook__album: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.stg_chinook__album"} */


  create view `clean`.`stg_chinook__album` 
  
    
    
  as (
    

-- Keep album grain; standardize names/types.
select
  cast(album_id  as Nullable(Int64))      as album_id,
  cast(title     as Nullable(String))     as album_title,
  cast(artist_id as Nullable(Int64))      as artist_id
from `raw`.`chinook___albums`
    
  )
      
      
                    -- end_of_sql
                    
                    ...
[0m08:20:44.806984 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m08:20:44.988754 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca3928e3-8b26-4980-8ffd-f2756d224eb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c00d8a1520>]}
[0m08:20:44.993420 [info ] [Thread-1  ]: 1 of 4 OK created sql view model `clean`.`stg_chinook__album` .................. [[32mOK[0m in 0.58s]
[0m08:20:44.995895 [debug] [Thread-1  ]: Finished running node model.ex_02_chinook.stg_chinook__album
[0m08:20:45.031615 [debug] [Thread-2  ]: Writing runtime sql for node "model.ex_02_chinook.stg_chinook__artist"
[0m08:20:45.033472 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_02_chinook.stg_chinook__artist: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.stg_chinook__artist"} */


  create view `clean`.`stg_chinook__artist` 
  
    
    
  as (
    

-- Standardize column names/types per table; no business logic.
select
  cast(artist_id as Nullable(Int64))      as artist_id,
  cast(name      as Nullable(String))     as artist_name
from `raw`.`chinook___artists`
    
  )
      
      
                    -- end_of_sql
                    
                    ...
[0m08:20:45.044272 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m08:20:45.048808 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca3928e3-8b26-4980-8ffd-f2756d224eb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c009ba17c0>]}
[0m08:20:45.050842 [info ] [Thread-2  ]: 2 of 4 OK created sql view model `clean`.`stg_chinook__artist` ................. [[32mOK[0m in 0.64s]
[0m08:20:45.052970 [debug] [Thread-2  ]: Finished running node model.ex_02_chinook.stg_chinook__artist
[0m08:20:45.073006 [debug] [Thread-4  ]: Began running node model.ex_02_chinook.dim_album
[0m08:20:45.075013 [debug] [Thread-3  ]: Began running node model.ex_02_chinook.dim_artist
[0m08:20:45.077652 [info ] [Thread-4  ]: 3 of 4 START sql table model `mart`.`dim_album` ................................ [RUN]
[0m08:20:45.080652 [info ] [Thread-3  ]: 4 of 4 START sql table model `mart`.`dim_artist` ............................... [RUN]
[0m08:20:45.083585 [debug] [Thread-4  ]: Acquiring new clickhouse connection 'model.ex_02_chinook.dim_album'
[0m08:20:45.086025 [debug] [Thread-3  ]: Acquiring new clickhouse connection 'model.ex_02_chinook.dim_artist'
[0m08:20:45.087841 [debug] [Thread-4  ]: Began compiling node model.ex_02_chinook.dim_album
[0m08:20:45.089661 [debug] [Thread-3  ]: Began compiling node model.ex_02_chinook.dim_artist
[0m08:20:45.109191 [debug] [Thread-4  ]: Writing injected SQL for node "model.ex_02_chinook.dim_album"
[0m08:20:45.116625 [debug] [Thread-3  ]: Writing injected SQL for node "model.ex_02_chinook.dim_artist"
[0m08:20:45.119019 [debug] [Thread-3  ]: Began executing node model.ex_02_chinook.dim_artist
[0m08:20:45.171312 [debug] [Thread-4  ]: Began executing node model.ex_02_chinook.dim_album
[0m08:20:45.312238 [debug] [Thread-3  ]: Creating new relation dim_artist
[0m08:20:45.390231 [debug] [Thread-4  ]: Creating new relation dim_album
[0m08:20:45.781614 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m08:20:45.783578 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m08:20:45.971749 [debug] [Thread-4  ]: dbt_clickhouse adapter: On model.ex_02_chinook.dim_album: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.dim_album"} */

            

    
        create table `mart`.`dim_album`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

-- Album dimension, denormalized with artist_name (common convenience).
with album as (
  select * from `clean`.`stg_chinook__album`
),
artist as (
  select * from `clean`.`stg_chinook__artist`
)
select
  a.album_id,
  a.album_title,
  a.artist_id,
  ar.artist_name
from album a
left join artist ar
  on ar.artist_id = a.artist_id
          )
        
        ...
[0m08:20:45.980550 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_02_chinook.dim_artist: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.dim_artist"} */

            

    
        create table `mart`.`dim_artist`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

-- Simple conformed dimension for artists.
select
  artist_id,
  artist_name
from `clean`.`stg_chinook__artist`
          )
        
        ...
[0m08:20:46.002438 [debug] [Thread-4  ]: dbt_clickhouse adapter: SQL status: OK in 0.03 seconds
[0m08:20:46.016636 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.03 seconds
[0m08:20:46.026945 [debug] [Thread-4  ]: dbt_clickhouse adapter: On model.ex_02_chinook.dim_album: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.dim_album"} */

    select name, type from system.columns where table = 'dim_album'
    
      and database = 'mart'
    
    order by position
  ...
[0m08:20:46.030458 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_02_chinook.dim_artist: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.dim_artist"} */

    select name, type from system.columns where table = 'dim_artist'
    
      and database = 'mart'
    
    order by position
  ...
[0m08:20:46.037405 [debug] [Thread-4  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m08:20:46.073191 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m08:20:46.085919 [debug] [Thread-4  ]: Writing runtime sql for node "model.ex_02_chinook.dim_album"
[0m08:20:46.091066 [debug] [Thread-3  ]: Writing runtime sql for node "model.ex_02_chinook.dim_artist"
[0m08:20:46.094010 [debug] [Thread-4  ]: dbt_clickhouse adapter: On model.ex_02_chinook.dim_album: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.dim_album"} */

  
    
    
    
        
         


        insert into `mart`.`dim_album`
        ("album_id", "album_title", "artist_id", "artist_name")

-- Album dimension, denormalized with artist_name (common convenience).
with album as (
  select * from `clean`.`stg_chinook__album`
),
artist as (
  select * from `clean`.`stg_chinook__artist`
)
select
  a.album_id,
  a.album_title,
  a.artist_id,
  ar.artist_name
from album a
left join artist ar
  on ar.artist_id = a.artist_id
  ...
[0m08:20:46.096223 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_02_chinook.dim_artist: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.dim_artist"} */

  
    
    
    
        
         


        insert into `mart`.`dim_artist`
        ("artist_id", "artist_name")

-- Simple conformed dimension for artists.
select
  artist_id,
  artist_name
from `clean`.`stg_chinook__artist`
  ...
[0m08:20:46.107633 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m08:20:46.115448 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca3928e3-8b26-4980-8ffd-f2756d224eb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c00ac3bd90>]}
[0m08:20:46.117992 [debug] [Thread-4  ]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m08:20:46.120417 [info ] [Thread-3  ]: 4 of 4 OK created sql table model `mart`.`dim_artist` .......................... [[32mOK[0m in 1.03s]
[0m08:20:46.174041 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca3928e3-8b26-4980-8ffd-f2756d224eb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c009ba66a0>]}
[0m08:20:46.176895 [debug] [Thread-3  ]: Finished running node model.ex_02_chinook.dim_artist
[0m08:20:46.179987 [info ] [Thread-4  ]: 3 of 4 OK created sql table model `mart`.`dim_album` ........................... [[32mOK[0m in 1.09s]
[0m08:20:46.183405 [debug] [Thread-4  ]: Finished running node model.ex_02_chinook.dim_album
[0m08:20:46.187441 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:20:46.188674 [debug] [MainThread]: Connection 'model.ex_02_chinook.stg_chinook__album' was left open.
[0m08:20:46.190007 [debug] [MainThread]: On model.ex_02_chinook.stg_chinook__album: Close
[0m08:20:46.191091 [debug] [MainThread]: Connection 'list__mart' was left open.
[0m08:20:46.192166 [debug] [MainThread]: On list__mart: Close
[0m08:20:46.193209 [debug] [MainThread]: Connection 'model.ex_02_chinook.stg_chinook__artist' was left open.
[0m08:20:46.194288 [debug] [MainThread]: On model.ex_02_chinook.stg_chinook__artist: Close
[0m08:20:46.195328 [debug] [MainThread]: Connection 'model.ex_02_chinook.dim_album' was left open.
[0m08:20:46.196486 [debug] [MainThread]: On model.ex_02_chinook.dim_album: Close
[0m08:20:46.197686 [debug] [MainThread]: Connection 'model.ex_02_chinook.dim_artist' was left open.
[0m08:20:46.198776 [debug] [MainThread]: On model.ex_02_chinook.dim_artist: Close
[0m08:20:46.200978 [info ] [MainThread]: 
[0m08:20:46.202340 [info ] [MainThread]: Finished running 2 view models, 2 table models in 0 hours 0 minutes and 2.70 seconds (2.70s).
[0m08:20:46.208280 [debug] [MainThread]: Command end result
[0m08:20:46.420286 [info ] [MainThread]: 
[0m08:20:46.472005 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:20:46.473300 [info ] [MainThread]: 
[0m08:20:46.474755 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m08:20:46.477595 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 6.3897505, "process_in_blocks": "0", "process_kernel_time": 0.586422, "process_mem_max_rss": "115652", "process_out_blocks": "10568", "process_user_time": 5.894728}
[0m08:20:46.479436 [debug] [MainThread]: Command `dbt build` succeeded at 08:20:46.478977 after 6.39 seconds
[0m08:20:46.480768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c00e2f4310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c009f18220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c00b880670>]}
[0m08:20:46.482013 [debug] [MainThread]: Flushing usage events
[0m08:29:04.884448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7080a617ef40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7080a2e21a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7080a2e21940>]}


============================== 08:29:04.893949 | 4384ba45-b63c-4062-8002-7b173b60ec7c ==============================
[0m08:29:04.893949 [info ] [MainThread]: Running with dbt=1.8.9
[0m08:29:04.895002 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'static_parser': 'True', 'partial_parse': 'True', 'profiles_dir': '.', 'version_check': 'True', 'empty': 'False', 'target_path': 'None', 'fail_fast': 'False', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build --profiles-dir . --target local', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'debug': 'False', 'introspect': 'True', 'quiet': 'False', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True', 'log_format': 'default', 'warn_error': 'None', 'no_print': 'None', 'log_path': '/workdir/transforms/02_chinook/logs'}
[0m08:29:05.474738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4384ba45-b63c-4062-8002-7b173b60ec7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7080a56d9fd0>]}
[0m08:29:05.667716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4384ba45-b63c-4062-8002-7b173b60ec7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7080a63db400>]}
[0m08:29:05.669033 [info ] [MainThread]: Registered adapter: clickhouse=1.8.6
[0m08:29:06.088998 [debug] [MainThread]: checksum: 134c0f7b96382cc6938697739bc32fb1adc530b177e30f60cebddf61dbd7e979, vars: {}, profile: , target: local, version: 1.8.9
[0m08:29:06.554063 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m08:29:06.554967 [debug] [MainThread]: Partial parsing: added file: ex_02_chinook://models/mart/vw_artist_album_counts.sql
[0m08:29:07.371371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4384ba45-b63c-4062-8002-7b173b60ec7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7080a21cf130>]}
[0m08:29:07.764539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4384ba45-b63c-4062-8002-7b173b60ec7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7080a205d6a0>]}
[0m08:29:07.765382 [info ] [MainThread]: Found 5 models, 2 sources, 471 macros
[0m08:29:07.768386 [info ] [MainThread]: 
[0m08:29:07.769624 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m08:29:07.783911 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m08:29:07.796159 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m08:29:07.870164 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:29:07.882215 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:29:08.511403 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m08:29:08.521000 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m08:29:08.552199 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m08:29:08.564515 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m08:29:08.766254 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__mart)
[0m08:29:08.767306 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__clean)
[0m08:29:08.778619 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__mart: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list__mart"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'mart'
      

  ...
[0m08:29:08.782568 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list__clean"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'clean'
      

  ...
[0m08:29:08.788466 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m08:29:08.791711 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m08:29:08.796711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4384ba45-b63c-4062-8002-7b173b60ec7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7080a1e31430>]}
[0m08:29:08.797632 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m08:29:08.798260 [info ] [MainThread]: 
[0m08:29:08.860547 [debug] [Thread-1  ]: Began running node model.ex_02_chinook.stg_chinook__album
[0m08:29:08.861499 [debug] [Thread-2  ]: Began running node model.ex_02_chinook.stg_chinook__artist
[0m08:29:08.862464 [info ] [Thread-1  ]: 1 of 5 START sql view model `clean`.`stg_chinook__album` ....................... [RUN]
[0m08:29:08.863681 [info ] [Thread-2  ]: 2 of 5 START sql view model `clean`.`stg_chinook__artist` ...................... [RUN]
[0m08:29:08.865198 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.ex_02_chinook.stg_chinook__album'
[0m08:29:08.866478 [debug] [Thread-2  ]: Acquiring new clickhouse connection 'model.ex_02_chinook.stg_chinook__artist'
[0m08:29:08.867530 [debug] [Thread-1  ]: Began compiling node model.ex_02_chinook.stg_chinook__album
[0m08:29:08.868590 [debug] [Thread-2  ]: Began compiling node model.ex_02_chinook.stg_chinook__artist
[0m08:29:08.950326 [debug] [Thread-2  ]: Writing injected SQL for node "model.ex_02_chinook.stg_chinook__artist"
[0m08:29:08.897265 [debug] [Thread-1  ]: Writing injected SQL for node "model.ex_02_chinook.stg_chinook__album"
[0m08:29:08.953417 [debug] [Thread-2  ]: Began executing node model.ex_02_chinook.stg_chinook__artist
[0m08:29:08.954780 [debug] [Thread-1  ]: Began executing node model.ex_02_chinook.stg_chinook__album
[0m08:29:09.368932 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m08:29:09.375131 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m08:29:09.516324 [debug] [Thread-1  ]: Writing runtime sql for node "model.ex_02_chinook.stg_chinook__album"
[0m08:29:09.521274 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_02_chinook.stg_chinook__album: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.stg_chinook__album"} */


  create view `clean`.`stg_chinook__album__dbt_tmp` 
  
    
    
  as (
    

-- Keep album grain; standardize names/types.
select
  cast(album_id  as Nullable(Int64))      as album_id,
  cast(title     as Nullable(String))     as album_title,
  cast(artist_id as Nullable(Int64))      as artist_id
from `raw`.`chinook___albums`
    
  )
      
      
                    -- end_of_sql
                    
                    ...
[0m08:29:09.525436 [debug] [Thread-2  ]: Writing runtime sql for node "model.ex_02_chinook.stg_chinook__artist"
[0m08:29:09.528871 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_02_chinook.stg_chinook__artist: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.stg_chinook__artist"} */


  create view `clean`.`stg_chinook__artist__dbt_tmp` 
  
    
    
  as (
    

-- Standardize column names/types per table; no business logic.
select
  cast(artist_id as Nullable(Int64))      as artist_id,
  cast(name      as Nullable(String))     as artist_name
from `raw`.`chinook___artists`
    
  )
      
      
                    -- end_of_sql
                    
                    ...
[0m08:29:09.549228 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.03 seconds
[0m08:29:09.575867 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m08:29:09.581631 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_02_chinook.stg_chinook__album: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.stg_chinook__album"} */

    drop table if exists `clean`.`stg_chinook__album__dbt_backup` 
  
  ...
[0m08:29:09.596067 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_02_chinook.stg_chinook__artist: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.stg_chinook__artist"} */

    drop table if exists `clean`.`stg_chinook__artist__dbt_backup` 
  
  ...
[0m08:29:09.652306 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m08:29:09.656807 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_02_chinook.stg_chinook__album: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.stg_chinook__album"} */

    rename table `clean`.`stg_chinook__album` to `clean`.`stg_chinook__album__dbt_backup` 
  
  ...
[0m08:29:09.661130 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m08:29:09.665373 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_02_chinook.stg_chinook__artist: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.stg_chinook__artist"} */

    rename table `clean`.`stg_chinook__artist` to `clean`.`stg_chinook__artist__dbt_backup` 
  
  ...
[0m08:29:09.670050 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m08:29:09.673004 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m08:29:09.687710 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_02_chinook.stg_chinook__album: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.stg_chinook__album"} */

    drop table if exists `clean`.`stg_chinook__album` 
  
  ...
[0m08:29:09.753242 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_02_chinook.stg_chinook__artist: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.stg_chinook__artist"} */

    drop table if exists `clean`.`stg_chinook__artist` 
  
  ...
[0m08:29:09.759510 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:29:09.763687 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_02_chinook.stg_chinook__album: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.stg_chinook__album"} */

    rename table `clean`.`stg_chinook__album__dbt_tmp` to `clean`.`stg_chinook__album` 
  
  ...
[0m08:29:09.768317 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m08:29:09.773381 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_02_chinook.stg_chinook__artist: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.stg_chinook__artist"} */

    rename table `clean`.`stg_chinook__artist__dbt_tmp` to `clean`.`stg_chinook__artist` 
  
  ...
[0m08:29:09.776030 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m08:29:09.793783 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m08:29:10.191901 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_02_chinook.stg_chinook__artist: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.stg_chinook__artist"} */

    drop table if exists `clean`.`stg_chinook__artist__dbt_backup` 
  ...
[0m08:29:10.194981 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_02_chinook.stg_chinook__album: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.stg_chinook__album"} */

    drop table if exists `clean`.`stg_chinook__album__dbt_backup` 
  ...
[0m08:29:10.252372 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m08:29:10.265487 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m08:29:10.269481 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4384ba45-b63c-4062-8002-7b173b60ec7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7080a1d18fa0>]}
[0m08:29:10.274239 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4384ba45-b63c-4062-8002-7b173b60ec7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7080a1d18880>]}
[0m08:29:10.276858 [info ] [Thread-2  ]: 2 of 5 OK created sql view model `clean`.`stg_chinook__artist` ................. [[32mOK[0m in 1.40s]
[0m08:29:10.279697 [info ] [Thread-1  ]: 1 of 5 OK created sql view model `clean`.`stg_chinook__album` .................. [[32mOK[0m in 1.41s]
[0m08:29:10.282717 [debug] [Thread-2  ]: Finished running node model.ex_02_chinook.stg_chinook__artist
[0m08:29:10.286087 [debug] [Thread-1  ]: Finished running node model.ex_02_chinook.stg_chinook__album
[0m08:29:10.289381 [debug] [Thread-4  ]: Began running node model.ex_02_chinook.dim_artist
[0m08:29:10.292889 [debug] [Thread-2  ]: Began running node model.ex_02_chinook.dim_album
[0m08:29:10.291621 [info ] [Thread-4  ]: 3 of 5 START sql table model `mart`.`dim_artist` ............................... [RUN]
[0m08:29:10.294748 [debug] [Thread-1  ]: Began running node model.ex_02_chinook.vw_artist_album_counts
[0m08:29:10.296845 [info ] [Thread-2  ]: 4 of 5 START sql table model `mart`.`dim_album` ................................ [RUN]
[0m08:29:10.349723 [debug] [Thread-4  ]: Acquiring new clickhouse connection 'model.ex_02_chinook.dim_artist'
[0m08:29:10.352126 [info ] [Thread-1  ]: 5 of 5 START sql view model `mart`.`vw_artist_album_counts` .................... [RUN]
[0m08:29:10.353973 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.ex_02_chinook.stg_chinook__artist, now model.ex_02_chinook.dim_album)
[0m08:29:10.355660 [debug] [Thread-4  ]: Began compiling node model.ex_02_chinook.dim_artist
[0m08:29:10.357363 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ex_02_chinook.stg_chinook__album, now model.ex_02_chinook.vw_artist_album_counts)
[0m08:29:10.359107 [debug] [Thread-2  ]: Began compiling node model.ex_02_chinook.dim_album
[0m08:29:10.372208 [debug] [Thread-4  ]: Writing injected SQL for node "model.ex_02_chinook.dim_artist"
[0m08:29:10.374072 [debug] [Thread-1  ]: Began compiling node model.ex_02_chinook.vw_artist_album_counts
[0m08:29:10.387749 [debug] [Thread-2  ]: Writing injected SQL for node "model.ex_02_chinook.dim_album"
[0m08:29:10.454093 [debug] [Thread-4  ]: Began executing node model.ex_02_chinook.dim_artist
[0m08:29:10.458263 [debug] [Thread-1  ]: Writing injected SQL for node "model.ex_02_chinook.vw_artist_album_counts"
[0m08:29:10.476086 [debug] [Thread-1  ]: Began executing node model.ex_02_chinook.vw_artist_album_counts
[0m08:29:10.486111 [debug] [Thread-2  ]: Began executing node model.ex_02_chinook.dim_album
[0m08:29:10.551239 [debug] [Thread-1  ]: Creating new relation vw_artist_album_counts
[0m08:29:10.585560 [debug] [Thread-1  ]: Writing runtime sql for node "model.ex_02_chinook.vw_artist_album_counts"
[0m08:29:10.748916 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_02_chinook.vw_artist_album_counts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.vw_artist_album_counts"} */


  create view `mart`.`vw_artist_album_counts` 
  
    
    
  as (
    

with album as (
  select album_id, artist_id
  from `clean`.`stg_chinook__album`
),
artist as (
  select artist_id, artist_name
  from `clean`.`stg_chinook__artist`
)

select
  ar.artist_id,
  ar.artist_name,
  substring(ar.artist_name, 1, 1)             as artist_initial,
  count(a.album_id)                            as album_count,
  case when count(a.album_id) >= 3 then 1 else 0 end as is_prolific -- handy filter in dashboards
from artist ar
left join album a
  on a.artist_id = ar.artist_id
group by
  ar.artist_id,
  ar.artist_name
order by album_count desc, ar.artist_name asc
    
  )
      
      
                    -- end_of_sql
                    
                    ...
[0m08:29:10.854604 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.09 seconds
[0m08:29:10.879815 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4384ba45-b63c-4062-8002-7b173b60ec7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7080a1c356d0>]}
[0m08:29:10.892821 [info ] [Thread-1  ]: 5 of 5 OK created sql view model `mart`.`vw_artist_album_counts` ............... [[32mOK[0m in 0.52s]
[0m08:29:10.959919 [debug] [Thread-1  ]: Finished running node model.ex_02_chinook.vw_artist_album_counts
[0m08:29:11.161858 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m08:29:11.163053 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_02_chinook.dim_album: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.dim_album"} */

            

    
        create table `mart`.`dim_album__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

-- Album dimension, denormalized with artist_name (common convenience).
with album as (
  select * from `clean`.`stg_chinook__album`
),
artist as (
  select * from `clean`.`stg_chinook__artist`
)
select
  a.album_id,
  a.album_title,
  a.artist_id,
  ar.artist_name
from album a
left join artist ar
  on ar.artist_id = a.artist_id
          )
        
        ...
[0m08:29:11.182232 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m08:29:11.254546 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_02_chinook.dim_album: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.dim_album"} */

    select name, type from system.columns where table = 'dim_album__dbt_backup'
    
      and database = 'mart'
    
    order by position
  ...
[0m08:29:11.266164 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m08:29:11.277826 [debug] [Thread-2  ]: Writing runtime sql for node "model.ex_02_chinook.dim_album"
[0m08:29:11.279901 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_02_chinook.dim_album: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.dim_album"} */

  
    
    
    
        
         


        insert into `mart`.`dim_album__dbt_backup`
        ("album_id", "album_title", "artist_id", "artist_name")

-- Album dimension, denormalized with artist_name (common convenience).
with album as (
  select * from `clean`.`stg_chinook__album`
),
artist as (
  select * from `clean`.`stg_chinook__artist`
)
select
  a.album_id,
  a.album_title,
  a.artist_id,
  ar.artist_name
from album a
left join artist ar
  on ar.artist_id = a.artist_id
  ...
[0m08:29:11.296476 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m08:29:11.353461 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_02_chinook.dim_album: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.dim_album"} */
EXCHANGE TABLES `mart`.`dim_album__dbt_backup` AND `mart`.`dim_album` 
  
  ...
[0m08:29:11.359249 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:29:11.370403 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_02_chinook.dim_album: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.dim_album"} */

    drop table if exists `mart`.`dim_album__dbt_backup` 
  ...
[0m08:29:11.377652 [debug] [Thread-4  ]: dbt_clickhouse adapter: On model.ex_02_chinook.dim_artist: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.dim_artist"} */

            

    
        create table `mart`.`dim_artist__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

-- Simple conformed dimension for artists.
select
  artist_id,
  artist_name
from `clean`.`stg_chinook__artist`
          )
        
        ...
[0m08:29:11.384022 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m08:29:11.388177 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4384ba45-b63c-4062-8002-7b173b60ec7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7080a1d13f10>]}
[0m08:29:11.390091 [info ] [Thread-2  ]: 4 of 5 OK created sql table model `mart`.`dim_album` ........................... [[32mOK[0m in 1.03s]
[0m08:29:11.392394 [debug] [Thread-2  ]: Finished running node model.ex_02_chinook.dim_album
[0m08:29:11.396771 [debug] [Thread-4  ]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m08:29:11.456339 [debug] [Thread-4  ]: dbt_clickhouse adapter: On model.ex_02_chinook.dim_artist: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.dim_artist"} */

    select name, type from system.columns where table = 'dim_artist__dbt_backup'
    
      and database = 'mart'
    
    order by position
  ...
[0m08:29:11.465204 [debug] [Thread-4  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m08:29:11.470372 [debug] [Thread-4  ]: Writing runtime sql for node "model.ex_02_chinook.dim_artist"
[0m08:29:11.472610 [debug] [Thread-4  ]: dbt_clickhouse adapter: On model.ex_02_chinook.dim_artist: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.dim_artist"} */

  
    
    
    
        
         


        insert into `mart`.`dim_artist__dbt_backup`
        ("artist_id", "artist_name")

-- Simple conformed dimension for artists.
select
  artist_id,
  artist_name
from `clean`.`stg_chinook__artist`
  ...
[0m08:29:11.481914 [debug] [Thread-4  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m08:29:11.486200 [debug] [Thread-4  ]: dbt_clickhouse adapter: On model.ex_02_chinook.dim_artist: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.dim_artist"} */
EXCHANGE TABLES `mart`.`dim_artist__dbt_backup` AND `mart`.`dim_artist` 
  
  ...
[0m08:29:11.491731 [debug] [Thread-4  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:29:11.505390 [debug] [Thread-4  ]: dbt_clickhouse adapter: On model.ex_02_chinook.dim_artist: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.dim_artist"} */

    drop table if exists `mart`.`dim_artist__dbt_backup` 
  ...
[0m08:29:11.551816 [debug] [Thread-4  ]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m08:29:11.556363 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4384ba45-b63c-4062-8002-7b173b60ec7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7080a1d1e3d0>]}
[0m08:29:11.558389 [info ] [Thread-4  ]: 3 of 5 OK created sql table model `mart`.`dim_artist` .......................... [[32mOK[0m in 1.21s]
[0m08:29:11.560828 [debug] [Thread-4  ]: Finished running node model.ex_02_chinook.dim_artist
[0m08:29:11.564671 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:29:11.565761 [debug] [MainThread]: Connection 'list__mart' was left open.
[0m08:29:11.566928 [debug] [MainThread]: On list__mart: Close
[0m08:29:11.567997 [debug] [MainThread]: Connection 'list__clean' was left open.
[0m08:29:11.569092 [debug] [MainThread]: On list__clean: Close
[0m08:29:11.570168 [debug] [MainThread]: Connection 'model.ex_02_chinook.vw_artist_album_counts' was left open.
[0m08:29:11.571280 [debug] [MainThread]: On model.ex_02_chinook.vw_artist_album_counts: Close
[0m08:29:11.572339 [debug] [MainThread]: Connection 'model.ex_02_chinook.dim_album' was left open.
[0m08:29:11.573438 [debug] [MainThread]: On model.ex_02_chinook.dim_album: Close
[0m08:29:11.574477 [debug] [MainThread]: Connection 'model.ex_02_chinook.dim_artist' was left open.
[0m08:29:11.575597 [debug] [MainThread]: On model.ex_02_chinook.dim_artist: Close
[0m08:29:11.577708 [info ] [MainThread]: 
[0m08:29:11.579081 [info ] [MainThread]: Finished running 3 view models, 2 table models in 0 hours 0 minutes and 3.81 seconds (3.81s).
[0m08:29:11.585423 [debug] [MainThread]: Command end result
[0m08:29:11.865823 [info ] [MainThread]: 
[0m08:29:11.867586 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:29:11.869096 [info ] [MainThread]: 
[0m08:29:11.870767 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m08:29:11.873679 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 7.1826053, "process_in_blocks": "0", "process_kernel_time": 0.659697, "process_mem_max_rss": "114800", "process_out_blocks": "10624", "process_user_time": 6.298559}
[0m08:29:11.875446 [debug] [MainThread]: Command `dbt build` succeeded at 08:29:11.874943 after 7.18 seconds
[0m08:29:11.876819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7080a617ef40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7080a1ceb7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7080a40e3580>]}
[0m08:29:11.877962 [debug] [MainThread]: Flushing usage events
[0m14:29:11.568730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78c870148310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78c86cda7a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78c86cda7940>]}


============================== 14:29:11.628368 | be521379-d80d-4499-8089-a6aabe140f57 ==============================
[0m14:29:11.628368 [info ] [MainThread]: Running with dbt=1.8.9
[0m14:29:11.629467 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'log_format': 'default', 'target_path': 'None', 'version_check': 'True', 'static_parser': 'True', 'profiles_dir': '.', 'partial_parse': 'True', 'log_path': '/workdir/transforms/03_meteo/logs', 'use_colors': 'True', 'warn_error': 'None', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'introspect': 'True', 'printer_width': '80', 'no_print': 'None', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'debug': 'False', 'invocation_command': 'dbt build --profiles-dir . --target local', 'empty': 'False'}
[0m14:29:12.168304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'be521379-d80d-4499-8089-a6aabe140f57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78c86ccc0a30>]}
[0m14:29:12.364386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'be521379-d80d-4499-8089-a6aabe140f57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78c86d1e4250>]}
[0m14:29:12.366235 [info ] [MainThread]: Registered adapter: clickhouse=1.8.6
[0m14:29:12.833954 [debug] [MainThread]: checksum: 134c0f7b96382cc6938697739bc32fb1adc530b177e30f60cebddf61dbd7e979, vars: {}, profile: , target: local, version: 1.8.9
[0m14:29:13.163994 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m14:29:13.164963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'be521379-d80d-4499-8089-a6aabe140f57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78c86e0dc9a0>]}
[0m14:29:17.661911 [error] [MainThread]: Encountered an error:
Compilation Error in model mart_meteo__manila_daily (models/mart/mart_meteo__manila_daily.sql)
  invalid syntax for function call expression
    line 1
      {{ config(
[0m14:29:17.664317 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 6.236668, "process_in_blocks": "43312", "process_kernel_time": 0.631717, "process_mem_max_rss": "99900", "process_out_blocks": "6624", "process_user_time": 6.095277}
[0m14:29:17.665105 [debug] [MainThread]: Command `dbt build` failed at 14:29:17.664895 after 6.24 seconds
[0m14:29:17.665757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78c870148310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78c86c549dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78c86c5fd8e0>]}
[0m14:29:17.666357 [debug] [MainThread]: Flushing usage events
[0m14:38:09.411212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f6bcb9e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f6891eb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f6891ea30>]}


============================== 14:38:09.422767 | 12f6f99d-a3c3-469b-861a-900627540855 ==============================
[0m14:38:09.422767 [info ] [MainThread]: Running with dbt=1.8.9
[0m14:38:09.423913 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt build --profiles-dir . --target local', 'log_cache_events': 'False', 'no_print': 'None', 'log_path': '/workdir/transforms/03_meteo/logs', 'profiles_dir': '.', 'use_experimental_parser': 'False', 'write_json': 'True', 'version_check': 'True', 'static_parser': 'True', 'indirect_selection': 'eager', 'debug': 'False', 'introspect': 'True', 'printer_width': '80', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'warn_error': 'None', 'log_format': 'default', 'fail_fast': 'False', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'quiet': 'False', 'empty': 'False', 'partial_parse': 'True'}
[0m14:38:10.013378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '12f6f99d-a3c3-469b-861a-900627540855', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f6b154910>]}
[0m14:38:10.206951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '12f6f99d-a3c3-469b-861a-900627540855', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f689740d0>]}
[0m14:38:10.208266 [info ] [MainThread]: Registered adapter: clickhouse=1.8.6
[0m14:38:10.622188 [debug] [MainThread]: checksum: 134c0f7b96382cc6938697739bc32fb1adc530b177e30f60cebddf61dbd7e979, vars: {}, profile: , target: local, version: 1.8.9
[0m14:38:11.003216 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m14:38:11.004080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '12f6f99d-a3c3-469b-861a-900627540855', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f69bd6700>]}
[0m14:38:15.406939 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:38:15.407822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '12f6f99d-a3c3-469b-861a-900627540855', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f67d01850>]}
[0m14:38:16.224974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '12f6f99d-a3c3-469b-861a-900627540855', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f679d7130>]}
[0m14:38:16.738809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '12f6f99d-a3c3-469b-861a-900627540855', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f67a10b20>]}
[0m14:38:16.739698 [info ] [MainThread]: Found 3 models, 4 data tests, 1 source, 471 macros
[0m14:38:16.742899 [info ] [MainThread]: 
[0m14:38:16.743899 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m14:38:16.782307 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m14:38:16.756623 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m14:38:16.818323 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:38:16.822243 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:38:17.418699 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m14:38:17.425041 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m14:38:17.484133 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m14:38:17.491081 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m14:38:17.529614 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__mart)
[0m14:38:17.531513 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__clean)
[0m14:38:17.604754 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__mart: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list__mart"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'mart'
      

  ...
[0m14:38:17.614529 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list__clean"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'clean'
      

  ...
[0m14:38:17.622596 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m14:38:17.627279 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m14:38:17.686453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12f6f99d-a3c3-469b-861a-900627540855', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f6707d9a0>]}
[0m14:38:17.688301 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m14:38:17.689654 [info ] [MainThread]: 
[0m14:38:17.717016 [debug] [Thread-1  ]: Began running node model.ex_03_meteo.stg_meteo__manila
[0m14:38:17.718582 [info ] [Thread-1  ]: 1 of 7 START sql view model `clean`.`stg_meteo__manila` ........................ [RUN]
[0m14:38:17.719988 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.ex_03_meteo.stg_meteo__manila'
[0m14:38:17.720989 [debug] [Thread-1  ]: Began compiling node model.ex_03_meteo.stg_meteo__manila
[0m14:38:17.791592 [debug] [Thread-1  ]: Writing injected SQL for node "model.ex_03_meteo.stg_meteo__manila"
[0m14:38:17.793215 [debug] [Thread-1  ]: Began executing node model.ex_03_meteo.stg_meteo__manila
[0m14:38:17.896865 [debug] [Thread-1  ]: Creating new relation stg_meteo__manila
[0m14:38:17.922576 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m14:38:18.032768 [debug] [Thread-1  ]: Writing runtime sql for node "model.ex_03_meteo.stg_meteo__manila"
[0m14:38:18.034230 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_03_meteo.stg_meteo__manila: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_03_meteo.stg_meteo__manila"} */


  create view `clean`.`stg_meteo__manila` 
  
    
    
  as (
    

-- Normalize types & naming; no business logic here.
select
  toDate(date)                         as dte,
  toFloat64(temp_min)                  as temp_min_c,
  toFloat64(temp_max)                  as temp_max_c,
  toFloat64(precipitation)             as precip_mm,
  toInt32(weather_code)                as weather_code
from `raw`.`meteo__manila`
    
  )
      
      
                    -- end_of_sql
                    
                    ...
[0m14:38:18.039065 [debug] [Thread-1  ]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_03_meteo.stg_meteo__manila"} */


  create view `clean`.`stg_meteo__manila` 
  
    
    
  as (
    

-- Normalize types & naming; no business logic here.
select
  toDate(date)                         as dte,
  toFloat64(temp_min)                  as temp_min_c,
  toFloat64(temp_max)                  as temp_max_c,
  toFloat64(precipitation)             as precip_mm,
  toInt32(weather_code)                as weather_code
from `raw`.`meteo__manila`
    
  )
      
      
                    -- end_of_sql
                    
                    
[0m14:38:18.047978 [debug] [Thread-1  ]: Database Error in model stg_meteo__manila (models/clean/stg_meteo__manila.sql)
  HTTPDriver for http://clickhouse:8123 received ClickHouse error code 60
   Code: 60. DB::Exception: Table raw.meteo__manila does not exist. Maybe you meant raw.meteo___manila?. (UNKNOWN_TABLE) (version 23.12.6.19 (official build))
  compiled code at target/run/ex_03_meteo/models/clean/stg_meteo__manila.sql
[0m14:38:18.050517 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12f6f99d-a3c3-469b-861a-900627540855', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f675e5eb0>]}
[0m14:38:18.051835 [error] [Thread-1  ]: 1 of 7 ERROR creating sql view model `clean`.`stg_meteo__manila` ............... [[31mERROR[0m in 0.33s]
[0m14:38:18.053236 [debug] [Thread-1  ]: Finished running node model.ex_03_meteo.stg_meteo__manila
[0m14:38:18.055498 [debug] [Thread-3  ]: Began running node test.ex_03_meteo.not_null_stg_meteo__manila_dte.513a28a12f
[0m14:38:18.056843 [debug] [Thread-4  ]: Began running node test.ex_03_meteo.not_null_stg_meteo__manila_temp_max_c.a5e6f8c339
[0m14:38:18.058582 [debug] [Thread-2  ]: Began running node test.ex_03_meteo.not_null_stg_meteo__manila_temp_min_c.f577a564e9
[0m14:38:18.059702 [debug] [Thread-1  ]: Began running node test.ex_03_meteo.unique_stg_meteo__manila_dte.65d5c5a8bc
[0m14:38:18.061064 [info ] [Thread-3  ]: 2 of 7 SKIP test not_null_stg_meteo__manila_dte ................................ [[33mSKIP[0m]
[0m14:38:18.063729 [info ] [Thread-4  ]: 3 of 7 SKIP test not_null_stg_meteo__manila_temp_max_c ......................... [[33mSKIP[0m]
[0m14:38:18.066046 [info ] [Thread-2  ]: 4 of 7 SKIP test not_null_stg_meteo__manila_temp_min_c ......................... [[33mSKIP[0m]
[0m14:38:18.068001 [info ] [Thread-1  ]: 5 of 7 SKIP test unique_stg_meteo__manila_dte .................................. [[33mSKIP[0m]
[0m14:38:18.070213 [debug] [Thread-3  ]: Finished running node test.ex_03_meteo.not_null_stg_meteo__manila_dte.513a28a12f
[0m14:38:18.072007 [debug] [Thread-4  ]: Finished running node test.ex_03_meteo.not_null_stg_meteo__manila_temp_max_c.a5e6f8c339
[0m14:38:18.073760 [debug] [Thread-2  ]: Finished running node test.ex_03_meteo.not_null_stg_meteo__manila_temp_min_c.f577a564e9
[0m14:38:18.082477 [debug] [Thread-1  ]: Finished running node test.ex_03_meteo.unique_stg_meteo__manila_dte.65d5c5a8bc
[0m14:38:18.086673 [debug] [Thread-3  ]: Began running node model.ex_03_meteo.mart_meteo__manila_daily
[0m14:38:18.088210 [debug] [Thread-4  ]: Began running node model.ex_03_meteo.mart_meteo__manila_monthly
[0m14:38:18.089971 [info ] [Thread-3  ]: 6 of 7 SKIP relation mart.mart_meteo__manila_daily ............................. [[33mSKIP[0m]
[0m14:38:18.091908 [info ] [Thread-4  ]: 7 of 7 SKIP relation mart.mart_meteo__manila_monthly ........................... [[33mSKIP[0m]
[0m14:38:18.093943 [debug] [Thread-3  ]: Finished running node model.ex_03_meteo.mart_meteo__manila_daily
[0m14:38:18.095757 [debug] [Thread-4  ]: Finished running node model.ex_03_meteo.mart_meteo__manila_monthly
[0m14:38:18.100043 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:38:18.101328 [debug] [MainThread]: Connection 'list__mart' was left open.
[0m14:38:18.102721 [debug] [MainThread]: On list__mart: Close
[0m14:38:18.103873 [debug] [MainThread]: Connection 'list__clean' was left open.
[0m14:38:18.105050 [debug] [MainThread]: On list__clean: Close
[0m14:38:18.106175 [debug] [MainThread]: Connection 'model.ex_03_meteo.stg_meteo__manila' was left open.
[0m14:38:18.107445 [debug] [MainThread]: On model.ex_03_meteo.stg_meteo__manila: Close
[0m14:38:18.109331 [info ] [MainThread]: 
[0m14:38:18.110748 [info ] [MainThread]: Finished running 1 view model, 4 data tests, 2 table models in 0 hours 0 minutes and 1.37 seconds (1.37s).
[0m14:38:18.115648 [debug] [MainThread]: Command end result
[0m14:38:18.329127 [info ] [MainThread]: 
[0m14:38:18.330292 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:38:18.331189 [info ] [MainThread]: 
[0m14:38:18.383025 [error] [MainThread]:   Database Error in model stg_meteo__manila (models/clean/stg_meteo__manila.sql)
  HTTPDriver for http://clickhouse:8123 received ClickHouse error code 60
   Code: 60. DB::Exception: Table raw.meteo__manila does not exist. Maybe you meant raw.meteo___manila?. (UNKNOWN_TABLE) (version 23.12.6.19 (official build))
  compiled code at target/run/ex_03_meteo/models/clean/stg_meteo__manila.sql
[0m14:38:18.384496 [info ] [MainThread]: 
[0m14:38:18.385917 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=6 TOTAL=7
[0m14:38:18.388873 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 9.179361, "process_in_blocks": "7128", "process_kernel_time": 0.633699, "process_mem_max_rss": "117360", "process_out_blocks": "10544", "process_user_time": 7.380388}
[0m14:38:18.390414 [debug] [MainThread]: Command `dbt build` failed at 14:38:18.390012 after 9.18 seconds
[0m14:38:18.391736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f6bcb9e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f6b154910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f67894ac0>]}
[0m14:38:18.393012 [debug] [MainThread]: Flushing usage events
[0m14:51:33.802297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73252b47a310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7325280dab50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7325280daa00>]}


============================== 14:51:33.863448 | 1a0f6246-5ab4-4dec-a443-c98a3a79ad87 ==============================
[0m14:51:33.863448 [info ] [MainThread]: Running with dbt=1.8.9
[0m14:51:33.864697 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'empty': 'False', 'partial_parse': 'True', 'profiles_dir': '.', 'use_colors': 'True', 'target_path': 'None', 'write_json': 'True', 'debug': 'False', 'introspect': 'True', 'quiet': 'False', 'static_parser': 'True', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'version_check': 'True', 'log_path': '/workdir/transforms/03_meteo/logs', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'log_format': 'default', 'fail_fast': 'False', 'invocation_command': 'dbt build --profiles-dir . --target local', 'use_experimental_parser': 'False'}
[0m14:51:34.396121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1a0f6246-5ab4-4dec-a443-c98a3a79ad87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x732527ff5520>]}
[0m14:51:34.589278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1a0f6246-5ab4-4dec-a443-c98a3a79ad87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x732527f49e20>]}
[0m14:51:34.590583 [info ] [MainThread]: Registered adapter: clickhouse=1.8.6
[0m14:51:35.003942 [debug] [MainThread]: checksum: 134c0f7b96382cc6938697739bc32fb1adc530b177e30f60cebddf61dbd7e979, vars: {}, profile: , target: local, version: 1.8.9
[0m14:51:35.575029 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:51:35.576421 [debug] [MainThread]: Partial parsing: updated file: ex_03_meteo://models/sources.yml
[0m14:51:36.300152 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:51:36.301077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1a0f6246-5ab4-4dec-a443-c98a3a79ad87', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x732527718a90>]}
[0m14:51:36.967203 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.ex_03_meteo.stg_meteo__manila' (models/clean/stg_meteo__manila.sql) depends on a source named 'raw.meteo__manila' which was not found
[0m14:51:36.968816 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 3.3599393, "process_in_blocks": "0", "process_kernel_time": 0.519098, "process_mem_max_rss": "104420", "process_out_blocks": "6616", "process_user_time": 4.472154}
[0m14:51:36.969596 [debug] [MainThread]: Command `dbt build` failed at 14:51:36.969356 after 3.36 seconds
[0m14:51:36.970245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73252b47a310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7325278581f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7325278047f0>]}
[0m14:51:36.970949 [debug] [MainThread]: Flushing usage events
[0m14:59:29.413824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee4809b7310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee47d618b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee47d6189d0>]}


============================== 14:59:29.423069 | 75dad68a-9f02-4bab-81b2-0f5442514c1a ==============================
[0m14:59:29.423069 [info ] [MainThread]: Running with dbt=1.8.9
[0m14:59:29.424198 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'target_path': 'None', 'version_check': 'True', 'warn_error': 'None', 'profiles_dir': '.', 'static_parser': 'True', 'printer_width': '80', 'cache_selected_only': 'False', 'use_colors': 'True', 'debug': 'False', 'introspect': 'True', 'write_json': 'True', 'log_path': '/workdir/transforms/03_meteo/logs', 'invocation_command': 'dbt build --profiles-dir . --target local', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'no_print': 'None', 'quiet': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'use_experimental_parser': 'False'}
[0m14:59:29.949296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '75dad68a-9f02-4bab-81b2-0f5442514c1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee47d5319d0>]}
[0m14:59:30.146509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '75dad68a-9f02-4bab-81b2-0f5442514c1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee47d5cf5b0>]}
[0m14:59:30.147931 [info ] [MainThread]: Registered adapter: clickhouse=1.8.6
[0m14:59:30.617222 [debug] [MainThread]: checksum: 134c0f7b96382cc6938697739bc32fb1adc530b177e30f60cebddf61dbd7e979, vars: {}, profile: , target: local, version: 1.8.9
[0m14:59:31.121368 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m14:59:31.122819 [debug] [MainThread]: Partial parsing: updated file: ex_03_meteo://models/sources.yml
[0m14:59:31.123412 [debug] [MainThread]: Partial parsing: updated file: ex_03_meteo://models/clean/stg_meteo__manila.sql
[0m14:59:31.854865 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:59:31.855871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '75dad68a-9f02-4bab-81b2-0f5442514c1a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee47c867eb0>]}
[0m14:59:32.834831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '75dad68a-9f02-4bab-81b2-0f5442514c1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee47c496ee0>]}
[0m14:59:33.273387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '75dad68a-9f02-4bab-81b2-0f5442514c1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee47d2ae580>]}
[0m14:59:33.274378 [info ] [MainThread]: Found 3 models, 4 data tests, 1 source, 471 macros
[0m14:59:33.316114 [info ] [MainThread]: 
[0m14:59:33.317629 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m14:59:33.330511 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m14:59:33.332088 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m14:59:33.549140 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:59:33.560945 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:59:34.122160 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m14:59:34.127053 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m14:59:34.152914 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m14:59:34.160030 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m14:59:34.229873 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__mart)
[0m14:59:34.231000 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__clean)
[0m14:59:34.243699 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__mart: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list__mart"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'mart'
      

  ...
[0m14:59:34.249049 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list__clean"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'clean'
      

  ...
[0m14:59:34.255987 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m14:59:34.257344 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m14:59:34.316943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75dad68a-9f02-4bab-81b2-0f5442514c1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee4809177c0>]}
[0m14:59:34.319026 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m14:59:34.320416 [info ] [MainThread]: 
[0m14:59:34.348173 [debug] [Thread-1  ]: Began running node model.ex_03_meteo.stg_meteo__manila
[0m14:59:34.349422 [info ] [Thread-1  ]: 1 of 7 START sql view model `clean`.`stg_meteo__manila` ........................ [RUN]
[0m14:59:34.350488 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list__mart, now model.ex_03_meteo.stg_meteo__manila)
[0m14:59:34.351416 [debug] [Thread-1  ]: Began compiling node model.ex_03_meteo.stg_meteo__manila
[0m14:59:34.422371 [debug] [Thread-1  ]: Writing injected SQL for node "model.ex_03_meteo.stg_meteo__manila"
[0m14:59:34.424241 [debug] [Thread-1  ]: Began executing node model.ex_03_meteo.stg_meteo__manila
[0m14:59:34.515604 [debug] [Thread-1  ]: Creating new relation stg_meteo__manila
[0m14:59:34.535141 [debug] [Thread-1  ]: Writing runtime sql for node "model.ex_03_meteo.stg_meteo__manila"
[0m14:59:34.536496 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_03_meteo.stg_meteo__manila: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_03_meteo.stg_meteo__manila"} */


  create view `clean`.`stg_meteo__manila` 
  
    
    
  as (
    

-- Normalize types & naming; no business logic here.
select
  toDate(date)                         as dte,
  toFloat64(temp_min)                  as temp_min_c,
  toFloat64(temp_max)                  as temp_max_c,
  toFloat64(precipitation)             as precip_mm,
  toInt32(weather_code)                as weather_code
from `raw`.`meteo___manila`
    
  )
      
      
                    -- end_of_sql
                    
                    ...
[0m14:59:34.547350 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m14:59:34.626476 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75dad68a-9f02-4bab-81b2-0f5442514c1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee47bab02b0>]}
[0m14:59:34.627664 [info ] [Thread-1  ]: 1 of 7 OK created sql view model `clean`.`stg_meteo__manila` ................... [[32mOK[0m in 0.27s]
[0m14:59:34.629070 [debug] [Thread-1  ]: Finished running node model.ex_03_meteo.stg_meteo__manila
[0m14:59:34.631428 [debug] [Thread-3  ]: Began running node test.ex_03_meteo.not_null_stg_meteo__manila_dte.513a28a12f
[0m14:59:34.632984 [debug] [Thread-4  ]: Began running node test.ex_03_meteo.not_null_stg_meteo__manila_temp_max_c.a5e6f8c339
[0m14:59:34.634191 [info ] [Thread-3  ]: 2 of 7 START test not_null_stg_meteo__manila_dte ............................... [RUN]
[0m14:59:34.635903 [debug] [Thread-2  ]: Began running node test.ex_03_meteo.not_null_stg_meteo__manila_temp_min_c.f577a564e9
[0m14:59:34.637651 [info ] [Thread-4  ]: 3 of 7 START test not_null_stg_meteo__manila_temp_max_c ........................ [RUN]
[0m14:59:34.639351 [debug] [Thread-1  ]: Began running node test.ex_03_meteo.unique_stg_meteo__manila_dte.65d5c5a8bc
[0m14:59:34.641193 [debug] [Thread-3  ]: Acquiring new clickhouse connection 'test.ex_03_meteo.not_null_stg_meteo__manila_dte.513a28a12f'
[0m14:59:34.642948 [info ] [Thread-2  ]: 4 of 7 START test not_null_stg_meteo__manila_temp_min_c ........................ [RUN]
[0m14:59:34.644651 [debug] [Thread-4  ]: Acquiring new clickhouse connection 'test.ex_03_meteo.not_null_stg_meteo__manila_temp_max_c.a5e6f8c339'
[0m14:59:34.645994 [info ] [Thread-1  ]: 5 of 7 START test unique_stg_meteo__manila_dte ................................. [RUN]
[0m14:59:34.647312 [debug] [Thread-3  ]: Began compiling node test.ex_03_meteo.not_null_stg_meteo__manila_dte.513a28a12f
[0m14:59:34.648866 [debug] [Thread-2  ]: Acquiring new clickhouse connection 'test.ex_03_meteo.not_null_stg_meteo__manila_temp_min_c.f577a564e9'
[0m14:59:34.650111 [debug] [Thread-4  ]: Began compiling node test.ex_03_meteo.not_null_stg_meteo__manila_temp_max_c.a5e6f8c339
[0m14:59:34.651442 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ex_03_meteo.stg_meteo__manila, now test.ex_03_meteo.unique_stg_meteo__manila_dte.65d5c5a8bc)
[0m14:59:34.724260 [debug] [Thread-2  ]: Began compiling node test.ex_03_meteo.not_null_stg_meteo__manila_temp_min_c.f577a564e9
[0m14:59:34.758890 [debug] [Thread-3  ]: Writing injected SQL for node "test.ex_03_meteo.not_null_stg_meteo__manila_dte.513a28a12f"
[0m14:59:34.813960 [debug] [Thread-1  ]: Began compiling node test.ex_03_meteo.unique_stg_meteo__manila_dte.65d5c5a8bc
[0m14:59:34.824963 [debug] [Thread-4  ]: Writing injected SQL for node "test.ex_03_meteo.not_null_stg_meteo__manila_temp_max_c.a5e6f8c339"
[0m14:59:34.841030 [debug] [Thread-2  ]: Writing injected SQL for node "test.ex_03_meteo.not_null_stg_meteo__manila_temp_min_c.f577a564e9"
[0m14:59:34.853341 [debug] [Thread-3  ]: Began executing node test.ex_03_meteo.not_null_stg_meteo__manila_dte.513a28a12f
[0m14:59:34.918912 [debug] [Thread-1  ]: Writing injected SQL for node "test.ex_03_meteo.unique_stg_meteo__manila_dte.65d5c5a8bc"
[0m14:59:34.921044 [debug] [Thread-4  ]: Began executing node test.ex_03_meteo.not_null_stg_meteo__manila_temp_max_c.a5e6f8c339
[0m14:59:34.927854 [debug] [Thread-2  ]: Began executing node test.ex_03_meteo.not_null_stg_meteo__manila_temp_min_c.f577a564e9
[0m14:59:35.048284 [debug] [Thread-3  ]: Writing runtime sql for node "test.ex_03_meteo.not_null_stg_meteo__manila_dte.513a28a12f"
[0m14:59:35.060381 [debug] [Thread-4  ]: Writing runtime sql for node "test.ex_03_meteo.not_null_stg_meteo__manila_temp_max_c.a5e6f8c339"
[0m14:59:35.115071 [debug] [Thread-2  ]: Writing runtime sql for node "test.ex_03_meteo.not_null_stg_meteo__manila_temp_min_c.f577a564e9"
[0m14:59:35.116916 [debug] [Thread-1  ]: Began executing node test.ex_03_meteo.unique_stg_meteo__manila_dte.65d5c5a8bc
[0m14:59:35.119639 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m14:59:35.121247 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m14:59:35.123051 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m14:59:35.134515 [debug] [Thread-1  ]: Writing runtime sql for node "test.ex_03_meteo.unique_stg_meteo__manila_dte.65d5c5a8bc"
[0m14:59:35.145813 [debug] [Thread-1  ]: dbt_clickhouse adapter: On test.ex_03_meteo.unique_stg_meteo__manila_dte.65d5c5a8bc: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "test.ex_03_meteo.unique_stg_meteo__manila_dte.65d5c5a8bc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    dte as unique_field,
    count(*) as n_records

from `clean`.`stg_meteo__manila`
where dte is not null
group by dte
having count(*) > 1



    ) dbt_internal_test...
[0m14:59:35.254205 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.10 seconds
[0m14:59:35.326604 [info ] [Thread-1  ]: 5 of 7 PASS unique_stg_meteo__manila_dte ....................................... [[32mPASS[0m in 0.67s]
[0m14:59:35.338480 [debug] [Thread-1  ]: Finished running node test.ex_03_meteo.unique_stg_meteo__manila_dte.65d5c5a8bc
[0m14:59:35.431022 [debug] [Thread-4  ]: dbt_clickhouse adapter: On test.ex_03_meteo.not_null_stg_meteo__manila_temp_max_c.a5e6f8c339: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "test.ex_03_meteo.not_null_stg_meteo__manila_temp_max_c.a5e6f8c339"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select temp_max_c
from `clean`.`stg_meteo__manila`
where temp_max_c is null



    ) dbt_internal_test...
[0m14:59:35.442663 [debug] [Thread-4  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m14:59:35.448956 [info ] [Thread-4  ]: 3 of 7 PASS not_null_stg_meteo__manila_temp_max_c .............................. [[32mPASS[0m in 0.80s]
[0m14:59:35.457580 [debug] [Thread-4  ]: Finished running node test.ex_03_meteo.not_null_stg_meteo__manila_temp_max_c.a5e6f8c339
[0m14:59:35.515101 [debug] [Thread-2  ]: dbt_clickhouse adapter: On test.ex_03_meteo.not_null_stg_meteo__manila_temp_min_c.f577a564e9: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "test.ex_03_meteo.not_null_stg_meteo__manila_temp_min_c.f577a564e9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select temp_min_c
from `clean`.`stg_meteo__manila`
where temp_min_c is null



    ) dbt_internal_test...
[0m14:59:35.471139 [debug] [Thread-3  ]: dbt_clickhouse adapter: On test.ex_03_meteo.not_null_stg_meteo__manila_dte.513a28a12f: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "test.ex_03_meteo.not_null_stg_meteo__manila_dte.513a28a12f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select dte
from `clean`.`stg_meteo__manila`
where dte is null



    ) dbt_internal_test...
[0m14:59:35.573091 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m14:59:35.575729 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m14:59:35.582180 [info ] [Thread-3  ]: 2 of 7 PASS not_null_stg_meteo__manila_dte ..................................... [[32mPASS[0m in 0.94s]
[0m14:59:35.588400 [info ] [Thread-2  ]: 4 of 7 PASS not_null_stg_meteo__manila_temp_min_c .............................. [[32mPASS[0m in 0.94s]
[0m14:59:35.592009 [debug] [Thread-3  ]: Finished running node test.ex_03_meteo.not_null_stg_meteo__manila_dte.513a28a12f
[0m14:59:35.595265 [debug] [Thread-2  ]: Finished running node test.ex_03_meteo.not_null_stg_meteo__manila_temp_min_c.f577a564e9
[0m14:59:35.598943 [debug] [Thread-1  ]: Began running node model.ex_03_meteo.mart_meteo__manila_daily
[0m14:59:35.600714 [debug] [Thread-4  ]: Began running node model.ex_03_meteo.mart_meteo__manila_monthly
[0m14:59:35.602974 [info ] [Thread-1  ]: 6 of 7 START sql table model `mart`.`mart_meteo__manila_daily` ................. [RUN]
[0m14:59:35.605338 [info ] [Thread-4  ]: 7 of 7 START sql table model `mart`.`mart_meteo__manila_monthly` ............... [RUN]
[0m14:59:35.607405 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ex_03_meteo.unique_stg_meteo__manila_dte.65d5c5a8bc, now model.ex_03_meteo.mart_meteo__manila_daily)
[0m14:59:35.609274 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ex_03_meteo.not_null_stg_meteo__manila_temp_max_c.a5e6f8c339, now model.ex_03_meteo.mart_meteo__manila_monthly)
[0m14:59:35.610878 [debug] [Thread-1  ]: Began compiling node model.ex_03_meteo.mart_meteo__manila_daily
[0m14:59:35.612433 [debug] [Thread-4  ]: Began compiling node model.ex_03_meteo.mart_meteo__manila_monthly
[0m14:59:35.626052 [debug] [Thread-1  ]: Writing injected SQL for node "model.ex_03_meteo.mart_meteo__manila_daily"
[0m14:59:35.639608 [debug] [Thread-4  ]: Writing injected SQL for node "model.ex_03_meteo.mart_meteo__manila_monthly"
[0m14:59:35.642200 [debug] [Thread-4  ]: Began executing node model.ex_03_meteo.mart_meteo__manila_monthly
[0m14:59:35.659330 [debug] [Thread-1  ]: Began executing node model.ex_03_meteo.mart_meteo__manila_daily
[0m14:59:35.845632 [debug] [Thread-4  ]: Creating new relation mart_meteo__manila_monthly
[0m14:59:35.918861 [debug] [Thread-1  ]: Creating new relation mart_meteo__manila_daily
[0m14:59:36.258041 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_03_meteo.mart_meteo__manila_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_03_meteo.mart_meteo__manila_daily"} */

            

    
        create table `mart`.`mart_meteo__manila_daily`
        
  
        
  engine = MergeTree()
        order by (dte)
        
        partition by (toYYYYMM(dte))
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

-- Daily meteo mart (persisted)
select
  dte,
  temp_min_c,
  temp_max_c,
  (temp_min_c + temp_max_c)/2.0 as temp_avg_c,
  precip_mm,
  weather_code
from `clean`.`stg_meteo__manila`
          )
        
        ...
[0m14:59:36.260888 [debug] [Thread-4  ]: dbt_clickhouse adapter: On model.ex_03_meteo.mart_meteo__manila_monthly: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_03_meteo.mart_meteo__manila_monthly"} */

            

    
        create table `mart`.`mart_meteo__manila_monthly`
        
  
        
  engine = MergeTree()
        order by (month)
        
        partition by (toYYYYMM(month))
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

with base as (
  select
    dte,
    temp_min_c,
    temp_max_c,
    (temp_min_c + temp_max_c)/2.0 as temp_avg_c,
    precip_mm
  from `clean`.`stg_meteo__manila`
)
select
  toStartOfMonth(dte)           as month,
  avg(temp_min_c)               as avg_min_c,
  avg(temp_max_c)               as avg_max_c,
  avg(temp_avg_c)               as avg_temp_c,
  sum(precip_mm)                as total_precip_mm,
  countIf(precip_mm > 0)        as rainy_days
from base
group by month
order by month
          )
        
        ...
[0m14:59:36.326599 [debug] [Thread-4  ]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_03_meteo.mart_meteo__manila_monthly"} */

            

    
        create table `mart`.`mart_meteo__manila_monthly`
        
  
        
  engine = MergeTree()
        order by (month)
        
        partition by (toYYYYMM(month))
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

with base as (
  select
    dte,
    temp_min_c,
    temp_max_c,
    (temp_min_c + temp_max_c)/2.0 as temp_avg_c,
    precip_mm
  from `clean`.`stg_meteo__manila`
)
select
  toStartOfMonth(dte)           as month,
  avg(temp_min_c)               as avg_min_c,
  avg(temp_max_c)               as avg_max_c,
  avg(temp_avg_c)               as avg_temp_c,
  sum(precip_mm)                as total_precip_mm,
  countIf(precip_mm > 0)        as rainy_days
from base
group by month
order by month
          )
        
        
[0m14:59:36.329683 [debug] [Thread-1  ]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_03_meteo.mart_meteo__manila_daily"} */

            

    
        create table `mart`.`mart_meteo__manila_daily`
        
  
        
  engine = MergeTree()
        order by (dte)
        
        partition by (toYYYYMM(dte))
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

-- Daily meteo mart (persisted)
select
  dte,
  temp_min_c,
  temp_max_c,
  (temp_min_c + temp_max_c)/2.0 as temp_avg_c,
  precip_mm,
  weather_code
from `clean`.`stg_meteo__manila`
          )
        
        
[0m14:59:36.342921 [debug] [Thread-1  ]: Database Error in model mart_meteo__manila_daily (models/mart/mart_meteo__manila_daily.sql)
  HTTPDriver for http://clickhouse:8123 received ClickHouse error code 44
   Code: 44. DB::Exception: Partition key contains nullable columns, but merge tree setting `allow_nullable_key` is disabled. (ILLEGAL_COLUMN) (version 23.12.6.19 (official build))
[0m14:59:36.346732 [debug] [Thread-4  ]: Database Error in model mart_meteo__manila_monthly (models/mart/mart_meteo__manila_monthly.sql)
  HTTPDriver for http://clickhouse:8123 received ClickHouse error code 44
   Code: 44. DB::Exception: Partition key contains nullable columns, but merge tree setting `allow_nullable_key` is disabled. (ILLEGAL_COLUMN) (version 23.12.6.19 (official build))
[0m14:59:36.348260 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75dad68a-9f02-4bab-81b2-0f5442514c1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee47b3755e0>]}
[0m14:59:36.349917 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75dad68a-9f02-4bab-81b2-0f5442514c1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee47b2d6c10>]}
[0m14:59:36.352438 [error] [Thread-1  ]: 6 of 7 ERROR creating sql table model `mart`.`mart_meteo__manila_daily` ........ [[31mERROR[0m in 0.74s]
[0m14:59:36.355149 [error] [Thread-4  ]: 7 of 7 ERROR creating sql table model `mart`.`mart_meteo__manila_monthly` ...... [[31mERROR[0m in 0.74s]
[0m14:59:36.358402 [debug] [Thread-1  ]: Finished running node model.ex_03_meteo.mart_meteo__manila_daily
[0m14:59:36.361339 [debug] [Thread-4  ]: Finished running node model.ex_03_meteo.mart_meteo__manila_monthly
[0m14:59:36.365897 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:59:36.367125 [debug] [MainThread]: Connection 'model.ex_03_meteo.mart_meteo__manila_daily' was left open.
[0m14:59:36.368413 [debug] [MainThread]: On model.ex_03_meteo.mart_meteo__manila_daily: Close
[0m14:59:36.414384 [debug] [MainThread]: Connection 'list__clean' was left open.
[0m14:59:36.415488 [debug] [MainThread]: On list__clean: Close
[0m14:59:36.416554 [debug] [MainThread]: Connection 'test.ex_03_meteo.not_null_stg_meteo__manila_dte.513a28a12f' was left open.
[0m14:59:36.417642 [debug] [MainThread]: On test.ex_03_meteo.not_null_stg_meteo__manila_dte.513a28a12f: Close
[0m14:59:36.418685 [debug] [MainThread]: Connection 'model.ex_03_meteo.mart_meteo__manila_monthly' was left open.
[0m14:59:36.419809 [debug] [MainThread]: On model.ex_03_meteo.mart_meteo__manila_monthly: Close
[0m14:59:36.420987 [debug] [MainThread]: Connection 'test.ex_03_meteo.not_null_stg_meteo__manila_temp_min_c.f577a564e9' was left open.
[0m14:59:36.422070 [debug] [MainThread]: On test.ex_03_meteo.not_null_stg_meteo__manila_temp_min_c.f577a564e9: Close
[0m14:59:36.424201 [info ] [MainThread]: 
[0m14:59:36.425979 [info ] [MainThread]: Finished running 1 view model, 4 data tests, 2 table models in 0 hours 0 minutes and 3.11 seconds (3.11s).
[0m14:59:36.435201 [debug] [MainThread]: Command end result
[0m14:59:36.650219 [info ] [MainThread]: 
[0m14:59:36.651758 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m14:59:36.652945 [info ] [MainThread]: 
[0m14:59:36.654400 [error] [MainThread]:   Database Error in model mart_meteo__manila_daily (models/mart/mart_meteo__manila_daily.sql)
  HTTPDriver for http://clickhouse:8123 received ClickHouse error code 44
   Code: 44. DB::Exception: Partition key contains nullable columns, but merge tree setting `allow_nullable_key` is disabled. (ILLEGAL_COLUMN) (version 23.12.6.19 (official build))
[0m14:59:36.655607 [info ] [MainThread]: 
[0m14:59:36.656986 [error] [MainThread]:   Database Error in model mart_meteo__manila_monthly (models/mart/mart_meteo__manila_monthly.sql)
  HTTPDriver for http://clickhouse:8123 received ClickHouse error code 44
   Code: 44. DB::Exception: Partition key contains nullable columns, but merge tree setting `allow_nullable_key` is disabled. (ILLEGAL_COLUMN) (version 23.12.6.19 (official build))
[0m14:59:36.658045 [info ] [MainThread]: 
[0m14:59:36.659165 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=2 SKIP=0 TOTAL=7
[0m14:59:36.661270 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 7.4437466, "process_in_blocks": "0", "process_kernel_time": 0.646847, "process_mem_max_rss": "118136", "process_out_blocks": "10648", "process_user_time": 6.436773}
[0m14:59:36.662473 [debug] [MainThread]: Command `dbt build` failed at 14:59:36.662166 after 7.45 seconds
[0m14:59:36.714836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee4809b7310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee47b305d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee47b305b50>]}
[0m14:59:36.716169 [debug] [MainThread]: Flushing usage events
[0m15:04:44.505438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cf0f4634310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cf0f1299ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cf0f1299970>]}


============================== 15:04:44.564881 | 385c2017-b0b4-4ca4-a91f-2950b472bd73 ==============================
[0m15:04:44.564881 [info ] [MainThread]: Running with dbt=1.8.9
[0m15:04:44.566142 [debug] [MainThread]: running dbt with arguments {'log_path': '/workdir/transforms/03_meteo/logs', 'empty': 'False', 'profiles_dir': '.', 'version_check': 'True', 'fail_fast': 'False', 'no_print': 'None', 'log_cache_events': 'False', 'invocation_command': 'dbt build --profiles-dir . --target local', 'target_path': 'None', 'write_json': 'True', 'printer_width': '80', 'indirect_selection': 'eager', 'introspect': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'quiet': 'False', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'use_experimental_parser': 'False', 'debug': 'False', 'warn_error': 'None'}
[0m15:04:45.176846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '385c2017-b0b4-4ca4-a91f-2950b472bd73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cf0f3be1b50>]}
[0m15:04:45.372681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '385c2017-b0b4-4ca4-a91f-2950b472bd73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cf0f4888a30>]}
[0m15:04:45.373934 [info ] [MainThread]: Registered adapter: clickhouse=1.8.6
[0m15:04:45.788617 [debug] [MainThread]: checksum: 134c0f7b96382cc6938697739bc32fb1adc530b177e30f60cebddf61dbd7e979, vars: {}, profile: , target: local, version: 1.8.9
[0m15:04:46.292842 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m15:04:46.293943 [debug] [MainThread]: Partial parsing: updated file: ex_03_meteo://models/mart/mart_meteo__manila_monthly.sql
[0m15:04:46.294648 [debug] [MainThread]: Partial parsing: updated file: ex_03_meteo://models/mart/mart_meteo__manila_daily.sql
[0m15:04:47.201353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '385c2017-b0b4-4ca4-a91f-2950b472bd73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cf0f0576e20>]}
[0m15:04:47.678238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '385c2017-b0b4-4ca4-a91f-2950b472bd73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cf0f05df1f0>]}
[0m15:04:47.679216 [info ] [MainThread]: Found 3 models, 4 data tests, 1 source, 471 macros
[0m15:04:47.683177 [info ] [MainThread]: 
[0m15:04:47.684431 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m15:04:47.697731 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m15:04:47.699283 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m15:04:47.778654 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:04:47.783378 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:04:48.367062 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m15:04:48.371504 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m15:04:48.375641 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m15:04:48.379646 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m15:04:48.607067 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__mart)
[0m15:04:48.608342 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__clean)
[0m15:04:48.673648 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__mart: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list__mart"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'mart'
      

  ...
[0m15:04:48.681707 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list__clean"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'clean'
      

  ...
[0m15:04:48.691211 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m15:04:48.700522 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m15:04:48.707356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '385c2017-b0b4-4ca4-a91f-2950b472bd73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cf0f0489970>]}
[0m15:04:48.708631 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m15:04:48.709714 [info ] [MainThread]: 
[0m15:04:48.783327 [debug] [Thread-1  ]: Began running node model.ex_03_meteo.stg_meteo__manila
[0m15:04:48.784436 [info ] [Thread-1  ]: 1 of 7 START sql view model `clean`.`stg_meteo__manila` ........................ [RUN]
[0m15:04:48.785591 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.ex_03_meteo.stg_meteo__manila'
[0m15:04:48.786308 [debug] [Thread-1  ]: Began compiling node model.ex_03_meteo.stg_meteo__manila
[0m15:04:48.804179 [debug] [Thread-1  ]: Writing injected SQL for node "model.ex_03_meteo.stg_meteo__manila"
[0m15:04:48.805477 [debug] [Thread-1  ]: Began executing node model.ex_03_meteo.stg_meteo__manila
[0m15:04:48.996627 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m15:04:49.106229 [debug] [Thread-1  ]: Writing runtime sql for node "model.ex_03_meteo.stg_meteo__manila"
[0m15:04:49.107620 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_03_meteo.stg_meteo__manila: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_03_meteo.stg_meteo__manila"} */


  create view `clean`.`stg_meteo__manila__dbt_tmp` 
  
    
    
  as (
    

-- Normalize types & naming; no business logic here.
select
  toDate(date)                         as dte,
  toFloat64(temp_min)                  as temp_min_c,
  toFloat64(temp_max)                  as temp_max_c,
  toFloat64(precipitation)             as precip_mm,
  toInt32(weather_code)                as weather_code
from `raw`.`meteo___manila`
    
  )
      
      
                    -- end_of_sql
                    
                    ...
[0m15:04:49.121957 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m15:04:49.136266 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_03_meteo.stg_meteo__manila: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_03_meteo.stg_meteo__manila"} */

    drop table if exists `clean`.`stg_meteo__manila__dbt_backup` 
  
  ...
[0m15:04:49.139677 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m15:04:49.141727 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_03_meteo.stg_meteo__manila: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_03_meteo.stg_meteo__manila"} */

    rename table `clean`.`stg_meteo__manila` to `clean`.`stg_meteo__manila__dbt_backup` 
  
  ...
[0m15:04:49.144740 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m15:04:49.150880 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_03_meteo.stg_meteo__manila: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_03_meteo.stg_meteo__manila"} */

    drop table if exists `clean`.`stg_meteo__manila` 
  
  ...
[0m15:04:49.153883 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m15:04:49.156367 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_03_meteo.stg_meteo__manila: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_03_meteo.stg_meteo__manila"} */

    rename table `clean`.`stg_meteo__manila__dbt_tmp` to `clean`.`stg_meteo__manila` 
  
  ...
[0m15:04:49.159732 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m15:04:49.210361 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_03_meteo.stg_meteo__manila: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_03_meteo.stg_meteo__manila"} */

    drop table if exists `clean`.`stg_meteo__manila__dbt_backup` 
  ...
[0m15:04:49.213787 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m15:04:49.267252 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '385c2017-b0b4-4ca4-a91f-2950b472bd73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cf0f00818e0>]}
[0m15:04:49.268449 [info ] [Thread-1  ]: 1 of 7 OK created sql view model `clean`.`stg_meteo__manila` ................... [[32mOK[0m in 0.48s]
[0m15:04:49.269815 [debug] [Thread-1  ]: Finished running node model.ex_03_meteo.stg_meteo__manila
[0m15:04:49.271970 [debug] [Thread-3  ]: Began running node test.ex_03_meteo.not_null_stg_meteo__manila_dte.513a28a12f
[0m15:04:49.273067 [debug] [Thread-4  ]: Began running node test.ex_03_meteo.not_null_stg_meteo__manila_temp_max_c.a5e6f8c339
[0m15:04:49.274407 [info ] [Thread-3  ]: 2 of 7 START test not_null_stg_meteo__manila_dte ............................... [RUN]
[0m15:04:49.275477 [debug] [Thread-2  ]: Began running node test.ex_03_meteo.not_null_stg_meteo__manila_temp_min_c.f577a564e9
[0m15:04:49.277152 [info ] [Thread-4  ]: 3 of 7 START test not_null_stg_meteo__manila_temp_max_c ........................ [RUN]
[0m15:04:49.278648 [debug] [Thread-1  ]: Began running node test.ex_03_meteo.unique_stg_meteo__manila_dte.65d5c5a8bc
[0m15:04:49.280261 [debug] [Thread-3  ]: Acquiring new clickhouse connection 'test.ex_03_meteo.not_null_stg_meteo__manila_dte.513a28a12f'
[0m15:04:49.282074 [info ] [Thread-2  ]: 4 of 7 START test not_null_stg_meteo__manila_temp_min_c ........................ [RUN]
[0m15:04:49.284653 [debug] [Thread-4  ]: Acquiring new clickhouse connection 'test.ex_03_meteo.not_null_stg_meteo__manila_temp_max_c.a5e6f8c339'
[0m15:04:49.286118 [info ] [Thread-1  ]: 5 of 7 START test unique_stg_meteo__manila_dte ................................. [RUN]
[0m15:04:49.287453 [debug] [Thread-3  ]: Began compiling node test.ex_03_meteo.not_null_stg_meteo__manila_dte.513a28a12f
[0m15:04:49.289710 [debug] [Thread-2  ]: Acquiring new clickhouse connection 'test.ex_03_meteo.not_null_stg_meteo__manila_temp_min_c.f577a564e9'
[0m15:04:49.291642 [debug] [Thread-4  ]: Began compiling node test.ex_03_meteo.not_null_stg_meteo__manila_temp_max_c.a5e6f8c339
[0m15:04:49.293002 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ex_03_meteo.stg_meteo__manila, now test.ex_03_meteo.unique_stg_meteo__manila_dte.65d5c5a8bc)
[0m15:04:49.365391 [debug] [Thread-2  ]: Began compiling node test.ex_03_meteo.not_null_stg_meteo__manila_temp_min_c.f577a564e9
[0m15:04:49.401566 [debug] [Thread-3  ]: Writing injected SQL for node "test.ex_03_meteo.not_null_stg_meteo__manila_dte.513a28a12f"
[0m15:04:49.403125 [debug] [Thread-1  ]: Began compiling node test.ex_03_meteo.unique_stg_meteo__manila_dte.65d5c5a8bc
[0m15:04:49.407850 [debug] [Thread-4  ]: Writing injected SQL for node "test.ex_03_meteo.not_null_stg_meteo__manila_temp_max_c.a5e6f8c339"
[0m15:04:49.474009 [debug] [Thread-2  ]: Writing injected SQL for node "test.ex_03_meteo.not_null_stg_meteo__manila_temp_min_c.f577a564e9"
[0m15:04:49.492021 [debug] [Thread-3  ]: Began executing node test.ex_03_meteo.not_null_stg_meteo__manila_dte.513a28a12f
[0m15:04:49.501256 [debug] [Thread-1  ]: Writing injected SQL for node "test.ex_03_meteo.unique_stg_meteo__manila_dte.65d5c5a8bc"
[0m15:04:49.503455 [debug] [Thread-4  ]: Began executing node test.ex_03_meteo.not_null_stg_meteo__manila_temp_max_c.a5e6f8c339
[0m15:04:49.582012 [debug] [Thread-2  ]: Began executing node test.ex_03_meteo.not_null_stg_meteo__manila_temp_min_c.f577a564e9
[0m15:04:49.593989 [debug] [Thread-1  ]: Began executing node test.ex_03_meteo.unique_stg_meteo__manila_dte.65d5c5a8bc
[0m15:04:49.901523 [debug] [Thread-3  ]: Writing runtime sql for node "test.ex_03_meteo.not_null_stg_meteo__manila_dte.513a28a12f"
[0m15:04:49.903157 [debug] [Thread-1  ]: Writing runtime sql for node "test.ex_03_meteo.unique_stg_meteo__manila_dte.65d5c5a8bc"
[0m15:04:49.911613 [debug] [Thread-2  ]: Writing runtime sql for node "test.ex_03_meteo.not_null_stg_meteo__manila_temp_min_c.f577a564e9"
[0m15:04:49.969014 [debug] [Thread-4  ]: Writing runtime sql for node "test.ex_03_meteo.not_null_stg_meteo__manila_temp_max_c.a5e6f8c339"
[0m15:04:49.971668 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m15:04:49.973771 [debug] [Thread-1  ]: dbt_clickhouse adapter: On test.ex_03_meteo.unique_stg_meteo__manila_dte.65d5c5a8bc: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "test.ex_03_meteo.unique_stg_meteo__manila_dte.65d5c5a8bc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    dte as unique_field,
    count(*) as n_records

from `clean`.`stg_meteo__manila`
where dte is not null
group by dte
having count(*) > 1



    ) dbt_internal_test...
[0m15:04:49.976108 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m15:04:49.979893 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m15:04:50.067686 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.08 seconds
[0m15:04:50.172874 [info ] [Thread-1  ]: 5 of 7 PASS unique_stg_meteo__manila_dte ....................................... [[32mPASS[0m in 0.88s]
[0m15:04:50.178361 [debug] [Thread-1  ]: Finished running node test.ex_03_meteo.unique_stg_meteo__manila_dte.65d5c5a8bc
[0m15:04:50.279969 [debug] [Thread-3  ]: dbt_clickhouse adapter: On test.ex_03_meteo.not_null_stg_meteo__manila_dte.513a28a12f: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "test.ex_03_meteo.not_null_stg_meteo__manila_dte.513a28a12f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select dte
from `clean`.`stg_meteo__manila`
where dte is null



    ) dbt_internal_test...
[0m15:04:50.294976 [debug] [Thread-2  ]: dbt_clickhouse adapter: On test.ex_03_meteo.not_null_stg_meteo__manila_temp_min_c.f577a564e9: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "test.ex_03_meteo.not_null_stg_meteo__manila_temp_min_c.f577a564e9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select temp_min_c
from `clean`.`stg_meteo__manila`
where temp_min_c is null



    ) dbt_internal_test...
[0m15:04:50.297825 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m15:04:50.302595 [debug] [Thread-4  ]: dbt_clickhouse adapter: On test.ex_03_meteo.not_null_stg_meteo__manila_temp_max_c.a5e6f8c339: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "test.ex_03_meteo.not_null_stg_meteo__manila_temp_max_c.a5e6f8c339"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select temp_max_c
from `clean`.`stg_meteo__manila`
where temp_max_c is null



    ) dbt_internal_test...
[0m15:04:50.308879 [info ] [Thread-3  ]: 2 of 7 PASS not_null_stg_meteo__manila_dte ..................................... [[32mPASS[0m in 1.03s]
[0m15:04:50.366625 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m15:04:50.370424 [debug] [Thread-3  ]: Finished running node test.ex_03_meteo.not_null_stg_meteo__manila_dte.513a28a12f
[0m15:04:50.377776 [info ] [Thread-2  ]: 4 of 7 PASS not_null_stg_meteo__manila_temp_min_c .............................. [[32mPASS[0m in 1.09s]
[0m15:04:50.381224 [debug] [Thread-4  ]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m15:04:50.384860 [debug] [Thread-2  ]: Finished running node test.ex_03_meteo.not_null_stg_meteo__manila_temp_min_c.f577a564e9
[0m15:04:50.390849 [info ] [Thread-4  ]: 3 of 7 PASS not_null_stg_meteo__manila_temp_max_c .............................. [[32mPASS[0m in 1.11s]
[0m15:04:50.394840 [debug] [Thread-4  ]: Finished running node test.ex_03_meteo.not_null_stg_meteo__manila_temp_max_c.a5e6f8c339
[0m15:04:50.397972 [debug] [Thread-1  ]: Began running node model.ex_03_meteo.mart_meteo__manila_daily
[0m15:04:50.399855 [debug] [Thread-3  ]: Began running node model.ex_03_meteo.mart_meteo__manila_monthly
[0m15:04:50.402252 [info ] [Thread-1  ]: 6 of 7 START sql table model `mart`.`mart_meteo__manila_daily` ................. [RUN]
[0m15:04:50.404813 [info ] [Thread-3  ]: 7 of 7 START sql table model `mart`.`mart_meteo__manila_monthly` ............... [RUN]
[0m15:04:50.406664 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ex_03_meteo.unique_stg_meteo__manila_dte.65d5c5a8bc, now model.ex_03_meteo.mart_meteo__manila_daily)
[0m15:04:50.408132 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ex_03_meteo.not_null_stg_meteo__manila_dte.513a28a12f, now model.ex_03_meteo.mart_meteo__manila_monthly)
[0m15:04:50.409707 [debug] [Thread-1  ]: Began compiling node model.ex_03_meteo.mart_meteo__manila_daily
[0m15:04:50.411273 [debug] [Thread-3  ]: Began compiling node model.ex_03_meteo.mart_meteo__manila_monthly
[0m15:04:50.486385 [debug] [Thread-1  ]: Writing injected SQL for node "model.ex_03_meteo.mart_meteo__manila_daily"
[0m15:04:50.490321 [debug] [Thread-3  ]: Writing injected SQL for node "model.ex_03_meteo.mart_meteo__manila_monthly"
[0m15:04:50.492891 [debug] [Thread-1  ]: Began executing node model.ex_03_meteo.mart_meteo__manila_daily
[0m15:04:50.494460 [debug] [Thread-3  ]: Began executing node model.ex_03_meteo.mart_meteo__manila_monthly
[0m15:04:50.691775 [debug] [Thread-1  ]: Creating new relation mart_meteo__manila_daily
[0m15:04:50.786092 [debug] [Thread-3  ]: Creating new relation mart_meteo__manila_monthly
[0m15:04:51.164767 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_03_meteo.mart_meteo__manila_monthly: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_03_meteo.mart_meteo__manila_monthly"} */

            

    
        create table `mart`.`mart_meteo__manila_monthly`
        
  
        
  engine = MergeTree()
        order by (month)
        
        partition by (toYYYYMM(month))
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

with base as (
  select
    assumeNotNull(dte)                            as dte_nn,   -- 👈 non-nullable
    toFloat64(temp_min_c)                         as temp_min_c,
    toFloat64(temp_max_c)                         as temp_max_c,
    (toFloat64(temp_min_c) + toFloat64(temp_max_c))/2.0 as temp_avg_c,
    toFloat64(precip_mm)                          as precip_mm
  from `clean`.`stg_meteo__manila`
)
select
  toStartOfMonth(dte_nn)                as month,             -- 👈 computed from non-null date
  avg(temp_min_c)                       as avg_min_c,
  avg(temp_max_c)                       as avg_max_c,
  avg(temp_avg_c)                       as avg_temp_c,
  sum(precip_mm)                        as total_precip_mm,
  countIf(precip_mm > 0)                as rainy_days
from base
group by month
order by month
          )
        
        ...
[0m15:04:51.166469 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_03_meteo.mart_meteo__manila_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_03_meteo.mart_meteo__manila_daily"} */

            

    
        create table `mart`.`mart_meteo__manila_daily`
        
  
        
  engine = MergeTree()
        order by (dte)
        
        partition by (toYYYYMM(dte))
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

-- Force non-nullable key for MergeTree
select
  assumeNotNull(dte)                         as dte,          -- 👈 non-nullable
  temp_min_c,
  temp_max_c,
  (temp_min_c + temp_max_c)/2.0              as temp_avg_c,
  precip_mm,
  weather_code
from `clean`.`stg_meteo__manila`
          )
        
        ...
[0m15:04:51.195273 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.03 seconds
[0m15:04:51.211659 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m15:04:51.221341 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_03_meteo.mart_meteo__manila_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_03_meteo.mart_meteo__manila_daily"} */

    select name, type from system.columns where table = 'mart_meteo__manila_daily'
    
      and database = 'mart'
    
    order by position
  ...
[0m15:04:51.231621 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_03_meteo.mart_meteo__manila_monthly: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_03_meteo.mart_meteo__manila_monthly"} */

    select name, type from system.columns where table = 'mart_meteo__manila_monthly'
    
      and database = 'mart'
    
    order by position
  ...
[0m15:04:51.267039 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.03 seconds
[0m15:04:51.283066 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m15:04:51.280478 [debug] [Thread-1  ]: Writing runtime sql for node "model.ex_03_meteo.mart_meteo__manila_daily"
[0m15:04:51.288793 [debug] [Thread-3  ]: Writing runtime sql for node "model.ex_03_meteo.mart_meteo__manila_monthly"
[0m15:04:51.291608 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_03_meteo.mart_meteo__manila_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_03_meteo.mart_meteo__manila_daily"} */

  
    
    
    
        
         


        insert into `mart`.`mart_meteo__manila_daily`
        ("dte", "temp_min_c", "temp_max_c", "temp_avg_c", "precip_mm", "weather_code")

-- Force non-nullable key for MergeTree
select
  assumeNotNull(dte)                         as dte,          -- 👈 non-nullable
  temp_min_c,
  temp_max_c,
  (temp_min_c + temp_max_c)/2.0              as temp_avg_c,
  precip_mm,
  weather_code
from `clean`.`stg_meteo__manila`
  ...
[0m15:04:51.293884 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_03_meteo.mart_meteo__manila_monthly: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_03_meteo.mart_meteo__manila_monthly"} */

  
    
    
    
        
         


        insert into `mart`.`mart_meteo__manila_monthly`
        ("month", "avg_min_c", "avg_max_c", "avg_temp_c", "total_precip_mm", "rainy_days")

with base as (
  select
    assumeNotNull(dte)                            as dte_nn,   -- 👈 non-nullable
    toFloat64(temp_min_c)                         as temp_min_c,
    toFloat64(temp_max_c)                         as temp_max_c,
    (toFloat64(temp_min_c) + toFloat64(temp_max_c))/2.0 as temp_avg_c,
    toFloat64(precip_mm)                          as precip_mm
  from `clean`.`stg_meteo__manila`
)
select
  toStartOfMonth(dte_nn)                as month,             -- 👈 computed from non-null date
  avg(temp_min_c)                       as avg_min_c,
  avg(temp_max_c)                       as avg_max_c,
  avg(temp_avg_c)                       as avg_temp_c,
  sum(precip_mm)                        as total_precip_mm,
  countIf(precip_mm > 0)                as rainy_days
from base
group by month
order by month
  ...
[0m15:04:51.339656 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m15:04:51.346193 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '385c2017-b0b4-4ca4-a91f-2950b472bd73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cf0f006f5e0>]}
[0m15:04:51.348723 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m15:04:51.351375 [info ] [Thread-1  ]: 6 of 7 OK created sql table model `mart`.`mart_meteo__manila_daily` ............ [[32mOK[0m in 0.94s]
[0m15:04:51.371206 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '385c2017-b0b4-4ca4-a91f-2950b472bd73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cf0eff47c10>]}
[0m15:04:51.374167 [debug] [Thread-1  ]: Finished running node model.ex_03_meteo.mart_meteo__manila_daily
[0m15:04:51.376869 [info ] [Thread-3  ]: 7 of 7 OK created sql table model `mart`.`mart_meteo__manila_monthly` .......... [[32mOK[0m in 0.96s]
[0m15:04:51.380182 [debug] [Thread-3  ]: Finished running node model.ex_03_meteo.mart_meteo__manila_monthly
[0m15:04:51.384005 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:04:51.385226 [debug] [MainThread]: Connection 'list__mart' was left open.
[0m15:04:51.386724 [debug] [MainThread]: On list__mart: Close
[0m15:04:51.388000 [debug] [MainThread]: Connection 'list__clean' was left open.
[0m15:04:51.389175 [debug] [MainThread]: On list__clean: Close
[0m15:04:51.390294 [debug] [MainThread]: Connection 'model.ex_03_meteo.mart_meteo__manila_daily' was left open.
[0m15:04:51.391475 [debug] [MainThread]: On model.ex_03_meteo.mart_meteo__manila_daily: Close
[0m15:04:51.392611 [debug] [MainThread]: Connection 'model.ex_03_meteo.mart_meteo__manila_monthly' was left open.
[0m15:04:51.393813 [debug] [MainThread]: On model.ex_03_meteo.mart_meteo__manila_monthly: Close
[0m15:04:51.394998 [debug] [MainThread]: Connection 'test.ex_03_meteo.not_null_stg_meteo__manila_temp_max_c.a5e6f8c339' was left open.
[0m15:04:51.396180 [debug] [MainThread]: On test.ex_03_meteo.not_null_stg_meteo__manila_temp_max_c.a5e6f8c339: Close
[0m15:04:51.397340 [debug] [MainThread]: Connection 'test.ex_03_meteo.not_null_stg_meteo__manila_temp_min_c.f577a564e9' was left open.
[0m15:04:51.398514 [debug] [MainThread]: On test.ex_03_meteo.not_null_stg_meteo__manila_temp_min_c.f577a564e9: Close
[0m15:04:51.400777 [info ] [MainThread]: 
[0m15:04:51.402246 [info ] [MainThread]: Finished running 1 view model, 4 data tests, 2 table models in 0 hours 0 minutes and 3.72 seconds (3.72s).
[0m15:04:51.410813 [debug] [MainThread]: Command end result
[0m15:04:51.675852 [info ] [MainThread]: 
[0m15:04:51.677491 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:04:51.678817 [info ] [MainThread]: 
[0m15:04:51.680157 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m15:04:51.682789 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 7.371369, "process_in_blocks": "0", "process_kernel_time": 0.653605, "process_mem_max_rss": "116544", "process_out_blocks": "10696", "process_user_time": 6.386916}
[0m15:04:51.684390 [debug] [MainThread]: Command `dbt build` succeeded at 15:04:51.683984 after 7.37 seconds
[0m15:04:51.685757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cf0f4634310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cf0f1bc2f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cf0f04ce790>]}
[0m15:04:51.687002 [debug] [MainThread]: Flushing usage events
[0m15:36:36.990440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d63af6ec310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d63ac34a4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d63ac34a610>]}


============================== 15:36:37.000651 | 883e48ce-5627-46b3-a880-4911742117d5 ==============================
[0m15:36:37.000651 [info ] [MainThread]: Running with dbt=1.8.9
[0m15:36:37.001876 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'log_path': '/workdir/transforms/03_meteo/logs', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'profiles_dir': '.', 'no_print': 'None', 'invocation_command': 'dbt build --profiles-dir . --target local', 'version_check': 'True', 'target_path': 'None', 'printer_width': '80', 'empty': 'False', 'debug': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'partial_parse': 'True', 'log_cache_events': 'False', 'static_parser': 'True', 'write_json': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])'}
[0m15:36:37.578295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '883e48ce-5627-46b3-a880-4911742117d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d63ac449460>]}
[0m15:36:37.773481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '883e48ce-5627-46b3-a880-4911742117d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d63ac422dc0>]}
[0m15:36:37.774737 [info ] [MainThread]: Registered adapter: clickhouse=1.8.6
[0m15:36:38.192036 [debug] [MainThread]: checksum: 134c0f7b96382cc6938697739bc32fb1adc530b177e30f60cebddf61dbd7e979, vars: {}, profile: , target: local, version: 1.8.9
[0m15:36:38.704485 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m15:36:38.705453 [debug] [MainThread]: Partial parsing: added file: ex_03_meteo://models/mart/vw_meteo__manila_night_weather.sql
[0m15:36:38.706650 [debug] [MainThread]: Partial parsing: updated file: ex_03_meteo://models/sources.yml
[0m15:36:39.492792 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m15:36:39.493771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '883e48ce-5627-46b3-a880-4911742117d5', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d63abacaeb0>]}
[0m15:36:40.508757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '883e48ce-5627-46b3-a880-4911742117d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d63ab1bde50>]}
[0m15:36:41.007924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '883e48ce-5627-46b3-a880-4911742117d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d63abb08a60>]}
[0m15:36:41.008815 [info ] [MainThread]: Found 4 models, 4 data tests, 2 sources, 471 macros
[0m15:36:41.012155 [info ] [MainThread]: 
[0m15:36:41.013186 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m15:36:41.025644 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m15:36:41.067232 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m15:36:41.310982 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:36:41.368962 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:36:42.172584 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m15:36:42.181213 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m15:36:42.183599 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m15:36:42.191776 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m15:36:42.289628 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__mart)
[0m15:36:42.301607 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__clean)
[0m15:36:42.306696 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__mart: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list__mart"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'mart'
      

  ...
[0m15:36:42.312501 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list__clean"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'clean'
      

  ...
[0m15:36:42.368663 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m15:36:42.385592 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m15:36:42.393808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '883e48ce-5627-46b3-a880-4911742117d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d63ac433190>]}
[0m15:36:42.395643 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m15:36:42.397001 [info ] [MainThread]: 
[0m15:36:42.469729 [debug] [Thread-1  ]: Began running node model.ex_03_meteo.stg_meteo__manila
[0m15:36:42.471133 [info ] [Thread-1  ]: 1 of 8 START sql view model `clean`.`stg_meteo__manila` ........................ [RUN]
[0m15:36:42.472188 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list__mart, now model.ex_03_meteo.stg_meteo__manila)
[0m15:36:42.473077 [debug] [Thread-1  ]: Began compiling node model.ex_03_meteo.stg_meteo__manila
[0m15:36:42.494072 [debug] [Thread-1  ]: Writing injected SQL for node "model.ex_03_meteo.stg_meteo__manila"
[0m15:36:42.495427 [debug] [Thread-1  ]: Began executing node model.ex_03_meteo.stg_meteo__manila
[0m15:36:42.694318 [debug] [Thread-1  ]: Writing runtime sql for node "model.ex_03_meteo.stg_meteo__manila"
[0m15:36:42.696109 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_03_meteo.stg_meteo__manila: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_03_meteo.stg_meteo__manila"} */


  create view `clean`.`stg_meteo__manila__dbt_tmp` 
  
    
    
  as (
    

-- Normalize types & naming; no business logic here.
select
  toDate(date)                         as dte,
  toFloat64(temp_min)                  as temp_min_c,
  toFloat64(temp_max)                  as temp_max_c,
  toFloat64(precipitation)             as precip_mm,
  toInt32(weather_code)                as weather_code
from `raw`.`meteo___manila`
    
  )
      
      
                    -- end_of_sql
                    
                    ...
[0m15:36:42.708187 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m15:36:42.720803 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_03_meteo.stg_meteo__manila: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_03_meteo.stg_meteo__manila"} */

    drop table if exists `clean`.`stg_meteo__manila__dbt_backup` 
  
  ...
[0m15:36:42.724203 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m15:36:42.767625 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_03_meteo.stg_meteo__manila: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_03_meteo.stg_meteo__manila"} */

    rename table `clean`.`stg_meteo__manila` to `clean`.`stg_meteo__manila__dbt_backup` 
  
  ...
[0m15:36:42.770834 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m15:36:42.777318 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_03_meteo.stg_meteo__manila: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_03_meteo.stg_meteo__manila"} */

    drop table if exists `clean`.`stg_meteo__manila` 
  
  ...
[0m15:36:42.780241 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m15:36:42.782064 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_03_meteo.stg_meteo__manila: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_03_meteo.stg_meteo__manila"} */

    rename table `clean`.`stg_meteo__manila__dbt_tmp` to `clean`.`stg_meteo__manila` 
  
  ...
[0m15:36:42.784907 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m15:36:42.878303 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_03_meteo.stg_meteo__manila: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_03_meteo.stg_meteo__manila"} */

    drop table if exists `clean`.`stg_meteo__manila__dbt_backup` 
  ...
[0m15:36:42.881659 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m15:36:42.888044 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '883e48ce-5627-46b3-a880-4911742117d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d63aad592b0>]}
[0m15:36:42.889231 [info ] [Thread-1  ]: 1 of 8 OK created sql view model `clean`.`stg_meteo__manila` ................... [[32mOK[0m in 0.41s]
[0m15:36:42.890616 [debug] [Thread-1  ]: Finished running node model.ex_03_meteo.stg_meteo__manila
[0m15:36:42.893258 [debug] [Thread-3  ]: Began running node test.ex_03_meteo.not_null_stg_meteo__manila_dte.513a28a12f
[0m15:36:42.894625 [debug] [Thread-4  ]: Began running node test.ex_03_meteo.not_null_stg_meteo__manila_temp_max_c.a5e6f8c339
[0m15:36:42.895793 [info ] [Thread-3  ]: 2 of 8 START test not_null_stg_meteo__manila_dte ............................... [RUN]
[0m15:36:42.897161 [debug] [Thread-2  ]: Began running node test.ex_03_meteo.not_null_stg_meteo__manila_temp_min_c.f577a564e9
[0m15:36:42.898699 [debug] [Thread-1  ]: Began running node test.ex_03_meteo.unique_stg_meteo__manila_dte.65d5c5a8bc
[0m15:36:42.899801 [info ] [Thread-4  ]: 3 of 8 START test not_null_stg_meteo__manila_temp_max_c ........................ [RUN]
[0m15:36:42.902138 [debug] [Thread-3  ]: Acquiring new clickhouse connection 'test.ex_03_meteo.not_null_stg_meteo__manila_dte.513a28a12f'
[0m15:36:42.903577 [info ] [Thread-2  ]: 4 of 8 START test not_null_stg_meteo__manila_temp_min_c ........................ [RUN]
[0m15:36:42.904578 [info ] [Thread-1  ]: 5 of 8 START test unique_stg_meteo__manila_dte ................................. [RUN]
[0m15:36:42.906092 [debug] [Thread-4  ]: Acquiring new clickhouse connection 'test.ex_03_meteo.not_null_stg_meteo__manila_temp_max_c.a5e6f8c339'
[0m15:36:42.907861 [debug] [Thread-3  ]: Began compiling node test.ex_03_meteo.not_null_stg_meteo__manila_dte.513a28a12f
[0m15:36:42.909362 [debug] [Thread-2  ]: Acquiring new clickhouse connection 'test.ex_03_meteo.not_null_stg_meteo__manila_temp_min_c.f577a564e9'
[0m15:36:42.910551 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ex_03_meteo.stg_meteo__manila, now test.ex_03_meteo.unique_stg_meteo__manila_dte.65d5c5a8bc)
[0m15:36:42.911886 [debug] [Thread-4  ]: Began compiling node test.ex_03_meteo.not_null_stg_meteo__manila_temp_max_c.a5e6f8c339
[0m15:36:42.982917 [debug] [Thread-2  ]: Began compiling node test.ex_03_meteo.not_null_stg_meteo__manila_temp_min_c.f577a564e9
[0m15:36:42.998189 [debug] [Thread-1  ]: Began compiling node test.ex_03_meteo.unique_stg_meteo__manila_dte.65d5c5a8bc
[0m15:36:43.011586 [debug] [Thread-3  ]: Writing injected SQL for node "test.ex_03_meteo.not_null_stg_meteo__manila_dte.513a28a12f"
[0m15:36:43.073458 [debug] [Thread-4  ]: Writing injected SQL for node "test.ex_03_meteo.not_null_stg_meteo__manila_temp_max_c.a5e6f8c339"
[0m15:36:43.080523 [debug] [Thread-2  ]: Writing injected SQL for node "test.ex_03_meteo.not_null_stg_meteo__manila_temp_min_c.f577a564e9"
[0m15:36:43.093206 [debug] [Thread-1  ]: Writing injected SQL for node "test.ex_03_meteo.unique_stg_meteo__manila_dte.65d5c5a8bc"
[0m15:36:43.094864 [debug] [Thread-3  ]: Began executing node test.ex_03_meteo.not_null_stg_meteo__manila_dte.513a28a12f
[0m15:36:43.095554 [debug] [Thread-4  ]: Began executing node test.ex_03_meteo.not_null_stg_meteo__manila_temp_max_c.a5e6f8c339
[0m15:36:43.096407 [debug] [Thread-1  ]: Began executing node test.ex_03_meteo.unique_stg_meteo__manila_dte.65d5c5a8bc
[0m15:36:43.097127 [debug] [Thread-2  ]: Began executing node test.ex_03_meteo.not_null_stg_meteo__manila_temp_min_c.f577a564e9
[0m15:36:43.302800 [debug] [Thread-3  ]: Writing runtime sql for node "test.ex_03_meteo.not_null_stg_meteo__manila_dte.513a28a12f"
[0m15:36:43.304692 [debug] [Thread-1  ]: Writing runtime sql for node "test.ex_03_meteo.unique_stg_meteo__manila_dte.65d5c5a8bc"
[0m15:36:43.369340 [debug] [Thread-2  ]: Writing runtime sql for node "test.ex_03_meteo.not_null_stg_meteo__manila_temp_min_c.f577a564e9"
[0m15:36:43.377943 [debug] [Thread-4  ]: Writing runtime sql for node "test.ex_03_meteo.not_null_stg_meteo__manila_temp_max_c.a5e6f8c339"
[0m15:36:43.379836 [debug] [Thread-1  ]: dbt_clickhouse adapter: On test.ex_03_meteo.unique_stg_meteo__manila_dte.65d5c5a8bc: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "test.ex_03_meteo.unique_stg_meteo__manila_dte.65d5c5a8bc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    dte as unique_field,
    count(*) as n_records

from `clean`.`stg_meteo__manila`
where dte is not null
group by dte
having count(*) > 1



    ) dbt_internal_test...
[0m15:36:43.380963 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m15:36:43.383885 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m15:36:43.385262 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m15:36:43.394542 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m15:36:43.479570 [info ] [Thread-1  ]: 5 of 8 PASS unique_stg_meteo__manila_dte ....................................... [[32mPASS[0m in 0.57s]
[0m15:36:43.502870 [debug] [Thread-1  ]: Finished running node test.ex_03_meteo.unique_stg_meteo__manila_dte.65d5c5a8bc
[0m15:36:43.631487 [debug] [Thread-3  ]: dbt_clickhouse adapter: On test.ex_03_meteo.not_null_stg_meteo__manila_dte.513a28a12f: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "test.ex_03_meteo.not_null_stg_meteo__manila_dte.513a28a12f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select dte
from `clean`.`stg_meteo__manila`
where dte is null



    ) dbt_internal_test...
[0m15:36:43.670960 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m15:36:43.676992 [info ] [Thread-3  ]: 2 of 8 PASS not_null_stg_meteo__manila_dte ..................................... [[32mPASS[0m in 0.78s]
[0m15:36:43.680745 [debug] [Thread-2  ]: dbt_clickhouse adapter: On test.ex_03_meteo.not_null_stg_meteo__manila_temp_min_c.f577a564e9: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "test.ex_03_meteo.not_null_stg_meteo__manila_temp_min_c.f577a564e9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select temp_min_c
from `clean`.`stg_meteo__manila`
where temp_min_c is null



    ) dbt_internal_test...
[0m15:36:43.683804 [debug] [Thread-3  ]: Finished running node test.ex_03_meteo.not_null_stg_meteo__manila_dte.513a28a12f
[0m15:36:43.695375 [debug] [Thread-4  ]: dbt_clickhouse adapter: On test.ex_03_meteo.not_null_stg_meteo__manila_temp_max_c.a5e6f8c339: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "test.ex_03_meteo.not_null_stg_meteo__manila_temp_max_c.a5e6f8c339"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select temp_max_c
from `clean`.`stg_meteo__manila`
where temp_max_c is null



    ) dbt_internal_test...
[0m15:36:43.705893 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m15:36:43.712120 [info ] [Thread-2  ]: 4 of 8 PASS not_null_stg_meteo__manila_temp_min_c .............................. [[32mPASS[0m in 0.80s]
[0m15:36:43.715292 [debug] [Thread-2  ]: Finished running node test.ex_03_meteo.not_null_stg_meteo__manila_temp_min_c.f577a564e9
[0m15:36:43.718634 [debug] [Thread-4  ]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m15:36:43.769904 [info ] [Thread-4  ]: 3 of 8 PASS not_null_stg_meteo__manila_temp_max_c .............................. [[32mPASS[0m in 0.86s]
[0m15:36:43.772712 [debug] [Thread-4  ]: Finished running node test.ex_03_meteo.not_null_stg_meteo__manila_temp_max_c.a5e6f8c339
[0m15:36:43.775974 [debug] [Thread-1  ]: Began running node model.ex_03_meteo.mart_meteo__manila_daily
[0m15:36:43.777802 [debug] [Thread-3  ]: Began running node model.ex_03_meteo.mart_meteo__manila_monthly
[0m15:36:43.779896 [info ] [Thread-1  ]: 6 of 8 START sql table model `mart`.`mart_meteo__manila_daily` ................. [RUN]
[0m15:36:43.781790 [debug] [Thread-2  ]: Began running node model.ex_03_meteo.vw_meteo__manila_night_weather
[0m15:36:43.783944 [info ] [Thread-3  ]: 7 of 8 START sql table model `mart`.`mart_meteo__manila_monthly` ............... [RUN]
[0m15:36:43.785802 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ex_03_meteo.unique_stg_meteo__manila_dte.65d5c5a8bc, now model.ex_03_meteo.mart_meteo__manila_daily)
[0m15:36:43.787947 [info ] [Thread-2  ]: 8 of 8 START sql view model `mart`.`vw_meteo__manila_night_weather` ............ [RUN]
[0m15:36:43.789836 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ex_03_meteo.not_null_stg_meteo__manila_dte.513a28a12f, now model.ex_03_meteo.mart_meteo__manila_monthly)
[0m15:36:43.791494 [debug] [Thread-1  ]: Began compiling node model.ex_03_meteo.mart_meteo__manila_daily
[0m15:36:43.793184 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ex_03_meteo.not_null_stg_meteo__manila_temp_min_c.f577a564e9, now model.ex_03_meteo.vw_meteo__manila_night_weather)
[0m15:36:43.794903 [debug] [Thread-3  ]: Began compiling node model.ex_03_meteo.mart_meteo__manila_monthly
[0m15:36:43.809033 [debug] [Thread-1  ]: Writing injected SQL for node "model.ex_03_meteo.mart_meteo__manila_daily"
[0m15:36:43.810715 [debug] [Thread-2  ]: Began compiling node model.ex_03_meteo.vw_meteo__manila_night_weather
[0m15:36:43.877692 [debug] [Thread-3  ]: Writing injected SQL for node "model.ex_03_meteo.mart_meteo__manila_monthly"
[0m15:36:43.892388 [debug] [Thread-2  ]: Writing injected SQL for node "model.ex_03_meteo.vw_meteo__manila_night_weather"
[0m15:36:43.894476 [debug] [Thread-1  ]: Began executing node model.ex_03_meteo.mart_meteo__manila_daily
[0m15:36:43.907067 [debug] [Thread-3  ]: Began executing node model.ex_03_meteo.mart_meteo__manila_monthly
[0m15:36:43.908828 [debug] [Thread-2  ]: Began executing node model.ex_03_meteo.vw_meteo__manila_night_weather
[0m15:36:44.067421 [debug] [Thread-2  ]: Creating new relation vw_meteo__manila_night_weather
[0m15:36:44.076634 [debug] [Thread-2  ]: Writing runtime sql for node "model.ex_03_meteo.vw_meteo__manila_night_weather"
[0m15:36:44.172866 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_03_meteo.vw_meteo__manila_night_weather: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_03_meteo.vw_meteo__manila_night_weather"} */


  create view `mart`.`vw_meteo__manila_night_weather` 
  
    
    
  as (
    

with daily as (
  select
    dte,
    temp_min_c,
    temp_max_c,
    (temp_min_c + temp_max_c)/2.0 as temp_avg_c,
    precip_mm,
    weather_code
  from `clean`.`stg_meteo__manila`
),
codes as (
  select
    toInt32(weather_code)                as weather_code,
    cast(night_description as String)    as condition_night,
    cast(night_icon_url as String)       as icon_url_night
  from `raw`.`meteo___wmo_codes`
)

select
  d.dte,
  d.temp_min_c,
  d.temp_max_c,
  d.temp_avg_c,
  d.precip_mm,
  d.weather_code,
  c.condition_night,
  c.icon_url_night
from daily d
left join codes c
  on c.weather_code = d.weather_code
order by d.dte
    
  )
      
      
                    -- end_of_sql
                    
                    ...
[0m15:36:44.291419 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.10 seconds
[0m15:36:44.379312 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '883e48ce-5627-46b3-a880-4911742117d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d63aaccd220>]}
[0m15:36:44.412002 [info ] [Thread-2  ]: 8 of 8 OK created sql view model `mart`.`vw_meteo__manila_night_weather` ....... [[32mOK[0m in 0.59s]
[0m15:36:44.484388 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_03_meteo.mart_meteo__manila_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_03_meteo.mart_meteo__manila_daily"} */

            

    
        create table `mart`.`mart_meteo__manila_daily__dbt_backup`
        
  
        
  engine = MergeTree()
        order by (dte)
        
        partition by (toYYYYMM(dte))
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

-- Force non-nullable key for MergeTree
select
  assumeNotNull(dte)                         as dte,          -- 👈 non-nullable
  temp_min_c,
  temp_max_c,
  (temp_min_c + temp_max_c)/2.0              as temp_avg_c,
  precip_mm,
  weather_code
from `clean`.`stg_meteo__manila`
          )
        
        ...
[0m15:36:44.488450 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_03_meteo.mart_meteo__manila_monthly: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_03_meteo.mart_meteo__manila_monthly"} */

            

    
        create table `mart`.`mart_meteo__manila_monthly__dbt_backup`
        
  
        
  engine = MergeTree()
        order by (month)
        
        partition by (toYYYYMM(month))
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

with base as (
  select
    assumeNotNull(dte)                            as dte_nn,   -- 👈 non-nullable
    toFloat64(temp_min_c)                         as temp_min_c,
    toFloat64(temp_max_c)                         as temp_max_c,
    (toFloat64(temp_min_c) + toFloat64(temp_max_c))/2.0 as temp_avg_c,
    toFloat64(precip_mm)                          as precip_mm
  from `clean`.`stg_meteo__manila`
)
select
  toStartOfMonth(dte_nn)                as month,             -- 👈 computed from non-null date
  avg(temp_min_c)                       as avg_min_c,
  avg(temp_max_c)                       as avg_max_c,
  avg(temp_avg_c)                       as avg_temp_c,
  sum(precip_mm)                        as total_precip_mm,
  countIf(precip_mm > 0)                as rainy_days
from base
group by month
order by month
          )
        
        ...
[0m15:36:44.492151 [debug] [Thread-2  ]: Finished running node model.ex_03_meteo.vw_meteo__manila_night_weather
[0m15:36:44.513963 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m15:36:44.528933 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.03 seconds
[0m15:36:44.572365 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_03_meteo.mart_meteo__manila_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_03_meteo.mart_meteo__manila_daily"} */

    select name, type from system.columns where table = 'mart_meteo__manila_daily__dbt_backup'
    
      and database = 'mart'
    
    order by position
  ...
[0m15:36:44.578867 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_03_meteo.mart_meteo__manila_monthly: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_03_meteo.mart_meteo__manila_monthly"} */

    select name, type from system.columns where table = 'mart_meteo__manila_monthly__dbt_backup'
    
      and database = 'mart'
    
    order by position
  ...
[0m15:36:44.584445 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m15:36:44.586065 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m15:36:44.593233 [debug] [Thread-1  ]: Writing runtime sql for node "model.ex_03_meteo.mart_meteo__manila_daily"
[0m15:36:44.596079 [debug] [Thread-3  ]: Writing runtime sql for node "model.ex_03_meteo.mart_meteo__manila_monthly"
[0m15:36:44.597540 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_03_meteo.mart_meteo__manila_monthly: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_03_meteo.mart_meteo__manila_monthly"} */

  
    
    
    
        
         


        insert into `mart`.`mart_meteo__manila_monthly__dbt_backup`
        ("month", "avg_min_c", "avg_max_c", "avg_temp_c", "total_precip_mm", "rainy_days")

with base as (
  select
    assumeNotNull(dte)                            as dte_nn,   -- 👈 non-nullable
    toFloat64(temp_min_c)                         as temp_min_c,
    toFloat64(temp_max_c)                         as temp_max_c,
    (toFloat64(temp_min_c) + toFloat64(temp_max_c))/2.0 as temp_avg_c,
    toFloat64(precip_mm)                          as precip_mm
  from `clean`.`stg_meteo__manila`
)
select
  toStartOfMonth(dte_nn)                as month,             -- 👈 computed from non-null date
  avg(temp_min_c)                       as avg_min_c,
  avg(temp_max_c)                       as avg_max_c,
  avg(temp_avg_c)                       as avg_temp_c,
  sum(precip_mm)                        as total_precip_mm,
  countIf(precip_mm > 0)                as rainy_days
from base
group by month
order by month
  ...
[0m15:36:44.598574 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_03_meteo.mart_meteo__manila_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_03_meteo.mart_meteo__manila_daily"} */

  
    
    
    
        
         


        insert into `mart`.`mart_meteo__manila_daily__dbt_backup`
        ("dte", "temp_min_c", "temp_max_c", "temp_avg_c", "precip_mm", "weather_code")

-- Force non-nullable key for MergeTree
select
  assumeNotNull(dte)                         as dte,          -- 👈 non-nullable
  temp_min_c,
  temp_max_c,
  (temp_min_c + temp_max_c)/2.0              as temp_avg_c,
  precip_mm,
  weather_code
from `clean`.`stg_meteo__manila`
  ...
[0m15:36:44.627315 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.03 seconds
[0m15:36:44.668058 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m15:36:44.669436 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_03_meteo.mart_meteo__manila_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_03_meteo.mart_meteo__manila_daily"} */
EXCHANGE TABLES `mart`.`mart_meteo__manila_daily__dbt_backup` AND `mart`.`mart_meteo__manila_daily` 
  
  ...
[0m15:36:44.671496 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_03_meteo.mart_meteo__manila_monthly: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_03_meteo.mart_meteo__manila_monthly"} */
EXCHANGE TABLES `mart`.`mart_meteo__manila_monthly__dbt_backup` AND `mart`.`mart_meteo__manila_monthly` 
  
  ...
[0m15:36:44.674712 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m15:36:44.681160 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m15:36:44.682645 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_03_meteo.mart_meteo__manila_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_03_meteo.mart_meteo__manila_daily"} */

    drop table if exists `mart`.`mart_meteo__manila_daily__dbt_backup` 
  ...
[0m15:36:44.690259 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_03_meteo.mart_meteo__manila_monthly: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_03_meteo.mart_meteo__manila_monthly"} */

    drop table if exists `mart`.`mart_meteo__manila_monthly__dbt_backup` 
  ...
[0m15:36:44.694098 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m15:36:44.695790 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m15:36:44.698658 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '883e48ce-5627-46b3-a880-4911742117d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d63a9eb6f70>]}
[0m15:36:44.702869 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '883e48ce-5627-46b3-a880-4911742117d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d63a9edceb0>]}
[0m15:36:44.704945 [info ] [Thread-1  ]: 6 of 8 OK created sql table model `mart`.`mart_meteo__manila_daily` ............ [[32mOK[0m in 0.91s]
[0m15:36:44.706956 [info ] [Thread-3  ]: 7 of 8 OK created sql table model `mart`.`mart_meteo__manila_monthly` .......... [[32mOK[0m in 0.91s]
[0m15:36:44.709015 [debug] [Thread-1  ]: Finished running node model.ex_03_meteo.mart_meteo__manila_daily
[0m15:36:44.710559 [debug] [Thread-3  ]: Finished running node model.ex_03_meteo.mart_meteo__manila_monthly
[0m15:36:44.713206 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:36:44.714292 [debug] [MainThread]: Connection 'model.ex_03_meteo.mart_meteo__manila_daily' was left open.
[0m15:36:44.715350 [debug] [MainThread]: On model.ex_03_meteo.mart_meteo__manila_daily: Close
[0m15:36:44.716225 [debug] [MainThread]: Connection 'list__clean' was left open.
[0m15:36:44.768035 [debug] [MainThread]: On list__clean: Close
[0m15:36:44.769199 [debug] [MainThread]: Connection 'model.ex_03_meteo.mart_meteo__manila_monthly' was left open.
[0m15:36:44.770554 [debug] [MainThread]: On model.ex_03_meteo.mart_meteo__manila_monthly: Close
[0m15:36:44.771334 [debug] [MainThread]: Connection 'test.ex_03_meteo.not_null_stg_meteo__manila_temp_max_c.a5e6f8c339' was left open.
[0m15:36:44.772484 [debug] [MainThread]: On test.ex_03_meteo.not_null_stg_meteo__manila_temp_max_c.a5e6f8c339: Close
[0m15:36:44.773552 [debug] [MainThread]: Connection 'model.ex_03_meteo.vw_meteo__manila_night_weather' was left open.
[0m15:36:44.775188 [debug] [MainThread]: On model.ex_03_meteo.vw_meteo__manila_night_weather: Close
[0m15:36:44.777508 [info ] [MainThread]: 
[0m15:36:44.779234 [info ] [MainThread]: Finished running 2 view models, 4 data tests, 2 table models in 0 hours 0 minutes and 3.76 seconds (3.76s).
[0m15:36:44.789826 [debug] [MainThread]: Command end result
[0m15:36:44.971153 [info ] [MainThread]: 
[0m15:36:44.972515 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:36:44.973807 [info ] [MainThread]: 
[0m15:36:44.975387 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m15:36:44.977910 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 8.180407, "process_in_blocks": "0", "process_kernel_time": 0.708007, "process_mem_max_rss": "118564", "process_out_blocks": "10760", "process_user_time": 6.789074}
[0m15:36:44.979271 [debug] [MainThread]: Command `dbt build` succeeded at 15:36:44.978939 after 8.18 seconds
[0m15:36:44.980345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d63af6ec310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d63ad5fda60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d63ab506e50>]}
[0m15:36:44.981234 [debug] [MainThread]: Flushing usage events
[0m15:37:28.896480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7639d1fd8310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7639cec2eb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7639cec2ea00>]}


============================== 15:37:28.906035 | 44d80b62-f5de-47ad-9490-491a483a09f7 ==============================
[0m15:37:28.906035 [info ] [MainThread]: Running with dbt=1.8.9
[0m15:37:28.907109 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'log_cache_events': 'False', 'use_colors': 'True', 'warn_error': 'None', 'version_check': 'True', 'quiet': 'False', 'indirect_selection': 'eager', 'introspect': 'True', 'empty': 'False', 'write_json': 'True', 'invocation_command': 'dbt build --profiles-dir . --target local', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'debug': 'False', 'cache_selected_only': 'False', 'printer_width': '80', 'static_parser': 'True', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'log_path': '/workdir/transforms/03_meteo/logs', 'profiles_dir': '.', 'target_path': 'None', 'no_print': 'None', 'partial_parse': 'True'}
[0m15:37:29.493081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '44d80b62-f5de-47ad-9490-491a483a09f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7639d1565ca0>]}
[0m15:37:29.688691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '44d80b62-f5de-47ad-9490-491a483a09f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7639ceb48dc0>]}
[0m15:37:29.689984 [info ] [MainThread]: Registered adapter: clickhouse=1.8.6
[0m15:37:30.110461 [debug] [MainThread]: checksum: 134c0f7b96382cc6938697739bc32fb1adc530b177e30f60cebddf61dbd7e979, vars: {}, profile: , target: local, version: 1.8.9
[0m15:37:30.616822 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:37:30.617812 [debug] [MainThread]: Partial parsing: updated file: ex_03_meteo://models/mart/vw_meteo__manila_night_weather.sql
[0m15:37:31.509433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '44d80b62-f5de-47ad-9490-491a483a09f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7639cdf07fa0>]}
[0m15:37:31.991337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '44d80b62-f5de-47ad-9490-491a483a09f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7639cddafc10>]}
[0m15:37:31.992201 [info ] [MainThread]: Found 4 models, 4 data tests, 2 sources, 471 macros
[0m15:37:31.995846 [info ] [MainThread]: 
[0m15:37:31.996913 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m15:37:32.009780 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m15:37:32.011312 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m15:37:32.104425 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:37:32.111227 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:37:32.778964 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m15:37:32.787451 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m15:37:32.791820 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m15:37:32.794473 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m15:37:33.089731 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__mart)
[0m15:37:33.091218 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__clean)
[0m15:37:33.106398 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__mart: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list__mart"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'mart'
      

  ...
[0m15:37:33.111922 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list__clean"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'clean'
      

  ...
[0m15:37:33.123904 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m15:37:33.125898 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m15:37:33.186921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '44d80b62-f5de-47ad-9490-491a483a09f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7639d1f2a7c0>]}
[0m15:37:33.189185 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m15:37:33.190697 [info ] [MainThread]: 
[0m15:37:33.218352 [debug] [Thread-1  ]: Began running node model.ex_03_meteo.stg_meteo__manila
[0m15:37:33.219919 [info ] [Thread-1  ]: 1 of 8 START sql view model `clean`.`stg_meteo__manila` ........................ [RUN]
[0m15:37:33.221164 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list__mart, now model.ex_03_meteo.stg_meteo__manila)
[0m15:37:33.272686 [debug] [Thread-1  ]: Began compiling node model.ex_03_meteo.stg_meteo__manila
[0m15:37:33.298602 [debug] [Thread-1  ]: Writing injected SQL for node "model.ex_03_meteo.stg_meteo__manila"
[0m15:37:33.300128 [debug] [Thread-1  ]: Began executing node model.ex_03_meteo.stg_meteo__manila
[0m15:37:33.499034 [debug] [Thread-1  ]: Writing runtime sql for node "model.ex_03_meteo.stg_meteo__manila"
[0m15:37:33.500835 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_03_meteo.stg_meteo__manila: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_03_meteo.stg_meteo__manila"} */


  create view `clean`.`stg_meteo__manila__dbt_tmp` 
  
    
    
  as (
    

-- Normalize types & naming; no business logic here.
select
  toDate(date)                         as dte,
  toFloat64(temp_min)                  as temp_min_c,
  toFloat64(temp_max)                  as temp_max_c,
  toFloat64(precipitation)             as precip_mm,
  toInt32(weather_code)                as weather_code
from `raw`.`meteo___manila`
    
  )
      
      
                    -- end_of_sql
                    
                    ...
[0m15:37:33.512327 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m15:37:33.526744 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_03_meteo.stg_meteo__manila: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_03_meteo.stg_meteo__manila"} */

    drop table if exists `clean`.`stg_meteo__manila__dbt_backup` 
  
  ...
[0m15:37:33.529798 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m15:37:33.573227 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_03_meteo.stg_meteo__manila: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_03_meteo.stg_meteo__manila"} */

    rename table `clean`.`stg_meteo__manila` to `clean`.`stg_meteo__manila__dbt_backup` 
  
  ...
[0m15:37:33.576427 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m15:37:33.582771 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_03_meteo.stg_meteo__manila: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_03_meteo.stg_meteo__manila"} */

    drop table if exists `clean`.`stg_meteo__manila` 
  
  ...
[0m15:37:33.586033 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m15:37:33.588164 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_03_meteo.stg_meteo__manila: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_03_meteo.stg_meteo__manila"} */

    rename table `clean`.`stg_meteo__manila__dbt_tmp` to `clean`.`stg_meteo__manila` 
  
  ...
[0m15:37:33.590880 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m15:37:33.690577 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_03_meteo.stg_meteo__manila: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_03_meteo.stg_meteo__manila"} */

    drop table if exists `clean`.`stg_meteo__manila__dbt_backup` 
  ...
[0m15:37:33.695070 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m15:37:33.701277 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44d80b62-f5de-47ad-9490-491a483a09f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7639cebf4d30>]}
[0m15:37:33.702631 [info ] [Thread-1  ]: 1 of 8 OK created sql view model `clean`.`stg_meteo__manila` ................... [[32mOK[0m in 0.48s]
[0m15:37:33.704050 [debug] [Thread-1  ]: Finished running node model.ex_03_meteo.stg_meteo__manila
[0m15:37:33.706308 [debug] [Thread-3  ]: Began running node test.ex_03_meteo.not_null_stg_meteo__manila_dte.513a28a12f
[0m15:37:33.707426 [debug] [Thread-4  ]: Began running node test.ex_03_meteo.not_null_stg_meteo__manila_temp_max_c.a5e6f8c339
[0m15:37:33.708468 [debug] [Thread-2  ]: Began running node test.ex_03_meteo.not_null_stg_meteo__manila_temp_min_c.f577a564e9
[0m15:37:33.709772 [info ] [Thread-3  ]: 2 of 8 START test not_null_stg_meteo__manila_dte ............................... [RUN]
[0m15:37:33.711197 [debug] [Thread-1  ]: Began running node test.ex_03_meteo.unique_stg_meteo__manila_dte.65d5c5a8bc
[0m15:37:33.711994 [info ] [Thread-4  ]: 3 of 8 START test not_null_stg_meteo__manila_temp_max_c ........................ [RUN]
[0m15:37:33.713054 [info ] [Thread-2  ]: 4 of 8 START test not_null_stg_meteo__manila_temp_min_c ........................ [RUN]
[0m15:37:33.714858 [debug] [Thread-3  ]: Acquiring new clickhouse connection 'test.ex_03_meteo.not_null_stg_meteo__manila_dte.513a28a12f'
[0m15:37:33.716254 [info ] [Thread-1  ]: 5 of 8 START test unique_stg_meteo__manila_dte ................................. [RUN]
[0m15:37:33.717886 [debug] [Thread-4  ]: Acquiring new clickhouse connection 'test.ex_03_meteo.not_null_stg_meteo__manila_temp_max_c.a5e6f8c339'
[0m15:37:33.720006 [debug] [Thread-2  ]: Acquiring new clickhouse connection 'test.ex_03_meteo.not_null_stg_meteo__manila_temp_min_c.f577a564e9'
[0m15:37:33.721742 [debug] [Thread-3  ]: Began compiling node test.ex_03_meteo.not_null_stg_meteo__manila_dte.513a28a12f
[0m15:37:33.772606 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ex_03_meteo.stg_meteo__manila, now test.ex_03_meteo.unique_stg_meteo__manila_dte.65d5c5a8bc)
[0m15:37:33.774234 [debug] [Thread-4  ]: Began compiling node test.ex_03_meteo.not_null_stg_meteo__manila_temp_max_c.a5e6f8c339
[0m15:37:33.775906 [debug] [Thread-2  ]: Began compiling node test.ex_03_meteo.not_null_stg_meteo__manila_temp_min_c.f577a564e9
[0m15:37:33.799311 [debug] [Thread-1  ]: Began compiling node test.ex_03_meteo.unique_stg_meteo__manila_dte.65d5c5a8bc
[0m15:37:33.892933 [debug] [Thread-3  ]: Writing injected SQL for node "test.ex_03_meteo.not_null_stg_meteo__manila_dte.513a28a12f"
[0m15:37:33.897311 [debug] [Thread-4  ]: Writing injected SQL for node "test.ex_03_meteo.not_null_stg_meteo__manila_temp_max_c.a5e6f8c339"
[0m15:37:33.906741 [debug] [Thread-2  ]: Writing injected SQL for node "test.ex_03_meteo.not_null_stg_meteo__manila_temp_min_c.f577a564e9"
[0m15:37:33.982066 [debug] [Thread-1  ]: Writing injected SQL for node "test.ex_03_meteo.unique_stg_meteo__manila_dte.65d5c5a8bc"
[0m15:37:33.984210 [debug] [Thread-3  ]: Began executing node test.ex_03_meteo.not_null_stg_meteo__manila_dte.513a28a12f
[0m15:37:34.004766 [debug] [Thread-1  ]: Began executing node test.ex_03_meteo.unique_stg_meteo__manila_dte.65d5c5a8bc
[0m15:37:34.006387 [debug] [Thread-4  ]: Began executing node test.ex_03_meteo.not_null_stg_meteo__manila_temp_max_c.a5e6f8c339
[0m15:37:34.093087 [debug] [Thread-2  ]: Began executing node test.ex_03_meteo.not_null_stg_meteo__manila_temp_min_c.f577a564e9
[0m15:37:34.200186 [debug] [Thread-2  ]: Writing runtime sql for node "test.ex_03_meteo.not_null_stg_meteo__manila_temp_min_c.f577a564e9"
[0m15:37:34.211464 [debug] [Thread-3  ]: Writing runtime sql for node "test.ex_03_meteo.not_null_stg_meteo__manila_dte.513a28a12f"
[0m15:37:34.303277 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m15:37:34.306520 [debug] [Thread-1  ]: Writing runtime sql for node "test.ex_03_meteo.unique_stg_meteo__manila_dte.65d5c5a8bc"
[0m15:37:34.314319 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m15:37:34.379999 [debug] [Thread-4  ]: Writing runtime sql for node "test.ex_03_meteo.not_null_stg_meteo__manila_temp_max_c.a5e6f8c339"
[0m15:37:34.388199 [debug] [Thread-1  ]: dbt_clickhouse adapter: On test.ex_03_meteo.unique_stg_meteo__manila_dte.65d5c5a8bc: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "test.ex_03_meteo.unique_stg_meteo__manila_dte.65d5c5a8bc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    dte as unique_field,
    count(*) as n_records

from `clean`.`stg_meteo__manila`
where dte is not null
group by dte
having count(*) > 1



    ) dbt_internal_test...
[0m15:37:34.393297 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m15:37:34.476009 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.09 seconds
[0m15:37:34.499416 [info ] [Thread-1  ]: 5 of 8 PASS unique_stg_meteo__manila_dte ....................................... [[32mPASS[0m in 0.73s]
[0m15:37:34.573640 [debug] [Thread-1  ]: Finished running node test.ex_03_meteo.unique_stg_meteo__manila_dte.65d5c5a8bc
[0m15:37:34.680742 [debug] [Thread-2  ]: dbt_clickhouse adapter: On test.ex_03_meteo.not_null_stg_meteo__manila_temp_min_c.f577a564e9: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "test.ex_03_meteo.not_null_stg_meteo__manila_temp_min_c.f577a564e9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select temp_min_c
from `clean`.`stg_meteo__manila`
where temp_min_c is null



    ) dbt_internal_test...
[0m15:37:34.695739 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m15:37:34.705083 [debug] [Thread-4  ]: dbt_clickhouse adapter: On test.ex_03_meteo.not_null_stg_meteo__manila_temp_max_c.a5e6f8c339: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "test.ex_03_meteo.not_null_stg_meteo__manila_temp_max_c.a5e6f8c339"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select temp_max_c
from `clean`.`stg_meteo__manila`
where temp_max_c is null



    ) dbt_internal_test...
[0m15:37:34.710047 [debug] [Thread-3  ]: dbt_clickhouse adapter: On test.ex_03_meteo.not_null_stg_meteo__manila_dte.513a28a12f: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "test.ex_03_meteo.not_null_stg_meteo__manila_dte.513a28a12f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select dte
from `clean`.`stg_meteo__manila`
where dte is null



    ) dbt_internal_test...
[0m15:37:34.702730 [info ] [Thread-2  ]: 4 of 8 PASS not_null_stg_meteo__manila_temp_min_c .............................. [[32mPASS[0m in 0.98s]
[0m15:37:34.715505 [debug] [Thread-2  ]: Finished running node test.ex_03_meteo.not_null_stg_meteo__manila_temp_min_c.f577a564e9
[0m15:37:34.772287 [debug] [Thread-4  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m15:37:34.775779 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m15:37:34.783067 [info ] [Thread-4  ]: 3 of 8 PASS not_null_stg_meteo__manila_temp_max_c .............................. [[32mPASS[0m in 1.07s]
[0m15:37:34.789641 [info ] [Thread-3  ]: 2 of 8 PASS not_null_stg_meteo__manila_dte ..................................... [[32mPASS[0m in 1.07s]
[0m15:37:34.792721 [debug] [Thread-4  ]: Finished running node test.ex_03_meteo.not_null_stg_meteo__manila_temp_max_c.a5e6f8c339
[0m15:37:34.795613 [debug] [Thread-3  ]: Finished running node test.ex_03_meteo.not_null_stg_meteo__manila_dte.513a28a12f
[0m15:37:34.799393 [debug] [Thread-1  ]: Began running node model.ex_03_meteo.mart_meteo__manila_daily
[0m15:37:34.801155 [debug] [Thread-2  ]: Began running node model.ex_03_meteo.mart_meteo__manila_monthly
[0m15:37:34.803311 [info ] [Thread-1  ]: 6 of 8 START sql table model `mart`.`mart_meteo__manila_daily` ................. [RUN]
[0m15:37:34.805269 [debug] [Thread-4  ]: Began running node model.ex_03_meteo.vw_meteo__manila_night_weather
[0m15:37:34.807506 [info ] [Thread-2  ]: 7 of 8 START sql table model `mart`.`mart_meteo__manila_monthly` ............... [RUN]
[0m15:37:34.809437 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ex_03_meteo.unique_stg_meteo__manila_dte.65d5c5a8bc, now model.ex_03_meteo.mart_meteo__manila_daily)
[0m15:37:34.811573 [info ] [Thread-4  ]: 8 of 8 START sql view model `mart`.`vw_meteo__manila_night_weather` ............ [RUN]
[0m15:37:34.813611 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ex_03_meteo.not_null_stg_meteo__manila_temp_min_c.f577a564e9, now model.ex_03_meteo.mart_meteo__manila_monthly)
[0m15:37:34.815324 [debug] [Thread-1  ]: Began compiling node model.ex_03_meteo.mart_meteo__manila_daily
[0m15:37:34.816967 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ex_03_meteo.not_null_stg_meteo__manila_temp_max_c.a5e6f8c339, now model.ex_03_meteo.vw_meteo__manila_night_weather)
[0m15:37:34.818618 [debug] [Thread-2  ]: Began compiling node model.ex_03_meteo.mart_meteo__manila_monthly
[0m15:37:34.886250 [debug] [Thread-1  ]: Writing injected SQL for node "model.ex_03_meteo.mart_meteo__manila_daily"
[0m15:37:34.887647 [debug] [Thread-4  ]: Began compiling node model.ex_03_meteo.vw_meteo__manila_night_weather
[0m15:37:34.895530 [debug] [Thread-2  ]: Writing injected SQL for node "model.ex_03_meteo.mart_meteo__manila_monthly"
[0m15:37:34.903477 [debug] [Thread-4  ]: Writing injected SQL for node "model.ex_03_meteo.vw_meteo__manila_night_weather"
[0m15:37:34.904740 [debug] [Thread-1  ]: Began executing node model.ex_03_meteo.mart_meteo__manila_daily
[0m15:37:34.905771 [debug] [Thread-2  ]: Began executing node model.ex_03_meteo.mart_meteo__manila_monthly
[0m15:37:34.916973 [debug] [Thread-4  ]: Began executing node model.ex_03_meteo.vw_meteo__manila_night_weather
[0m15:37:35.097158 [debug] [Thread-4  ]: Writing runtime sql for node "model.ex_03_meteo.vw_meteo__manila_night_weather"
[0m15:37:35.207865 [debug] [Thread-4  ]: dbt_clickhouse adapter: On model.ex_03_meteo.vw_meteo__manila_night_weather: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_03_meteo.vw_meteo__manila_night_weather"} */


  create view `mart`.`vw_meteo__manila_night_weather__dbt_tmp` 
  
    
    
  as (
    

with daily as (
  select
    dte,
    temp_min_c,
    temp_max_c,
    (temp_min_c + temp_max_c)/2.0 as temp_avg_c,
    precip_mm,
    weather_code
  from `clean`.`stg_meteo__manila`
),
codes as (
  select
    toInt32(weather_code)                as weather_code,
    cast(night_description as String)    as condition
  from `raw`.`meteo___wmo_codes`
)

select
  d.dte,
  d.temp_min_c,
  d.temp_max_c,
  d.temp_avg_c,
  d.precip_mm,
  d.weather_code,
  c.condition
from daily d
left join codes c
  on c.weather_code = d.weather_code
order by d.dte
    
  )
      
      
                    -- end_of_sql
                    
                    ...
[0m15:37:35.373415 [debug] [Thread-4  ]: dbt_clickhouse adapter: SQL status: OK in 0.15 seconds
[0m15:37:35.408166 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_03_meteo.mart_meteo__manila_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_03_meteo.mart_meteo__manila_daily"} */

            

    
        create table `mart`.`mart_meteo__manila_daily__dbt_backup`
        
  
        
  engine = MergeTree()
        order by (dte)
        
        partition by (toYYYYMM(dte))
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

-- Force non-nullable key for MergeTree
select
  assumeNotNull(dte)                         as dte,          -- 👈 non-nullable
  temp_min_c,
  temp_max_c,
  (temp_min_c + temp_max_c)/2.0              as temp_avg_c,
  precip_mm,
  weather_code
from `clean`.`stg_meteo__manila`
          )
        
        ...
[0m15:37:35.409680 [debug] [Thread-4  ]: dbt_clickhouse adapter: On model.ex_03_meteo.vw_meteo__manila_night_weather: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_03_meteo.vw_meteo__manila_night_weather"} */

    drop table if exists `mart`.`vw_meteo__manila_night_weather__dbt_backup` 
  
  ...
[0m15:37:35.415451 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_03_meteo.mart_meteo__manila_monthly: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_03_meteo.mart_meteo__manila_monthly"} */

            

    
        create table `mart`.`mart_meteo__manila_monthly__dbt_backup`
        
  
        
  engine = MergeTree()
        order by (month)
        
        partition by (toYYYYMM(month))
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

with base as (
  select
    assumeNotNull(dte)                            as dte_nn,   -- 👈 non-nullable
    toFloat64(temp_min_c)                         as temp_min_c,
    toFloat64(temp_max_c)                         as temp_max_c,
    (toFloat64(temp_min_c) + toFloat64(temp_max_c))/2.0 as temp_avg_c,
    toFloat64(precip_mm)                          as precip_mm
  from `clean`.`stg_meteo__manila`
)
select
  toStartOfMonth(dte_nn)                as month,             -- 👈 computed from non-null date
  avg(temp_min_c)                       as avg_min_c,
  avg(temp_max_c)                       as avg_max_c,
  avg(temp_avg_c)                       as avg_temp_c,
  sum(precip_mm)                        as total_precip_mm,
  countIf(precip_mm > 0)                as rainy_days
from base
group by month
order by month
          )
        
        ...
[0m15:37:35.473963 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m15:37:35.492219 [debug] [Thread-4  ]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m15:37:35.505118 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.08 seconds
[0m15:37:35.509253 [debug] [Thread-4  ]: dbt_clickhouse adapter: On model.ex_03_meteo.vw_meteo__manila_night_weather: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_03_meteo.vw_meteo__manila_night_weather"} */

    rename table `mart`.`vw_meteo__manila_night_weather` to `mart`.`vw_meteo__manila_night_weather__dbt_backup` 
  
  ...
[0m15:37:35.518984 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_03_meteo.mart_meteo__manila_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_03_meteo.mart_meteo__manila_daily"} */

    select name, type from system.columns where table = 'mart_meteo__manila_daily__dbt_backup'
    
      and database = 'mart'
    
    order by position
  ...
[0m15:37:35.581955 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_03_meteo.mart_meteo__manila_monthly: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_03_meteo.mart_meteo__manila_monthly"} */

    select name, type from system.columns where table = 'mart_meteo__manila_monthly__dbt_backup'
    
      and database = 'mart'
    
    order by position
  ...
[0m15:37:35.588820 [debug] [Thread-4  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m15:37:35.594009 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m15:37:35.602399 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m15:37:35.609920 [debug] [Thread-4  ]: dbt_clickhouse adapter: On model.ex_03_meteo.vw_meteo__manila_night_weather: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_03_meteo.vw_meteo__manila_night_weather"} */

    drop table if exists `mart`.`vw_meteo__manila_night_weather` 
  
  ...
[0m15:37:35.674369 [debug] [Thread-1  ]: Writing runtime sql for node "model.ex_03_meteo.mart_meteo__manila_daily"
[0m15:37:35.679874 [debug] [Thread-2  ]: Writing runtime sql for node "model.ex_03_meteo.mart_meteo__manila_monthly"
[0m15:37:35.684874 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_03_meteo.mart_meteo__manila_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_03_meteo.mart_meteo__manila_daily"} */

  
    
    
    
        
         


        insert into `mart`.`mart_meteo__manila_daily__dbt_backup`
        ("dte", "temp_min_c", "temp_max_c", "temp_avg_c", "precip_mm", "weather_code")

-- Force non-nullable key for MergeTree
select
  assumeNotNull(dte)                         as dte,          -- 👈 non-nullable
  temp_min_c,
  temp_max_c,
  (temp_min_c + temp_max_c)/2.0              as temp_avg_c,
  precip_mm,
  weather_code
from `clean`.`stg_meteo__manila`
  ...
[0m15:37:35.687508 [debug] [Thread-4  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m15:37:35.693426 [debug] [Thread-4  ]: dbt_clickhouse adapter: On model.ex_03_meteo.vw_meteo__manila_night_weather: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_03_meteo.vw_meteo__manila_night_weather"} */

    rename table `mart`.`vw_meteo__manila_night_weather__dbt_tmp` to `mart`.`vw_meteo__manila_night_weather` 
  
  ...
[0m15:37:35.697830 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_03_meteo.mart_meteo__manila_monthly: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_03_meteo.mart_meteo__manila_monthly"} */

  
    
    
    
        
         


        insert into `mart`.`mart_meteo__manila_monthly__dbt_backup`
        ("month", "avg_min_c", "avg_max_c", "avg_temp_c", "total_precip_mm", "rainy_days")

with base as (
  select
    assumeNotNull(dte)                            as dte_nn,   -- 👈 non-nullable
    toFloat64(temp_min_c)                         as temp_min_c,
    toFloat64(temp_max_c)                         as temp_max_c,
    (toFloat64(temp_min_c) + toFloat64(temp_max_c))/2.0 as temp_avg_c,
    toFloat64(precip_mm)                          as precip_mm
  from `clean`.`stg_meteo__manila`
)
select
  toStartOfMonth(dte_nn)                as month,             -- 👈 computed from non-null date
  avg(temp_min_c)                       as avg_min_c,
  avg(temp_max_c)                       as avg_max_c,
  avg(temp_avg_c)                       as avg_temp_c,
  sum(precip_mm)                        as total_precip_mm,
  countIf(precip_mm > 0)                as rainy_days
from base
group by month
order by month
  ...
[0m15:37:35.705284 [debug] [Thread-4  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m15:37:35.777770 [debug] [Thread-4  ]: dbt_clickhouse adapter: On model.ex_03_meteo.vw_meteo__manila_night_weather: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_03_meteo.vw_meteo__manila_night_weather"} */

    drop table if exists `mart`.`vw_meteo__manila_night_weather__dbt_backup` 
  ...
[0m15:37:35.780522 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.09 seconds
[0m15:37:35.773444 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m15:37:35.795759 [debug] [Thread-4  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m15:37:35.804191 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_03_meteo.mart_meteo__manila_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_03_meteo.mart_meteo__manila_daily"} */
EXCHANGE TABLES `mart`.`mart_meteo__manila_daily__dbt_backup` AND `mart`.`mart_meteo__manila_daily` 
  
  ...
[0m15:37:35.808623 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_03_meteo.mart_meteo__manila_monthly: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_03_meteo.mart_meteo__manila_monthly"} */
EXCHANGE TABLES `mart`.`mart_meteo__manila_monthly__dbt_backup` AND `mart`.`mart_meteo__manila_monthly` 
  
  ...
[0m15:37:35.813670 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44d80b62-f5de-47ad-9490-491a483a09f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7639cda59c10>]}
[0m15:37:35.872394 [info ] [Thread-4  ]: 8 of 8 OK created sql view model `mart`.`vw_meteo__manila_night_weather` ....... [[32mOK[0m in 1.00s]
[0m15:37:35.875852 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m15:37:35.878931 [debug] [Thread-4  ]: Finished running node model.ex_03_meteo.vw_meteo__manila_night_weather
[0m15:37:35.892569 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.08 seconds
[0m15:37:35.896712 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_03_meteo.mart_meteo__manila_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_03_meteo.mart_meteo__manila_daily"} */

    drop table if exists `mart`.`mart_meteo__manila_daily__dbt_backup` 
  ...
[0m15:37:35.911408 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_03_meteo.mart_meteo__manila_monthly: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_03_meteo.mart_meteo__manila_monthly"} */

    drop table if exists `mart`.`mart_meteo__manila_monthly__dbt_backup` 
  ...
[0m15:37:35.918512 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m15:37:35.973354 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m15:37:35.978651 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44d80b62-f5de-47ad-9490-491a483a09f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7639cda4e880>]}
[0m15:37:35.984026 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44d80b62-f5de-47ad-9490-491a483a09f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7639cda57e50>]}
[0m15:37:35.986567 [info ] [Thread-1  ]: 6 of 8 OK created sql table model `mart`.`mart_meteo__manila_daily` ............ [[32mOK[0m in 1.17s]
[0m15:37:35.989289 [info ] [Thread-2  ]: 7 of 8 OK created sql table model `mart`.`mart_meteo__manila_monthly` .......... [[32mOK[0m in 1.17s]
[0m15:37:35.992644 [debug] [Thread-1  ]: Finished running node model.ex_03_meteo.mart_meteo__manila_daily
[0m15:37:35.996111 [debug] [Thread-2  ]: Finished running node model.ex_03_meteo.mart_meteo__manila_monthly
[0m15:37:36.000601 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:37:36.001926 [debug] [MainThread]: Connection 'model.ex_03_meteo.mart_meteo__manila_daily' was left open.
[0m15:37:36.003177 [debug] [MainThread]: On model.ex_03_meteo.mart_meteo__manila_daily: Close
[0m15:37:36.004334 [debug] [MainThread]: Connection 'list__clean' was left open.
[0m15:37:36.005568 [debug] [MainThread]: On list__clean: Close
[0m15:37:36.006822 [debug] [MainThread]: Connection 'test.ex_03_meteo.not_null_stg_meteo__manila_dte.513a28a12f' was left open.
[0m15:37:36.007998 [debug] [MainThread]: On test.ex_03_meteo.not_null_stg_meteo__manila_dte.513a28a12f: Close
[0m15:37:36.009195 [debug] [MainThread]: Connection 'model.ex_03_meteo.vw_meteo__manila_night_weather' was left open.
[0m15:37:36.010370 [debug] [MainThread]: On model.ex_03_meteo.vw_meteo__manila_night_weather: Close
[0m15:37:36.011545 [debug] [MainThread]: Connection 'model.ex_03_meteo.mart_meteo__manila_monthly' was left open.
[0m15:37:36.012714 [debug] [MainThread]: On model.ex_03_meteo.mart_meteo__manila_monthly: Close
[0m15:37:36.014894 [info ] [MainThread]: 
[0m15:37:36.016365 [info ] [MainThread]: Finished running 2 view models, 4 data tests, 2 table models in 0 hours 0 minutes and 4.02 seconds (4.02s).
[0m15:37:36.073959 [debug] [MainThread]: Command end result
[0m15:37:36.280883 [info ] [MainThread]: 
[0m15:37:36.281831 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:37:36.282460 [info ] [MainThread]: 
[0m15:37:36.283151 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m15:37:36.284552 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 7.578497, "process_in_blocks": "0", "process_kernel_time": 0.682573, "process_mem_max_rss": "115960", "process_out_blocks": "10768", "process_user_time": 6.469437}
[0m15:37:36.285359 [debug] [MainThread]: Command `dbt build` succeeded at 15:37:36.285162 after 7.58 seconds
[0m15:37:36.286050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7639d1fd8310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7639cfef6940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7639cfe63f70>]}
[0m15:37:36.286674 [debug] [MainThread]: Flushing usage events
[0m15:39:29.299563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70899b86d310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7089984d1ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7089984d1970>]}


============================== 15:39:29.359802 | 01efb72d-0201-4d73-8e52-98a582b86a5e ==============================
[0m15:39:29.359802 [info ] [MainThread]: Running with dbt=1.8.9
[0m15:39:29.360954 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'fail_fast': 'False', 'indirect_selection': 'eager', 'use_colors': 'True', 'profiles_dir': '.', 'cache_selected_only': 'False', 'log_path': '/workdir/transforms/03_meteo/logs', 'invocation_command': 'dbt build --profiles-dir . --target local', 'static_parser': 'True', 'no_print': 'None', 'debug': 'False', 'partial_parse': 'True', 'write_json': 'True', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'warn_error': 'None', 'log_cache_events': 'False', 'log_format': 'default', 'empty': 'False', 'target_path': 'None', 'quiet': 'False', 'printer_width': '80'}
[0m15:39:29.887807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '01efb72d-0201-4d73-8e52-98a582b86a5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70899856bd90>]}
[0m15:39:30.080446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '01efb72d-0201-4d73-8e52-98a582b86a5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708998488250>]}
[0m15:39:30.081732 [info ] [MainThread]: Registered adapter: clickhouse=1.8.6
[0m15:39:30.493868 [debug] [MainThread]: checksum: 134c0f7b96382cc6938697739bc32fb1adc530b177e30f60cebddf61dbd7e979, vars: {}, profile: , target: local, version: 1.8.9
[0m15:39:30.996960 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m15:39:30.997856 [debug] [MainThread]: Partial parsing: added file: ex_03_meteo://models/mart/vw_meteo__manila_weather.sql
[0m15:39:30.998436 [debug] [MainThread]: Partial parsing: deleted file: ex_03_meteo://models/mart/vw_meteo__manila_night_weather.sql
[0m15:39:31.894840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '01efb72d-0201-4d73-8e52-98a582b86a5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7089977a5f10>]}
[0m15:39:32.371571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '01efb72d-0201-4d73-8e52-98a582b86a5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708997718af0>]}
[0m15:39:32.372469 [info ] [MainThread]: Found 4 models, 4 data tests, 2 sources, 471 macros
[0m15:39:32.376086 [info ] [MainThread]: 
[0m15:39:32.377315 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m15:39:32.389504 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m15:39:32.395838 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m15:39:32.409839 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:39:32.464902 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:39:33.010452 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m15:39:33.016514 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m15:39:33.020155 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m15:39:33.023149 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m15:39:33.263444 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__mart)
[0m15:39:33.275599 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__clean)
[0m15:39:33.280503 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__mart: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list__mart"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'mart'
      

  ...
[0m15:39:33.288047 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list__clean"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'clean'
      

  ...
[0m15:39:33.297266 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m15:39:33.307068 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m15:39:33.362790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01efb72d-0201-4d73-8e52-98a582b86a5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70899726da60>]}
[0m15:39:33.364742 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m15:39:33.366027 [info ] [MainThread]: 
[0m15:39:33.390815 [debug] [Thread-1  ]: Began running node model.ex_03_meteo.stg_meteo__manila
[0m15:39:33.391951 [info ] [Thread-1  ]: 1 of 8 START sql view model `clean`.`stg_meteo__manila` ........................ [RUN]
[0m15:39:33.392804 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list__mart, now model.ex_03_meteo.stg_meteo__manila)
[0m15:39:33.393549 [debug] [Thread-1  ]: Began compiling node model.ex_03_meteo.stg_meteo__manila
[0m15:39:33.462213 [debug] [Thread-1  ]: Writing injected SQL for node "model.ex_03_meteo.stg_meteo__manila"
[0m15:39:33.463359 [debug] [Thread-1  ]: Began executing node model.ex_03_meteo.stg_meteo__manila
[0m15:39:33.587734 [debug] [Thread-1  ]: Writing runtime sql for node "model.ex_03_meteo.stg_meteo__manila"
[0m15:39:33.589336 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_03_meteo.stg_meteo__manila: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_03_meteo.stg_meteo__manila"} */


  create view `clean`.`stg_meteo__manila__dbt_tmp` 
  
    
    
  as (
    

-- Normalize types & naming; no business logic here.
select
  toDate(date)                         as dte,
  toFloat64(temp_min)                  as temp_min_c,
  toFloat64(temp_max)                  as temp_max_c,
  toFloat64(precipitation)             as precip_mm,
  toInt32(weather_code)                as weather_code
from `raw`.`meteo___manila`
    
  )
      
      
                    -- end_of_sql
                    
                    ...
[0m15:39:33.600957 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m15:39:33.614339 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_03_meteo.stg_meteo__manila: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_03_meteo.stg_meteo__manila"} */

    drop table if exists `clean`.`stg_meteo__manila__dbt_backup` 
  
  ...
[0m15:39:33.617355 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m15:39:33.660484 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_03_meteo.stg_meteo__manila: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_03_meteo.stg_meteo__manila"} */

    rename table `clean`.`stg_meteo__manila` to `clean`.`stg_meteo__manila__dbt_backup` 
  
  ...
[0m15:39:33.663409 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m15:39:33.668741 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_03_meteo.stg_meteo__manila: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_03_meteo.stg_meteo__manila"} */

    drop table if exists `clean`.`stg_meteo__manila` 
  
  ...
[0m15:39:33.671389 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m15:39:33.673114 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_03_meteo.stg_meteo__manila: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_03_meteo.stg_meteo__manila"} */

    rename table `clean`.`stg_meteo__manila__dbt_tmp` to `clean`.`stg_meteo__manila` 
  
  ...
[0m15:39:33.675795 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m15:39:33.770228 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_03_meteo.stg_meteo__manila: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_03_meteo.stg_meteo__manila"} */

    drop table if exists `clean`.`stg_meteo__manila__dbt_backup` 
  ...
[0m15:39:33.773961 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m15:39:33.779993 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01efb72d-0201-4d73-8e52-98a582b86a5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708997304f70>]}
[0m15:39:33.781143 [info ] [Thread-1  ]: 1 of 8 OK created sql view model `clean`.`stg_meteo__manila` ................... [[32mOK[0m in 0.39s]
[0m15:39:33.782555 [debug] [Thread-1  ]: Finished running node model.ex_03_meteo.stg_meteo__manila
[0m15:39:33.784797 [debug] [Thread-3  ]: Began running node test.ex_03_meteo.not_null_stg_meteo__manila_dte.513a28a12f
[0m15:39:33.785674 [info ] [Thread-3  ]: 2 of 8 START test not_null_stg_meteo__manila_dte ............................... [RUN]
[0m15:39:33.786908 [debug] [Thread-4  ]: Began running node test.ex_03_meteo.not_null_stg_meteo__manila_temp_max_c.a5e6f8c339
[0m15:39:33.788490 [debug] [Thread-3  ]: Acquiring new clickhouse connection 'test.ex_03_meteo.not_null_stg_meteo__manila_dte.513a28a12f'
[0m15:39:33.789500 [debug] [Thread-2  ]: Began running node test.ex_03_meteo.not_null_stg_meteo__manila_temp_min_c.f577a564e9
[0m15:39:33.791286 [info ] [Thread-4  ]: 3 of 8 START test not_null_stg_meteo__manila_temp_max_c ........................ [RUN]
[0m15:39:33.792823 [debug] [Thread-1  ]: Began running node test.ex_03_meteo.unique_stg_meteo__manila_dte.65d5c5a8bc
[0m15:39:33.793957 [debug] [Thread-3  ]: Began compiling node test.ex_03_meteo.not_null_stg_meteo__manila_dte.513a28a12f
[0m15:39:33.795350 [info ] [Thread-2  ]: 4 of 8 START test not_null_stg_meteo__manila_temp_min_c ........................ [RUN]
[0m15:39:33.796959 [debug] [Thread-4  ]: Acquiring new clickhouse connection 'test.ex_03_meteo.not_null_stg_meteo__manila_temp_max_c.a5e6f8c339'
[0m15:39:33.798419 [info ] [Thread-1  ]: 5 of 8 START test unique_stg_meteo__manila_dte ................................. [RUN]
[0m15:39:33.866121 [debug] [Thread-2  ]: Acquiring new clickhouse connection 'test.ex_03_meteo.not_null_stg_meteo__manila_temp_min_c.f577a564e9'
[0m15:39:33.896456 [debug] [Thread-4  ]: Began compiling node test.ex_03_meteo.not_null_stg_meteo__manila_temp_max_c.a5e6f8c339
[0m15:39:33.902097 [debug] [Thread-3  ]: Writing injected SQL for node "test.ex_03_meteo.not_null_stg_meteo__manila_dte.513a28a12f"
[0m15:39:33.903799 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ex_03_meteo.stg_meteo__manila, now test.ex_03_meteo.unique_stg_meteo__manila_dte.65d5c5a8bc)
[0m15:39:33.905312 [debug] [Thread-2  ]: Began compiling node test.ex_03_meteo.not_null_stg_meteo__manila_temp_min_c.f577a564e9
[0m15:39:33.971364 [debug] [Thread-4  ]: Writing injected SQL for node "test.ex_03_meteo.not_null_stg_meteo__manila_temp_max_c.a5e6f8c339"
[0m15:39:33.974098 [debug] [Thread-1  ]: Began compiling node test.ex_03_meteo.unique_stg_meteo__manila_dte.65d5c5a8bc
[0m15:39:33.976032 [debug] [Thread-3  ]: Began executing node test.ex_03_meteo.not_null_stg_meteo__manila_dte.513a28a12f
[0m15:39:33.991420 [debug] [Thread-2  ]: Writing injected SQL for node "test.ex_03_meteo.not_null_stg_meteo__manila_temp_min_c.f577a564e9"
[0m15:39:34.065033 [debug] [Thread-4  ]: Began executing node test.ex_03_meteo.not_null_stg_meteo__manila_temp_max_c.a5e6f8c339
[0m15:39:34.085363 [debug] [Thread-1  ]: Writing injected SQL for node "test.ex_03_meteo.unique_stg_meteo__manila_dte.65d5c5a8bc"
[0m15:39:34.108315 [debug] [Thread-2  ]: Began executing node test.ex_03_meteo.not_null_stg_meteo__manila_temp_min_c.f577a564e9
[0m15:39:34.271979 [debug] [Thread-3  ]: Writing runtime sql for node "test.ex_03_meteo.not_null_stg_meteo__manila_dte.513a28a12f"
[0m15:39:34.283930 [debug] [Thread-1  ]: Began executing node test.ex_03_meteo.unique_stg_meteo__manila_dte.65d5c5a8bc
[0m15:39:34.295963 [debug] [Thread-2  ]: Writing runtime sql for node "test.ex_03_meteo.not_null_stg_meteo__manila_temp_min_c.f577a564e9"
[0m15:39:34.305489 [debug] [Thread-4  ]: Writing runtime sql for node "test.ex_03_meteo.not_null_stg_meteo__manila_temp_max_c.a5e6f8c339"
[0m15:39:34.365725 [debug] [Thread-1  ]: Writing runtime sql for node "test.ex_03_meteo.unique_stg_meteo__manila_dte.65d5c5a8bc"
[0m15:39:34.368207 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m15:39:34.424128 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m15:39:34.425340 [debug] [Thread-1  ]: dbt_clickhouse adapter: On test.ex_03_meteo.unique_stg_meteo__manila_dte.65d5c5a8bc: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "test.ex_03_meteo.unique_stg_meteo__manila_dte.65d5c5a8bc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    dte as unique_field,
    count(*) as n_records

from `clean`.`stg_meteo__manila`
where dte is not null
group by dte
having count(*) > 1



    ) dbt_internal_test...
[0m15:39:34.426590 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m15:39:34.484397 [debug] [Thread-3  ]: dbt_clickhouse adapter: On test.ex_03_meteo.not_null_stg_meteo__manila_dte.513a28a12f: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "test.ex_03_meteo.not_null_stg_meteo__manila_dte.513a28a12f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select dte
from `clean`.`stg_meteo__manila`
where dte is null



    ) dbt_internal_test...
[0m15:39:34.491802 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m15:39:34.571818 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.08 seconds
[0m15:39:34.581107 [info ] [Thread-1  ]: 5 of 8 PASS unique_stg_meteo__manila_dte ....................................... [[32mPASS[0m in 0.68s]
[0m15:39:34.586973 [info ] [Thread-3  ]: 2 of 8 PASS not_null_stg_meteo__manila_dte ..................................... [[32mPASS[0m in 0.80s]
[0m15:39:34.599292 [debug] [Thread-1  ]: Finished running node test.ex_03_meteo.unique_stg_meteo__manila_dte.65d5c5a8bc
[0m15:39:34.660160 [debug] [Thread-3  ]: Finished running node test.ex_03_meteo.not_null_stg_meteo__manila_dte.513a28a12f
[0m15:39:34.684662 [debug] [Thread-2  ]: dbt_clickhouse adapter: On test.ex_03_meteo.not_null_stg_meteo__manila_temp_min_c.f577a564e9: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "test.ex_03_meteo.not_null_stg_meteo__manila_temp_min_c.f577a564e9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select temp_min_c
from `clean`.`stg_meteo__manila`
where temp_min_c is null



    ) dbt_internal_test...
[0m15:39:34.693079 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m15:39:34.697968 [info ] [Thread-2  ]: 4 of 8 PASS not_null_stg_meteo__manila_temp_min_c .............................. [[32mPASS[0m in 0.83s]
[0m15:39:34.700066 [debug] [Thread-2  ]: Finished running node test.ex_03_meteo.not_null_stg_meteo__manila_temp_min_c.f577a564e9
[0m15:39:34.712189 [debug] [Thread-4  ]: dbt_clickhouse adapter: On test.ex_03_meteo.not_null_stg_meteo__manila_temp_max_c.a5e6f8c339: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "test.ex_03_meteo.not_null_stg_meteo__manila_temp_max_c.a5e6f8c339"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select temp_max_c
from `clean`.`stg_meteo__manila`
where temp_max_c is null



    ) dbt_internal_test...
[0m15:39:34.718881 [debug] [Thread-4  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m15:39:34.722845 [info ] [Thread-4  ]: 3 of 8 PASS not_null_stg_meteo__manila_temp_max_c .............................. [[32mPASS[0m in 0.93s]
[0m15:39:34.724634 [debug] [Thread-4  ]: Finished running node test.ex_03_meteo.not_null_stg_meteo__manila_temp_max_c.a5e6f8c339
[0m15:39:34.726976 [debug] [Thread-1  ]: Began running node model.ex_03_meteo.mart_meteo__manila_daily
[0m15:39:34.727874 [debug] [Thread-3  ]: Began running node model.ex_03_meteo.mart_meteo__manila_monthly
[0m15:39:34.728981 [debug] [Thread-2  ]: Began running node model.ex_03_meteo.vw_meteo__manila_weather
[0m15:39:34.730643 [info ] [Thread-1  ]: 6 of 8 START sql table model `mart`.`mart_meteo__manila_daily` ................. [RUN]
[0m15:39:34.732336 [info ] [Thread-3  ]: 7 of 8 START sql table model `mart`.`mart_meteo__manila_monthly` ............... [RUN]
[0m15:39:34.762179 [info ] [Thread-2  ]: 8 of 8 START sql view model `mart`.`vw_meteo__manila_weather` .................. [RUN]
[0m15:39:34.764202 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ex_03_meteo.unique_stg_meteo__manila_dte.65d5c5a8bc, now model.ex_03_meteo.mart_meteo__manila_daily)
[0m15:39:34.765870 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ex_03_meteo.not_null_stg_meteo__manila_dte.513a28a12f, now model.ex_03_meteo.mart_meteo__manila_monthly)
[0m15:39:34.767401 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ex_03_meteo.not_null_stg_meteo__manila_temp_min_c.f577a564e9, now model.ex_03_meteo.vw_meteo__manila_weather)
[0m15:39:34.769267 [debug] [Thread-1  ]: Began compiling node model.ex_03_meteo.mart_meteo__manila_daily
[0m15:39:34.771640 [debug] [Thread-3  ]: Began compiling node model.ex_03_meteo.mart_meteo__manila_monthly
[0m15:39:34.773338 [debug] [Thread-2  ]: Began compiling node model.ex_03_meteo.vw_meteo__manila_weather
[0m15:39:34.790099 [debug] [Thread-1  ]: Writing injected SQL for node "model.ex_03_meteo.mart_meteo__manila_daily"
[0m15:39:34.860270 [debug] [Thread-3  ]: Writing injected SQL for node "model.ex_03_meteo.mart_meteo__manila_monthly"
[0m15:39:34.877309 [debug] [Thread-2  ]: Writing injected SQL for node "model.ex_03_meteo.vw_meteo__manila_weather"
[0m15:39:34.879876 [debug] [Thread-1  ]: Began executing node model.ex_03_meteo.mart_meteo__manila_daily
[0m15:39:34.892592 [debug] [Thread-3  ]: Began executing node model.ex_03_meteo.mart_meteo__manila_monthly
[0m15:39:34.899490 [debug] [Thread-2  ]: Began executing node model.ex_03_meteo.vw_meteo__manila_weather
[0m15:39:35.005508 [debug] [Thread-2  ]: Creating new relation vw_meteo__manila_weather
[0m15:39:35.085595 [debug] [Thread-2  ]: Writing runtime sql for node "model.ex_03_meteo.vw_meteo__manila_weather"
[0m15:39:35.204452 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_03_meteo.vw_meteo__manila_weather: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_03_meteo.vw_meteo__manila_weather"} */


  create view `mart`.`vw_meteo__manila_weather` 
  
    
    
  as (
    

with daily as (
  select
    dte,
    temp_min_c,
    temp_max_c,
    (temp_min_c + temp_max_c)/2.0 as temp_avg_c,
    precip_mm,
    weather_code
  from `clean`.`stg_meteo__manila`
),
codes as (
  select
    toInt32(weather_code)                as weather_code,
    cast(night_description as String)    as condition
  from `raw`.`meteo___wmo_codes`
)

select
  d.dte,
  d.temp_min_c,
  d.temp_max_c,
  d.temp_avg_c,
  d.precip_mm,
  d.weather_code,
  c.condition
from daily d
left join codes c
  on c.weather_code = d.weather_code
order by d.dte
    
  )
      
      
                    -- end_of_sql
                    
                    ...
[0m15:39:35.382418 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.09 seconds
[0m15:39:35.468202 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01efb72d-0201-4d73-8e52-98a582b86a5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7089972f96d0>]}
[0m15:39:35.475761 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_03_meteo.mart_meteo__manila_monthly: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_03_meteo.mart_meteo__manila_monthly"} */

            

    
        create table `mart`.`mart_meteo__manila_monthly__dbt_backup`
        
  
        
  engine = MergeTree()
        order by (month)
        
        partition by (toYYYYMM(month))
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

with base as (
  select
    assumeNotNull(dte)                            as dte_nn,   -- 👈 non-nullable
    toFloat64(temp_min_c)                         as temp_min_c,
    toFloat64(temp_max_c)                         as temp_max_c,
    (toFloat64(temp_min_c) + toFloat64(temp_max_c))/2.0 as temp_avg_c,
    toFloat64(precip_mm)                          as precip_mm
  from `clean`.`stg_meteo__manila`
)
select
  toStartOfMonth(dte_nn)                as month,             -- 👈 computed from non-null date
  avg(temp_min_c)                       as avg_min_c,
  avg(temp_max_c)                       as avg_max_c,
  avg(temp_avg_c)                       as avg_temp_c,
  sum(precip_mm)                        as total_precip_mm,
  countIf(precip_mm > 0)                as rainy_days
from base
group by month
order by month
          )
        
        ...
[0m15:39:35.480170 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_03_meteo.mart_meteo__manila_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_03_meteo.mart_meteo__manila_daily"} */

            

    
        create table `mart`.`mart_meteo__manila_daily__dbt_backup`
        
  
        
  engine = MergeTree()
        order by (dte)
        
        partition by (toYYYYMM(dte))
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

-- Force non-nullable key for MergeTree
select
  assumeNotNull(dte)                         as dte,          -- 👈 non-nullable
  temp_min_c,
  temp_max_c,
  (temp_min_c + temp_max_c)/2.0              as temp_avg_c,
  precip_mm,
  weather_code
from `clean`.`stg_meteo__manila`
          )
        
        ...
[0m15:39:35.481895 [info ] [Thread-2  ]: 8 of 8 OK created sql view model `mart`.`vw_meteo__manila_weather` ............. [[32mOK[0m in 0.70s]
[0m15:39:35.485960 [debug] [Thread-2  ]: Finished running node model.ex_03_meteo.vw_meteo__manila_weather
[0m15:39:35.502959 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m15:39:35.519786 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m15:39:35.521120 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_03_meteo.mart_meteo__manila_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_03_meteo.mart_meteo__manila_daily"} */

    select name, type from system.columns where table = 'mart_meteo__manila_daily__dbt_backup'
    
      and database = 'mart'
    
    order by position
  ...
[0m15:39:35.562202 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_03_meteo.mart_meteo__manila_monthly: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_03_meteo.mart_meteo__manila_monthly"} */

    select name, type from system.columns where table = 'mart_meteo__manila_monthly__dbt_backup'
    
      and database = 'mart'
    
    order by position
  ...
[0m15:39:35.567363 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m15:39:35.568793 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m15:39:35.575027 [debug] [Thread-1  ]: Writing runtime sql for node "model.ex_03_meteo.mart_meteo__manila_daily"
[0m15:39:35.577663 [debug] [Thread-3  ]: Writing runtime sql for node "model.ex_03_meteo.mart_meteo__manila_monthly"
[0m15:39:35.579091 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_03_meteo.mart_meteo__manila_monthly: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_03_meteo.mart_meteo__manila_monthly"} */

  
    
    
    
        
         


        insert into `mart`.`mart_meteo__manila_monthly__dbt_backup`
        ("month", "avg_min_c", "avg_max_c", "avg_temp_c", "total_precip_mm", "rainy_days")

with base as (
  select
    assumeNotNull(dte)                            as dte_nn,   -- 👈 non-nullable
    toFloat64(temp_min_c)                         as temp_min_c,
    toFloat64(temp_max_c)                         as temp_max_c,
    (toFloat64(temp_min_c) + toFloat64(temp_max_c))/2.0 as temp_avg_c,
    toFloat64(precip_mm)                          as precip_mm
  from `clean`.`stg_meteo__manila`
)
select
  toStartOfMonth(dte_nn)                as month,             -- 👈 computed from non-null date
  avg(temp_min_c)                       as avg_min_c,
  avg(temp_max_c)                       as avg_max_c,
  avg(temp_avg_c)                       as avg_temp_c,
  sum(precip_mm)                        as total_precip_mm,
  countIf(precip_mm > 0)                as rainy_days
from base
group by month
order by month
  ...
[0m15:39:35.580139 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_03_meteo.mart_meteo__manila_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_03_meteo.mart_meteo__manila_daily"} */

  
    
    
    
        
         


        insert into `mart`.`mart_meteo__manila_daily__dbt_backup`
        ("dte", "temp_min_c", "temp_max_c", "temp_avg_c", "precip_mm", "weather_code")

-- Force non-nullable key for MergeTree
select
  assumeNotNull(dte)                         as dte,          -- 👈 non-nullable
  temp_min_c,
  temp_max_c,
  (temp_min_c + temp_max_c)/2.0              as temp_avg_c,
  precip_mm,
  weather_code
from `clean`.`stg_meteo__manila`
  ...
[0m15:39:35.595675 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m15:39:35.604694 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_03_meteo.mart_meteo__manila_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_03_meteo.mart_meteo__manila_daily"} */
EXCHANGE TABLES `mart`.`mart_meteo__manila_daily__dbt_backup` AND `mart`.`mart_meteo__manila_daily` 
  
  ...
[0m15:39:35.608105 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m15:39:35.615219 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_03_meteo.mart_meteo__manila_daily: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_03_meteo.mart_meteo__manila_daily"} */

    drop table if exists `mart`.`mart_meteo__manila_daily__dbt_backup` 
  ...
[0m15:39:35.618739 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m15:39:35.621474 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01efb72d-0201-4d73-8e52-98a582b86a5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7089985c7d30>]}
[0m15:39:35.660564 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.08 seconds
[0m15:39:35.661438 [info ] [Thread-1  ]: 6 of 8 OK created sql table model `mart`.`mart_meteo__manila_daily` ............ [[32mOK[0m in 0.86s]
[0m15:39:35.663792 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_03_meteo.mart_meteo__manila_monthly: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_03_meteo.mart_meteo__manila_monthly"} */
EXCHANGE TABLES `mart`.`mart_meteo__manila_monthly__dbt_backup` AND `mart`.`mart_meteo__manila_monthly` 
  
  ...
[0m15:39:35.665180 [debug] [Thread-1  ]: Finished running node model.ex_03_meteo.mart_meteo__manila_daily
[0m15:39:35.668356 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m15:39:35.675162 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_03_meteo.mart_meteo__manila_monthly: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_03_meteo.mart_meteo__manila_monthly"} */

    drop table if exists `mart`.`mart_meteo__manila_monthly__dbt_backup` 
  ...
[0m15:39:35.678322 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m15:39:35.681187 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01efb72d-0201-4d73-8e52-98a582b86a5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7089972e7cd0>]}
[0m15:39:35.682949 [info ] [Thread-3  ]: 7 of 8 OK created sql table model `mart`.`mart_meteo__manila_monthly` .......... [[32mOK[0m in 0.92s]
[0m15:39:35.684565 [debug] [Thread-3  ]: Finished running node model.ex_03_meteo.mart_meteo__manila_monthly
[0m15:39:35.686614 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:39:35.687168 [debug] [MainThread]: Connection 'model.ex_03_meteo.mart_meteo__manila_daily' was left open.
[0m15:39:35.687761 [debug] [MainThread]: On model.ex_03_meteo.mart_meteo__manila_daily: Close
[0m15:39:35.688240 [debug] [MainThread]: Connection 'list__clean' was left open.
[0m15:39:35.688774 [debug] [MainThread]: On list__clean: Close
[0m15:39:35.689292 [debug] [MainThread]: Connection 'model.ex_03_meteo.mart_meteo__manila_monthly' was left open.
[0m15:39:35.689808 [debug] [MainThread]: On model.ex_03_meteo.mart_meteo__manila_monthly: Close
[0m15:39:35.690328 [debug] [MainThread]: Connection 'test.ex_03_meteo.not_null_stg_meteo__manila_temp_max_c.a5e6f8c339' was left open.
[0m15:39:35.690895 [debug] [MainThread]: On test.ex_03_meteo.not_null_stg_meteo__manila_temp_max_c.a5e6f8c339: Close
[0m15:39:35.691395 [debug] [MainThread]: Connection 'model.ex_03_meteo.vw_meteo__manila_weather' was left open.
[0m15:39:35.691985 [debug] [MainThread]: On model.ex_03_meteo.vw_meteo__manila_weather: Close
[0m15:39:35.693132 [info ] [MainThread]: 
[0m15:39:35.693854 [info ] [MainThread]: Finished running 2 view models, 4 data tests, 2 table models in 0 hours 0 minutes and 3.32 seconds (3.32s).
[0m15:39:35.698175 [debug] [MainThread]: Command end result
[0m15:39:35.804969 [info ] [MainThread]: 
[0m15:39:35.805916 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:39:35.806569 [info ] [MainThread]: 
[0m15:39:35.807288 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m15:39:35.859996 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 6.754122, "process_in_blocks": "0", "process_kernel_time": 0.677149, "process_mem_max_rss": "115812", "process_out_blocks": "10752", "process_user_time": 5.994761}
[0m15:39:35.860933 [debug] [MainThread]: Command `dbt build` succeeded at 15:39:35.860735 after 6.76 seconds
[0m15:39:35.861599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70899b86d310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708997cb5790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708997655c40>]}
[0m15:39:35.862189 [debug] [MainThread]: Flushing usage events
