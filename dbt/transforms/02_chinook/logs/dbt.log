[0m08:12:25.675608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16213f0310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f161e051af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f161e0519a0>]}


============================== 08:12:25.685682 | e061b0be-5b36-4441-8234-6cda140ba967 ==============================
[0m08:12:25.685682 [info ] [MainThread]: Running with dbt=1.8.9
[0m08:12:25.686740 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'empty': 'False', 'partial_parse': 'True', 'indirect_selection': 'eager', 'fail_fast': 'False', 'introspect': 'True', 'debug': 'False', 'log_path': '/workdir/transforms/02_chinook/logs', 'invocation_command': 'dbt build --profiles-dir . --target local', 'use_experimental_parser': 'False', 'warn_error': 'None', 'use_colors': 'True', 'quiet': 'False', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '.', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'version_check': 'True', 'printer_width': '80', 'log_format': 'default'}
[0m08:12:26.225884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e061b0be-5b36-4441-8234-6cda140ba967', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1620997fd0>]}
[0m08:12:26.414257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e061b0be-5b36-4441-8234-6cda140ba967', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f161e01abe0>]}
[0m08:12:26.416010 [info ] [MainThread]: Registered adapter: clickhouse=1.8.6
[0m08:12:26.886038 [debug] [MainThread]: checksum: 134c0f7b96382cc6938697739bc32fb1adc530b177e30f60cebddf61dbd7e979, vars: {}, profile: , target: local, version: 1.8.9
[0m08:12:26.887403 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m08:12:26.888099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e061b0be-5b36-4441-8234-6cda140ba967', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f161dcf31c0>]}
[0m08:12:31.808527 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.ex_01_mpg.stg_chinook__album.sql' (models/clean/stg_chinook__album.sql.sql) depends on a source named 'chinook.albums' which was not found
[0m08:12:31.810992 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 6.3323393, "process_in_blocks": "2816", "process_kernel_time": 0.545969, "process_mem_max_rss": "100432", "process_out_blocks": "6616", "process_user_time": 5.998663}
[0m08:12:31.811740 [debug] [MainThread]: Command `dbt build` failed at 08:12:31.811528 after 6.33 seconds
[0m08:12:31.812370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16213f0310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f161df36580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f161df369a0>]}
[0m08:12:31.812979 [debug] [MainThread]: Flushing usage events
[0m08:15:44.751396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c09ff80310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c09cbdea90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c09cbde940>]}


============================== 08:15:44.760627 | 9a85211f-b6ad-4538-81e1-ca33b1791f09 ==============================
[0m08:15:44.760627 [info ] [MainThread]: Running with dbt=1.8.9
[0m08:15:44.761801 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_cache_events': 'False', 'empty': 'False', 'static_parser': 'True', 'warn_error': 'None', 'profiles_dir': '.', 'partial_parse': 'True', 'printer_width': '80', 'use_experimental_parser': 'False', 'write_json': 'True', 'indirect_selection': 'eager', 'version_check': 'True', 'introspect': 'True', 'no_print': 'None', 'log_format': 'default', 'target_path': 'None', 'debug': 'False', 'log_path': '/workdir/transforms/02_chinook/logs', 'fail_fast': 'False', 'quiet': 'False', 'use_colors': 'True', 'cache_selected_only': 'False', 'invocation_command': 'dbt build --profiles-dir . --target local', 'send_anonymous_usage_stats': 'True'}
[0m08:15:45.373139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9a85211f-b6ad-4538-81e1-ca33b1791f09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c09cae1a30>]}
[0m08:15:45.566646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9a85211f-b6ad-4538-81e1-ca33b1791f09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c09d02f250>]}
[0m08:15:45.567889 [info ] [MainThread]: Registered adapter: clickhouse=1.8.6
[0m08:15:46.026707 [debug] [MainThread]: checksum: 134c0f7b96382cc6938697739bc32fb1adc530b177e30f60cebddf61dbd7e979, vars: {}, profile: , target: local, version: 1.8.9
[0m08:15:46.028122 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m08:15:46.028830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9a85211f-b6ad-4538-81e1-ca33b1791f09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c09c8807c0>]}
[0m08:15:50.341294 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.ex_02_chinook.dim_album' (models/mart/dim_album.sql) depends on a node named 'stg_chinook__album' which was not found
[0m08:15:50.342913 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 5.7825723, "process_in_blocks": "26968", "process_kernel_time": 0.616956, "process_mem_max_rss": "100444", "process_out_blocks": "6624", "process_user_time": 5.770411}
[0m08:15:50.343652 [debug] [MainThread]: Command `dbt build` failed at 08:15:50.343432 after 5.78 seconds
[0m08:15:50.344297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c09ff80310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c09bf64220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79c09c5d3880>]}
[0m08:15:50.344888 [debug] [MainThread]: Flushing usage events
[0m08:16:16.719791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7090a69ab310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7090a360ba90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7090a360b940>]}


============================== 08:16:16.729086 | 44b6ec08-02b4-422e-b9e6-aaeb9fd15429 ==============================
[0m08:16:16.729086 [info ] [MainThread]: Running with dbt=1.8.9
[0m08:16:16.730200 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'indirect_selection': 'eager', 'version_check': 'True', 'log_format': 'default', 'write_json': 'True', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'target_path': 'None', 'warn_error': 'None', 'empty': 'False', 'use_colors': 'True', 'log_path': '/workdir/transforms/02_chinook/logs', 'no_print': 'None', 'printer_width': '80', 'introspect': 'True', 'fail_fast': 'False', 'quiet': 'False', 'profiles_dir': '.', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'invocation_command': 'dbt build --profiles-dir . --target local', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:16:17.317044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '44b6ec08-02b4-422e-b9e6-aaeb9fd15429', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7090a5f53fd0>]}
[0m08:16:17.508771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '44b6ec08-02b4-422e-b9e6-aaeb9fd15429', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7090a40f1430>]}
[0m08:16:17.510035 [info ] [MainThread]: Registered adapter: clickhouse=1.8.6
[0m08:16:17.931558 [debug] [MainThread]: checksum: 134c0f7b96382cc6938697739bc32fb1adc530b177e30f60cebddf61dbd7e979, vars: {}, profile: , target: local, version: 1.8.9
[0m08:16:17.933094 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m08:16:17.933798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '44b6ec08-02b4-422e-b9e6-aaeb9fd15429', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7090a32a0ee0>]}
[0m08:16:22.613563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '44b6ec08-02b4-422e-b9e6-aaeb9fd15429', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7090a32a0100>]}
[0m08:16:23.020605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '44b6ec08-02b4-422e-b9e6-aaeb9fd15429', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7090a28df430>]}
[0m08:16:23.021460 [info ] [MainThread]: Found 4 models, 2 sources, 471 macros
[0m08:16:23.024414 [info ] [MainThread]: 
[0m08:16:23.025440 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m08:16:23.038138 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m08:16:23.045093 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m08:16:23.201277 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:16:23.202900 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:16:23.768465 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m08:16:23.796168 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.03 seconds
[0m08:16:23.799628 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m08:16:23.807309 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m08:16:23.905579 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now create__staging)
[0m08:16:23.907226 [debug] [ThreadPool]: Creating schema "schema: "staging"
"
[0m08:16:23.922357 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create__staging, now list__mart)
[0m08:16:23.923981 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__staging)
[0m08:16:23.940565 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__mart: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list__mart"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'mart'
      

  ...
[0m08:16:24.002063 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__staging: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list__staging"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'staging'
      

  ...
[0m08:16:24.013872 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m08:16:24.016045 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m08:16:24.024554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '44b6ec08-02b4-422e-b9e6-aaeb9fd15429', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7090a5dc8940>]}
[0m08:16:24.026317 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m08:16:24.027394 [info ] [MainThread]: 
[0m08:16:24.099001 [debug] [Thread-1  ]: Began running node model.ex_02_chinook.stg_chinook__album
[0m08:16:24.100323 [info ] [Thread-1  ]: 1 of 4 START sql view model `staging`.`stg_chinook__album` ..................... [RUN]
[0m08:16:24.101329 [debug] [Thread-2  ]: Began running node model.ex_02_chinook.stg_chinook__artist
[0m08:16:24.102199 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list__mart, now model.ex_02_chinook.stg_chinook__album)
[0m08:16:24.103314 [info ] [Thread-2  ]: 2 of 4 START sql view model `staging`.`stg_chinook__artist` .................... [RUN]
[0m08:16:24.104282 [debug] [Thread-1  ]: Began compiling node model.ex_02_chinook.stg_chinook__album
[0m08:16:24.105385 [debug] [Thread-2  ]: Acquiring new clickhouse connection 'model.ex_02_chinook.stg_chinook__artist'
[0m08:16:24.125324 [debug] [Thread-1  ]: Writing injected SQL for node "model.ex_02_chinook.stg_chinook__album"
[0m08:16:24.126224 [debug] [Thread-2  ]: Began compiling node model.ex_02_chinook.stg_chinook__artist
[0m08:16:24.132324 [debug] [Thread-2  ]: Writing injected SQL for node "model.ex_02_chinook.stg_chinook__artist"
[0m08:16:24.133370 [debug] [Thread-1  ]: Began executing node model.ex_02_chinook.stg_chinook__album
[0m08:16:24.199793 [debug] [Thread-2  ]: Began executing node model.ex_02_chinook.stg_chinook__artist
[0m08:16:24.308784 [debug] [Thread-1  ]: Creating new relation stg_chinook__album
[0m08:16:24.422360 [debug] [Thread-2  ]: Creating new relation stg_chinook__artist
[0m08:16:24.512026 [debug] [Thread-1  ]: Writing runtime sql for node "model.ex_02_chinook.stg_chinook__album"
[0m08:16:24.514001 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m08:16:24.517250 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_02_chinook.stg_chinook__album: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.stg_chinook__album"} */


  create view `staging`.`stg_chinook__album` 
  
    
    
  as (
    

-- Keep album grain; standardize names/types.
select
  cast(album_id  as Nullable(Int64))      as album_id,
  cast(title     as Nullable(String))     as album_title,
  cast(artist_id as Nullable(Int64))      as artist_id
from `raw`.`albums`
    
  )
      
      
                    -- end_of_sql
                    
                    ...
[0m08:16:24.522964 [debug] [Thread-1  ]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.stg_chinook__album"} */


  create view `staging`.`stg_chinook__album` 
  
    
    
  as (
    

-- Keep album grain; standardize names/types.
select
  cast(album_id  as Nullable(Int64))      as album_id,
  cast(title     as Nullable(String))     as album_title,
  cast(artist_id as Nullable(Int64))      as artist_id
from `raw`.`albums`
    
  )
      
      
                    -- end_of_sql
                    
                    
[0m08:16:24.604943 [debug] [Thread-1  ]: Database Error in model stg_chinook__album (models/clean/stg_chinook__album.sql)
  HTTPDriver for http://clickhouse:8123 received ClickHouse error code 497
   Code: 497. DB::Exception: ftw_user: Not enough privileges. To execute this query, it's necessary to have the grant CREATE VIEW ON staging.stg_chinook__album. (ACCESS_DENIED) (version 23.12.6.19 (official build))
  compiled code at target/run/ex_02_chinook/models/clean/stg_chinook__album.sql
[0m08:16:24.610776 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44b6ec08-02b4-422e-b9e6-aaeb9fd15429', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7090a24903d0>]}
[0m08:16:24.613244 [error] [Thread-1  ]: 1 of 4 ERROR creating sql view model `staging`.`stg_chinook__album` ............ [[31mERROR[0m in 0.50s]
[0m08:16:24.616098 [debug] [Thread-1  ]: Finished running node model.ex_02_chinook.stg_chinook__album
[0m08:16:24.646038 [debug] [Thread-2  ]: Writing runtime sql for node "model.ex_02_chinook.stg_chinook__artist"
[0m08:16:24.648376 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_02_chinook.stg_chinook__artist: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.stg_chinook__artist"} */


  create view `staging`.`stg_chinook__artist` 
  
    
    
  as (
    

-- Standardize column names/types per table; no business logic.
select
  cast(artist_id as Nullable(Int64))      as artist_id,
  cast(name      as Nullable(String))     as artist_name
from `raw`.`artists`
    
  )
      
      
                    -- end_of_sql
                    
                    ...
[0m08:16:24.654667 [debug] [Thread-2  ]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.stg_chinook__artist"} */


  create view `staging`.`stg_chinook__artist` 
  
    
    
  as (
    

-- Standardize column names/types per table; no business logic.
select
  cast(artist_id as Nullable(Int64))      as artist_id,
  cast(name      as Nullable(String))     as artist_name
from `raw`.`artists`
    
  )
      
      
                    -- end_of_sql
                    
                    
[0m08:16:24.658343 [debug] [Thread-2  ]: Database Error in model stg_chinook__artist (models/clean/stg_chinook__artist.sql)
  HTTPDriver for http://clickhouse:8123 received ClickHouse error code 497
   Code: 497. DB::Exception: ftw_user: Not enough privileges. To execute this query, it's necessary to have the grant CREATE VIEW ON staging.stg_chinook__artist. (ACCESS_DENIED) (version 23.12.6.19 (official build))
  compiled code at target/run/ex_02_chinook/models/clean/stg_chinook__artist.sql
[0m08:16:24.659818 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44b6ec08-02b4-422e-b9e6-aaeb9fd15429', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7090a263a940>]}
[0m08:16:24.695519 [error] [Thread-2  ]: 2 of 4 ERROR creating sql view model `staging`.`stg_chinook__artist` ........... [[31mERROR[0m in 0.55s]
[0m08:16:24.697804 [debug] [Thread-2  ]: Finished running node model.ex_02_chinook.stg_chinook__artist
[0m08:16:24.699813 [debug] [Thread-4  ]: Began running node model.ex_02_chinook.dim_album
[0m08:16:24.700799 [debug] [Thread-3  ]: Began running node model.ex_02_chinook.dim_artist
[0m08:16:24.701963 [info ] [Thread-4  ]: 3 of 4 SKIP relation mart.dim_album ............................................ [[33mSKIP[0m]
[0m08:16:24.703164 [info ] [Thread-3  ]: 4 of 4 SKIP relation mart.dim_artist ........................................... [[33mSKIP[0m]
[0m08:16:24.704378 [debug] [Thread-4  ]: Finished running node model.ex_02_chinook.dim_album
[0m08:16:24.705496 [debug] [Thread-3  ]: Finished running node model.ex_02_chinook.dim_artist
[0m08:16:24.708055 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:16:24.708740 [debug] [MainThread]: Connection 'model.ex_02_chinook.stg_chinook__album' was left open.
[0m08:16:24.709328 [debug] [MainThread]: On model.ex_02_chinook.stg_chinook__album: Close
[0m08:16:24.709903 [debug] [MainThread]: Connection 'list__staging' was left open.
[0m08:16:24.710452 [debug] [MainThread]: On list__staging: Close
[0m08:16:24.711003 [debug] [MainThread]: Connection 'model.ex_02_chinook.stg_chinook__artist' was left open.
[0m08:16:24.711564 [debug] [MainThread]: On model.ex_02_chinook.stg_chinook__artist: Close
[0m08:16:24.712589 [info ] [MainThread]: 
[0m08:16:24.713298 [info ] [MainThread]: Finished running 2 view models, 2 table models in 0 hours 0 minutes and 1.69 seconds (1.69s).
[0m08:16:24.715524 [debug] [MainThread]: Command end result
[0m08:16:24.819373 [info ] [MainThread]: 
[0m08:16:24.820694 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m08:16:24.821676 [info ] [MainThread]: 
[0m08:16:24.823115 [error] [MainThread]:   Database Error in model stg_chinook__album (models/clean/stg_chinook__album.sql)
  HTTPDriver for http://clickhouse:8123 received ClickHouse error code 497
   Code: 497. DB::Exception: ftw_user: Not enough privileges. To execute this query, it's necessary to have the grant CREATE VIEW ON staging.stg_chinook__album. (ACCESS_DENIED) (version 23.12.6.19 (official build))
  compiled code at target/run/ex_02_chinook/models/clean/stg_chinook__album.sql
[0m08:16:24.823874 [info ] [MainThread]: 
[0m08:16:24.824828 [error] [MainThread]:   Database Error in model stg_chinook__artist (models/clean/stg_chinook__artist.sql)
  HTTPDriver for http://clickhouse:8123 received ClickHouse error code 497
   Code: 497. DB::Exception: ftw_user: Not enough privileges. To execute this query, it's necessary to have the grant CREATE VIEW ON staging.stg_chinook__artist. (ACCESS_DENIED) (version 23.12.6.19 (official build))
  compiled code at target/run/ex_02_chinook/models/clean/stg_chinook__artist.sql
[0m08:16:24.825654 [info ] [MainThread]: 
[0m08:16:24.826506 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=2 TOTAL=4
[0m08:16:24.828071 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 8.303202, "process_in_blocks": "6024", "process_kernel_time": 0.663966, "process_mem_max_rss": "114932", "process_out_blocks": "10536", "process_user_time": 6.875945}
[0m08:16:24.829117 [debug] [MainThread]: Command `dbt build` failed at 08:16:24.828903 after 8.30 seconds
[0m08:16:24.829810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7090a69ab310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7090a2834100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7090a5f53fd0>]}
[0m08:16:24.830395 [debug] [MainThread]: Flushing usage events
[0m08:19:17.613903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7def4f428310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7def4c087b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7def4c087a00>]}


============================== 08:19:17.673658 | 8c4bdebb-67b8-46b6-8115-8773f345dd57 ==============================
[0m08:19:17.673658 [info ] [MainThread]: Running with dbt=1.8.9
[0m08:19:17.674815 [debug] [MainThread]: running dbt with arguments {'empty': 'False', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'write_json': 'True', 'profiles_dir': '.', 'version_check': 'True', 'partial_parse': 'True', 'log_path': '/workdir/transforms/02_chinook/logs', 'log_format': 'default', 'static_parser': 'True', 'fail_fast': 'False', 'invocation_command': 'dbt build --profiles-dir . --target local', 'no_print': 'None', 'warn_error': 'None', 'quiet': 'False', 'introspect': 'True', 'log_cache_events': 'False', 'printer_width': '80', 'use_colors': 'True'}
[0m08:19:18.204478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8c4bdebb-67b8-46b6-8115-8773f345dd57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7def4f62a160>]}
[0m08:19:18.397593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8c4bdebb-67b8-46b6-8115-8773f345dd57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7def4c0788e0>]}
[0m08:19:18.398815 [info ] [MainThread]: Registered adapter: clickhouse=1.8.6
[0m08:19:18.877796 [debug] [MainThread]: checksum: 134c0f7b96382cc6938697739bc32fb1adc530b177e30f60cebddf61dbd7e979, vars: {}, profile: , target: local, version: 1.8.9
[0m08:19:19.294009 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m08:19:19.294981 [debug] [MainThread]: Partial parsing: updated file: ex_02_chinook://models/clean/stg_chinook__artist.sql
[0m08:19:19.295653 [debug] [MainThread]: Partial parsing: updated file: ex_02_chinook://models/clean/stg_chinook__album.sql
[0m08:19:20.170846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8c4bdebb-67b8-46b6-8115-8773f345dd57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7def4b458130>]}
[0m08:19:20.526413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8c4bdebb-67b8-46b6-8115-8773f345dd57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7def4b27d0a0>]}
[0m08:19:20.527278 [info ] [MainThread]: Found 4 models, 2 sources, 471 macros
[0m08:19:20.530252 [info ] [MainThread]: 
[0m08:19:20.531431 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m08:19:20.578367 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m08:19:20.590124 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m08:19:20.682830 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:19:20.681822 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:19:21.357610 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m08:19:21.375724 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m08:19:21.379754 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m08:19:21.384022 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m08:19:21.618177 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__mart)
[0m08:19:21.624581 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__clean)
[0m08:19:21.683940 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__mart: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list__mart"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'mart'
      

  ...
[0m08:19:21.689562 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list__clean"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'clean'
      

  ...
[0m08:19:21.698422 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m08:19:21.703874 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m08:19:21.709753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c4bdebb-67b8-46b6-8115-8773f345dd57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7def4e842970>]}
[0m08:19:21.711492 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m08:19:21.712890 [info ] [MainThread]: 
[0m08:19:21.787891 [debug] [Thread-1  ]: Began running node model.ex_02_chinook.stg_chinook__album
[0m08:19:21.788764 [debug] [Thread-2  ]: Began running node model.ex_02_chinook.stg_chinook__artist
[0m08:19:21.789846 [info ] [Thread-1  ]: 1 of 4 START sql view model `clean`.`stg_chinook__album` ....................... [RUN]
[0m08:19:21.790964 [info ] [Thread-2  ]: 2 of 4 START sql view model `clean`.`stg_chinook__artist` ...................... [RUN]
[0m08:19:21.792128 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.ex_02_chinook.stg_chinook__album'
[0m08:19:21.793096 [debug] [Thread-2  ]: Acquiring new clickhouse connection 'model.ex_02_chinook.stg_chinook__artist'
[0m08:19:21.793885 [debug] [Thread-1  ]: Began compiling node model.ex_02_chinook.stg_chinook__album
[0m08:19:21.794648 [debug] [Thread-2  ]: Began compiling node model.ex_02_chinook.stg_chinook__artist
[0m08:19:21.812780 [debug] [Thread-1  ]: Writing injected SQL for node "model.ex_02_chinook.stg_chinook__album"
[0m08:19:21.872382 [debug] [Thread-2  ]: Writing injected SQL for node "model.ex_02_chinook.stg_chinook__artist"
[0m08:19:21.874762 [debug] [Thread-1  ]: Began executing node model.ex_02_chinook.stg_chinook__album
[0m08:19:21.876600 [debug] [Thread-2  ]: Began executing node model.ex_02_chinook.stg_chinook__artist
[0m08:19:22.203849 [debug] [Thread-2  ]: Creating new relation stg_chinook__artist
[0m08:19:22.206353 [debug] [Thread-1  ]: Creating new relation stg_chinook__album
[0m08:19:22.374089 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m08:19:22.379606 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m08:19:22.547804 [debug] [Thread-1  ]: Writing runtime sql for node "model.ex_02_chinook.stg_chinook__album"
[0m08:19:22.571480 [debug] [Thread-2  ]: Writing runtime sql for node "model.ex_02_chinook.stg_chinook__artist"
[0m08:19:22.573197 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_02_chinook.stg_chinook__album: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.stg_chinook__album"} */


  create view `clean`.`stg_chinook__album` 
  
    
    
  as (
    

-- Keep album grain; standardize names/types.
select
  cast(album_id  as Nullable(Int64))      as album_id,
  cast(title     as Nullable(String))     as album_title,
  cast(artist_id as Nullable(Int64))      as artist_id
from `raw`.`albums`
    
  )
      
      
                    -- end_of_sql
                    
                    ...
[0m08:19:22.577101 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_02_chinook.stg_chinook__artist: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.stg_chinook__artist"} */


  create view `clean`.`stg_chinook__artist` 
  
    
    
  as (
    

-- Standardize column names/types per table; no business logic.
select
  cast(artist_id as Nullable(Int64))      as artist_id,
  cast(name      as Nullable(String))     as artist_name
from `raw`.`artists`
    
  )
      
      
                    -- end_of_sql
                    
                    ...
[0m08:19:22.581635 [debug] [Thread-1  ]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.stg_chinook__album"} */


  create view `clean`.`stg_chinook__album` 
  
    
    
  as (
    

-- Keep album grain; standardize names/types.
select
  cast(album_id  as Nullable(Int64))      as album_id,
  cast(title     as Nullable(String))     as album_title,
  cast(artist_id as Nullable(Int64))      as artist_id
from `raw`.`albums`
    
  )
      
      
                    -- end_of_sql
                    
                    
[0m08:19:22.585706 [debug] [Thread-2  ]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.stg_chinook__artist"} */


  create view `clean`.`stg_chinook__artist` 
  
    
    
  as (
    

-- Standardize column names/types per table; no business logic.
select
  cast(artist_id as Nullable(Int64))      as artist_id,
  cast(name      as Nullable(String))     as artist_name
from `raw`.`artists`
    
  )
      
      
                    -- end_of_sql
                    
                    
[0m08:19:22.595861 [debug] [Thread-2  ]: Database Error in model stg_chinook__artist (models/clean/stg_chinook__artist.sql)
  HTTPDriver for http://clickhouse:8123 received ClickHouse error code 60
   Code: 60. DB::Exception: Table raw.artists does not exist. (UNKNOWN_TABLE) (version 23.12.6.19 (official build))
  compiled code at target/run/ex_02_chinook/models/clean/stg_chinook__artist.sql
[0m08:19:22.597171 [debug] [Thread-1  ]: Database Error in model stg_chinook__album (models/clean/stg_chinook__album.sql)
  HTTPDriver for http://clickhouse:8123 received ClickHouse error code 60
   Code: 60. DB::Exception: Table raw.albums does not exist. (UNKNOWN_TABLE) (version 23.12.6.19 (official build))
  compiled code at target/run/ex_02_chinook/models/clean/stg_chinook__album.sql
[0m08:19:22.600523 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c4bdebb-67b8-46b6-8115-8773f345dd57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7def4c140550>]}
[0m08:19:22.601424 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c4bdebb-67b8-46b6-8115-8773f345dd57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7def4b82ae20>]}
[0m08:19:22.602824 [error] [Thread-2  ]: 2 of 4 ERROR creating sql view model `clean`.`stg_chinook__artist` ............. [[31mERROR[0m in 0.81s]
[0m08:19:22.604166 [error] [Thread-1  ]: 1 of 4 ERROR creating sql view model `clean`.`stg_chinook__album` .............. [[31mERROR[0m in 0.81s]
[0m08:19:22.605662 [debug] [Thread-2  ]: Finished running node model.ex_02_chinook.stg_chinook__artist
[0m08:19:22.607050 [debug] [Thread-1  ]: Finished running node model.ex_02_chinook.stg_chinook__album
[0m08:19:22.608443 [debug] [Thread-4  ]: Began running node model.ex_02_chinook.dim_artist
[0m08:19:22.609445 [debug] [Thread-2  ]: Began running node model.ex_02_chinook.dim_album
[0m08:19:22.610411 [info ] [Thread-4  ]: 3 of 4 SKIP relation mart.dim_artist ........................................... [[33mSKIP[0m]
[0m08:19:22.611459 [info ] [Thread-2  ]: 4 of 4 SKIP relation mart.dim_album ............................................ [[33mSKIP[0m]
[0m08:19:22.612578 [debug] [Thread-4  ]: Finished running node model.ex_02_chinook.dim_artist
[0m08:19:22.613736 [debug] [Thread-2  ]: Finished running node model.ex_02_chinook.dim_album
[0m08:19:22.616107 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:19:22.670286 [debug] [MainThread]: Connection 'list__mart' was left open.
[0m08:19:22.671608 [debug] [MainThread]: On list__mart: Close
[0m08:19:22.672673 [debug] [MainThread]: Connection 'list__clean' was left open.
[0m08:19:22.673820 [debug] [MainThread]: On list__clean: Close
[0m08:19:22.674868 [debug] [MainThread]: Connection 'model.ex_02_chinook.stg_chinook__album' was left open.
[0m08:19:22.675944 [debug] [MainThread]: On model.ex_02_chinook.stg_chinook__album: Close
[0m08:19:22.676987 [debug] [MainThread]: Connection 'model.ex_02_chinook.stg_chinook__artist' was left open.
[0m08:19:22.678103 [debug] [MainThread]: On model.ex_02_chinook.stg_chinook__artist: Close
[0m08:19:22.680196 [info ] [MainThread]: 
[0m08:19:22.681584 [info ] [MainThread]: Finished running 2 view models, 2 table models in 0 hours 0 minutes and 2.15 seconds (2.15s).
[0m08:19:22.685633 [debug] [MainThread]: Command end result
[0m08:19:22.890051 [info ] [MainThread]: 
[0m08:19:22.890909 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m08:19:22.891488 [info ] [MainThread]: 
[0m08:19:22.892299 [error] [MainThread]:   Database Error in model stg_chinook__artist (models/clean/stg_chinook__artist.sql)
  HTTPDriver for http://clickhouse:8123 received ClickHouse error code 60
   Code: 60. DB::Exception: Table raw.artists does not exist. (UNKNOWN_TABLE) (version 23.12.6.19 (official build))
  compiled code at target/run/ex_02_chinook/models/clean/stg_chinook__artist.sql
[0m08:19:22.892913 [info ] [MainThread]: 
[0m08:19:22.893672 [error] [MainThread]:   Database Error in model stg_chinook__album (models/clean/stg_chinook__album.sql)
  HTTPDriver for http://clickhouse:8123 received ClickHouse error code 60
   Code: 60. DB::Exception: Table raw.albums does not exist. (UNKNOWN_TABLE) (version 23.12.6.19 (official build))
  compiled code at target/run/ex_02_chinook/models/clean/stg_chinook__album.sql
[0m08:19:22.894285 [info ] [MainThread]: 
[0m08:19:22.894915 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=2 TOTAL=4
[0m08:19:22.896186 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 5.477993, "process_in_blocks": "0", "process_kernel_time": 0.673751, "process_mem_max_rss": "113764", "process_out_blocks": "10528", "process_user_time": 5.503464}
[0m08:19:22.896924 [debug] [MainThread]: Command `dbt build` failed at 08:19:22.896735 after 5.48 seconds
[0m08:19:22.897572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7def4f428310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7def4a5edb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7def4a5ed070>]}
[0m08:19:22.898169 [debug] [MainThread]: Flushing usage events
[0m08:20:40.300161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c00e2f4310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c00af54a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c00af54940>]}


============================== 08:20:40.309940 | ca3928e3-8b26-4980-8ffd-f2756d224eb2 ==============================
[0m08:20:40.309940 [info ] [MainThread]: Running with dbt=1.8.9
[0m08:20:40.311269 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'warn_error': 'None', 'profiles_dir': '.', 'use_experimental_parser': 'False', 'use_colors': 'True', 'write_json': 'True', 'log_format': 'default', 'version_check': 'True', 'indirect_selection': 'eager', 'empty': 'False', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_cache_events': 'False', 'quiet': 'False', 'debug': 'False', 'invocation_command': 'dbt build --profiles-dir . --target local', 'partial_parse': 'True', 'target_path': 'None', 'log_path': '/workdir/transforms/02_chinook/logs', 'no_print': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'static_parser': 'True'}
[0m08:20:40.891663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ca3928e3-8b26-4980-8ffd-f2756d224eb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c00af311f0>]}
[0m08:20:41.085867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ca3928e3-8b26-4980-8ffd-f2756d224eb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c00b052d00>]}
[0m08:20:41.087119 [info ] [MainThread]: Registered adapter: clickhouse=1.8.6
[0m08:20:41.502856 [debug] [MainThread]: checksum: 134c0f7b96382cc6938697739bc32fb1adc530b177e30f60cebddf61dbd7e979, vars: {}, profile: , target: local, version: 1.8.9
[0m08:20:41.972868 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m08:20:41.974362 [debug] [MainThread]: Partial parsing: updated file: ex_02_chinook://models/sources.yml
[0m08:20:41.974964 [debug] [MainThread]: Partial parsing: updated file: ex_02_chinook://models/clean/stg_chinook__artist.sql
[0m08:20:41.975523 [debug] [MainThread]: Partial parsing: updated file: ex_02_chinook://models/clean/stg_chinook__album.sql
[0m08:20:43.096278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ca3928e3-8b26-4980-8ffd-f2756d224eb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c00a01cee0>]}
[0m08:20:43.491702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ca3928e3-8b26-4980-8ffd-f2756d224eb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c009f18220>]}
[0m08:20:43.492543 [info ] [MainThread]: Found 4 models, 2 sources, 471 macros
[0m08:20:43.495455 [info ] [MainThread]: 
[0m08:20:43.496522 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m08:20:43.509564 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m08:20:43.510757 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m08:20:43.586583 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:20:43.588045 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:20:44.239470 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m08:20:44.244323 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m08:20:44.245862 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m08:20:44.249381 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:20:44.288974 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__clean)
[0m08:20:44.290020 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__mart)
[0m08:20:44.301653 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list__clean"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'clean'
      

  ...
[0m08:20:44.306180 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__mart: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list__mart"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'mart'
      

  ...
[0m08:20:44.312351 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m08:20:44.315750 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m08:20:44.320164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca3928e3-8b26-4980-8ffd-f2756d224eb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c009b1f130>]}
[0m08:20:44.371669 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m08:20:44.373138 [info ] [MainThread]: 
[0m08:20:44.400074 [debug] [Thread-1  ]: Began running node model.ex_02_chinook.stg_chinook__album
[0m08:20:44.400982 [debug] [Thread-2  ]: Began running node model.ex_02_chinook.stg_chinook__artist
[0m08:20:44.402006 [info ] [Thread-1  ]: 1 of 4 START sql view model `clean`.`stg_chinook__album` ....................... [RUN]
[0m08:20:44.403070 [info ] [Thread-2  ]: 2 of 4 START sql view model `clean`.`stg_chinook__artist` ...................... [RUN]
[0m08:20:44.404009 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list__clean, now model.ex_02_chinook.stg_chinook__album)
[0m08:20:44.405038 [debug] [Thread-2  ]: Acquiring new clickhouse connection 'model.ex_02_chinook.stg_chinook__artist'
[0m08:20:44.405809 [debug] [Thread-1  ]: Began compiling node model.ex_02_chinook.stg_chinook__album
[0m08:20:44.406684 [debug] [Thread-2  ]: Began compiling node model.ex_02_chinook.stg_chinook__artist
[0m08:20:44.474089 [debug] [Thread-1  ]: Writing injected SQL for node "model.ex_02_chinook.stg_chinook__album"
[0m08:20:44.486579 [debug] [Thread-2  ]: Writing injected SQL for node "model.ex_02_chinook.stg_chinook__artist"
[0m08:20:44.488377 [debug] [Thread-1  ]: Began executing node model.ex_02_chinook.stg_chinook__album
[0m08:20:44.510160 [debug] [Thread-2  ]: Began executing node model.ex_02_chinook.stg_chinook__artist
[0m08:20:44.609845 [debug] [Thread-1  ]: Creating new relation stg_chinook__album
[0m08:20:44.619888 [debug] [Thread-2  ]: Creating new relation stg_chinook__artist
[0m08:20:44.776702 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m08:20:44.775373 [debug] [Thread-1  ]: Writing runtime sql for node "model.ex_02_chinook.stg_chinook__album"
[0m08:20:44.781578 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_02_chinook.stg_chinook__album: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.stg_chinook__album"} */


  create view `clean`.`stg_chinook__album` 
  
    
    
  as (
    

-- Keep album grain; standardize names/types.
select
  cast(album_id  as Nullable(Int64))      as album_id,
  cast(title     as Nullable(String))     as album_title,
  cast(artist_id as Nullable(Int64))      as artist_id
from `raw`.`chinook___albums`
    
  )
      
      
                    -- end_of_sql
                    
                    ...
[0m08:20:44.806984 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m08:20:44.988754 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca3928e3-8b26-4980-8ffd-f2756d224eb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c00d8a1520>]}
[0m08:20:44.993420 [info ] [Thread-1  ]: 1 of 4 OK created sql view model `clean`.`stg_chinook__album` .................. [[32mOK[0m in 0.58s]
[0m08:20:44.995895 [debug] [Thread-1  ]: Finished running node model.ex_02_chinook.stg_chinook__album
[0m08:20:45.031615 [debug] [Thread-2  ]: Writing runtime sql for node "model.ex_02_chinook.stg_chinook__artist"
[0m08:20:45.033472 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_02_chinook.stg_chinook__artist: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.stg_chinook__artist"} */


  create view `clean`.`stg_chinook__artist` 
  
    
    
  as (
    

-- Standardize column names/types per table; no business logic.
select
  cast(artist_id as Nullable(Int64))      as artist_id,
  cast(name      as Nullable(String))     as artist_name
from `raw`.`chinook___artists`
    
  )
      
      
                    -- end_of_sql
                    
                    ...
[0m08:20:45.044272 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m08:20:45.048808 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca3928e3-8b26-4980-8ffd-f2756d224eb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c009ba17c0>]}
[0m08:20:45.050842 [info ] [Thread-2  ]: 2 of 4 OK created sql view model `clean`.`stg_chinook__artist` ................. [[32mOK[0m in 0.64s]
[0m08:20:45.052970 [debug] [Thread-2  ]: Finished running node model.ex_02_chinook.stg_chinook__artist
[0m08:20:45.073006 [debug] [Thread-4  ]: Began running node model.ex_02_chinook.dim_album
[0m08:20:45.075013 [debug] [Thread-3  ]: Began running node model.ex_02_chinook.dim_artist
[0m08:20:45.077652 [info ] [Thread-4  ]: 3 of 4 START sql table model `mart`.`dim_album` ................................ [RUN]
[0m08:20:45.080652 [info ] [Thread-3  ]: 4 of 4 START sql table model `mart`.`dim_artist` ............................... [RUN]
[0m08:20:45.083585 [debug] [Thread-4  ]: Acquiring new clickhouse connection 'model.ex_02_chinook.dim_album'
[0m08:20:45.086025 [debug] [Thread-3  ]: Acquiring new clickhouse connection 'model.ex_02_chinook.dim_artist'
[0m08:20:45.087841 [debug] [Thread-4  ]: Began compiling node model.ex_02_chinook.dim_album
[0m08:20:45.089661 [debug] [Thread-3  ]: Began compiling node model.ex_02_chinook.dim_artist
[0m08:20:45.109191 [debug] [Thread-4  ]: Writing injected SQL for node "model.ex_02_chinook.dim_album"
[0m08:20:45.116625 [debug] [Thread-3  ]: Writing injected SQL for node "model.ex_02_chinook.dim_artist"
[0m08:20:45.119019 [debug] [Thread-3  ]: Began executing node model.ex_02_chinook.dim_artist
[0m08:20:45.171312 [debug] [Thread-4  ]: Began executing node model.ex_02_chinook.dim_album
[0m08:20:45.312238 [debug] [Thread-3  ]: Creating new relation dim_artist
[0m08:20:45.390231 [debug] [Thread-4  ]: Creating new relation dim_album
[0m08:20:45.781614 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m08:20:45.783578 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m08:20:45.971749 [debug] [Thread-4  ]: dbt_clickhouse adapter: On model.ex_02_chinook.dim_album: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.dim_album"} */

            

    
        create table `mart`.`dim_album`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

-- Album dimension, denormalized with artist_name (common convenience).
with album as (
  select * from `clean`.`stg_chinook__album`
),
artist as (
  select * from `clean`.`stg_chinook__artist`
)
select
  a.album_id,
  a.album_title,
  a.artist_id,
  ar.artist_name
from album a
left join artist ar
  on ar.artist_id = a.artist_id
          )
        
        ...
[0m08:20:45.980550 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_02_chinook.dim_artist: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.dim_artist"} */

            

    
        create table `mart`.`dim_artist`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

-- Simple conformed dimension for artists.
select
  artist_id,
  artist_name
from `clean`.`stg_chinook__artist`
          )
        
        ...
[0m08:20:46.002438 [debug] [Thread-4  ]: dbt_clickhouse adapter: SQL status: OK in 0.03 seconds
[0m08:20:46.016636 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.03 seconds
[0m08:20:46.026945 [debug] [Thread-4  ]: dbt_clickhouse adapter: On model.ex_02_chinook.dim_album: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.dim_album"} */

    select name, type from system.columns where table = 'dim_album'
    
      and database = 'mart'
    
    order by position
  ...
[0m08:20:46.030458 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_02_chinook.dim_artist: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.dim_artist"} */

    select name, type from system.columns where table = 'dim_artist'
    
      and database = 'mart'
    
    order by position
  ...
[0m08:20:46.037405 [debug] [Thread-4  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m08:20:46.073191 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m08:20:46.085919 [debug] [Thread-4  ]: Writing runtime sql for node "model.ex_02_chinook.dim_album"
[0m08:20:46.091066 [debug] [Thread-3  ]: Writing runtime sql for node "model.ex_02_chinook.dim_artist"
[0m08:20:46.094010 [debug] [Thread-4  ]: dbt_clickhouse adapter: On model.ex_02_chinook.dim_album: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.dim_album"} */

  
    
    
    
        
         


        insert into `mart`.`dim_album`
        ("album_id", "album_title", "artist_id", "artist_name")

-- Album dimension, denormalized with artist_name (common convenience).
with album as (
  select * from `clean`.`stg_chinook__album`
),
artist as (
  select * from `clean`.`stg_chinook__artist`
)
select
  a.album_id,
  a.album_title,
  a.artist_id,
  ar.artist_name
from album a
left join artist ar
  on ar.artist_id = a.artist_id
  ...
[0m08:20:46.096223 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_02_chinook.dim_artist: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.dim_artist"} */

  
    
    
    
        
         


        insert into `mart`.`dim_artist`
        ("artist_id", "artist_name")

-- Simple conformed dimension for artists.
select
  artist_id,
  artist_name
from `clean`.`stg_chinook__artist`
  ...
[0m08:20:46.107633 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m08:20:46.115448 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca3928e3-8b26-4980-8ffd-f2756d224eb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c00ac3bd90>]}
[0m08:20:46.117992 [debug] [Thread-4  ]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m08:20:46.120417 [info ] [Thread-3  ]: 4 of 4 OK created sql table model `mart`.`dim_artist` .......................... [[32mOK[0m in 1.03s]
[0m08:20:46.174041 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca3928e3-8b26-4980-8ffd-f2756d224eb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c009ba66a0>]}
[0m08:20:46.176895 [debug] [Thread-3  ]: Finished running node model.ex_02_chinook.dim_artist
[0m08:20:46.179987 [info ] [Thread-4  ]: 3 of 4 OK created sql table model `mart`.`dim_album` ........................... [[32mOK[0m in 1.09s]
[0m08:20:46.183405 [debug] [Thread-4  ]: Finished running node model.ex_02_chinook.dim_album
[0m08:20:46.187441 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:20:46.188674 [debug] [MainThread]: Connection 'model.ex_02_chinook.stg_chinook__album' was left open.
[0m08:20:46.190007 [debug] [MainThread]: On model.ex_02_chinook.stg_chinook__album: Close
[0m08:20:46.191091 [debug] [MainThread]: Connection 'list__mart' was left open.
[0m08:20:46.192166 [debug] [MainThread]: On list__mart: Close
[0m08:20:46.193209 [debug] [MainThread]: Connection 'model.ex_02_chinook.stg_chinook__artist' was left open.
[0m08:20:46.194288 [debug] [MainThread]: On model.ex_02_chinook.stg_chinook__artist: Close
[0m08:20:46.195328 [debug] [MainThread]: Connection 'model.ex_02_chinook.dim_album' was left open.
[0m08:20:46.196486 [debug] [MainThread]: On model.ex_02_chinook.dim_album: Close
[0m08:20:46.197686 [debug] [MainThread]: Connection 'model.ex_02_chinook.dim_artist' was left open.
[0m08:20:46.198776 [debug] [MainThread]: On model.ex_02_chinook.dim_artist: Close
[0m08:20:46.200978 [info ] [MainThread]: 
[0m08:20:46.202340 [info ] [MainThread]: Finished running 2 view models, 2 table models in 0 hours 0 minutes and 2.70 seconds (2.70s).
[0m08:20:46.208280 [debug] [MainThread]: Command end result
[0m08:20:46.420286 [info ] [MainThread]: 
[0m08:20:46.472005 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:20:46.473300 [info ] [MainThread]: 
[0m08:20:46.474755 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m08:20:46.477595 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 6.3897505, "process_in_blocks": "0", "process_kernel_time": 0.586422, "process_mem_max_rss": "115652", "process_out_blocks": "10568", "process_user_time": 5.894728}
[0m08:20:46.479436 [debug] [MainThread]: Command `dbt build` succeeded at 08:20:46.478977 after 6.39 seconds
[0m08:20:46.480768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c00e2f4310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c009f18220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c00b880670>]}
[0m08:20:46.482013 [debug] [MainThread]: Flushing usage events
[0m08:29:04.884448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7080a617ef40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7080a2e21a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7080a2e21940>]}


============================== 08:29:04.893949 | 4384ba45-b63c-4062-8002-7b173b60ec7c ==============================
[0m08:29:04.893949 [info ] [MainThread]: Running with dbt=1.8.9
[0m08:29:04.895002 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'static_parser': 'True', 'partial_parse': 'True', 'profiles_dir': '.', 'version_check': 'True', 'empty': 'False', 'target_path': 'None', 'fail_fast': 'False', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build --profiles-dir . --target local', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'debug': 'False', 'introspect': 'True', 'quiet': 'False', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True', 'log_format': 'default', 'warn_error': 'None', 'no_print': 'None', 'log_path': '/workdir/transforms/02_chinook/logs'}
[0m08:29:05.474738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4384ba45-b63c-4062-8002-7b173b60ec7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7080a56d9fd0>]}
[0m08:29:05.667716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4384ba45-b63c-4062-8002-7b173b60ec7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7080a63db400>]}
[0m08:29:05.669033 [info ] [MainThread]: Registered adapter: clickhouse=1.8.6
[0m08:29:06.088998 [debug] [MainThread]: checksum: 134c0f7b96382cc6938697739bc32fb1adc530b177e30f60cebddf61dbd7e979, vars: {}, profile: , target: local, version: 1.8.9
[0m08:29:06.554063 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m08:29:06.554967 [debug] [MainThread]: Partial parsing: added file: ex_02_chinook://models/mart/vw_artist_album_counts.sql
[0m08:29:07.371371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4384ba45-b63c-4062-8002-7b173b60ec7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7080a21cf130>]}
[0m08:29:07.764539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4384ba45-b63c-4062-8002-7b173b60ec7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7080a205d6a0>]}
[0m08:29:07.765382 [info ] [MainThread]: Found 5 models, 2 sources, 471 macros
[0m08:29:07.768386 [info ] [MainThread]: 
[0m08:29:07.769624 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m08:29:07.783911 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m08:29:07.796159 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m08:29:07.870164 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:29:07.882215 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:29:08.511403 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m08:29:08.521000 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m08:29:08.552199 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m08:29:08.564515 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m08:29:08.766254 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__mart)
[0m08:29:08.767306 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__clean)
[0m08:29:08.778619 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__mart: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list__mart"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'mart'
      

  ...
[0m08:29:08.782568 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list__clean"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'clean'
      

  ...
[0m08:29:08.788466 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m08:29:08.791711 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m08:29:08.796711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4384ba45-b63c-4062-8002-7b173b60ec7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7080a1e31430>]}
[0m08:29:08.797632 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m08:29:08.798260 [info ] [MainThread]: 
[0m08:29:08.860547 [debug] [Thread-1  ]: Began running node model.ex_02_chinook.stg_chinook__album
[0m08:29:08.861499 [debug] [Thread-2  ]: Began running node model.ex_02_chinook.stg_chinook__artist
[0m08:29:08.862464 [info ] [Thread-1  ]: 1 of 5 START sql view model `clean`.`stg_chinook__album` ....................... [RUN]
[0m08:29:08.863681 [info ] [Thread-2  ]: 2 of 5 START sql view model `clean`.`stg_chinook__artist` ...................... [RUN]
[0m08:29:08.865198 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.ex_02_chinook.stg_chinook__album'
[0m08:29:08.866478 [debug] [Thread-2  ]: Acquiring new clickhouse connection 'model.ex_02_chinook.stg_chinook__artist'
[0m08:29:08.867530 [debug] [Thread-1  ]: Began compiling node model.ex_02_chinook.stg_chinook__album
[0m08:29:08.868590 [debug] [Thread-2  ]: Began compiling node model.ex_02_chinook.stg_chinook__artist
[0m08:29:08.950326 [debug] [Thread-2  ]: Writing injected SQL for node "model.ex_02_chinook.stg_chinook__artist"
[0m08:29:08.897265 [debug] [Thread-1  ]: Writing injected SQL for node "model.ex_02_chinook.stg_chinook__album"
[0m08:29:08.953417 [debug] [Thread-2  ]: Began executing node model.ex_02_chinook.stg_chinook__artist
[0m08:29:08.954780 [debug] [Thread-1  ]: Began executing node model.ex_02_chinook.stg_chinook__album
[0m08:29:09.368932 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m08:29:09.375131 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m08:29:09.516324 [debug] [Thread-1  ]: Writing runtime sql for node "model.ex_02_chinook.stg_chinook__album"
[0m08:29:09.521274 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_02_chinook.stg_chinook__album: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.stg_chinook__album"} */


  create view `clean`.`stg_chinook__album__dbt_tmp` 
  
    
    
  as (
    

-- Keep album grain; standardize names/types.
select
  cast(album_id  as Nullable(Int64))      as album_id,
  cast(title     as Nullable(String))     as album_title,
  cast(artist_id as Nullable(Int64))      as artist_id
from `raw`.`chinook___albums`
    
  )
      
      
                    -- end_of_sql
                    
                    ...
[0m08:29:09.525436 [debug] [Thread-2  ]: Writing runtime sql for node "model.ex_02_chinook.stg_chinook__artist"
[0m08:29:09.528871 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_02_chinook.stg_chinook__artist: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.stg_chinook__artist"} */


  create view `clean`.`stg_chinook__artist__dbt_tmp` 
  
    
    
  as (
    

-- Standardize column names/types per table; no business logic.
select
  cast(artist_id as Nullable(Int64))      as artist_id,
  cast(name      as Nullable(String))     as artist_name
from `raw`.`chinook___artists`
    
  )
      
      
                    -- end_of_sql
                    
                    ...
[0m08:29:09.549228 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.03 seconds
[0m08:29:09.575867 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m08:29:09.581631 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_02_chinook.stg_chinook__album: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.stg_chinook__album"} */

    drop table if exists `clean`.`stg_chinook__album__dbt_backup` 
  
  ...
[0m08:29:09.596067 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_02_chinook.stg_chinook__artist: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.stg_chinook__artist"} */

    drop table if exists `clean`.`stg_chinook__artist__dbt_backup` 
  
  ...
[0m08:29:09.652306 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m08:29:09.656807 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_02_chinook.stg_chinook__album: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.stg_chinook__album"} */

    rename table `clean`.`stg_chinook__album` to `clean`.`stg_chinook__album__dbt_backup` 
  
  ...
[0m08:29:09.661130 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m08:29:09.665373 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_02_chinook.stg_chinook__artist: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.stg_chinook__artist"} */

    rename table `clean`.`stg_chinook__artist` to `clean`.`stg_chinook__artist__dbt_backup` 
  
  ...
[0m08:29:09.670050 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m08:29:09.673004 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m08:29:09.687710 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_02_chinook.stg_chinook__album: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.stg_chinook__album"} */

    drop table if exists `clean`.`stg_chinook__album` 
  
  ...
[0m08:29:09.753242 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_02_chinook.stg_chinook__artist: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.stg_chinook__artist"} */

    drop table if exists `clean`.`stg_chinook__artist` 
  
  ...
[0m08:29:09.759510 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:29:09.763687 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_02_chinook.stg_chinook__album: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.stg_chinook__album"} */

    rename table `clean`.`stg_chinook__album__dbt_tmp` to `clean`.`stg_chinook__album` 
  
  ...
[0m08:29:09.768317 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m08:29:09.773381 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_02_chinook.stg_chinook__artist: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.stg_chinook__artist"} */

    rename table `clean`.`stg_chinook__artist__dbt_tmp` to `clean`.`stg_chinook__artist` 
  
  ...
[0m08:29:09.776030 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m08:29:09.793783 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m08:29:10.191901 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_02_chinook.stg_chinook__artist: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.stg_chinook__artist"} */

    drop table if exists `clean`.`stg_chinook__artist__dbt_backup` 
  ...
[0m08:29:10.194981 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_02_chinook.stg_chinook__album: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.stg_chinook__album"} */

    drop table if exists `clean`.`stg_chinook__album__dbt_backup` 
  ...
[0m08:29:10.252372 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.06 seconds
[0m08:29:10.265487 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m08:29:10.269481 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4384ba45-b63c-4062-8002-7b173b60ec7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7080a1d18fa0>]}
[0m08:29:10.274239 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4384ba45-b63c-4062-8002-7b173b60ec7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7080a1d18880>]}
[0m08:29:10.276858 [info ] [Thread-2  ]: 2 of 5 OK created sql view model `clean`.`stg_chinook__artist` ................. [[32mOK[0m in 1.40s]
[0m08:29:10.279697 [info ] [Thread-1  ]: 1 of 5 OK created sql view model `clean`.`stg_chinook__album` .................. [[32mOK[0m in 1.41s]
[0m08:29:10.282717 [debug] [Thread-2  ]: Finished running node model.ex_02_chinook.stg_chinook__artist
[0m08:29:10.286087 [debug] [Thread-1  ]: Finished running node model.ex_02_chinook.stg_chinook__album
[0m08:29:10.289381 [debug] [Thread-4  ]: Began running node model.ex_02_chinook.dim_artist
[0m08:29:10.292889 [debug] [Thread-2  ]: Began running node model.ex_02_chinook.dim_album
[0m08:29:10.291621 [info ] [Thread-4  ]: 3 of 5 START sql table model `mart`.`dim_artist` ............................... [RUN]
[0m08:29:10.294748 [debug] [Thread-1  ]: Began running node model.ex_02_chinook.vw_artist_album_counts
[0m08:29:10.296845 [info ] [Thread-2  ]: 4 of 5 START sql table model `mart`.`dim_album` ................................ [RUN]
[0m08:29:10.349723 [debug] [Thread-4  ]: Acquiring new clickhouse connection 'model.ex_02_chinook.dim_artist'
[0m08:29:10.352126 [info ] [Thread-1  ]: 5 of 5 START sql view model `mart`.`vw_artist_album_counts` .................... [RUN]
[0m08:29:10.353973 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.ex_02_chinook.stg_chinook__artist, now model.ex_02_chinook.dim_album)
[0m08:29:10.355660 [debug] [Thread-4  ]: Began compiling node model.ex_02_chinook.dim_artist
[0m08:29:10.357363 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ex_02_chinook.stg_chinook__album, now model.ex_02_chinook.vw_artist_album_counts)
[0m08:29:10.359107 [debug] [Thread-2  ]: Began compiling node model.ex_02_chinook.dim_album
[0m08:29:10.372208 [debug] [Thread-4  ]: Writing injected SQL for node "model.ex_02_chinook.dim_artist"
[0m08:29:10.374072 [debug] [Thread-1  ]: Began compiling node model.ex_02_chinook.vw_artist_album_counts
[0m08:29:10.387749 [debug] [Thread-2  ]: Writing injected SQL for node "model.ex_02_chinook.dim_album"
[0m08:29:10.454093 [debug] [Thread-4  ]: Began executing node model.ex_02_chinook.dim_artist
[0m08:29:10.458263 [debug] [Thread-1  ]: Writing injected SQL for node "model.ex_02_chinook.vw_artist_album_counts"
[0m08:29:10.476086 [debug] [Thread-1  ]: Began executing node model.ex_02_chinook.vw_artist_album_counts
[0m08:29:10.486111 [debug] [Thread-2  ]: Began executing node model.ex_02_chinook.dim_album
[0m08:29:10.551239 [debug] [Thread-1  ]: Creating new relation vw_artist_album_counts
[0m08:29:10.585560 [debug] [Thread-1  ]: Writing runtime sql for node "model.ex_02_chinook.vw_artist_album_counts"
[0m08:29:10.748916 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_02_chinook.vw_artist_album_counts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.vw_artist_album_counts"} */


  create view `mart`.`vw_artist_album_counts` 
  
    
    
  as (
    

with album as (
  select album_id, artist_id
  from `clean`.`stg_chinook__album`
),
artist as (
  select artist_id, artist_name
  from `clean`.`stg_chinook__artist`
)

select
  ar.artist_id,
  ar.artist_name,
  substring(ar.artist_name, 1, 1)             as artist_initial,
  count(a.album_id)                            as album_count,
  case when count(a.album_id) >= 3 then 1 else 0 end as is_prolific -- handy filter in dashboards
from artist ar
left join album a
  on a.artist_id = ar.artist_id
group by
  ar.artist_id,
  ar.artist_name
order by album_count desc, ar.artist_name asc
    
  )
      
      
                    -- end_of_sql
                    
                    ...
[0m08:29:10.854604 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.09 seconds
[0m08:29:10.879815 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4384ba45-b63c-4062-8002-7b173b60ec7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7080a1c356d0>]}
[0m08:29:10.892821 [info ] [Thread-1  ]: 5 of 5 OK created sql view model `mart`.`vw_artist_album_counts` ............... [[32mOK[0m in 0.52s]
[0m08:29:10.959919 [debug] [Thread-1  ]: Finished running node model.ex_02_chinook.vw_artist_album_counts
[0m08:29:11.161858 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m08:29:11.163053 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_02_chinook.dim_album: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.dim_album"} */

            

    
        create table `mart`.`dim_album__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

-- Album dimension, denormalized with artist_name (common convenience).
with album as (
  select * from `clean`.`stg_chinook__album`
),
artist as (
  select * from `clean`.`stg_chinook__artist`
)
select
  a.album_id,
  a.album_title,
  a.artist_id,
  ar.artist_name
from album a
left join artist ar
  on ar.artist_id = a.artist_id
          )
        
        ...
[0m08:29:11.182232 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m08:29:11.254546 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_02_chinook.dim_album: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.dim_album"} */

    select name, type from system.columns where table = 'dim_album__dbt_backup'
    
      and database = 'mart'
    
    order by position
  ...
[0m08:29:11.266164 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m08:29:11.277826 [debug] [Thread-2  ]: Writing runtime sql for node "model.ex_02_chinook.dim_album"
[0m08:29:11.279901 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_02_chinook.dim_album: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.dim_album"} */

  
    
    
    
        
         


        insert into `mart`.`dim_album__dbt_backup`
        ("album_id", "album_title", "artist_id", "artist_name")

-- Album dimension, denormalized with artist_name (common convenience).
with album as (
  select * from `clean`.`stg_chinook__album`
),
artist as (
  select * from `clean`.`stg_chinook__artist`
)
select
  a.album_id,
  a.album_title,
  a.artist_id,
  ar.artist_name
from album a
left join artist ar
  on ar.artist_id = a.artist_id
  ...
[0m08:29:11.296476 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m08:29:11.353461 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_02_chinook.dim_album: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.dim_album"} */
EXCHANGE TABLES `mart`.`dim_album__dbt_backup` AND `mart`.`dim_album` 
  
  ...
[0m08:29:11.359249 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:29:11.370403 [debug] [Thread-2  ]: dbt_clickhouse adapter: On model.ex_02_chinook.dim_album: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.dim_album"} */

    drop table if exists `mart`.`dim_album__dbt_backup` 
  ...
[0m08:29:11.377652 [debug] [Thread-4  ]: dbt_clickhouse adapter: On model.ex_02_chinook.dim_artist: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.dim_artist"} */

            

    
        create table `mart`.`dim_artist__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

-- Simple conformed dimension for artists.
select
  artist_id,
  artist_name
from `clean`.`stg_chinook__artist`
          )
        
        ...
[0m08:29:11.384022 [debug] [Thread-2  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m08:29:11.388177 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4384ba45-b63c-4062-8002-7b173b60ec7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7080a1d13f10>]}
[0m08:29:11.390091 [info ] [Thread-2  ]: 4 of 5 OK created sql table model `mart`.`dim_album` ........................... [[32mOK[0m in 1.03s]
[0m08:29:11.392394 [debug] [Thread-2  ]: Finished running node model.ex_02_chinook.dim_album
[0m08:29:11.396771 [debug] [Thread-4  ]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m08:29:11.456339 [debug] [Thread-4  ]: dbt_clickhouse adapter: On model.ex_02_chinook.dim_artist: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.dim_artist"} */

    select name, type from system.columns where table = 'dim_artist__dbt_backup'
    
      and database = 'mart'
    
    order by position
  ...
[0m08:29:11.465204 [debug] [Thread-4  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m08:29:11.470372 [debug] [Thread-4  ]: Writing runtime sql for node "model.ex_02_chinook.dim_artist"
[0m08:29:11.472610 [debug] [Thread-4  ]: dbt_clickhouse adapter: On model.ex_02_chinook.dim_artist: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.dim_artist"} */

  
    
    
    
        
         


        insert into `mart`.`dim_artist__dbt_backup`
        ("artist_id", "artist_name")

-- Simple conformed dimension for artists.
select
  artist_id,
  artist_name
from `clean`.`stg_chinook__artist`
  ...
[0m08:29:11.481914 [debug] [Thread-4  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m08:29:11.486200 [debug] [Thread-4  ]: dbt_clickhouse adapter: On model.ex_02_chinook.dim_artist: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.dim_artist"} */
EXCHANGE TABLES `mart`.`dim_artist__dbt_backup` AND `mart`.`dim_artist` 
  
  ...
[0m08:29:11.491731 [debug] [Thread-4  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:29:11.505390 [debug] [Thread-4  ]: dbt_clickhouse adapter: On model.ex_02_chinook.dim_artist: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_02_chinook.dim_artist"} */

    drop table if exists `mart`.`dim_artist__dbt_backup` 
  ...
[0m08:29:11.551816 [debug] [Thread-4  ]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m08:29:11.556363 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4384ba45-b63c-4062-8002-7b173b60ec7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7080a1d1e3d0>]}
[0m08:29:11.558389 [info ] [Thread-4  ]: 3 of 5 OK created sql table model `mart`.`dim_artist` .......................... [[32mOK[0m in 1.21s]
[0m08:29:11.560828 [debug] [Thread-4  ]: Finished running node model.ex_02_chinook.dim_artist
[0m08:29:11.564671 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:29:11.565761 [debug] [MainThread]: Connection 'list__mart' was left open.
[0m08:29:11.566928 [debug] [MainThread]: On list__mart: Close
[0m08:29:11.567997 [debug] [MainThread]: Connection 'list__clean' was left open.
[0m08:29:11.569092 [debug] [MainThread]: On list__clean: Close
[0m08:29:11.570168 [debug] [MainThread]: Connection 'model.ex_02_chinook.vw_artist_album_counts' was left open.
[0m08:29:11.571280 [debug] [MainThread]: On model.ex_02_chinook.vw_artist_album_counts: Close
[0m08:29:11.572339 [debug] [MainThread]: Connection 'model.ex_02_chinook.dim_album' was left open.
[0m08:29:11.573438 [debug] [MainThread]: On model.ex_02_chinook.dim_album: Close
[0m08:29:11.574477 [debug] [MainThread]: Connection 'model.ex_02_chinook.dim_artist' was left open.
[0m08:29:11.575597 [debug] [MainThread]: On model.ex_02_chinook.dim_artist: Close
[0m08:29:11.577708 [info ] [MainThread]: 
[0m08:29:11.579081 [info ] [MainThread]: Finished running 3 view models, 2 table models in 0 hours 0 minutes and 3.81 seconds (3.81s).
[0m08:29:11.585423 [debug] [MainThread]: Command end result
[0m08:29:11.865823 [info ] [MainThread]: 
[0m08:29:11.867586 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:29:11.869096 [info ] [MainThread]: 
[0m08:29:11.870767 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m08:29:11.873679 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 7.1826053, "process_in_blocks": "0", "process_kernel_time": 0.659697, "process_mem_max_rss": "114800", "process_out_blocks": "10624", "process_user_time": 6.298559}
[0m08:29:11.875446 [debug] [MainThread]: Command `dbt build` succeeded at 08:29:11.874943 after 7.18 seconds
[0m08:29:11.876819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7080a617ef40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7080a1ceb7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7080a40e3580>]}
[0m08:29:11.877962 [debug] [MainThread]: Flushing usage events
