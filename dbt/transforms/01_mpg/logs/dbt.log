[0m13:33:11.496838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1a81040f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1a7dcf6610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1a7dcf65e0>]}


============================== 13:33:11.549650 | a4c7733f-64d5-425d-b801-a80e231a97c7 ==============================
[0m13:33:11.549650 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:33:11.550839 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'printer_width': '80', 'target_path': 'None', 'empty': 'False', 'partial_parse': 'True', 'log_cache_events': 'False', 'invocation_command': 'dbt build --profiles-dir .', 'no_print': 'None', 'static_parser': 'True', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'log_path': '/workdir/transforms/01_mpg/logs', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'use_colors': 'True', 'cache_selected_only': 'False', 'version_check': 'True', 'log_format': 'default', 'introspect': 'True', 'write_json': 'True', 'profiles_dir': '.', 'debug': 'False', 'fail_fast': 'False', 'quiet': 'False'}
[0m13:33:11.555524 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'clickhouse_ftw'
[0m13:33:11.558261 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.21043192, "process_in_blocks": "69272", "process_kernel_time": 0.616665, "process_mem_max_rss": "90116", "process_out_blocks": "6600", "process_user_time": 3.24493}
[0m13:33:11.559311 [debug] [MainThread]: Command `dbt build` failed at 13:33:11.559050 after 0.21 seconds
[0m13:33:11.559985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1a81040f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1a7e1386d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e1a7dda6b50>]}
[0m13:33:11.560602 [debug] [MainThread]: Flushing usage events
[0m13:38:53.969457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd827a73430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd824854610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd824854760>]}


============================== 13:38:54.030621 | 108503a8-91fc-4f48-bfaa-d65aa9d29597 ==============================
[0m13:38:54.030621 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:38:54.031812 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'target_path': 'None', 'log_path': '/workdir/transforms/01_mpg/logs', 'profiles_dir': '.', 'no_print': 'None', 'log_cache_events': 'False', 'log_format': 'default', 'version_check': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'empty': 'False', 'invocation_command': 'dbt build --profiles-dir .', 'partial_parse': 'True', 'debug': 'False', 'quiet': 'False', 'write_json': 'True', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'static_parser': 'True'}
[0m13:38:54.036700 [error] [MainThread]: Encountered an error:
Runtime Error
  The profile 'clickhouse_ftw' does not have a target named 'local'. The valid target names for this profile are:
   - default
[0m13:38:54.038555 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.2641497, "process_in_blocks": "0", "process_kernel_time": 0.419579, "process_mem_max_rss": "90508", "process_out_blocks": "6592", "process_user_time": 3.079913}
[0m13:38:54.039637 [debug] [MainThread]: Command `dbt build` failed at 13:38:54.039394 after 0.27 seconds
[0m13:38:54.040302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd827a73430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd82492c9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd82492cc40>]}
[0m13:38:54.040923 [debug] [MainThread]: Flushing usage events
[0m13:39:47.944821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747853433310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747850094ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747850094970>]}


============================== 13:39:47.953921 | b2275fa3-9c95-41b4-abd3-54a53878eea5 ==============================
[0m13:39:47.953921 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:39:47.955046 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'empty': 'False', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'partial_parse': 'True', 'log_path': '/workdir/transforms/01_mpg/logs', 'debug': 'False', 'write_json': 'True', 'invocation_command': 'dbt build --profiles-dir .', 'use_colors': 'True', 'target_path': 'None', 'profiles_dir': '.', 'printer_width': '80', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_format': 'default', 'log_cache_events': 'False', 'fail_fast': 'False', 'introspect': 'True'}
[0m13:39:47.959729 [error] [MainThread]: Encountered an error:
Runtime Error
  The profile 'clickhouse_ftw' does not have a target named 'local'. The valid target names for this profile are:
   - default
[0m13:39:47.961173 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.20792367, "process_in_blocks": "0", "process_kernel_time": 0.469234, "process_mem_max_rss": "90452", "process_out_blocks": "6592", "process_user_time": 3.105227}
[0m13:39:47.962177 [debug] [MainThread]: Command `dbt build` failed at 13:39:47.961961 after 0.21 seconds
[0m13:39:47.962828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747853433310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7478500f7100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7478500f73a0>]}
[0m13:39:47.963404 [debug] [MainThread]: Flushing usage events
[0m13:40:52.203528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a4a14e2310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a49e1564f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a49e156640>]}


============================== 13:40:52.212859 | 0be9a68d-fe76-4c4c-af1b-c30303b9ad1a ==============================
[0m13:40:52.212859 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:40:52.214033 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt build --profiles-dir .', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'debug': 'False', 'use_colors': 'True', 'fail_fast': 'False', 'warn_error': 'None', 'version_check': 'True', 'indirect_selection': 'eager', 'log_path': '/workdir/transforms/01_mpg/logs', 'log_cache_events': 'False', 'static_parser': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'no_print': 'None', 'write_json': 'True', 'profiles_dir': '.', 'quiet': 'False', 'empty': 'False', 'use_experimental_parser': 'False', 'target_path': 'None'}
[0m13:40:52.218674 [error] [MainThread]: Encountered an error:
Runtime Error
  The profile 'clickhouse_ftw' does not have a target named 'local'. The valid target names for this profile are:
   - default
[0m13:40:52.220206 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.20925443, "process_in_blocks": "0", "process_kernel_time": 0.455506, "process_mem_max_rss": "90652", "process_out_blocks": "6600", "process_user_time": 3.069458}
[0m13:40:52.221236 [debug] [MainThread]: Command `dbt build` failed at 13:40:52.221028 after 0.21 seconds
[0m13:40:52.221937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a4a14e2310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a4a34d14c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70a49e20a6a0>]}
[0m13:40:52.222522 [debug] [MainThread]: Flushing usage events
[0m13:49:05.081504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x782879785f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78287642aa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78287642a940>]}


============================== 13:49:05.090773 | 7075433c-ca52-4abc-a332-6ad5e3f145b5 ==============================
[0m13:49:05.090773 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:49:05.091934 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'log_path': '/workdir/transforms/01_mpg/logs', 'debug': 'False', 'profiles_dir': '.', 'printer_width': '80', 'invocation_command': 'dbt build --profiles-dir .', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'empty': 'False', 'no_print': 'None', 'warn_error': 'None', 'log_cache_events': 'False', 'static_parser': 'True', 'write_json': 'True', 'log_format': 'default', 'indirect_selection': 'eager', 'partial_parse': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'quiet': 'False', 'fail_fast': 'False', 'use_colors': 'True'}
[0m13:49:05.096596 [error] [MainThread]: Encountered an error:
Runtime Error
  The profile 'clickhouse_ftw' does not have a target named 'local'. The valid target names for this profile are:
   - default
[0m13:49:05.098164 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.20678261, "process_in_blocks": "0", "process_kernel_time": 0.436945, "process_mem_max_rss": "90400", "process_out_blocks": "6592", "process_user_time": 3.07358}
[0m13:49:05.099085 [debug] [MainThread]: Command `dbt build` failed at 13:49:05.098869 after 0.21 seconds
[0m13:49:05.099742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x782879785f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7828776e2af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78287688c3d0>]}
[0m13:49:05.100333 [debug] [MainThread]: Flushing usage events
[0m13:56:21.648058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7935b6bbe310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7935b381eb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7935b381e9d0>]}


============================== 13:56:21.657287 | 25ad8516-ac49-40ca-9986-ef3bdd6f6048 ==============================
[0m13:56:21.657287 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:56:21.658414 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'fail_fast': 'False', 'empty': 'False', 'no_print': 'None', 'profiles_dir': '.', 'partial_parse': 'True', 'log_cache_events': 'False', 'static_parser': 'True', 'indirect_selection': 'eager', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'use_colors': 'True', 'invocation_command': 'dbt build --profiles-dir .', 'printer_width': '80', 'quiet': 'False', 'log_path': '/workdir/transforms/01_mpg/logs', 'use_experimental_parser': 'False', 'introspect': 'True', 'target_path': 'None', 'debug': 'False', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'log_format': 'default'}
[0m13:56:21.663653 [error] [MainThread]: Encountered an error:
Runtime Error
  The profile 'clickhouse_ftw' does not have a target named 'local'. The valid target names for this profile are:
   - default
[0m13:56:21.665195 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.20876543, "process_in_blocks": "0", "process_kernel_time": 0.412855, "process_mem_max_rss": "90576", "process_out_blocks": "6600", "process_user_time": 3.105914}
[0m13:56:21.665988 [debug] [MainThread]: Command `dbt build` failed at 13:56:21.665779 after 0.21 seconds
[0m13:56:21.666623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7935b6bbe310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7935b8f79070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7935b6e43a00>]}
[0m13:56:21.667228 [debug] [MainThread]: Flushing usage events
[0m13:59:17.978509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5fdc249310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5fd8ea9490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5fd8ea95e0>]}


============================== 13:59:17.987710 | 7e66556e-9b99-4d45-a9d1-6acb4c970857 ==============================
[0m13:59:17.987710 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:59:17.988967 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'fail_fast': 'False', 'quiet': 'False', 'debug': 'False', 'static_parser': 'True', 'target_path': 'None', 'printer_width': '80', 'log_path': '/workdir/transforms/01_mpg/logs', 'profiles_dir': '.', 'indirect_selection': 'eager', 'use_colors': 'True', 'invocation_command': 'dbt build --profiles-dir .', 'introspect': 'True', 'no_print': 'None', 'log_format': 'default', 'write_json': 'True', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'warn_error': 'None'}
[0m13:59:17.994559 [error] [MainThread]: Encountered an error:
Runtime Error
  The profile 'clickhouse_ftw' does not have a target named 'local'. The valid target names for this profile are:
   - default
[0m13:59:17.996180 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.21011144, "process_in_blocks": "0", "process_kernel_time": 0.436567, "process_mem_max_rss": "90140", "process_out_blocks": "6592", "process_user_time": 3.019341}
[0m13:59:17.996984 [debug] [MainThread]: Command `dbt build` failed at 13:59:17.996773 after 0.21 seconds
[0m13:59:17.997624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5fdc249310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5fd92eb730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5fd8f5d880>]}
[0m13:59:17.998233 [debug] [MainThread]: Flushing usage events
[0m14:13:18.746364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afd87f02310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afd84b76460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afd84b765b0>]}


============================== 14:13:18.805966 | bdd51c1e-c348-4ca7-9eef-32ef1719bf9e ==============================
[0m14:13:18.805966 [info ] [MainThread]: Running with dbt=1.8.9
[0m14:13:18.807076 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt build --profiles-dir .', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'version_check': 'True', 'no_print': 'None', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'static_parser': 'True', 'profiles_dir': '.', 'target_path': 'None', 'log_path': '/workdir/transforms/01_mpg/logs', 'write_json': 'True', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'warn_error': 'None', 'introspect': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'empty': 'False', 'quiet': 'False', 'printer_width': '80', 'fail_fast': 'False'}
[0m14:13:19.351234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bdd51c1e-c348-4ca7-9eef-32ef1719bf9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afd84a55520>]}
[0m14:13:19.538233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bdd51c1e-c348-4ca7-9eef-32ef1719bf9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afd8813a7c0>]}
[0m14:13:19.539947 [info ] [MainThread]: Registered adapter: clickhouse=1.8.6
[0m14:13:20.009465 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m14:13:20.010911 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:13:20.011586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bdd51c1e-c348-4ca7-9eef-32ef1719bf9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afd848541c0>]}
[0m14:13:24.546097 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.ex_01_mpg.cylinders_by_origin' (models/cylinders_by_origin.sql) depends on a source named 'default.auto_mpg___mpg_raw' which was not found
[0m14:13:24.598087 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 5.9948387, "process_in_blocks": "2680", "process_kernel_time": 0.470665, "process_mem_max_rss": "99680", "process_out_blocks": "6616", "process_user_time": 5.79588}
[0m14:13:24.598996 [debug] [MainThread]: Command `dbt build` failed at 14:13:24.598774 after 6.00 seconds
[0m14:13:24.599687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afd87f02310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afd83fa9760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afd83fa92e0>]}
[0m14:13:24.600269 [debug] [MainThread]: Flushing usage events
[0m14:13:51.722950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72893fee7310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72893cb51b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72893cb51a30>]}


============================== 14:13:51.733282 | 3e678fd1-fad3-480c-ba55-9bb148e92a32 ==============================
[0m14:13:51.733282 [info ] [MainThread]: Running with dbt=1.8.9
[0m14:13:51.734510 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'indirect_selection': 'eager', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'quiet': 'False', 'empty': 'False', 'use_colors': 'True', 'warn_error': 'None', 'log_path': '/workdir/transforms/01_mpg/logs', 'write_json': 'True', 'no_print': 'None', 'static_parser': 'True', 'version_check': 'True', 'profiles_dir': '.', 'invocation_command': 'dbt build --profiles-dir .', 'fail_fast': 'False', 'target_path': 'None', 'debug': 'False', 'cache_selected_only': 'False', 'introspect': 'True', 'use_experimental_parser': 'False', 'log_format': 'default'}
[0m14:13:52.342249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3e678fd1-fad3-480c-ba55-9bb148e92a32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72893e62deb0>]}
[0m14:13:52.534156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3e678fd1-fad3-480c-ba55-9bb148e92a32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72893ca1ee50>]}
[0m14:13:52.535416 [info ] [MainThread]: Registered adapter: clickhouse=1.8.6
[0m14:13:52.945833 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m14:13:52.947163 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:13:52.947868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3e678fd1-fad3-480c-ba55-9bb148e92a32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72893c808b50>]}
[0m14:13:56.903662 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.ex_01_mpg.cylinders_by_origin' (models/cylinders_by_origin.sql) depends on a source named 'raw.auto_mpg___mpg_raw' which was not found
[0m14:13:56.905347 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 5.3724074, "process_in_blocks": "0", "process_kernel_time": 0.448038, "process_mem_max_rss": "100140", "process_out_blocks": "6616", "process_user_time": 5.530069}
[0m14:13:56.906177 [debug] [MainThread]: Command `dbt build` failed at 14:13:56.905963 after 5.37 seconds
[0m14:13:56.906851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72893fee7310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72893c1d1b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72893bf25d90>]}
[0m14:13:56.907451 [debug] [MainThread]: Flushing usage events
[0m14:17:04.530070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4990ed3310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c498db2faf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c498db2f9a0>]}


============================== 14:17:04.539161 | a145353a-4abd-4695-bc95-0535de2e2efa ==============================
[0m14:17:04.539161 [info ] [MainThread]: Running with dbt=1.8.9
[0m14:17:04.540200 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'printer_width': '80', 'warn_error': 'None', 'debug': 'False', 'quiet': 'False', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'profiles_dir': '.', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'log_format': 'default', 'fail_fast': 'False', 'no_print': 'None', 'static_parser': 'True', 'log_path': '/workdir/transforms/01_mpg/logs', 'log_cache_events': 'False', 'empty': 'False', 'use_colors': 'True', 'target_path': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'version_check': 'True', 'invocation_command': 'dbt build --profiles-dir . --target local'}
[0m14:17:05.115387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a145353a-4abd-4695-bc95-0535de2e2efa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4990478fd0>]}
[0m14:17:05.257311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a145353a-4abd-4695-bc95-0535de2e2efa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c498dafb070>]}
[0m14:17:05.258592 [info ] [MainThread]: Registered adapter: clickhouse=1.8.6
[0m14:17:05.727025 [debug] [MainThread]: checksum: 134c0f7b96382cc6938697739bc32fb1adc530b177e30f60cebddf61dbd7e979, vars: {}, profile: , target: local, version: 1.8.9
[0m14:17:05.728376 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:17:05.729112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a145353a-4abd-4695-bc95-0535de2e2efa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c498d7ca4f0>]}
[0m14:17:10.357670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a145353a-4abd-4695-bc95-0535de2e2efa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c498d5c1ac0>]}
[0m14:17:10.781029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a145353a-4abd-4695-bc95-0535de2e2efa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c498d9ae8b0>]}
[0m14:17:10.782023 [info ] [MainThread]: Found 1 model, 1 source, 468 macros
[0m14:17:10.784903 [info ] [MainThread]: 
[0m14:17:10.785888 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m14:17:10.787625 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m14:17:10.831452 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:17:11.302961 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m14:17:11.307691 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m14:17:11.346951 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__clean)
[0m14:17:11.361259 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list__clean"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'clean'
      

  ...
[0m14:17:11.369081 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m14:17:11.371959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a145353a-4abd-4695-bc95-0535de2e2efa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c498d4cc550>]}
[0m14:17:11.412454 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m14:17:11.413788 [info ] [MainThread]: 
[0m14:17:11.441382 [debug] [Thread-1  ]: Began running node model.ex_01_mpg.cylinders_by_origin
[0m14:17:11.442501 [info ] [Thread-1  ]: 1 of 1 START sql view model `clean`.`cylinders_by_origin` ...................... [RUN]
[0m14:17:11.443628 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.ex_01_mpg.cylinders_by_origin'
[0m14:17:11.444409 [debug] [Thread-1  ]: Began compiling node model.ex_01_mpg.cylinders_by_origin
[0m14:17:11.459529 [debug] [Thread-1  ]: Writing injected SQL for node "model.ex_01_mpg.cylinders_by_origin"
[0m14:17:11.460683 [debug] [Thread-1  ]: Began executing node model.ex_01_mpg.cylinders_by_origin
[0m14:17:11.624460 [debug] [Thread-1  ]: Creating new relation cylinders_by_origin
[0m14:17:11.645223 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m14:17:11.747522 [debug] [Thread-1  ]: Writing runtime sql for node "model.ex_01_mpg.cylinders_by_origin"
[0m14:17:11.748879 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */


  create view `clean`.`cylinders_by_origin` 
  
    
    
  as (
    SELECT 
  origin,
  avg(cylinders) AS avg_cyl,
  count() AS n
FROM `raw`.`auto_mpg___mpg_raw`  # Now matches
GROUP BY origin
    
  )
      
      
                    -- end_of_sql
                    
                    ...
[0m14:17:11.753515 [debug] [Thread-1  ]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */


  create view `clean`.`cylinders_by_origin` 
  
    
    
  as (
    SELECT 
  origin,
  avg(cylinders) AS avg_cyl,
  count() AS n
FROM `raw`.`auto_mpg___mpg_raw`  # Now matches
GROUP BY origin
    
  )
      
      
                    -- end_of_sql
                    
                    
[0m14:17:11.761512 [debug] [Thread-1  ]: Database Error in model cylinders_by_origin (models/cylinders_by_origin.sql)
  HTTPDriver for http://clickhouse:8123 received ClickHouse error code 60
   Code: 60. DB::Exception: Table raw.auto_mpg___mpg_raw does not exist. (UNKNOWN_TABLE) (version 23.12.6.19 (official build))
  compiled code at target/run/ex_01_mpg/models/cylinders_by_origin.sql
[0m14:17:11.764109 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a145353a-4abd-4695-bc95-0535de2e2efa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c498da72850>]}
[0m14:17:11.765298 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model `clean`.`cylinders_by_origin` ............. [[31mERROR[0m in 0.32s]
[0m14:17:11.766694 [debug] [Thread-1  ]: Finished running node model.ex_01_mpg.cylinders_by_origin
[0m14:17:11.768786 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:17:11.769298 [debug] [MainThread]: Connection 'list__clean' was left open.
[0m14:17:11.769849 [debug] [MainThread]: On list__clean: Close
[0m14:17:11.770317 [debug] [MainThread]: Connection 'model.ex_01_mpg.cylinders_by_origin' was left open.
[0m14:17:11.770837 [debug] [MainThread]: On model.ex_01_mpg.cylinders_by_origin: Close
[0m14:17:11.771701 [info ] [MainThread]: 
[0m14:17:11.772461 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.99 seconds (0.99s).
[0m14:17:11.773924 [debug] [MainThread]: Command end result
[0m14:17:11.860872 [info ] [MainThread]: 
[0m14:17:11.861874 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:17:11.862577 [info ] [MainThread]: 
[0m14:17:11.863523 [error] [MainThread]:   Database Error in model cylinders_by_origin (models/cylinders_by_origin.sql)
  HTTPDriver for http://clickhouse:8123 received ClickHouse error code 60
   Code: 60. DB::Exception: Table raw.auto_mpg___mpg_raw does not exist. (UNKNOWN_TABLE) (version 23.12.6.19 (official build))
  compiled code at target/run/ex_01_mpg/models/cylinders_by_origin.sql
[0m14:17:11.864283 [info ] [MainThread]: 
[0m14:17:11.865069 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:17:11.866591 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 7.526383, "process_in_blocks": "7680", "process_kernel_time": 0.576779, "process_mem_max_rss": "113784", "process_out_blocks": "10424", "process_user_time": 6.521665}
[0m14:17:11.867580 [debug] [MainThread]: Command `dbt build` failed at 14:17:11.867342 after 7.53 seconds
[0m14:17:11.868373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4990ed3310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c498edf00d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c498c880ac0>]}
[0m14:17:11.869152 [debug] [MainThread]: Flushing usage events
[0m14:35:24.751058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x743736033310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x743732c96b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x743732c96a00>]}


============================== 14:35:24.760408 | fb11bea8-4915-475b-ada1-0c5125850489 ==============================
[0m14:35:24.760408 [info ] [MainThread]: Running with dbt=1.8.9
[0m14:35:24.761513 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'empty': 'False', 'log_path': '/workdir/transforms/01_mpg/logs', 'target_path': 'None', 'cache_selected_only': 'False', 'log_format': 'default', 'indirect_selection': 'eager', 'printer_width': '80', 'introspect': 'True', 'warn_error': 'None', 'use_colors': 'True', 'fail_fast': 'False', 'no_print': 'None', 'static_parser': 'True', 'debug': 'False', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'write_json': 'True', 'invocation_command': 'dbt build --profiles-dir . --target local', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'use_experimental_parser': 'False', 'profiles_dir': '.'}
[0m14:35:25.335508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fb11bea8-4915-475b-ada1-0c5125850489', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x743732c5afd0>]}
[0m14:35:25.530060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fb11bea8-4915-475b-ada1-0c5125850489', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x743732bb81c0>]}
[0m14:35:25.531308 [info ] [MainThread]: Registered adapter: clickhouse=1.8.6
[0m14:35:25.941727 [debug] [MainThread]: checksum: 134c0f7b96382cc6938697739bc32fb1adc530b177e30f60cebddf61dbd7e979, vars: {}, profile: , target: local, version: 1.8.9
[0m14:35:26.351245 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:35:26.352304 [debug] [MainThread]: Partial parsing: updated file: ex_01_mpg://models/cylinders_by_origin.sql
[0m14:35:26.944525 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.ex_01_mpg.cylinders_by_origin' (models/cylinders_by_origin.sql) depends on a source named 'raw.autompg___cars' which was not found
[0m14:35:26.946197 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 2.3902361, "process_in_blocks": "0", "process_kernel_time": 0.506564, "process_mem_max_rss": "99832", "process_out_blocks": "6608", "process_user_time": 3.965448}
[0m14:35:26.946998 [debug] [MainThread]: Command `dbt build` failed at 14:35:26.946791 after 2.39 seconds
[0m14:35:26.947655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x743736033310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x743732b22910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74373544edc0>]}
[0m14:35:26.948314 [debug] [MainThread]: Flushing usage events
[0m14:44:08.744982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee6bb1f6310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee6b7e5caf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee6b7e5c9a0>]}


============================== 14:44:08.754616 | c6641145-d2d1-407d-9444-1cd0f718e4e2 ==============================
[0m14:44:08.754616 [info ] [MainThread]: Running with dbt=1.8.9
[0m14:44:08.755823 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'cache_selected_only': 'False', 'no_print': 'None', 'partial_parse': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'indirect_selection': 'eager', 'use_colors': 'True', 'empty': 'False', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'log_path': '/workdir/transforms/01_mpg/logs', 'log_format': 'default', 'debug': 'False', 'invocation_command': 'dbt build --profiles-dir . --target local', 'printer_width': '80', 'profiles_dir': '.', 'quiet': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'introspect': 'True', 'write_json': 'True', 'log_cache_events': 'False'}
[0m14:44:09.363290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c6641145-d2d1-407d-9444-1cd0f718e4e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee6b7d60460>]}
[0m14:44:09.562904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c6641145-d2d1-407d-9444-1cd0f718e4e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee6b7d5c040>]}
[0m14:44:09.564150 [info ] [MainThread]: Registered adapter: clickhouse=1.8.6
[0m14:44:10.033686 [debug] [MainThread]: checksum: 134c0f7b96382cc6938697739bc32fb1adc530b177e30f60cebddf61dbd7e979, vars: {}, profile: , target: local, version: 1.8.9
[0m14:44:10.459930 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m14:44:10.461043 [debug] [MainThread]: Partial parsing: updated file: ex_01_mpg://models/sources.yml
[0m14:44:10.461668 [debug] [MainThread]: Partial parsing: updated file: ex_01_mpg://models/cylinders_by_origin.sql
[0m14:44:11.630429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c6641145-d2d1-407d-9444-1cd0f718e4e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee6b6f4a130>]}
[0m14:44:12.031931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c6641145-d2d1-407d-9444-1cd0f718e4e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee6b6f623d0>]}
[0m14:44:12.032876 [info ] [MainThread]: Found 1 model, 1 source, 468 macros
[0m14:44:12.035609 [info ] [MainThread]: 
[0m14:44:12.036769 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m14:44:12.038352 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m14:44:12.058925 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:44:12.498192 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m14:44:12.502415 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m14:44:12.648298 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__clean)
[0m14:44:12.659558 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list__clean"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'clean'
      

  ...
[0m14:44:12.667188 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m14:44:12.669721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c6641145-d2d1-407d-9444-1cd0f718e4e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee6b6e9d0d0>]}
[0m14:44:12.671260 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m14:44:12.672375 [info ] [MainThread]: 
[0m14:44:12.743042 [debug] [Thread-1  ]: Began running node model.ex_01_mpg.cylinders_by_origin
[0m14:44:12.744135 [info ] [Thread-1  ]: 1 of 1 START sql view model `clean`.`cylinders_by_origin` ...................... [RUN]
[0m14:44:12.745016 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list__clean, now model.ex_01_mpg.cylinders_by_origin)
[0m14:44:12.745729 [debug] [Thread-1  ]: Began compiling node model.ex_01_mpg.cylinders_by_origin
[0m14:44:12.761411 [debug] [Thread-1  ]: Writing injected SQL for node "model.ex_01_mpg.cylinders_by_origin"
[0m14:44:12.762518 [debug] [Thread-1  ]: Began executing node model.ex_01_mpg.cylinders_by_origin
[0m14:44:12.868246 [debug] [Thread-1  ]: Creating new relation cylinders_by_origin
[0m14:44:12.940627 [debug] [Thread-1  ]: Writing runtime sql for node "model.ex_01_mpg.cylinders_by_origin"
[0m14:44:12.942267 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */


  create view `clean`.`cylinders_by_origin` 
  
    
    
  as (
    SELECT 
  origin,
  avg(cylinders) AS avg_cyl,
  count() AS n
FROM `raw`.`autompg___cars`  # Now matches
GROUP BY origin
    
  )
      
      
                    -- end_of_sql
                    
                    ...
[0m14:44:12.957016 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m14:44:13.032879 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6641145-d2d1-407d-9444-1cd0f718e4e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee6b7d470a0>]}
[0m14:44:13.034141 [info ] [Thread-1  ]: 1 of 1 OK created sql view model `clean`.`cylinders_by_origin` ................. [[32mOK[0m in 0.29s]
[0m14:44:13.035516 [debug] [Thread-1  ]: Finished running node model.ex_01_mpg.cylinders_by_origin
[0m14:44:13.038800 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:44:13.040088 [debug] [MainThread]: Connection 'model.ex_01_mpg.cylinders_by_origin' was left open.
[0m14:44:13.041324 [debug] [MainThread]: On model.ex_01_mpg.cylinders_by_origin: Close
[0m14:44:13.042757 [info ] [MainThread]: 
[0m14:44:13.044226 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.01 seconds (1.01s).
[0m14:44:13.046214 [debug] [MainThread]: Command end result
[0m14:44:13.251231 [info ] [MainThread]: 
[0m14:44:13.252850 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:44:13.254123 [info ] [MainThread]: 
[0m14:44:13.255598 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:44:13.258381 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 4.712172, "process_in_blocks": "0", "process_kernel_time": 0.610888, "process_mem_max_rss": "113972", "process_out_blocks": "10400", "process_user_time": 5.093396}
[0m14:44:13.260231 [debug] [MainThread]: Command `dbt build` succeeded at 14:44:13.259742 after 4.71 seconds
[0m14:44:13.261514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee6bb1f6310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee6b9124ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee6b7cf5910>]}
[0m14:44:13.262721 [debug] [MainThread]: Flushing usage events
[0m15:36:32.059955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52f5cfc310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52f296e520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52f296e670>]}


============================== 15:36:32.069567 | 4f5fbeec-8118-47ee-b8a8-fca4f5bad5f6 ==============================
[0m15:36:32.069567 [info ] [MainThread]: Running with dbt=1.8.9
[0m15:36:32.070731 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'empty': 'False', 'invocation_command': 'dbt build --profiles-dir . --target local', 'static_parser': 'True', 'version_check': 'True', 'introspect': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_format': 'default', 'indirect_selection': 'eager', 'debug': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'log_cache_events': 'False', 'profiles_dir': '.', 'use_colors': 'True', 'log_path': '/workdir/transforms/01_mpg/logs', 'printer_width': '80', 'quiet': 'False', 'fail_fast': 'False'}
[0m15:36:32.592414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4f5fbeec-8118-47ee-b8a8-fca4f5bad5f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52f52ac2b0>]}
[0m15:36:32.786598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4f5fbeec-8118-47ee-b8a8-fca4f5bad5f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52f447b5b0>]}
[0m15:36:32.787833 [info ] [MainThread]: Registered adapter: clickhouse=1.8.6
[0m15:36:33.199061 [debug] [MainThread]: checksum: 134c0f7b96382cc6938697739bc32fb1adc530b177e30f60cebddf61dbd7e979, vars: {}, profile: , target: local, version: 1.8.9
[0m15:36:33.576464 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m15:36:33.577406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4f5fbeec-8118-47ee-b8a8-fca4f5bad5f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52f44bb400>]}
[0m15:36:38.106699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4f5fbeec-8118-47ee-b8a8-fca4f5bad5f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52f2946d60>]}
[0m15:36:38.502316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4f5fbeec-8118-47ee-b8a8-fca4f5bad5f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52f221fc10>]}
[0m15:36:38.503119 [info ] [MainThread]: Found 1 model, 1 source, 468 macros
[0m15:36:38.505470 [info ] [MainThread]: 
[0m15:36:38.506418 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m15:36:38.507898 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m15:36:38.569773 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:36:38.964924 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m15:36:38.968276 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m15:36:38.992527 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__mart)
[0m15:36:39.003969 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__mart: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list__mart"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'mart'
      

  ...
[0m15:36:39.008991 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m15:36:39.011389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f5fbeec-8118-47ee-b8a8-fca4f5bad5f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52f1afb910>]}
[0m15:36:39.012278 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m15:36:39.060142 [info ] [MainThread]: 
[0m15:36:39.073042 [debug] [Thread-1  ]: Began running node model.ex_01_mpg.cylinders_by_origin
[0m15:36:39.074254 [info ] [Thread-1  ]: 1 of 1 START sql view model `mart`.`cylinders_by_origin` ....................... [RUN]
[0m15:36:39.075153 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list__mart, now model.ex_01_mpg.cylinders_by_origin)
[0m15:36:39.075910 [debug] [Thread-1  ]: Began compiling node model.ex_01_mpg.cylinders_by_origin
[0m15:36:39.092653 [debug] [Thread-1  ]: Writing injected SQL for node "model.ex_01_mpg.cylinders_by_origin"
[0m15:36:39.093813 [debug] [Thread-1  ]: Began executing node model.ex_01_mpg.cylinders_by_origin
[0m15:36:39.207094 [debug] [Thread-1  ]: Creating new relation cylinders_by_origin
[0m15:36:39.284530 [debug] [Thread-1  ]: Writing runtime sql for node "model.ex_01_mpg.cylinders_by_origin"
[0m15:36:39.286316 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */


  create view `mart`.`cylinders_by_origin` 
  
    
    
  as (
    SELECT 
  origin,
  avg(cylinders) AS avg_cyl,
  count() AS n
FROM `raw`.`autompg___cars`  # Now matches
GROUP BY origin
    
  )
      
      
                    -- end_of_sql
                    
                    ...
[0m15:36:39.298778 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m15:36:39.378951 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f5fbeec-8118-47ee-b8a8-fca4f5bad5f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52f109de80>]}
[0m15:36:39.380156 [info ] [Thread-1  ]: 1 of 1 OK created sql view model `mart`.`cylinders_by_origin` .................. [[32mOK[0m in 0.30s]
[0m15:36:39.381506 [debug] [Thread-1  ]: Finished running node model.ex_01_mpg.cylinders_by_origin
[0m15:36:39.383505 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:36:39.384625 [debug] [MainThread]: Connection 'model.ex_01_mpg.cylinders_by_origin' was left open.
[0m15:36:39.385771 [debug] [MainThread]: On model.ex_01_mpg.cylinders_by_origin: Close
[0m15:36:39.387115 [info ] [MainThread]: 
[0m15:36:39.388583 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.88 seconds (0.88s).
[0m15:36:39.391355 [debug] [MainThread]: Command end result
[0m15:36:39.604911 [info ] [MainThread]: 
[0m15:36:39.606220 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:36:39.607164 [info ] [MainThread]: 
[0m15:36:39.608189 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:36:39.660447 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 7.792892, "process_in_blocks": "0", "process_kernel_time": 0.573635, "process_mem_max_rss": "114500", "process_out_blocks": "10408", "process_user_time": 6.610563}
[0m15:36:39.662144 [debug] [MainThread]: Command `dbt build` succeeded at 15:36:39.661729 after 7.79 seconds
[0m15:36:39.663457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52f5cfc310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52f52ac2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52f1571370>]}
[0m15:36:39.664867 [debug] [MainThread]: Flushing usage events
[0m16:08:04.484447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x6ffe11620310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x6ffe0e285af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x6ffe0e2859a0>]}


============================== 16:08:04.493925 | abafa960-f2a3-4181-90bb-b47a4eb0c15d ==============================
[0m16:08:04.493925 [info ] [MainThread]: Running with dbt=1.8.9
[0m16:08:04.495104 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'profiles_dir': '.', 'static_parser': 'True', 'warn_error': 'None', 'fail_fast': 'False', 'introspect': 'True', 'use_experimental_parser': 'False', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'version_check': 'True', 'debug': 'False', 'printer_width': '80', 'quiet': 'False', 'empty': 'False', 'no_print': 'None', 'log_path': '/workdir/transforms/01_mpg/logs', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'target_path': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'invocation_command': 'dbt build --profiles-dir . --target local', 'log_cache_events': 'False'}
[0m16:08:05.071459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'abafa960-f2a3-4181-90bb-b47a4eb0c15d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x6ffe13df58b0>]}
[0m16:08:05.267178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'abafa960-f2a3-4181-90bb-b47a4eb0c15d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x6ffe0e2e8040>]}
[0m16:08:05.268515 [info ] [MainThread]: Registered adapter: clickhouse=1.8.6
[0m16:08:05.687968 [debug] [MainThread]: checksum: 134c0f7b96382cc6938697739bc32fb1adc530b177e30f60cebddf61dbd7e979, vars: {}, profile: , target: local, version: 1.8.9
[0m16:08:06.111476 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 2 files added, 0 files changed.
[0m16:08:06.112378 [debug] [MainThread]: Partial parsing: added file: ex_01_mpg://models/mart/cylinders_by_origin.sql
[0m16:08:06.112987 [debug] [MainThread]: Partial parsing: added file: ex_01_mpg://models/clean/mpg_standardized.sql
[0m16:08:06.113497 [debug] [MainThread]: Partial parsing: deleted file: ex_01_mpg://models/cylinders_by_origin.sql
[0m16:08:06.989566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'abafa960-f2a3-4181-90bb-b47a4eb0c15d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x6ffe0d5d9f40>]}
[0m16:08:07.402870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'abafa960-f2a3-4181-90bb-b47a4eb0c15d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x6ffe0d5d9d90>]}
[0m16:08:07.403773 [info ] [MainThread]: Found 2 models, 1 source, 468 macros
[0m16:08:07.406430 [info ] [MainThread]: 
[0m16:08:07.407566 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m16:08:07.419012 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m16:08:07.484570 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:08:07.932372 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m16:08:07.936459 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m16:08:07.958026 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__mart)
[0m16:08:07.977250 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__mart: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list__mart"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'mart'
      

  ...
[0m16:08:07.985240 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m16:08:07.988116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'abafa960-f2a3-4181-90bb-b47a4eb0c15d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x6ffe0d146f70>]}
[0m16:08:07.990098 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m16:08:07.991411 [info ] [MainThread]: 
[0m16:08:08.209256 [debug] [Thread-1  ]: Began running node model.ex_01_mpg.mpg_standardized
[0m16:08:08.210381 [info ] [Thread-1  ]: 1 of 2 START sql table model `mart`.`mpg_standardized` ......................... [RUN]
[0m16:08:08.211431 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.ex_01_mpg.mpg_standardized'
[0m16:08:08.212164 [debug] [Thread-1  ]: Began compiling node model.ex_01_mpg.mpg_standardized
[0m16:08:08.282988 [debug] [Thread-1  ]: Writing injected SQL for node "model.ex_01_mpg.mpg_standardized"
[0m16:08:08.284509 [debug] [Thread-1  ]: Began executing node model.ex_01_mpg.mpg_standardized
[0m16:08:08.384178 [debug] [Thread-1  ]: Creating new relation mpg_standardized
[0m16:08:08.507560 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m16:08:08.618003 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.mpg_standardized"} */

            

    
        create table `mart`.`mpg_standardized`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

select
  cast(mpg as float64)        as mpg,
  cast(cylinders as int32)    as cylinders,
  cast(displacement as float64) as displacement,
  cast(horsepower as float64) as horsepower,
  cast(weight as float64)     as weight,
  cast(acceleration as float64) as acceleration,
  cast(model_year as int32)   as model_year,
  origin,
  make
from `raw`.`autompg___cars`
          )
        
        ...
[0m16:08:08.623749 [debug] [Thread-1  ]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.mpg_standardized"} */

            

    
        create table `mart`.`mpg_standardized`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

select
  cast(mpg as float64)        as mpg,
  cast(cylinders as int32)    as cylinders,
  cast(displacement as float64) as displacement,
  cast(horsepower as float64) as horsepower,
  cast(weight as float64)     as weight,
  cast(acceleration as float64) as acceleration,
  cast(model_year as int32)   as model_year,
  origin,
  make
from `raw`.`autompg___cars`
          )
        
        
[0m16:08:08.627477 [debug] [Thread-1  ]: Database Error in model mpg_standardized (models/clean/mpg_standardized.sql)
  HTTPDriver for http://clickhouse:8123 received ClickHouse error code 47
   Code: 47. DB::Exception: Missing columns: 'make' while processing query: 'SELECT CAST(mpg, 'float64') AS mpg, CAST(cylinders, 'int32') AS cylinders, CAST(displacement, 'float64') AS displacement, CAST(horsepower, 'float64') AS horsepower, CAST(weight, 'float64') AS weight, CAST(acceleration, 'float64') AS acceleration, CAST(model_year, 'int32') AS model_year, origin, make FROM raw.autompg___cars', required columns: 'origin' 'make' 'horsepower' 'mpg' 'weight' 'model_year' 'cylinders' 'displacement' 'acceleration', maybe you meant: 'origin', 'name', 'horsepower', 'mpg', 'weight', 'model_year', 'cylinders', 'displacement' or 'acceleration'. (UNKNOWN_IDENTIFIER) (version 23.12.6.19 (official build))
[0m16:08:08.630107 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'abafa960-f2a3-4181-90bb-b47a4eb0c15d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x6ffe0e243f40>]}
[0m16:08:08.631204 [error] [Thread-1  ]: 1 of 2 ERROR creating sql table model `mart`.`mpg_standardized` ................ [[31mERROR[0m in 0.42s]
[0m16:08:08.632594 [debug] [Thread-1  ]: Finished running node model.ex_01_mpg.mpg_standardized
[0m16:08:08.634713 [debug] [Thread-3  ]: Began running node model.ex_01_mpg.cylinders_by_origin
[0m16:08:08.636076 [info ] [Thread-3  ]: 2 of 2 SKIP relation mart.cylinders_by_origin .................................. [[33mSKIP[0m]
[0m16:08:08.637519 [debug] [Thread-3  ]: Finished running node model.ex_01_mpg.cylinders_by_origin
[0m16:08:08.640018 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:08:08.640863 [debug] [MainThread]: Connection 'list__mart' was left open.
[0m16:08:08.641714 [debug] [MainThread]: On list__mart: Close
[0m16:08:08.642497 [debug] [MainThread]: Connection 'model.ex_01_mpg.mpg_standardized' was left open.
[0m16:08:08.643344 [debug] [MainThread]: On model.ex_01_mpg.mpg_standardized: Close
[0m16:08:08.644475 [info ] [MainThread]: 
[0m16:08:08.645418 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 1.24 seconds (1.24s).
[0m16:08:08.647707 [debug] [MainThread]: Command end result
[0m16:08:08.796641 [info ] [MainThread]: 
[0m16:08:08.798120 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:08:08.798973 [info ] [MainThread]: 
[0m16:08:08.800447 [error] [MainThread]:   Database Error in model mpg_standardized (models/clean/mpg_standardized.sql)
  HTTPDriver for http://clickhouse:8123 received ClickHouse error code 47
   Code: 47. DB::Exception: Missing columns: 'make' while processing query: 'SELECT CAST(mpg, 'float64') AS mpg, CAST(cylinders, 'int32') AS cylinders, CAST(displacement, 'float64') AS displacement, CAST(horsepower, 'float64') AS horsepower, CAST(weight, 'float64') AS weight, CAST(acceleration, 'float64') AS acceleration, CAST(model_year, 'int32') AS model_year, origin, make FROM raw.autompg___cars', required columns: 'origin' 'make' 'horsepower' 'mpg' 'weight' 'model_year' 'cylinders' 'displacement' 'acceleration', maybe you meant: 'origin', 'name', 'horsepower', 'mpg', 'weight', 'model_year', 'cylinders', 'displacement' or 'acceleration'. (UNKNOWN_IDENTIFIER) (version 23.12.6.19 (official build))
[0m16:08:08.801485 [info ] [MainThread]: 
[0m16:08:08.802576 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m16:08:08.804571 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 4.5137253, "process_in_blocks": "0", "process_kernel_time": 0.63087, "process_mem_max_rss": "113916", "process_out_blocks": "10424", "process_user_time": 5.047947}
[0m16:08:08.805670 [debug] [MainThread]: Command `dbt build` failed at 16:08:08.805382 after 4.52 seconds
[0m16:08:08.806513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x6ffe11620310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x6ffe0df1c310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x6ffe0df819d0>]}
[0m16:08:08.807346 [debug] [MainThread]: Flushing usage events
[0m16:16:48.691518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73081bbaf310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73081880ca90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73081880c940>]}


============================== 16:16:48.701317 | 571e97d5-3879-48af-b358-4c3fb6aba509 ==============================
[0m16:16:48.701317 [info ] [MainThread]: Running with dbt=1.8.9
[0m16:16:48.702459 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'debug': 'False', 'warn_error': 'None', 'quiet': 'False', 'target_path': 'None', 'profiles_dir': '.', 'write_json': 'True', 'use_colors': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt build --profiles-dir . --target local', 'version_check': 'True', 'static_parser': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'log_path': '/workdir/transforms/01_mpg/logs', 'cache_selected_only': 'False', 'empty': 'False', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80'}
[0m16:16:49.231422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '571e97d5-3879-48af-b358-4c3fb6aba509', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7308187d9be0>]}
[0m16:16:49.427174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '571e97d5-3879-48af-b358-4c3fb6aba509', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730818c5c040>]}
[0m16:16:49.428561 [info ] [MainThread]: Registered adapter: clickhouse=1.8.6
[0m16:16:49.895302 [debug] [MainThread]: checksum: 134c0f7b96382cc6938697739bc32fb1adc530b177e30f60cebddf61dbd7e979, vars: {}, profile: , target: local, version: 1.8.9
[0m16:16:50.312570 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m16:16:50.313564 [debug] [MainThread]: Partial parsing: updated file: ex_01_mpg://models/clean/mpg_standardized.sql
[0m16:16:50.314236 [debug] [MainThread]: Partial parsing: updated file: ex_01_mpg://models/mart/cylinders_by_origin.sql
[0m16:16:51.134943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '571e97d5-3879-48af-b358-4c3fb6aba509', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730817b18fd0>]}
[0m16:16:51.536154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '571e97d5-3879-48af-b358-4c3fb6aba509', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730817a93730>]}
[0m16:16:51.537000 [info ] [MainThread]: Found 2 models, 1 source, 468 macros
[0m16:16:51.539674 [info ] [MainThread]: 
[0m16:16:51.540702 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m16:16:51.592419 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m16:16:51.552486 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m16:16:51.622638 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:16:51.624098 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:16:52.230507 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m16:16:52.238659 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m16:16:52.243050 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m16:16:52.248045 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m16:16:52.521642 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now create__mart_clean)
[0m16:16:52.522640 [debug] [ThreadPool]: Creating schema "schema: "mart_clean"
"
[0m16:16:52.523504 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now create__mart_mart)
[0m16:16:52.535809 [debug] [ThreadPool]: Creating schema "schema: "mart_mart"
"
[0m16:16:52.603189 [debug] [ThreadPool]: dbt_clickhouse adapter: On create__mart_clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "create__mart_clean"} */
create database if not exists `mart_clean`
        
  
        
  ...
[0m16:16:52.611881 [debug] [ThreadPool]: dbt_clickhouse adapter: On create__mart_mart: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "create__mart_mart"} */
create database if not exists `mart_mart`
        
  
        
  ...
[0m16:16:52.618822 [debug] [ThreadPool]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "create__mart_clean"} */
create database if not exists `mart_clean`
        
  
        
  
[0m16:16:52.621062 [debug] [ThreadPool]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "create__mart_mart"} */
create database if not exists `mart_mart`
        
  
        
  
[0m16:16:52.622711 [debug] [ThreadPool]: dbt_clickhouse adapter: Error running SQL: macro create_schema
[0m16:16:52.624263 [debug] [ThreadPool]: dbt_clickhouse adapter: Error running SQL: macro create_schema
[0m16:16:52.627805 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:16:52.629046 [debug] [MainThread]: Connection 'create__mart_clean' was left open.
[0m16:16:52.630306 [debug] [MainThread]: On create__mart_clean: Close
[0m16:16:52.631471 [debug] [MainThread]: Connection 'create__mart_mart' was left open.
[0m16:16:52.632698 [debug] [MainThread]: On create__mart_mart: Close
[0m16:16:52.633901 [info ] [MainThread]: 
[0m16:16:52.635328 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 1.09 seconds (1.09s).
[0m16:16:52.637061 [error] [MainThread]: Encountered an error:
Database Error
  HTTPDriver for http://clickhouse:8123 received ClickHouse error code 497
   Code: 497. DB::Exception: ftw_user: Not enough privileges. To execute this query, it's necessary to have the grant CREATE DATABASE ON mart_clean.*. (ACCESS_DENIED) (version 23.12.6.19 (official build))
[0m16:16:52.639698 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 4.140759, "process_in_blocks": "0", "process_kernel_time": 0.579005, "process_mem_max_rss": "112148", "process_out_blocks": "9368", "process_user_time": 4.852618}
[0m16:16:52.641247 [debug] [MainThread]: Command `dbt build` failed at 16:16:52.640828 after 4.14 seconds
[0m16:16:52.691283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73081bbaf310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73081783b9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730816ea4670>]}
[0m16:16:52.692918 [debug] [MainThread]: Flushing usage events
[0m16:35:01.945765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735946a4f310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7359436b1af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7359436b19a0>]}


============================== 16:35:01.961762 | ddd886db-afcc-4b35-97c4-39a49767c406 ==============================
[0m16:35:01.961762 [info ] [MainThread]: Running with dbt=1.8.9
[0m16:35:01.963664 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': '/workdir/transforms/01_mpg/logs', 'quiet': 'False', 'version_check': 'True', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'no_print': 'None', 'profiles_dir': '.', 'invocation_command': 'dbt build --profiles-dir . --target local', 'printer_width': '80', 'static_parser': 'True', 'write_json': 'True', 'empty': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_cache_events': 'False'}
[0m16:35:02.586442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ddd886db-afcc-4b35-97c4-39a49767c406', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735945ff6fd0>]}
[0m16:35:02.783296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ddd886db-afcc-4b35-97c4-39a49767c406', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73594367f070>]}
[0m16:35:02.784612 [info ] [MainThread]: Registered adapter: clickhouse=1.8.6
[0m16:35:03.257226 [debug] [MainThread]: checksum: 134c0f7b96382cc6938697739bc32fb1adc530b177e30f60cebddf61dbd7e979, vars: {}, profile: , target: local, version: 1.8.9
[0m16:35:03.672960 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m16:35:03.673836 [debug] [MainThread]: Partial parsing: added file: ex_01_mpg://models/macro/create_schema.sql
[0m16:35:04.548748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ddd886db-afcc-4b35-97c4-39a49767c406', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735942b7cf40>]}
[0m16:35:04.905718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ddd886db-afcc-4b35-97c4-39a49767c406', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735942f341c0>]}
[0m16:35:04.906608 [info ] [MainThread]: Found 3 models, 1 source, 468 macros
[0m16:35:04.943570 [info ] [MainThread]: 
[0m16:35:04.944827 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m16:35:04.956356 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m16:35:04.968030 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m16:35:04.975657 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m16:35:05.055065 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:35:05.057743 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:35:05.068860 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:35:05.815314 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m16:35:05.825972 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m16:35:05.849141 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m16:35:05.852642 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m16:35:05.860433 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m16:35:06.071838 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.21 seconds
[0m16:35:06.145846 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now create__mart_clean)
[0m16:35:06.146914 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now create__mart_mart)
[0m16:35:06.148339 [debug] [ThreadPool]: Creating schema "schema: "mart_clean"
"
[0m16:35:06.149751 [debug] [ThreadPool]: Creating schema "schema: "mart_mart"
"
[0m16:35:06.163562 [debug] [ThreadPool]: dbt_clickhouse adapter: On create__mart_clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "create__mart_clean"} */
create database if not exists `mart_clean`
        
  
        
  ...
[0m16:35:06.172440 [debug] [ThreadPool]: dbt_clickhouse adapter: On create__mart_mart: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "create__mart_mart"} */
create database if not exists `mart_mart`
        
  
        
  ...
[0m16:35:06.177819 [debug] [ThreadPool]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "create__mart_clean"} */
create database if not exists `mart_clean`
        
  
        
  
[0m16:35:06.178581 [debug] [ThreadPool]: dbt_clickhouse adapter: Error running SQL: macro create_schema
[0m16:35:06.180911 [debug] [ThreadPool]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "create__mart_mart"} */
create database if not exists `mart_mart`
        
  
        
  
[0m16:35:06.182625 [debug] [ThreadPool]: dbt_clickhouse adapter: Error running SQL: macro create_schema
[0m16:35:06.184768 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:35:06.185892 [debug] [MainThread]: Connection 'list_' was left open.
[0m16:35:06.186993 [debug] [MainThread]: On list_: Close
[0m16:35:06.188068 [debug] [MainThread]: Connection 'create__mart_mart' was left open.
[0m16:35:06.189149 [debug] [MainThread]: On create__mart_mart: Close
[0m16:35:06.242557 [debug] [MainThread]: Connection 'create__mart_clean' was left open.
[0m16:35:06.243767 [debug] [MainThread]: On create__mart_clean: Close
[0m16:35:06.245243 [info ] [MainThread]: 
[0m16:35:06.246818 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 1.30 seconds (1.30s).
[0m16:35:06.248625 [error] [MainThread]: Encountered an error:
Database Error
  HTTPDriver for http://clickhouse:8123 received ClickHouse error code 497
   Code: 497. DB::Exception: ftw_user: Not enough privileges. To execute this query, it's necessary to have the grant CREATE DATABASE ON mart_clean.*. (ACCESS_DENIED) (version 23.12.6.19 (official build))
[0m16:35:06.251410 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 4.5685906, "process_in_blocks": "0", "process_kernel_time": 0.601303, "process_mem_max_rss": "111768", "process_out_blocks": "9368", "process_user_time": 5.029532}
[0m16:35:06.253148 [debug] [MainThread]: Command `dbt build` failed at 16:35:06.252730 after 4.57 seconds
[0m16:35:06.254579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735946a4f310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735942afba60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7359428a6430>]}
[0m16:35:06.255901 [debug] [MainThread]: Flushing usage events
[0m16:35:58.384326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aec7d30b310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aec79f6aaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aec79f6a9a0>]}


============================== 16:35:58.393705 | 24c79631-913d-43bf-9543-afff78a2a29f ==============================
[0m16:35:58.393705 [info ] [MainThread]: Running with dbt=1.8.9
[0m16:35:58.394868 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'log_format': 'default', 'fail_fast': 'False', 'version_check': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'partial_parse': 'True', 'empty': 'False', 'target_path': 'None', 'log_cache_events': 'False', 'quiet': 'False', 'invocation_command': 'dbt build --profiles-dir . --target local', 'log_path': '/workdir/transforms/01_mpg/logs', 'write_json': 'True', 'profiles_dir': '.', 'indirect_selection': 'eager', 'introspect': 'True', 'use_colors': 'True', 'printer_width': '80'}
[0m16:35:58.978214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '24c79631-913d-43bf-9543-afff78a2a29f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aec7c8b43a0>]}
[0m16:35:59.176604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '24c79631-913d-43bf-9543-afff78a2a29f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aec7b2a5eb0>]}
[0m16:35:59.177928 [info ] [MainThread]: Registered adapter: clickhouse=1.8.6
[0m16:35:59.597796 [debug] [MainThread]: checksum: 134c0f7b96382cc6938697739bc32fb1adc530b177e30f60cebddf61dbd7e979, vars: {}, profile: , target: local, version: 1.8.9
[0m16:36:00.016016 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:36:00.016963 [debug] [MainThread]: Partial parsing: updated file: ex_01_mpg://models/macro/create_schema.sql
[0m16:36:00.890764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '24c79631-913d-43bf-9543-afff78a2a29f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aec794ae9a0>]}
[0m16:36:01.281186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '24c79631-913d-43bf-9543-afff78a2a29f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aec79695310>]}
[0m16:36:01.282034 [info ] [MainThread]: Found 3 models, 1 source, 468 macros
[0m16:36:01.285035 [info ] [MainThread]: 
[0m16:36:01.286128 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m16:36:01.298404 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m16:36:01.310198 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m16:36:01.311756 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m16:36:01.376929 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:36:01.379579 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:36:01.385067 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:36:01.957007 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m16:36:01.961607 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m16:36:01.967442 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m16:36:01.974610 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m16:36:02.104315 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m16:36:02.109060 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m16:36:02.177681 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now create__mart_clean)
[0m16:36:02.178667 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now create__mart_mart)
[0m16:36:02.180160 [debug] [ThreadPool]: Creating schema "schema: "mart_clean"
"
[0m16:36:02.181638 [debug] [ThreadPool]: Creating schema "schema: "mart_mart"
"
[0m16:36:02.206049 [debug] [ThreadPool]: dbt_clickhouse adapter: On create__mart_clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "create__mart_clean"} */
create database if not exists `mart_clean`
        
  
        
  ...
[0m16:36:02.210413 [debug] [ThreadPool]: dbt_clickhouse adapter: On create__mart_mart: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "create__mart_mart"} */
create database if not exists `mart_mart`
        
  
        
  ...
[0m16:36:02.216224 [debug] [ThreadPool]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "create__mart_clean"} */
create database if not exists `mart_clean`
        
  
        
  
[0m16:36:02.218198 [debug] [ThreadPool]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "create__mart_mart"} */
create database if not exists `mart_mart`
        
  
        
  
[0m16:36:02.219515 [debug] [ThreadPool]: dbt_clickhouse adapter: Error running SQL: macro create_schema
[0m16:36:02.220852 [debug] [ThreadPool]: dbt_clickhouse adapter: Error running SQL: macro create_schema
[0m16:36:02.224157 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:36:02.225287 [debug] [MainThread]: Connection 'create__mart_clean' was left open.
[0m16:36:02.277440 [debug] [MainThread]: On create__mart_clean: Close
[0m16:36:02.278613 [debug] [MainThread]: Connection 'list_' was left open.
[0m16:36:02.279749 [debug] [MainThread]: On list_: Close
[0m16:36:02.280833 [debug] [MainThread]: Connection 'create__mart_mart' was left open.
[0m16:36:02.281946 [debug] [MainThread]: On create__mart_mart: Close
[0m16:36:02.283206 [info ] [MainThread]: 
[0m16:36:02.284647 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 1.00 seconds (1.00s).
[0m16:36:02.286408 [error] [MainThread]: Encountered an error:
Database Error
  HTTPDriver for http://clickhouse:8123 received ClickHouse error code 497
   Code: 497. DB::Exception: ftw_user: Not enough privileges. To execute this query, it's necessary to have the grant CREATE DATABASE ON mart_clean.*. (ACCESS_DENIED) (version 23.12.6.19 (official build))
[0m16:36:02.289385 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 4.094927, "process_in_blocks": "0", "process_kernel_time": 0.580362, "process_mem_max_rss": "112192", "process_out_blocks": "9368", "process_user_time": 4.754816}
[0m16:36:02.291212 [debug] [MainThread]: Command `dbt build` failed at 16:36:02.290700 after 4.10 seconds
[0m16:36:02.292675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aec7d30b310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aec78f42100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aec78f34ca0>]}
[0m16:36:02.293986 [debug] [MainThread]: Flushing usage events
[0m16:36:15.451603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x724cf556a310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x724cf21caa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x724cf21ca940>]}


============================== 16:36:15.462146 | 6b361c23-5c78-4f04-8984-48a92998c78c ==============================
[0m16:36:15.462146 [info ] [MainThread]: Running with dbt=1.8.9
[0m16:36:15.463290 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'invocation_command': 'dbt build --profiles-dir . --target local', 'log_format': 'default', 'static_parser': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'introspect': 'True', 'partial_parse': 'True', 'fail_fast': 'False', 'log_path': '/workdir/transforms/01_mpg/logs', 'target_path': 'None', 'empty': 'False', 'log_cache_events': 'False', 'write_json': 'True', 'use_colors': 'True', 'printer_width': '80', 'no_print': 'None', 'profiles_dir': '.', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False'}
[0m16:36:16.035585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6b361c23-5c78-4f04-8984-48a92998c78c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x724cf3ee3fa0>]}
[0m16:36:16.230742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6b361c23-5c78-4f04-8984-48a92998c78c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x724cf2cf2bb0>]}
[0m16:36:16.232116 [info ] [MainThread]: Registered adapter: clickhouse=1.8.6
[0m16:36:16.648023 [debug] [MainThread]: checksum: 134c0f7b96382cc6938697739bc32fb1adc530b177e30f60cebddf61dbd7e979, vars: {}, profile: , target: local, version: 1.8.9
[0m16:36:17.065777 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m16:36:17.066670 [debug] [MainThread]: Partial parsing: added file: ex_01_mpg://models/macro/generate_schema_name.sql
[0m16:36:17.067191 [debug] [MainThread]: Partial parsing: deleted file: ex_01_mpg://models/macro/create_schema.sql
[0m16:36:17.935130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6b361c23-5c78-4f04-8984-48a92998c78c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x724cf1707130>]}
[0m16:36:18.327090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6b361c23-5c78-4f04-8984-48a92998c78c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x724cf1a650a0>]}
[0m16:36:18.327927 [info ] [MainThread]: Found 3 models, 1 source, 468 macros
[0m16:36:18.330718 [info ] [MainThread]: 
[0m16:36:18.331740 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m16:36:18.343323 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m16:36:18.344974 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m16:36:18.356897 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m16:36:18.427667 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:36:18.432142 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:36:18.442042 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:36:19.240623 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m16:36:19.243401 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m16:36:19.251966 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m16:36:19.256985 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m16:36:19.320130 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m16:36:19.540605 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m16:36:19.627665 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now create__mart_clean)
[0m16:36:19.629624 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now create__mart_mart)
[0m16:36:19.631593 [debug] [ThreadPool]: Creating schema "schema: "mart_clean"
"
[0m16:36:19.633425 [debug] [ThreadPool]: Creating schema "schema: "mart_mart"
"
[0m16:36:19.732183 [debug] [ThreadPool]: dbt_clickhouse adapter: On create__mart_clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "create__mart_clean"} */
create database if not exists `mart_clean`
        
  
        
  ...
[0m16:36:19.736393 [debug] [ThreadPool]: dbt_clickhouse adapter: On create__mart_mart: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "create__mart_mart"} */
create database if not exists `mart_mart`
        
  
        
  ...
[0m16:36:19.742067 [debug] [ThreadPool]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "create__mart_clean"} */
create database if not exists `mart_clean`
        
  
        
  
[0m16:36:19.743447 [debug] [ThreadPool]: dbt_clickhouse adapter: Error running SQL: macro create_schema
[0m16:36:19.745886 [debug] [ThreadPool]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "create__mart_mart"} */
create database if not exists `mart_mart`
        
  
        
  
[0m16:36:19.747148 [debug] [ThreadPool]: dbt_clickhouse adapter: Error running SQL: macro create_schema
[0m16:36:19.748773 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:36:19.749580 [debug] [MainThread]: Connection 'list_' was left open.
[0m16:36:19.750369 [debug] [MainThread]: On list_: Close
[0m16:36:19.751123 [debug] [MainThread]: Connection 'create__mart_clean' was left open.
[0m16:36:19.751896 [debug] [MainThread]: On create__mart_clean: Close
[0m16:36:19.752628 [debug] [MainThread]: Connection 'create__mart_mart' was left open.
[0m16:36:19.753366 [debug] [MainThread]: On create__mart_mart: Close
[0m16:36:19.754305 [info ] [MainThread]: 
[0m16:36:19.755328 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 1.42 seconds (1.42s).
[0m16:36:19.756500 [error] [MainThread]: Encountered an error:
Database Error
  HTTPDriver for http://clickhouse:8123 received ClickHouse error code 497
   Code: 497. DB::Exception: ftw_user: Not enough privileges. To execute this query, it's necessary to have the grant CREATE DATABASE ON mart_clean.*. (ACCESS_DENIED) (version 23.12.6.19 (official build))
[0m16:36:19.758428 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 4.5035124, "process_in_blocks": "0", "process_kernel_time": 0.655504, "process_mem_max_rss": "112104", "process_out_blocks": "9376", "process_user_time": 4.905839}
[0m16:36:19.759464 [debug] [MainThread]: Command `dbt build` failed at 16:36:19.759197 after 4.50 seconds
[0m16:36:19.760332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x724cf556a310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x724cf13bcaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x724cf11a6580>]}
[0m16:36:19.761273 [debug] [MainThread]: Flushing usage events
[0m16:37:07.485842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710e344b0310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710e31124520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710e31124670>]}


============================== 16:37:07.495143 | 30e9c8b5-56be-4a16-a2bb-f88bee4e7c9a ==============================
[0m16:37:07.495143 [info ] [MainThread]: Running with dbt=1.8.9
[0m16:37:07.496276 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'use_experimental_parser': 'False', 'printer_width': '80', 'invocation_command': 'dbt build --profiles-dir . --target local', 'version_check': 'True', 'fail_fast': 'False', 'partial_parse': 'True', 'target_path': 'None', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'static_parser': 'True', 'introspect': 'True', 'debug': 'False', 'empty': 'False', 'profiles_dir': '.', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'log_format': 'default', 'log_path': '/workdir/transforms/01_mpg/logs', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True', 'warn_error': 'None'}
[0m16:37:08.075752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '30e9c8b5-56be-4a16-a2bb-f88bee4e7c9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710e33a4eca0>]}
[0m16:37:08.268128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '30e9c8b5-56be-4a16-a2bb-f88bee4e7c9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710e30fb4370>]}
[0m16:37:08.269403 [info ] [MainThread]: Registered adapter: clickhouse=1.8.6
[0m16:37:08.682090 [debug] [MainThread]: checksum: 134c0f7b96382cc6938697739bc32fb1adc530b177e30f60cebddf61dbd7e979, vars: {}, profile: , target: local, version: 1.8.9
[0m16:37:09.101366 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m16:37:09.102313 [debug] [MainThread]: Partial parsing: added file: ex_01_mpg://models/macro/create_schema.sql
[0m16:37:09.997192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '30e9c8b5-56be-4a16-a2bb-f88bee4e7c9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710e305d4fd0>]}
[0m16:37:10.396344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '30e9c8b5-56be-4a16-a2bb-f88bee4e7c9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710e30749dc0>]}
[0m16:37:10.397170 [info ] [MainThread]: Found 4 models, 1 source, 468 macros
[0m16:37:10.399971 [info ] [MainThread]: 
[0m16:37:10.400991 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m16:37:10.413008 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m16:37:10.456986 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m16:37:10.463658 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m16:37:10.489888 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:37:10.557847 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:37:10.559905 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:37:11.433890 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m16:37:11.457231 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m16:37:11.444709 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m16:37:11.466079 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m16:37:11.468763 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m16:37:11.479311 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m16:37:11.766999 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now create__mart_clean)
[0m16:37:11.767977 [debug] [ThreadPool]: Creating schema "schema: "mart_clean"
"
[0m16:37:11.768893 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now create__mart_mart)
[0m16:37:11.783359 [debug] [ThreadPool]: dbt_clickhouse adapter: On create__mart_clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "create__mart_clean"} */
create database if not exists `mart_clean`
        
  
        
  ...
[0m16:37:11.784841 [debug] [ThreadPool]: Creating schema "schema: "mart_mart"
"
[0m16:37:11.793940 [debug] [ThreadPool]: dbt_clickhouse adapter: On create__mart_mart: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "create__mart_mart"} */
create database if not exists `mart_mart`
        
  
        
  ...
[0m16:37:11.795739 [debug] [ThreadPool]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "create__mart_clean"} */
create database if not exists `mart_clean`
        
  
        
  
[0m16:37:11.798221 [debug] [ThreadPool]: dbt_clickhouse adapter: Error running SQL: macro create_schema
[0m16:37:11.800269 [debug] [ThreadPool]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "create__mart_mart"} */
create database if not exists `mart_mart`
        
  
        
  
[0m16:37:11.802076 [debug] [ThreadPool]: dbt_clickhouse adapter: Error running SQL: macro create_schema
[0m16:37:11.804526 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:37:11.857528 [debug] [MainThread]: Connection 'list_' was left open.
[0m16:37:11.858742 [debug] [MainThread]: On list_: Close
[0m16:37:11.859847 [debug] [MainThread]: Connection 'create__mart_clean' was left open.
[0m16:37:11.861008 [debug] [MainThread]: On create__mart_clean: Close
[0m16:37:11.862149 [debug] [MainThread]: Connection 'create__mart_mart' was left open.
[0m16:37:11.863338 [debug] [MainThread]: On create__mart_mart: Close
[0m16:37:11.864828 [info ] [MainThread]: 
[0m16:37:11.866401 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 1.46 seconds (1.46s).
[0m16:37:11.867971 [error] [MainThread]: Encountered an error:
Database Error
  HTTPDriver for http://clickhouse:8123 received ClickHouse error code 497
   Code: 497. DB::Exception: ftw_user: Not enough privileges. To execute this query, it's necessary to have the grant CREATE DATABASE ON mart_clean.*. (ACCESS_DENIED) (version 23.12.6.19 (official build))
[0m16:37:11.870867 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 4.5758843, "process_in_blocks": "0", "process_kernel_time": 0.645108, "process_mem_max_rss": "112176", "process_out_blocks": "9400", "process_user_time": 5.070689}
[0m16:37:11.872616 [debug] [MainThread]: Command `dbt build` failed at 16:37:11.872182 after 4.58 seconds
[0m16:37:11.873920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710e344b0310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710e30664730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710e30749c40>]}
[0m16:37:11.875189 [debug] [MainThread]: Flushing usage events
[0m16:40:23.263018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b68a210d310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b689ed732e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b689ed73430>]}


============================== 16:40:23.272983 | 46ca07e5-6fac-4bc1-8917-7258e67c4a7a ==============================
[0m16:40:23.272983 [info ] [MainThread]: Running with dbt=1.8.9
[0m16:40:23.274178 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'introspect': 'True', 'target_path': 'None', 'quiet': 'False', 'log_path': '/workdir/transforms/01_mpg/logs', 'log_format': 'default', 'debug': 'False', 'partial_parse': 'True', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'printer_width': '80', 'no_print': 'None', 'use_colors': 'True', 'write_json': 'True', 'log_cache_events': 'False', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'warn_error': 'None', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'empty': 'None', 'profiles_dir': '/workdir/transforms/01_mpg'}
[0m16:40:23.607755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '46ca07e5-6fac-4bc1-8917-7258e67c4a7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b689ee2b970>]}
[0m16:40:23.673421 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.6076764, "process_in_blocks": "8", "process_kernel_time": 0.459289, "process_mem_max_rss": "91576", "process_out_blocks": "6592", "process_user_time": 3.221907}
[0m16:40:23.674221 [debug] [MainThread]: Command `dbt clean` succeeded at 16:40:23.674011 after 0.61 seconds
[0m16:40:23.674858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b68a210d310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b689ebab430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b689ed73910>]}
[0m16:40:23.675529 [debug] [MainThread]: Flushing usage events
[0m16:40:32.896634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7651a3dd9310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7651a0a3eaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7651a0a3e9a0>]}


============================== 16:40:32.956981 | e0a4c0c3-80cf-4c9b-a972-ad8ea7fe303a ==============================
[0m16:40:32.956981 [info ] [MainThread]: Running with dbt=1.8.9
[0m16:40:32.958181 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt build --profiles-dir . --target local', 'log_cache_events': 'False', 'empty': 'False', 'fail_fast': 'False', 'log_path': '/workdir/transforms/01_mpg/logs', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'introspect': 'True', 'target_path': 'None', 'partial_parse': 'True', 'write_json': 'True', 'profiles_dir': '.', 'version_check': 'True', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'use_experimental_parser': 'False', 'static_parser': 'True', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'printer_width': '80'}
[0m16:40:33.485416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e0a4c0c3-80cf-4c9b-a972-ad8ea7fe303a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7651a0959c70>]}
[0m16:40:33.677944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e0a4c0c3-80cf-4c9b-a972-ad8ea7fe303a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7651a1c76700>]}
[0m16:40:33.679219 [info ] [MainThread]: Registered adapter: clickhouse=1.8.6
[0m16:40:34.102684 [debug] [MainThread]: checksum: 134c0f7b96382cc6938697739bc32fb1adc530b177e30f60cebddf61dbd7e979, vars: {}, profile: , target: local, version: 1.8.9
[0m16:40:34.104062 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m16:40:34.104745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e0a4c0c3-80cf-4c9b-a972-ad8ea7fe303a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7651a06f03d0>]}
[0m16:40:38.762295 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.mart
- models.clean
[0m16:40:38.784816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e0a4c0c3-80cf-4c9b-a972-ad8ea7fe303a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7651a0746be0>]}
[0m16:40:39.194455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e0a4c0c3-80cf-4c9b-a972-ad8ea7fe303a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7651a095cdf0>]}
[0m16:40:39.195326 [info ] [MainThread]: Found 2 models, 1 source, 468 macros
[0m16:40:39.198128 [info ] [MainThread]: 
[0m16:40:39.199254 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m16:40:39.211052 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m16:40:39.212053 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m16:40:39.281849 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:40:39.289783 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:40:39.763227 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m16:40:39.769650 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m16:40:39.772615 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m16:40:39.776201 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m16:40:39.875844 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now create__mart_mart)
[0m16:40:39.877131 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now create__mart_clean)
[0m16:40:39.878895 [debug] [ThreadPool]: Creating schema "schema: "mart_mart"
"
[0m16:40:39.880332 [debug] [ThreadPool]: Creating schema "schema: "mart_clean"
"
[0m16:40:39.962551 [debug] [ThreadPool]: dbt_clickhouse adapter: On create__mart_mart: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "create__mart_mart"} */
create database if not exists `mart_mart`
        
  
        
  ...
[0m16:40:39.968205 [debug] [ThreadPool]: dbt_clickhouse adapter: On create__mart_clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "create__mart_clean"} */
create database if not exists `mart_clean`
        
  
        
  ...
[0m16:40:39.973894 [debug] [ThreadPool]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "create__mart_mart"} */
create database if not exists `mart_mart`
        
  
        
  
[0m16:40:39.976183 [debug] [ThreadPool]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "create__mart_clean"} */
create database if not exists `mart_clean`
        
  
        
  
[0m16:40:39.977658 [debug] [ThreadPool]: dbt_clickhouse adapter: Error running SQL: macro create_schema
[0m16:40:39.979110 [debug] [ThreadPool]: dbt_clickhouse adapter: Error running SQL: macro create_schema
[0m16:40:39.982527 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:40:39.983682 [debug] [MainThread]: Connection 'create__mart_clean' was left open.
[0m16:40:39.984932 [debug] [MainThread]: On create__mart_clean: Close
[0m16:40:39.986093 [debug] [MainThread]: Connection 'create__mart_mart' was left open.
[0m16:40:39.987249 [debug] [MainThread]: On create__mart_mart: Close
[0m16:40:39.988423 [info ] [MainThread]: 
[0m16:40:39.989931 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.79 seconds (0.79s).
[0m16:40:39.991736 [error] [MainThread]: Encountered an error:
Database Error
  HTTPDriver for http://clickhouse:8123 received ClickHouse error code 497
   Code: 497. DB::Exception: ftw_user: Not enough privileges. To execute this query, it's necessary to have the grant CREATE DATABASE ON mart_mart.*. (ACCESS_DENIED) (version 23.12.6.19 (official build))
[0m16:40:39.994487 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 7.2886744, "process_in_blocks": "0", "process_kernel_time": 0.6108, "process_mem_max_rss": "112572", "process_out_blocks": "9384", "process_user_time": 6.33521}
[0m16:40:39.996144 [debug] [MainThread]: Command `dbt build` failed at 16:40:39.995726 after 7.29 seconds
[0m16:40:39.997651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7651a3dd9310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7651a04a3e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7651a0237df0>]}
[0m16:40:39.998976 [debug] [MainThread]: Flushing usage events
[0m16:43:43.030332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x731769f68310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x731766bc8af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x731766bc89a0>]}


============================== 16:43:43.039556 | e6d73261-3a04-411e-bd49-89f62361e7f3 ==============================
[0m16:43:43.039556 [info ] [MainThread]: Running with dbt=1.8.9
[0m16:43:43.040639 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'write_json': 'True', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'fail_fast': 'False', 'introspect': 'True', 'warn_error': 'None', 'debug': 'False', 'no_print': 'None', 'invocation_command': 'dbt build --profiles-dir . --target local', 'use_experimental_parser': 'False', 'static_parser': 'True', 'printer_width': '80', 'empty': 'False', 'log_path': '/workdir/transforms/01_mpg/logs', 'indirect_selection': 'eager', 'use_colors': 'True', 'quiet': 'False', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'cache_selected_only': 'False', 'profiles_dir': '.', 'partial_parse': 'True'}
[0m16:43:43.564652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e6d73261-3a04-411e-bd49-89f62361e7f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x731766bc8f70>]}
[0m16:43:43.755568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e6d73261-3a04-411e-bd49-89f62361e7f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73176a1974c0>]}
[0m16:43:43.756876 [info ] [MainThread]: Registered adapter: clickhouse=1.8.6
[0m16:43:44.225299 [debug] [MainThread]: checksum: 134c0f7b96382cc6938697739bc32fb1adc530b177e30f60cebddf61dbd7e979, vars: {}, profile: , target: local, version: 1.8.9
[0m16:43:44.637697 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:43:44.638344 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:43:44.652558 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.mart
- models.clean
[0m16:43:44.763345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e6d73261-3a04-411e-bd49-89f62361e7f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73176640a130>]}
[0m16:43:45.180844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e6d73261-3a04-411e-bd49-89f62361e7f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7317663b79a0>]}
[0m16:43:45.220765 [info ] [MainThread]: Found 2 models, 1 source, 468 macros
[0m16:43:45.223633 [info ] [MainThread]: 
[0m16:43:45.224749 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m16:43:45.236714 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m16:43:45.258309 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m16:43:45.321812 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:43:45.271054 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:43:46.034320 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m16:43:46.039836 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m16:43:46.044031 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m16:43:46.046379 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m16:43:46.144622 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now create__mart_mart)
[0m16:43:46.146341 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now create__mart_clean)
[0m16:43:46.148020 [debug] [ThreadPool]: Creating schema "schema: "mart_mart"
"
[0m16:43:46.149695 [debug] [ThreadPool]: Creating schema "schema: "mart_clean"
"
[0m16:43:46.236719 [debug] [ThreadPool]: dbt_clickhouse adapter: On create__mart_clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "create__mart_clean"} */
create database if not exists `mart_clean`
        
  
        
  ...
[0m16:43:46.234847 [debug] [ThreadPool]: dbt_clickhouse adapter: On create__mart_mart: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "create__mart_mart"} */
create database if not exists `mart_mart`
        
  
        
  ...
[0m16:43:46.245347 [debug] [ThreadPool]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "create__mart_clean"} */
create database if not exists `mart_clean`
        
  
        
  
[0m16:43:46.247624 [debug] [ThreadPool]: dbt_clickhouse adapter: Error running SQL: macro create_schema
[0m16:43:46.251486 [debug] [ThreadPool]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "create__mart_mart"} */
create database if not exists `mart_mart`
        
  
        
  
[0m16:43:46.253069 [debug] [ThreadPool]: dbt_clickhouse adapter: Error running SQL: macro create_schema
[0m16:43:46.255304 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:43:46.256673 [debug] [MainThread]: Connection 'create__mart_clean' was left open.
[0m16:43:46.258489 [debug] [MainThread]: On create__mart_clean: Close
[0m16:43:46.259619 [debug] [MainThread]: Connection 'create__mart_mart' was left open.
[0m16:43:46.260746 [debug] [MainThread]: On create__mart_mart: Close
[0m16:43:46.261876 [info ] [MainThread]: 
[0m16:43:46.263272 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 1.04 seconds (1.04s).
[0m16:43:46.264947 [error] [MainThread]: Encountered an error:
Database Error
  HTTPDriver for http://clickhouse:8123 received ClickHouse error code 497
   Code: 497. DB::Exception: ftw_user: Not enough privileges. To execute this query, it's necessary to have the grant CREATE DATABASE ON mart_clean.*. (ACCESS_DENIED) (version 23.12.6.19 (official build))
[0m16:43:46.267694 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 3.4278169, "process_in_blocks": "0", "process_kernel_time": 0.589237, "process_mem_max_rss": "109356", "process_out_blocks": "8408", "process_user_time": 4.512244}
[0m16:43:46.269321 [debug] [MainThread]: Command `dbt build` failed at 16:43:46.268879 after 3.43 seconds
[0m16:43:46.321926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x731769f68310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x731766353730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7317662b9370>]}
[0m16:43:46.323242 [debug] [MainThread]: Flushing usage events
[0m16:44:04.848944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766c48fdcf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766c45c85a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766c45c85940>]}


============================== 16:44:04.909017 | ffa1644e-8161-42a5-8b32-a2a019953414 ==============================
[0m16:44:04.909017 [info ] [MainThread]: Running with dbt=1.8.9
[0m16:44:04.910135 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'debug': 'False', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'no_print': 'None', 'static_parser': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'write_json': 'True', 'log_path': '/workdir/transforms/01_mpg/logs', 'cache_selected_only': 'False', 'version_check': 'True', 'partial_parse': 'True', 'profiles_dir': '.', 'printer_width': '80', 'target_path': 'None', 'invocation_command': 'dbt build --profiles-dir . --target local', 'indirect_selection': 'eager', 'empty': 'False', 'use_colors': 'True', 'log_cache_events': 'False'}
[0m16:44:05.438148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ffa1644e-8161-42a5-8b32-a2a019953414', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766c45b70670>]}
[0m16:44:05.633323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ffa1644e-8161-42a5-8b32-a2a019953414', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766c465a0610>]}
[0m16:44:05.634638 [info ] [MainThread]: Registered adapter: clickhouse=1.8.6
[0m16:44:06.102182 [debug] [MainThread]: checksum: 134c0f7b96382cc6938697739bc32fb1adc530b177e30f60cebddf61dbd7e979, vars: {}, profile: , target: local, version: 1.8.9
[0m16:44:06.433214 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m16:44:06.434112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ffa1644e-8161-42a5-8b32-a2a019953414', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766c46fb7910>]}
[0m16:44:11.124078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ffa1644e-8161-42a5-8b32-a2a019953414', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766c44f51130>]}
[0m16:44:11.509352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ffa1644e-8161-42a5-8b32-a2a019953414', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766c44e66880>]}
[0m16:44:11.510178 [info ] [MainThread]: Found 2 models, 1 source, 468 macros
[0m16:44:11.512701 [info ] [MainThread]: 
[0m16:44:11.513729 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m16:44:11.525085 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m16:44:11.531768 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m16:44:11.635161 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:44:11.640690 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:44:12.363676 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m16:44:12.367308 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m16:44:12.372953 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m16:44:12.375114 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m16:44:12.442168 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now create__mart_clean)
[0m16:44:12.443720 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now create__mart_mart)
[0m16:44:12.445445 [debug] [ThreadPool]: Creating schema "schema: "mart_clean"
"
[0m16:44:12.447204 [debug] [ThreadPool]: Creating schema "schema: "mart_mart"
"
[0m16:44:12.529128 [debug] [ThreadPool]: dbt_clickhouse adapter: On create__mart_clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "create__mart_clean"} */
create database if not exists `mart_clean`
        
  
        
  ...
[0m16:44:12.533145 [debug] [ThreadPool]: dbt_clickhouse adapter: On create__mart_mart: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "create__mart_mart"} */
create database if not exists `mart_mart`
        
  
        
  ...
[0m16:44:12.539119 [debug] [ThreadPool]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "create__mart_clean"} */
create database if not exists `mart_clean`
        
  
        
  
[0m16:44:12.541316 [debug] [ThreadPool]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "create__mart_mart"} */
create database if not exists `mart_mart`
        
  
        
  
[0m16:44:12.542750 [debug] [ThreadPool]: dbt_clickhouse adapter: Error running SQL: macro create_schema
[0m16:44:12.544161 [debug] [ThreadPool]: dbt_clickhouse adapter: Error running SQL: macro create_schema
[0m16:44:12.547483 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:44:12.548633 [debug] [MainThread]: Connection 'create__mart_mart' was left open.
[0m16:44:12.549707 [debug] [MainThread]: On create__mart_mart: Close
[0m16:44:12.602453 [debug] [MainThread]: Connection 'create__mart_clean' was left open.
[0m16:44:12.603690 [debug] [MainThread]: On create__mart_clean: Close
[0m16:44:12.604792 [info ] [MainThread]: 
[0m16:44:12.606122 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 1.09 seconds (1.09s).
[0m16:44:12.607766 [error] [MainThread]: Encountered an error:
Database Error
  HTTPDriver for http://clickhouse:8123 received ClickHouse error code 497
   Code: 497. DB::Exception: ftw_user: Not enough privileges. To execute this query, it's necessary to have the grant CREATE DATABASE ON mart_clean.*. (ACCESS_DENIED) (version 23.12.6.19 (official build))
[0m16:44:12.610357 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 7.9030128, "process_in_blocks": "0", "process_kernel_time": 0.621796, "process_mem_max_rss": "112948", "process_out_blocks": "9368", "process_user_time": 6.773526}
[0m16:44:12.611915 [debug] [MainThread]: Command `dbt build` failed at 16:44:12.611486 after 7.90 seconds
[0m16:44:12.613224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766c48fdcf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766c445ee910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x766c4418dca0>]}
[0m16:44:12.614437 [debug] [MainThread]: Flushing usage events
[0m16:44:59.251333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73de2779f310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73de243f1b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73de243f19d0>]}


============================== 16:44:59.260760 | 73bbf2fa-6e29-4f5b-8779-e864e2868738 ==============================
[0m16:44:59.260760 [info ] [MainThread]: Running with dbt=1.8.9
[0m16:44:59.261820 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'log_format': 'default', 'quiet': 'False', 'log_path': '/workdir/transforms/01_mpg/logs', 'no_print': 'None', 'introspect': 'True', 'indirect_selection': 'eager', 'empty': 'False', 'static_parser': 'True', 'partial_parse': 'True', 'printer_width': '80', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'profiles_dir': '.', 'debug': 'False', 'warn_error': 'None', 'target_path': 'None', 'invocation_command': 'dbt build --profiles-dir . --target local', 'version_check': 'True', 'use_colors': 'True', 'cache_selected_only': 'False'}
[0m16:44:59.837864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '73bbf2fa-6e29-4f5b-8779-e864e2868738', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73de26d373a0>]}
[0m16:44:59.981670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '73bbf2fa-6e29-4f5b-8779-e864e2868738', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73de24500e80>]}
[0m16:45:00.033310 [info ] [MainThread]: Registered adapter: clickhouse=1.8.6
[0m16:45:00.452348 [debug] [MainThread]: checksum: 134c0f7b96382cc6938697739bc32fb1adc530b177e30f60cebddf61dbd7e979, vars: {}, profile: , target: local, version: 1.8.9
[0m16:45:00.864921 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:45:00.865617 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:45:01.037417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '73bbf2fa-6e29-4f5b-8779-e864e2868738', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73de23c34130>]}
[0m16:45:01.441328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '73bbf2fa-6e29-4f5b-8779-e864e2868738', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73de23c8a370>]}
[0m16:45:01.442185 [info ] [MainThread]: Found 2 models, 1 source, 468 macros
[0m16:45:01.444730 [info ] [MainThread]: 
[0m16:45:01.445752 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m16:45:01.457438 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m16:45:01.459086 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m16:45:01.551466 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:45:01.565985 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:45:02.122035 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m16:45:02.127198 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m16:45:02.133780 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m16:45:02.138635 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m16:45:02.160374 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now create__mart_clean)
[0m16:45:02.161215 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now create__mart_mart)
[0m16:45:02.162286 [debug] [ThreadPool]: Creating schema "schema: "mart_clean"
"
[0m16:45:02.163481 [debug] [ThreadPool]: Creating schema "schema: "mart_mart"
"
[0m16:45:02.178176 [debug] [ThreadPool]: dbt_clickhouse adapter: On create__mart_clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "create__mart_clean"} */
create database if not exists `mart_clean`
        
  
        
  ...
[0m16:45:02.234228 [debug] [ThreadPool]: dbt_clickhouse adapter: On create__mart_mart: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "create__mart_mart"} */
create database if not exists `mart_mart`
        
  
        
  ...
[0m16:45:02.240021 [debug] [ThreadPool]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "create__mart_clean"} */
create database if not exists `mart_clean`
        
  
        
  
[0m16:45:02.242399 [debug] [ThreadPool]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "create__mart_mart"} */
create database if not exists `mart_mart`
        
  
        
  
[0m16:45:02.243933 [debug] [ThreadPool]: dbt_clickhouse adapter: Error running SQL: macro create_schema
[0m16:45:02.245525 [debug] [ThreadPool]: dbt_clickhouse adapter: Error running SQL: macro create_schema
[0m16:45:02.248716 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:45:02.249638 [debug] [MainThread]: Connection 'create__mart_mart' was left open.
[0m16:45:02.250505 [debug] [MainThread]: On create__mart_mart: Close
[0m16:45:02.251575 [debug] [MainThread]: Connection 'create__mart_clean' was left open.
[0m16:45:02.252524 [debug] [MainThread]: On create__mart_clean: Close
[0m16:45:02.253786 [info ] [MainThread]: 
[0m16:45:02.255306 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.81 seconds (0.81s).
[0m16:45:02.256964 [error] [MainThread]: Encountered an error:
Database Error
  HTTPDriver for http://clickhouse:8123 received ClickHouse error code 497
   Code: 497. DB::Exception: ftw_user: Not enough privileges. To execute this query, it's necessary to have the grant CREATE DATABASE ON mart_clean.*. (ACCESS_DENIED) (version 23.12.6.19 (official build))
[0m16:45:02.258976 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 3.2007086, "process_in_blocks": "0", "process_kernel_time": 0.570517, "process_mem_max_rss": "109436", "process_out_blocks": "8408", "process_user_time": 4.340722}
[0m16:45:02.259962 [debug] [MainThread]: Command `dbt build` failed at 16:45:02.259720 after 3.20 seconds
[0m16:45:02.260796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73de2779f310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73de23928d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73de22f1f730>]}
[0m16:45:02.261565 [debug] [MainThread]: Flushing usage events
[0m16:46:42.099570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ccafeaa310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ccacb0e220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ccacb0e370>]}


============================== 16:46:42.109090 | bab29ebb-e692-4e22-aabc-5b19385db847 ==============================
[0m16:46:42.109090 [info ] [MainThread]: Running with dbt=1.8.9
[0m16:46:42.110241 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'debug': 'False', 'empty': 'None', 'log_path': '/workdir/transforms/01_mpg/logs', 'static_parser': 'True', 'no_print': 'None', 'write_json': 'True', 'partial_parse': 'True', 'fail_fast': 'False', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'log_format': 'default', 'use_experimental_parser': 'False', 'version_check': 'True', 'profiles_dir': '/workdir/transforms/01_mpg', 'use_colors': 'True', 'printer_width': '80', 'warn_error': 'None', 'introspect': 'True', 'indirect_selection': 'eager'}
[0m16:46:42.434160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bab29ebb-e692-4e22-aabc-5b19385db847', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ccacb68e80>]}
[0m16:46:42.498805 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.59386694, "process_in_blocks": "0", "process_kernel_time": 0.442788, "process_mem_max_rss": "91672", "process_out_blocks": "6592", "process_user_time": 3.255739}
[0m16:46:42.499628 [debug] [MainThread]: Command `dbt clean` succeeded at 16:46:42.499410 after 0.59 seconds
[0m16:46:42.500282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ccafeaa310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ccac948eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ccacf6a520>]}
[0m16:46:42.500889 [debug] [MainThread]: Flushing usage events
[0m16:46:56.902340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790dcc352310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790dc8fbaac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790dc8fba970>]}


============================== 16:46:56.913001 | 1f7f4730-4e80-40e8-b796-315b3455facc ==============================
[0m16:46:56.913001 [info ] [MainThread]: Running with dbt=1.8.9
[0m16:46:56.914083 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'invocation_command': 'dbt build --profiles-dir . --target local', 'warn_error': 'None', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'write_json': 'True', 'target_path': 'None', 'partial_parse': 'True', 'fail_fast': 'False', 'log_path': '/workdir/transforms/01_mpg/logs', 'empty': 'False', 'introspect': 'True', 'no_print': 'None', 'printer_width': '80', 'use_colors': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'profiles_dir': '.', 'quiet': 'False', 'version_check': 'True', 'log_cache_events': 'False'}
[0m16:46:57.448598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1f7f4730-4e80-40e8-b796-315b3455facc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790dc8ed2970>]}
[0m16:46:57.645237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1f7f4730-4e80-40e8-b796-315b3455facc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790dc8eb4f10>]}
[0m16:46:57.646556 [info ] [MainThread]: Registered adapter: clickhouse=1.8.6
[0m16:46:58.115331 [debug] [MainThread]: checksum: 134c0f7b96382cc6938697739bc32fb1adc530b177e30f60cebddf61dbd7e979, vars: {}, profile: , target: local, version: 1.8.9
[0m16:46:58.116853 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m16:46:58.117616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1f7f4730-4e80-40e8-b796-315b3455facc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790dc8c73cd0>]}
[0m16:47:03.004182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1f7f4730-4e80-40e8-b796-315b3455facc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790dc88405e0>]}
[0m16:47:03.356647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1f7f4730-4e80-40e8-b796-315b3455facc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790dca1ec880>]}
[0m16:47:03.357451 [info ] [MainThread]: Found 2 models, 1 source, 468 macros
[0m16:47:03.360061 [info ] [MainThread]: 
[0m16:47:03.361162 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m16:47:03.410342 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m16:47:03.412332 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m16:47:03.442513 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:47:03.512190 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:47:04.284056 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m16:47:04.309281 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m16:47:04.312335 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m16:47:04.330269 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m16:47:04.416500 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now create__mart_mart)
[0m16:47:04.418135 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now create__mart_clean)
[0m16:47:04.419810 [debug] [ThreadPool]: Creating schema "schema: "mart_mart"
"
[0m16:47:04.421479 [debug] [ThreadPool]: Creating schema "schema: "mart_clean"
"
[0m16:47:04.510768 [debug] [ThreadPool]: dbt_clickhouse adapter: On create__mart_mart: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "create__mart_mart"} */
create database if not exists `mart_mart`
        
  
        
  ...
[0m16:47:04.513263 [debug] [ThreadPool]: dbt_clickhouse adapter: On create__mart_clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "create__mart_clean"} */
create database if not exists `mart_clean`
        
  
        
  ...
[0m16:47:04.517096 [debug] [ThreadPool]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "create__mart_mart"} */
create database if not exists `mart_mart`
        
  
        
  
[0m16:47:04.518398 [debug] [ThreadPool]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "create__mart_clean"} */
create database if not exists `mart_clean`
        
  
        
  
[0m16:47:04.519203 [debug] [ThreadPool]: dbt_clickhouse adapter: Error running SQL: macro create_schema
[0m16:47:04.520055 [debug] [ThreadPool]: dbt_clickhouse adapter: Error running SQL: macro create_schema
[0m16:47:04.521853 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:47:04.522767 [debug] [MainThread]: Connection 'create__mart_mart' was left open.
[0m16:47:04.523722 [debug] [MainThread]: On create__mart_mart: Close
[0m16:47:04.524508 [debug] [MainThread]: Connection 'create__mart_clean' was left open.
[0m16:47:04.525379 [debug] [MainThread]: On create__mart_clean: Close
[0m16:47:04.526254 [info ] [MainThread]: 
[0m16:47:04.527345 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 1.17 seconds (1.17s).
[0m16:47:04.528598 [error] [MainThread]: Encountered an error:
Database Error
  HTTPDriver for http://clickhouse:8123 received ClickHouse error code 497
   Code: 497. DB::Exception: ftw_user: Not enough privileges. To execute this query, it's necessary to have the grant CREATE DATABASE ON mart_mart.*. (ACCESS_DENIED) (version 23.12.6.19 (official build))
[0m16:47:04.530682 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 7.8179274, "process_in_blocks": "0", "process_kernel_time": 0.613648, "process_mem_max_rss": "112404", "process_out_blocks": "9376", "process_user_time": 6.605687}
[0m16:47:04.531933 [debug] [MainThread]: Command `dbt build` failed at 16:47:04.531627 after 7.82 seconds
[0m16:47:04.532938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790dcc352310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790dc8702fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790dc75b0700>]}
[0m16:47:04.534035 [debug] [MainThread]: Flushing usage events
[0m16:53:09.540925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772185f48310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772182ba6ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772182ba6970>]}


============================== 16:53:09.550674 | e9b5ea38-360c-44ef-a888-47a45eff89a4 ==============================
[0m16:53:09.550674 [info ] [MainThread]: Running with dbt=1.8.9
[0m16:53:09.551777 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'invocation_command': 'dbt build --profiles-dir . --target local', 'partial_parse': 'True', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/workdir/transforms/01_mpg/logs', 'empty': 'False', 'log_cache_events': 'False', 'printer_width': '80', 'cache_selected_only': 'False', 'introspect': 'True', 'log_format': 'default', 'version_check': 'True', 'quiet': 'False', 'static_parser': 'True', 'debug': 'False', 'indirect_selection': 'eager', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'no_print': 'None', 'profiles_dir': '.', 'use_colors': 'True', 'write_json': 'True'}
[0m16:53:10.129254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e9b5ea38-360c-44ef-a888-47a45eff89a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772182aa9580>]}
[0m16:53:10.325367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e9b5ea38-360c-44ef-a888-47a45eff89a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772182c085b0>]}
[0m16:53:10.326667 [info ] [MainThread]: Registered adapter: clickhouse=1.8.6
[0m16:53:10.747090 [debug] [MainThread]: checksum: 134c0f7b96382cc6938697739bc32fb1adc530b177e30f60cebddf61dbd7e979, vars: {}, profile: , target: local, version: 1.8.9
[0m16:53:11.133099 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m16:53:11.133961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e9b5ea38-360c-44ef-a888-47a45eff89a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772183ede070>]}
[0m16:53:15.717845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e9b5ea38-360c-44ef-a888-47a45eff89a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772181e70130>]}
[0m16:53:16.070575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e9b5ea38-360c-44ef-a888-47a45eff89a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772181d968b0>]}
[0m16:53:16.071434 [info ] [MainThread]: Found 2 models, 1 source, 471 macros
[0m16:53:16.074185 [info ] [MainThread]: 
[0m16:53:16.075241 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m16:53:16.125964 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m16:53:16.132637 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m16:53:16.151986 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:53:16.152665 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:53:16.614899 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m16:53:16.619280 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m16:53:16.623699 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m16:53:16.629006 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m16:53:16.648367 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__clean)
[0m16:53:16.660440 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__mart)
[0m16:53:16.661693 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list__clean"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'clean'
      

  ...
[0m16:53:16.716217 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__mart: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list__mart"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'mart'
      

  ...
[0m16:53:16.725197 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m16:53:16.729161 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m16:53:16.732836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e9b5ea38-360c-44ef-a888-47a45eff89a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772181d29cd0>]}
[0m16:53:16.734716 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m16:53:16.736133 [info ] [MainThread]: 
[0m16:53:16.762244 [debug] [Thread-1  ]: Began running node model.ex_01_mpg.mpg_standardized
[0m16:53:16.763378 [info ] [Thread-1  ]: 1 of 2 START sql table model `clean`.`mpg_standardized` ........................ [RUN]
[0m16:53:16.764418 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.ex_01_mpg.mpg_standardized'
[0m16:53:16.765138 [debug] [Thread-1  ]: Began compiling node model.ex_01_mpg.mpg_standardized
[0m16:53:16.834506 [debug] [Thread-1  ]: Writing injected SQL for node "model.ex_01_mpg.mpg_standardized"
[0m16:53:16.836151 [debug] [Thread-1  ]: Began executing node model.ex_01_mpg.mpg_standardized
[0m16:53:16.935692 [debug] [Thread-1  ]: Creating new relation mpg_standardized
[0m16:53:17.054936 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m16:53:17.163702 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.mpg_standardized"} */

            

    
        create table `clean`.`mpg_standardized`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

select
  toFloat64OrNull(mpg)            as mpg,
  toInt64OrNull(cylinders)        as cylinders,
  toFloat64OrNull(displacement)   as displacement,
  toFloat64OrNull(horsepower)     as horsepower,
  toInt64OrNull(weight)           as weight,
  toFloat64OrNull(acceleration)   as acceleration,
  toInt64OrNull(model_year)       as model_year,
  toString(origin)                as origin,
  toString(name)                  as make   -- raw column is `name`
from `raw`.`autompg___cars`
          )
        
        ...
[0m16:53:17.180701 [debug] [Thread-1  ]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.mpg_standardized"} */

            

    
        create table `clean`.`mpg_standardized`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

select
  toFloat64OrNull(mpg)            as mpg,
  toInt64OrNull(cylinders)        as cylinders,
  toFloat64OrNull(displacement)   as displacement,
  toFloat64OrNull(horsepower)     as horsepower,
  toInt64OrNull(weight)           as weight,
  toFloat64OrNull(acceleration)   as acceleration,
  toInt64OrNull(model_year)       as model_year,
  toString(origin)                as origin,
  toString(name)                  as make   -- raw column is `name`
from `raw`.`autompg___cars`
          )
        
        
[0m16:53:17.186953 [debug] [Thread-1  ]: Database Error in model mpg_standardized (models/clean/mpg_standardized.sql)
  HTTPDriver for http://clickhouse:8123 received ClickHouse error code 43
   Code: 43. DB::Exception: Illegal type Float64 of first argument of function toFloat64OrNull. Conversion functions with postfix 'OrZero' or 'OrNull' should take String argument: While processing toFloat64OrNull(mpg) AS mpg, toInt64OrNull(cylinders) AS cylinders, toFloat64OrNull(displacement) AS displacement, toFloat64OrNull(horsepower) AS horsepower, toInt64OrNull(weight) AS weight, toFloat64OrNull(acceleration) AS acceleration, toInt64OrNull(model_year) AS model_year, toString(origin) AS origin, toString(name) AS make. (ILLEGAL_TYPE_OF_ARGUMENT) (version 23.12.6.19 (official build))
[0m16:53:17.191584 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9b5ea38-360c-44ef-a888-47a45eff89a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772181066ca0>]}
[0m16:53:17.193336 [error] [Thread-1  ]: 1 of 2 ERROR creating sql table model `clean`.`mpg_standardized` ............... [[31mERROR[0m in 0.42s]
[0m16:53:17.195272 [debug] [Thread-1  ]: Finished running node model.ex_01_mpg.mpg_standardized
[0m16:53:17.197975 [debug] [Thread-3  ]: Began running node model.ex_01_mpg.cylinders_by_origin
[0m16:53:17.199846 [info ] [Thread-3  ]: 2 of 2 SKIP relation mart.cylinders_by_origin .................................. [[33mSKIP[0m]
[0m16:53:17.201867 [debug] [Thread-3  ]: Finished running node model.ex_01_mpg.cylinders_by_origin
[0m16:53:17.205368 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:53:17.206560 [debug] [MainThread]: Connection 'list__clean' was left open.
[0m16:53:17.207723 [debug] [MainThread]: On list__clean: Close
[0m16:53:17.208793 [debug] [MainThread]: Connection 'list__mart' was left open.
[0m16:53:17.209872 [debug] [MainThread]: On list__mart: Close
[0m16:53:17.210933 [debug] [MainThread]: Connection 'model.ex_01_mpg.mpg_standardized' was left open.
[0m16:53:17.212075 [debug] [MainThread]: On model.ex_01_mpg.mpg_standardized: Close
[0m16:53:17.213751 [info ] [MainThread]: 
[0m16:53:17.215083 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 1.14 seconds (1.14s).
[0m16:53:17.218121 [debug] [MainThread]: Command end result
[0m16:53:17.420247 [info ] [MainThread]: 
[0m16:53:17.421971 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:53:17.423403 [info ] [MainThread]: 
[0m16:53:17.425486 [error] [MainThread]:   Database Error in model mpg_standardized (models/clean/mpg_standardized.sql)
  HTTPDriver for http://clickhouse:8123 received ClickHouse error code 43
   Code: 43. DB::Exception: Illegal type Float64 of first argument of function toFloat64OrNull. Conversion functions with postfix 'OrZero' or 'OrNull' should take String argument: While processing toFloat64OrNull(mpg) AS mpg, toInt64OrNull(cylinders) AS cylinders, toFloat64OrNull(displacement) AS displacement, toFloat64OrNull(horsepower) AS horsepower, toInt64OrNull(weight) AS weight, toFloat64OrNull(acceleration) AS acceleration, toInt64OrNull(model_year) AS model_year, toString(origin) AS origin, toString(name) AS make. (ILLEGAL_TYPE_OF_ARGUMENT) (version 23.12.6.19 (official build))
[0m16:53:17.427000 [info ] [MainThread]: 
[0m16:53:17.428378 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m16:53:17.431334 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 8.089641, "process_in_blocks": "0", "process_kernel_time": 0.597088, "process_mem_max_rss": "115328", "process_out_blocks": "10456", "process_user_time": 6.776556}
[0m16:53:17.432939 [debug] [MainThread]: Command `dbt build` failed at 16:53:17.432513 after 8.09 seconds
[0m16:53:17.434257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772185f48310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77218231f160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772182aa9580>]}
[0m16:53:17.435514 [debug] [MainThread]: Flushing usage events
[0m16:54:56.657055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2981b40310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b297e7a7b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b297e7a79d0>]}


============================== 16:54:56.666034 | 6604c90a-9372-499a-9302-1b36ee427efc ==============================
[0m16:54:56.666034 [info ] [MainThread]: Running with dbt=1.8.9
[0m16:54:56.667100 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'log_format': 'default', 'use_colors': 'True', 'quiet': 'False', 'target_path': 'None', 'debug': 'False', 'empty': 'False', 'indirect_selection': 'eager', 'partial_parse': 'True', 'profiles_dir': '.', 'version_check': 'True', 'warn_error': 'None', 'introspect': 'True', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'static_parser': 'True', 'fail_fast': 'False', 'write_json': 'True', 'no_print': 'None', 'invocation_command': 'dbt build --profiles-dir . --target local', 'log_path': '/workdir/transforms/01_mpg/logs', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:54:57.244820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6604c90a-9372-499a-9302-1b36ee427efc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b29810e3ca0>]}
[0m16:54:57.437277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6604c90a-9372-499a-9302-1b36ee427efc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b297e7e10a0>]}
[0m16:54:57.438524 [info ] [MainThread]: Registered adapter: clickhouse=1.8.6
[0m16:54:57.848080 [debug] [MainThread]: checksum: 134c0f7b96382cc6938697739bc32fb1adc530b177e30f60cebddf61dbd7e979, vars: {}, profile: , target: local, version: 1.8.9
[0m16:54:58.259842 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:54:58.260823 [debug] [MainThread]: Partial parsing: updated file: ex_01_mpg://models/clean/mpg_standardized.sql
[0m16:54:59.071733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6604c90a-9372-499a-9302-1b36ee427efc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b297db6b130>]}
[0m16:54:59.471917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6604c90a-9372-499a-9302-1b36ee427efc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b297da5a430>]}
[0m16:54:59.472757 [info ] [MainThread]: Found 2 models, 1 source, 471 macros
[0m16:54:59.475367 [info ] [MainThread]: 
[0m16:54:59.476363 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m16:54:59.488449 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m16:54:59.536166 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m16:54:59.570587 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:54:59.575068 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:55:00.206241 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m16:55:00.210446 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m16:55:00.212868 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m16:55:00.230585 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m16:55:00.434800 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__mart)
[0m16:55:00.436326 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__clean)
[0m16:55:00.457551 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__mart: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list__mart"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'mart'
      

  ...
[0m16:55:00.464831 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list__clean"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'clean'
      

  ...
[0m16:55:00.476304 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m16:55:00.480483 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m16:55:00.484412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6604c90a-9372-499a-9302-1b36ee427efc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b297d51d880>]}
[0m16:55:00.486338 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m16:55:00.531803 [info ] [MainThread]: 
[0m16:55:00.558353 [debug] [Thread-1  ]: Began running node model.ex_01_mpg.mpg_standardized
[0m16:55:00.560177 [info ] [Thread-1  ]: 1 of 2 START sql table model `clean`.`mpg_standardized` ........................ [RUN]
[0m16:55:00.561138 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list__mart, now model.ex_01_mpg.mpg_standardized)
[0m16:55:00.561839 [debug] [Thread-1  ]: Began compiling node model.ex_01_mpg.mpg_standardized
[0m16:55:00.578873 [debug] [Thread-1  ]: Writing injected SQL for node "model.ex_01_mpg.mpg_standardized"
[0m16:55:00.580026 [debug] [Thread-1  ]: Began executing node model.ex_01_mpg.mpg_standardized
[0m16:55:00.678593 [debug] [Thread-1  ]: Creating new relation mpg_standardized
[0m16:55:00.855097 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.mpg_standardized"} */

            

    
        create table `clean`.`mpg_standardized`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

select
  CAST(nullIf(CAST(mpg          AS String), '?') AS Float64) as mpg,
  CAST(nullIf(CAST(cylinders    AS String), '?') AS Int64)   as cylinders,
  CAST(nullIf(CAST(displacement AS String), '?') AS Float64) as displacement,
  CAST(nullIf(CAST(horsepower   AS String), '?') AS Float64) as horsepower,
  CAST(nullIf(CAST(weight       AS String), '?') AS Int64)   as weight,
  CAST(nullIf(CAST(acceleration AS String), '?') AS Float64) as acceleration,
  CAST(nullIf(CAST(model_year   AS String), '?') AS Int64)   as model_year,
  CAST(origin AS String) as origin,
  CAST(name   AS String) as make
from `raw`.`autompg___cars`
          )
        
        ...
[0m16:55:00.874905 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m16:55:00.891003 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.mpg_standardized"} */

    select name, type from system.columns where table = 'mpg_standardized'
    
      and database = 'clean'
    
    order by position
  ...
[0m16:55:00.895910 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m16:55:00.934309 [debug] [Thread-1  ]: Writing runtime sql for node "model.ex_01_mpg.mpg_standardized"
[0m16:55:00.935747 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.mpg_standardized"} */

  
    
    
    
        
         


        insert into `clean`.`mpg_standardized`
        ("mpg", "cylinders", "displacement", "horsepower", "weight", "acceleration", "model_year", "origin", "make")

select
  CAST(nullIf(CAST(mpg          AS String), '?') AS Float64) as mpg,
  CAST(nullIf(CAST(cylinders    AS String), '?') AS Int64)   as cylinders,
  CAST(nullIf(CAST(displacement AS String), '?') AS Float64) as displacement,
  CAST(nullIf(CAST(horsepower   AS String), '?') AS Float64) as horsepower,
  CAST(nullIf(CAST(weight       AS String), '?') AS Int64)   as weight,
  CAST(nullIf(CAST(acceleration AS String), '?') AS Float64) as acceleration,
  CAST(nullIf(CAST(model_year   AS String), '?') AS Int64)   as model_year,
  CAST(origin AS String) as origin,
  CAST(name   AS String) as make
from `raw`.`autompg___cars`
  ...
[0m16:55:00.951387 [debug] [Thread-1  ]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.mpg_standardized"} */

  
    
    
    
        
         


        insert into `clean`.`mpg_standardized`
        ("mpg", "cylinders", "displacement", "horsepower", "weight", "acceleration", "model_year", "origin", "make")

select
  CAST(nullIf(CAST(mpg          AS String), '?') AS Float64) as mpg,
  CAST(nullIf(CAST(cylinders    AS String), '?') AS Int64)   as cylinders,
  CAST(nullIf(CAST(displacement AS String), '?') AS Float64) as displacement,
  CAST(nullIf(CAST(horsepower   AS String), '?') AS Float64) as horsepower,
  CAST(nullIf(CAST(weight       AS String), '?') AS Int64)   as weight,
  CAST(nullIf(CAST(acceleration AS String), '?') AS Float64) as acceleration,
  CAST(nullIf(CAST(model_year   AS String), '?') AS Int64)   as model_year,
  CAST(origin AS String) as origin,
  CAST(name   AS String) as make
from `raw`.`autompg___cars`
  
[0m16:55:00.954788 [debug] [Thread-1  ]: Database Error in model mpg_standardized (models/clean/mpg_standardized.sql)
  HTTPDriver for http://clickhouse:8123 received ClickHouse error code 349
   Code: 349. DB::Exception: Cannot convert NULL value to non-Nullable type: while executing 'FUNCTION CAST(horsepower :: 3, 'String' : 9) -> CAST(horsepower, 'String') String : 2'. (CANNOT_INSERT_NULL_IN_ORDINARY_COLUMN) (version 23.12.6.19 (official build))
  compiled code at target/run/ex_01_mpg/models/clean/mpg_standardized.sql
[0m16:55:00.957337 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6604c90a-9372-499a-9302-1b36ee427efc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b297f9e3490>]}
[0m16:55:00.958508 [error] [Thread-1  ]: 1 of 2 ERROR creating sql table model `clean`.`mpg_standardized` ............... [[31mERROR[0m in 0.39s]
[0m16:55:00.959873 [debug] [Thread-1  ]: Finished running node model.ex_01_mpg.mpg_standardized
[0m16:55:00.961401 [debug] [Thread-3  ]: Began running node model.ex_01_mpg.cylinders_by_origin
[0m16:55:00.962284 [info ] [Thread-3  ]: 2 of 2 SKIP relation mart.cylinders_by_origin .................................. [[33mSKIP[0m]
[0m16:55:00.963346 [debug] [Thread-3  ]: Finished running node model.ex_01_mpg.cylinders_by_origin
[0m16:55:00.965196 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:55:00.965911 [debug] [MainThread]: Connection 'model.ex_01_mpg.mpg_standardized' was left open.
[0m16:55:00.966457 [debug] [MainThread]: On model.ex_01_mpg.mpg_standardized: Close
[0m16:55:00.966963 [debug] [MainThread]: Connection 'list__clean' was left open.
[0m16:55:00.967451 [debug] [MainThread]: On list__clean: Close
[0m16:55:00.968159 [info ] [MainThread]: 
[0m16:55:00.968877 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 1.49 seconds (1.49s).
[0m16:55:00.970285 [debug] [MainThread]: Command end result
[0m16:55:01.061337 [info ] [MainThread]: 
[0m16:55:01.062320 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:55:01.062967 [info ] [MainThread]: 
[0m16:55:01.063895 [error] [MainThread]:   Database Error in model mpg_standardized (models/clean/mpg_standardized.sql)
  HTTPDriver for http://clickhouse:8123 received ClickHouse error code 349
   Code: 349. DB::Exception: Cannot convert NULL value to non-Nullable type: while executing 'FUNCTION CAST(horsepower :: 3, 'String' : 9) -> CAST(horsepower, 'String') String : 2'. (CANNOT_INSERT_NULL_IN_ORDINARY_COLUMN) (version 23.12.6.19 (official build))
  compiled code at target/run/ex_01_mpg/models/clean/mpg_standardized.sql
[0m16:55:01.064585 [info ] [MainThread]: 
[0m16:55:01.065229 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m16:55:01.066592 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 4.600109, "process_in_blocks": "0", "process_kernel_time": 0.580871, "process_mem_max_rss": "114416", "process_out_blocks": "10464", "process_user_time": 5.042442}
[0m16:55:01.067406 [debug] [MainThread]: Command `dbt build` failed at 16:55:01.067210 after 4.60 seconds
[0m16:55:01.068124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2981b40310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b297da5aa60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b297dee1f70>]}
[0m16:55:01.068852 [debug] [MainThread]: Flushing usage events
[0m16:57:36.797025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76551d1ff310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x765519e62a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x765519e62940>]}


============================== 16:57:36.806578 | 608108d3-2acc-43bc-afdd-e5ef3386dbb8 ==============================
[0m16:57:36.806578 [info ] [MainThread]: Running with dbt=1.8.9
[0m16:57:36.807724 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'profiles_dir': '.', 'indirect_selection': 'eager', 'partial_parse': 'True', 'use_colors': 'True', 'static_parser': 'True', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'debug': 'False', 'invocation_command': 'dbt build --profiles-dir . --target local', 'printer_width': '80', 'log_format': 'default', 'cache_selected_only': 'False', 'warn_error': 'None', 'use_experimental_parser': 'False', 'target_path': 'None', 'log_path': '/workdir/transforms/01_mpg/logs', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'write_json': 'True', 'empty': 'False', 'quiet': 'False', 'fail_fast': 'False', 'log_cache_events': 'False'}
[0m16:57:37.389971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '608108d3-2acc-43bc-afdd-e5ef3386dbb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x765519d64a30>]}
[0m16:57:37.587252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '608108d3-2acc-43bc-afdd-e5ef3386dbb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76551a2b3250>]}
[0m16:57:37.588573 [info ] [MainThread]: Registered adapter: clickhouse=1.8.6
[0m16:57:38.003424 [debug] [MainThread]: checksum: 134c0f7b96382cc6938697739bc32fb1adc530b177e30f60cebddf61dbd7e979, vars: {}, profile: , target: local, version: 1.8.9
[0m16:57:38.418781 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:57:38.419821 [debug] [MainThread]: Partial parsing: updated file: ex_01_mpg://models/clean/mpg_standardized.sql
[0m16:57:39.289472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '608108d3-2acc-43bc-afdd-e5ef3386dbb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x765519232130>]}
[0m16:57:39.691486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '608108d3-2acc-43bc-afdd-e5ef3386dbb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7655190efe20>]}
[0m16:57:39.692372 [info ] [MainThread]: Found 2 models, 1 source, 471 macros
[0m16:57:39.695054 [info ] [MainThread]: 
[0m16:57:39.696106 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m16:57:39.708224 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m16:57:39.714907 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m16:57:39.729927 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:57:39.733603 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:57:40.267861 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m16:57:40.286275 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m16:57:40.291747 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m16:57:40.298364 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m16:57:40.517639 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__mart)
[0m16:57:40.519452 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__clean)
[0m16:57:40.597065 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__mart: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list__mart"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'mart'
      

  ...
[0m16:57:40.601020 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list__clean"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'clean'
      

  ...
[0m16:57:40.612183 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m16:57:40.614202 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m16:57:40.622372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '608108d3-2acc-43bc-afdd-e5ef3386dbb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7655190afb50>]}
[0m16:57:40.624298 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m16:57:40.625716 [info ] [MainThread]: 
[0m16:57:40.700124 [debug] [Thread-1  ]: Began running node model.ex_01_mpg.mpg_standardized
[0m16:57:40.701340 [info ] [Thread-1  ]: 1 of 2 START sql table model `clean`.`mpg_standardized` ........................ [RUN]
[0m16:57:40.702258 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list__mart, now model.ex_01_mpg.mpg_standardized)
[0m16:57:40.703054 [debug] [Thread-1  ]: Began compiling node model.ex_01_mpg.mpg_standardized
[0m16:57:40.719431 [debug] [Thread-1  ]: Writing injected SQL for node "model.ex_01_mpg.mpg_standardized"
[0m16:57:40.720527 [debug] [Thread-1  ]: Began executing node model.ex_01_mpg.mpg_standardized
[0m16:57:40.992841 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.mpg_standardized"} */

            

    
        create table `clean`.`mpg_standardized__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

-- Source columns are already Nullable with correct types.
-- Keep them as-is to preserve nullability and avoid insert errors.

select
  mpg,            -- Nullable(Float64)
  cylinders,      -- Nullable(Int64)
  displacement,   -- Nullable(Float64)
  horsepower,     -- Nullable(Float64)
  weight,         -- Nullable(Int64)
  acceleration,   -- Nullable(Float64)
  model_year,     -- Nullable(Int64)
  origin,         -- Nullable(String)
  name as make    -- Nullable(String)
from `raw`.`autompg___cars`
          )
        
        ...
[0m16:57:41.013552 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m16:57:41.029376 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.mpg_standardized"} */

    select name, type from system.columns where table = 'mpg_standardized__dbt_backup'
    
      and database = 'clean'
    
    order by position
  ...
[0m16:57:41.035628 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m16:57:41.041732 [debug] [Thread-1  ]: Writing runtime sql for node "model.ex_01_mpg.mpg_standardized"
[0m16:57:41.042913 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.mpg_standardized"} */

  
    
    
    
        
         


        insert into `clean`.`mpg_standardized__dbt_backup`
        ("mpg", "cylinders", "displacement", "horsepower", "weight", "acceleration", "model_year", "origin", "make")

-- Source columns are already Nullable with correct types.
-- Keep them as-is to preserve nullability and avoid insert errors.

select
  mpg,            -- Nullable(Float64)
  cylinders,      -- Nullable(Int64)
  displacement,   -- Nullable(Float64)
  horsepower,     -- Nullable(Float64)
  weight,         -- Nullable(Int64)
  acceleration,   -- Nullable(Float64)
  model_year,     -- Nullable(Int64)
  origin,         -- Nullable(String)
  name as make    -- Nullable(String)
from `raw`.`autompg___cars`
  ...
[0m16:57:41.050746 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m16:57:41.059115 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.mpg_standardized"} */
EXCHANGE TABLES `clean`.`mpg_standardized__dbt_backup` AND `clean`.`mpg_standardized` 
  
  ...
[0m16:57:41.085324 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m16:57:41.130224 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.mpg_standardized"} */

    drop table if exists `clean`.`mpg_standardized__dbt_backup` 
  ...
[0m16:57:41.134248 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m16:57:41.190003 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '608108d3-2acc-43bc-afdd-e5ef3386dbb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x765518cc7790>]}
[0m16:57:41.191267 [info ] [Thread-1  ]: 1 of 2 OK created sql table model `clean`.`mpg_standardized` ................... [[32mOK[0m in 0.49s]
[0m16:57:41.192694 [debug] [Thread-1  ]: Finished running node model.ex_01_mpg.mpg_standardized
[0m16:57:41.194806 [debug] [Thread-3  ]: Began running node model.ex_01_mpg.cylinders_by_origin
[0m16:57:41.196244 [info ] [Thread-3  ]: 2 of 2 START sql view model `mart`.`cylinders_by_origin` ....................... [RUN]
[0m16:57:41.197889 [debug] [Thread-3  ]: Acquiring new clickhouse connection 'model.ex_01_mpg.cylinders_by_origin'
[0m16:57:41.198991 [debug] [Thread-3  ]: Began compiling node model.ex_01_mpg.cylinders_by_origin
[0m16:57:41.207090 [debug] [Thread-3  ]: Writing injected SQL for node "model.ex_01_mpg.cylinders_by_origin"
[0m16:57:41.208468 [debug] [Thread-3  ]: Began executing node model.ex_01_mpg.cylinders_by_origin
[0m16:57:41.301457 [debug] [Thread-3  ]: Creating new relation cylinders_by_origin
[0m16:57:41.322908 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m16:57:41.430198 [debug] [Thread-3  ]: Writing runtime sql for node "model.ex_01_mpg.cylinders_by_origin"
[0m16:57:41.431831 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */


  create view `mart`.`cylinders_by_origin` 
  
    
    
  as (
    

select
  origin,
  avg(cylinders) as avg_cylinders,
  count()        as n
from `clean`.`mpg_standardized`
group by origin
    
  )
      
      
                    -- end_of_sql
                    
                    ...
[0m16:57:41.443061 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m16:57:41.449477 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '608108d3-2acc-43bc-afdd-e5ef3386dbb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x765518cc7df0>]}
[0m16:57:41.452227 [info ] [Thread-3  ]: 2 of 2 OK created sql view model `mart`.`cylinders_by_origin` .................. [[32mOK[0m in 0.25s]
[0m16:57:41.454901 [debug] [Thread-3  ]: Finished running node model.ex_01_mpg.cylinders_by_origin
[0m16:57:41.458618 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:57:41.459428 [debug] [MainThread]: Connection 'model.ex_01_mpg.mpg_standardized' was left open.
[0m16:57:41.460268 [debug] [MainThread]: On model.ex_01_mpg.mpg_standardized: Close
[0m16:57:41.461119 [debug] [MainThread]: Connection 'list__clean' was left open.
[0m16:57:41.462136 [debug] [MainThread]: On list__clean: Close
[0m16:57:41.463684 [debug] [MainThread]: Connection 'model.ex_01_mpg.cylinders_by_origin' was left open.
[0m16:57:41.464432 [debug] [MainThread]: On model.ex_01_mpg.cylinders_by_origin: Close
[0m16:57:41.465754 [info ] [MainThread]: 
[0m16:57:41.466494 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 1.77 seconds (1.77s).
[0m16:57:41.468456 [debug] [MainThread]: Command end result
[0m16:57:41.620338 [info ] [MainThread]: 
[0m16:57:41.621907 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:57:41.623023 [info ] [MainThread]: 
[0m16:57:41.624279 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m16:57:41.626700 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 5.0217857, "process_in_blocks": "0", "process_kernel_time": 0.598008, "process_mem_max_rss": "114268", "process_out_blocks": "10480", "process_user_time": 5.281254}
[0m16:57:41.628002 [debug] [MainThread]: Command `dbt build` succeeded at 16:57:41.627678 after 5.02 seconds
[0m16:57:41.629083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76551d1ff310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x765519e173a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x765519e17700>]}
[0m16:57:41.630090 [debug] [MainThread]: Flushing usage events
[0m10:29:24.564673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74315181b310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74314e478a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74314e478940>]}


============================== 10:29:24.617579 | 137ce063-02c1-488c-8a25-e2b3b0384657 ==============================
[0m10:29:24.617579 [info ] [MainThread]: Running with dbt=1.8.9
[0m10:29:24.619237 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt build --profiles-dir . --target local', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'log_format': 'default', 'use_experimental_parser': 'False', 'version_check': 'True', 'indirect_selection': 'eager', 'printer_width': '80', 'no_print': 'None', 'log_path': '/workdir/transforms/01_mpg/logs', 'log_cache_events': 'False', 'profiles_dir': '.', 'fail_fast': 'False', 'quiet': 'False', 'use_colors': 'True', 'cache_selected_only': 'False', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'debug': 'False', 'empty': 'False'}
[0m10:29:25.263834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '137ce063-02c1-488c-8a25-e2b3b0384657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x743150dc4fd0>]}
[0m10:29:25.535000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '137ce063-02c1-488c-8a25-e2b3b0384657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74314ef5d430>]}
[0m10:29:25.536543 [info ] [MainThread]: Registered adapter: clickhouse=1.8.6
[0m10:29:26.053557 [debug] [MainThread]: checksum: 134c0f7b96382cc6938697739bc32fb1adc530b177e30f60cebddf61dbd7e979, vars: {}, profile: , target: local, version: 1.8.9
[0m10:29:26.503430 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:29:26.504081 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:29:26.638141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '137ce063-02c1-488c-8a25-e2b3b0384657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74314dcfbe20>]}
[0m10:29:27.236372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '137ce063-02c1-488c-8a25-e2b3b0384657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74314dc07c10>]}
[0m10:29:27.237525 [info ] [MainThread]: Found 2 models, 1 source, 471 macros
[0m10:29:27.241126 [info ] [MainThread]: 
[0m10:29:27.242487 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m10:29:27.258632 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m10:29:27.259967 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m10:29:27.331584 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:29:27.335457 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:29:27.895496 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m10:29:27.904636 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m10:29:27.906994 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m10:29:27.925123 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m10:29:28.026156 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__mart)
[0m10:29:28.028917 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__clean)
[0m10:29:28.050596 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__mart: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list__mart"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'mart'
      

  ...
[0m10:29:28.057142 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list__clean"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'clean'
      

  ...
[0m10:29:28.068607 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m10:29:28.070403 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m10:29:28.145806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '137ce063-02c1-488c-8a25-e2b3b0384657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74314db94670>]}
[0m10:29:28.147767 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m10:29:28.149274 [info ] [MainThread]: 
[0m10:29:28.229178 [debug] [Thread-1  ]: Began running node model.ex_01_mpg.mpg_standardized
[0m10:29:28.230775 [info ] [Thread-1  ]: 1 of 2 START sql table model `clean`.`mpg_standardized` ........................ [RUN]
[0m10:29:28.232197 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.ex_01_mpg.mpg_standardized'
[0m10:29:28.233234 [debug] [Thread-1  ]: Began compiling node model.ex_01_mpg.mpg_standardized
[0m10:29:28.253982 [debug] [Thread-1  ]: Writing injected SQL for node "model.ex_01_mpg.mpg_standardized"
[0m10:29:28.255206 [debug] [Thread-1  ]: Began executing node model.ex_01_mpg.mpg_standardized
[0m10:29:28.527454 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m10:29:28.604195 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.mpg_standardized"} */

            

    
        create table `clean`.`mpg_standardized__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

-- Source columns are already Nullable with correct types.
-- Keep them as-is to preserve nullability and avoid insert errors.

select
  mpg,            -- Nullable(Float64)
  cylinders,      -- Nullable(Int64)
  displacement,   -- Nullable(Float64)
  horsepower,     -- Nullable(Float64)
  weight,         -- Nullable(Int64)
  acceleration,   -- Nullable(Float64)
  model_year,     -- Nullable(Int64)
  origin,         -- Nullable(String)
  name as make    -- Nullable(String)
from `raw`.`autompg___cars`
          )
        
        ...
[0m10:29:28.628530 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m10:29:28.652375 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.mpg_standardized"} */

    select name, type from system.columns where table = 'mpg_standardized__dbt_backup'
    
      and database = 'clean'
    
    order by position
  ...
[0m10:29:28.657950 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m10:29:28.664817 [debug] [Thread-1  ]: Writing runtime sql for node "model.ex_01_mpg.mpg_standardized"
[0m10:29:28.666200 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.mpg_standardized"} */

  
    
    
    
        
         


        insert into `clean`.`mpg_standardized__dbt_backup`
        ("mpg", "cylinders", "displacement", "horsepower", "weight", "acceleration", "model_year", "origin", "make")

-- Source columns are already Nullable with correct types.
-- Keep them as-is to preserve nullability and avoid insert errors.

select
  mpg,            -- Nullable(Float64)
  cylinders,      -- Nullable(Int64)
  displacement,   -- Nullable(Float64)
  horsepower,     -- Nullable(Float64)
  weight,         -- Nullable(Int64)
  acceleration,   -- Nullable(Float64)
  model_year,     -- Nullable(Int64)
  origin,         -- Nullable(String)
  name as make    -- Nullable(String)
from `raw`.`autompg___cars`
  ...
[0m10:29:28.672603 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m10:29:28.681769 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.mpg_standardized"} */
EXCHANGE TABLES `clean`.`mpg_standardized__dbt_backup` AND `clean`.`mpg_standardized` 
  
  ...
[0m10:29:28.685017 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m10:29:28.957349 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.mpg_standardized"} */

    drop table if exists `clean`.`mpg_standardized__dbt_backup` 
  ...
[0m10:29:28.960829 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m10:29:28.967306 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '137ce063-02c1-488c-8a25-e2b3b0384657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x743150dbc820>]}
[0m10:29:28.968682 [info ] [Thread-1  ]: 1 of 2 OK created sql table model `clean`.`mpg_standardized` ................... [[32mOK[0m in 0.73s]
[0m10:29:28.970114 [debug] [Thread-1  ]: Finished running node model.ex_01_mpg.mpg_standardized
[0m10:29:28.971764 [debug] [Thread-3  ]: Began running node model.ex_01_mpg.cylinders_by_origin
[0m10:29:28.972903 [info ] [Thread-3  ]: 2 of 2 START sql view model `mart`.`cylinders_by_origin` ....................... [RUN]
[0m10:29:28.974171 [debug] [Thread-3  ]: Acquiring new clickhouse connection 'model.ex_01_mpg.cylinders_by_origin'
[0m10:29:28.975077 [debug] [Thread-3  ]: Began compiling node model.ex_01_mpg.cylinders_by_origin
[0m10:29:29.030778 [debug] [Thread-3  ]: Writing injected SQL for node "model.ex_01_mpg.cylinders_by_origin"
[0m10:29:29.032044 [debug] [Thread-3  ]: Began executing node model.ex_01_mpg.cylinders_by_origin
[0m10:29:29.135906 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m10:29:29.197873 [debug] [Thread-3  ]: Writing runtime sql for node "model.ex_01_mpg.cylinders_by_origin"
[0m10:29:29.199401 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */


  create view `mart`.`cylinders_by_origin__dbt_tmp` 
  
    
    
  as (
    

select
  origin,
  avg(cylinders) as avg_cylinders,
  count()        as n
from `clean`.`mpg_standardized`
group by origin
    
  )
      
      
                    -- end_of_sql
                    
                    ...
[0m10:29:29.215186 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m10:29:29.228341 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */

    drop table if exists `mart`.`cylinders_by_origin__dbt_backup` 
  
  ...
[0m10:29:29.231358 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m10:29:29.233483 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */

    rename table `mart`.`cylinders_by_origin` to `mart`.`cylinders_by_origin__dbt_backup` 
  
  ...
[0m10:29:29.236302 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m10:29:29.243066 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */

    drop table if exists `mart`.`cylinders_by_origin` 
  
  ...
[0m10:29:29.245897 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m10:29:29.247842 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */

    rename table `mart`.`cylinders_by_origin__dbt_tmp` to `mart`.`cylinders_by_origin` 
  
  ...
[0m10:29:29.250578 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m10:29:29.257266 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */

    drop table if exists `mart`.`cylinders_by_origin__dbt_backup` 
  ...
[0m10:29:29.260202 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m10:29:29.262714 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '137ce063-02c1-488c-8a25-e2b3b0384657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74314ced2640>]}
[0m10:29:29.263838 [info ] [Thread-3  ]: 2 of 2 OK created sql view model `mart`.`cylinders_by_origin` .................. [[32mOK[0m in 0.29s]
[0m10:29:29.265176 [debug] [Thread-3  ]: Finished running node model.ex_01_mpg.cylinders_by_origin
[0m10:29:29.267122 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:29:29.267681 [debug] [MainThread]: Connection 'list__mart' was left open.
[0m10:29:29.268200 [debug] [MainThread]: On list__mart: Close
[0m10:29:29.268706 [debug] [MainThread]: Connection 'list__clean' was left open.
[0m10:29:29.269191 [debug] [MainThread]: On list__clean: Close
[0m10:29:29.269679 [debug] [MainThread]: Connection 'model.ex_01_mpg.mpg_standardized' was left open.
[0m10:29:29.270248 [debug] [MainThread]: On model.ex_01_mpg.mpg_standardized: Close
[0m10:29:29.270740 [debug] [MainThread]: Connection 'model.ex_01_mpg.cylinders_by_origin' was left open.
[0m10:29:29.271221 [debug] [MainThread]: On model.ex_01_mpg.cylinders_by_origin: Close
[0m10:29:29.272098 [info ] [MainThread]: 
[0m10:29:29.272786 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 2.03 seconds (2.03s).
[0m10:29:29.274554 [debug] [MainThread]: Command end result
[0m10:29:29.429607 [info ] [MainThread]: 
[0m10:29:29.430586 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:29:29.431269 [info ] [MainThread]: 
[0m10:29:29.431933 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m10:29:29.433327 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 5.0828104, "process_in_blocks": "1320", "process_kernel_time": 0.638786, "process_mem_max_rss": "111484", "process_out_blocks": "9504", "process_user_time": 5.238449}
[0m10:29:29.434152 [debug] [MainThread]: Command `dbt build` succeeded at 10:29:29.433938 after 5.08 seconds
[0m10:29:29.434858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74315181b310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74314f740f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x743150dc4fd0>]}
[0m10:29:29.435469 [debug] [MainThread]: Flushing usage events
[0m15:01:30.514366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7206f9f310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7203c00af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7203c009a0>]}


============================== 15:01:30.528193 | b64af2e6-6073-423f-8244-cf943957cb90 ==============================
[0m15:01:30.528193 [info ] [MainThread]: Running with dbt=1.8.9
[0m15:01:30.542430 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'profiles_dir': '.', 'introspect': 'True', 'static_parser': 'True', 'version_check': 'True', 'fail_fast': 'False', 'invocation_command': 'dbt build --profiles-dir . --target local', 'log_format': 'default', 'partial_parse': 'True', 'warn_error': 'None', 'log_cache_events': 'False', 'use_colors': 'True', 'printer_width': '80', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'log_path': '/workdir/transforms/01_mpg/logs', 'target_path': 'None'}
[0m15:01:30.929773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b64af2e6-6073-423f-8244-cf943957cb90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7206549fd0>]}
[0m15:01:31.053484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b64af2e6-6073-423f-8244-cf943957cb90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7203bcabe0>]}
[0m15:01:31.055664 [info ] [MainThread]: Registered adapter: clickhouse=1.8.6
[0m15:01:31.287176 [debug] [MainThread]: checksum: 134c0f7b96382cc6938697739bc32fb1adc530b177e30f60cebddf61dbd7e979, vars: {}, profile: , target: local, version: 1.8.9
[0m15:01:31.694999 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:01:31.696125 [debug] [MainThread]: Partial parsing: updated file: ex_01_mpg://models/clean/mpg_standardized.sql
[0m15:01:32.295846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b64af2e6-6073-423f-8244-cf943957cb90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72021ab130>]}
[0m15:01:32.633552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b64af2e6-6073-423f-8244-cf943957cb90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f720206eaf0>]}
[0m15:01:32.635037 [info ] [MainThread]: Found 2 models, 1 source, 471 macros
[0m15:01:32.639409 [info ] [MainThread]: 
[0m15:01:32.641223 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m15:01:32.660219 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m15:01:32.661350 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m15:01:32.697984 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:01:32.702405 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:01:33.155068 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m15:01:33.158208 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m15:01:33.162209 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m15:01:33.166021 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m15:01:33.304078 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__mart)
[0m15:01:33.305354 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__clean)
[0m15:01:33.322650 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__mart: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list__mart"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'mart'
      

  ...
[0m15:01:33.328209 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list__clean"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'clean'
      

  ...
[0m15:01:33.338105 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m15:01:33.339870 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m15:01:33.364451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b64af2e6-6073-423f-8244-cf943957cb90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7201bb1bb0>]}
[0m15:01:33.366209 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m15:01:33.367473 [info ] [MainThread]: 
[0m15:01:33.382924 [debug] [Thread-1  ]: Began running node model.ex_01_mpg.mpg_standardized
[0m15:01:33.384063 [info ] [Thread-1  ]: 1 of 2 START sql table model `clean`.`mpg_standardized` ........................ [RUN]
[0m15:01:33.384987 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list__mart, now model.ex_01_mpg.mpg_standardized)
[0m15:01:33.385703 [debug] [Thread-1  ]: Began compiling node model.ex_01_mpg.mpg_standardized
[0m15:01:33.401921 [debug] [Thread-1  ]: Writing injected SQL for node "model.ex_01_mpg.mpg_standardized"
[0m15:01:33.416144 [debug] [Thread-1  ]: Began executing node model.ex_01_mpg.mpg_standardized
[0m15:01:33.568333 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.mpg_standardized"} */

            

    
        create table `clean`.`mpg_standardized__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

-- Source columns are already Nullable with correct types.
-- Keep them as-is to preserve nullability and avoid insert errors.

select
  nullif(mpg, '?')::Float64           as mpg,
  nullif(cylinders, '?')::Int64       as cylinders,
  nullif(displacement, '?')::Float64  as displacement,
  nullif(horsepower, '?')::Float64    as horsepower,
  nullif(weight, '?')::Int64          as weight,
  nullif(acceleration, '?')::Float64  as acceleration,
  nullif(model_year, '?')::Int64      as model_year,
  nullif(origin, '?')::String         as origin,
  nullif(name, '?')::String           as make
from `raw`.`autompg___cars`
          )
        
        ...
[0m15:01:33.613285 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m15:01:33.643462 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.mpg_standardized"} */

    select name, type from system.columns where table = 'mpg_standardized__dbt_backup'
    
      and database = 'clean'
    
    order by position
  ...
[0m15:01:33.656208 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m15:01:33.666040 [debug] [Thread-1  ]: Writing runtime sql for node "model.ex_01_mpg.mpg_standardized"
[0m15:01:33.667656 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.mpg_standardized"} */

  
    
    
    
        
         


        insert into `clean`.`mpg_standardized__dbt_backup`
        ("mpg", "cylinders", "displacement", "horsepower", "weight", "acceleration", "model_year", "origin", "make")

-- Source columns are already Nullable with correct types.
-- Keep them as-is to preserve nullability and avoid insert errors.

select
  nullif(mpg, '?')::Float64           as mpg,
  nullif(cylinders, '?')::Int64       as cylinders,
  nullif(displacement, '?')::Float64  as displacement,
  nullif(horsepower, '?')::Float64    as horsepower,
  nullif(weight, '?')::Int64          as weight,
  nullif(acceleration, '?')::Float64  as acceleration,
  nullif(model_year, '?')::Int64      as model_year,
  nullif(origin, '?')::String         as origin,
  nullif(name, '?')::String           as make
from `raw`.`autompg___cars`
  ...
[0m15:01:33.742226 [debug] [Thread-1  ]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.mpg_standardized"} */

  
    
    
    
        
         


        insert into `clean`.`mpg_standardized__dbt_backup`
        ("mpg", "cylinders", "displacement", "horsepower", "weight", "acceleration", "model_year", "origin", "make")

-- Source columns are already Nullable with correct types.
-- Keep them as-is to preserve nullability and avoid insert errors.

select
  nullif(mpg, '?')::Float64           as mpg,
  nullif(cylinders, '?')::Int64       as cylinders,
  nullif(displacement, '?')::Float64  as displacement,
  nullif(horsepower, '?')::Float64    as horsepower,
  nullif(weight, '?')::Int64          as weight,
  nullif(acceleration, '?')::Float64  as acceleration,
  nullif(model_year, '?')::Int64      as model_year,
  nullif(origin, '?')::String         as origin,
  nullif(name, '?')::String           as make
from `raw`.`autompg___cars`
  
[0m15:01:33.755835 [debug] [Thread-1  ]: Database Error in model mpg_standardized (models/clean/mpg_standardized.sql)
  HTTPDriver for http://clickhouse:8123 received ClickHouse error code 53
   Code: 53. DB::Exception: Cannot convert string ? to type Float64. (TYPE_MISMATCH) (version 23.12.6.19 (official build))
  compiled code at target/run/ex_01_mpg/models/clean/mpg_standardized.sql
[0m15:01:33.759165 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b64af2e6-6073-423f-8244-cf943957cb90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7203911580>]}
[0m15:01:33.760625 [error] [Thread-1  ]: 1 of 2 ERROR creating sql table model `clean`.`mpg_standardized` ............... [[31mERROR[0m in 0.37s]
[0m15:01:33.762850 [debug] [Thread-1  ]: Finished running node model.ex_01_mpg.mpg_standardized
[0m15:01:33.765145 [debug] [Thread-3  ]: Began running node model.ex_01_mpg.cylinders_by_origin
[0m15:01:33.766368 [info ] [Thread-3  ]: 2 of 2 SKIP relation mart.cylinders_by_origin .................................. [[33mSKIP[0m]
[0m15:01:33.768219 [debug] [Thread-3  ]: Finished running node model.ex_01_mpg.cylinders_by_origin
[0m15:01:33.771244 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:01:33.772287 [debug] [MainThread]: Connection 'model.ex_01_mpg.mpg_standardized' was left open.
[0m15:01:33.773262 [debug] [MainThread]: On model.ex_01_mpg.mpg_standardized: Close
[0m15:01:33.774190 [debug] [MainThread]: Connection 'list__clean' was left open.
[0m15:01:33.775164 [debug] [MainThread]: On list__clean: Close
[0m15:01:33.776609 [info ] [MainThread]: 
[0m15:01:33.777956 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 1.14 seconds (1.14s).
[0m15:01:33.781011 [debug] [MainThread]: Command end result
[0m15:01:33.868528 [info ] [MainThread]: 
[0m15:01:33.869929 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:01:33.871020 [info ] [MainThread]: 
[0m15:01:33.872406 [error] [MainThread]:   Database Error in model mpg_standardized (models/clean/mpg_standardized.sql)
  HTTPDriver for http://clickhouse:8123 received ClickHouse error code 53
   Code: 53. DB::Exception: Cannot convert string ? to type Float64. (TYPE_MISMATCH) (version 23.12.6.19 (official build))
  compiled code at target/run/ex_01_mpg/models/clean/mpg_standardized.sql
[0m15:01:33.873474 [info ] [MainThread]: 
[0m15:01:33.874501 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m15:01:33.877516 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 3.5232182, "process_in_blocks": "73712", "process_kernel_time": 0.928247, "process_mem_max_rss": "113716", "process_out_blocks": "10472", "process_user_time": 6.787495}
[0m15:01:33.878825 [debug] [MainThread]: Command `dbt build` failed at 15:01:33.878525 after 3.52 seconds
[0m15:01:33.879862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7206f9f310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7203cf53d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7201fe4d30>]}
[0m15:01:33.880857 [debug] [MainThread]: Flushing usage events
[0m15:04:39.189319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb41e47b310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb41b0efa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb41b0ef940>]}


============================== 15:04:39.199820 | 22a4ac5c-0807-4463-a29e-9eb825d0ad9f ==============================
[0m15:04:39.199820 [info ] [MainThread]: Running with dbt=1.8.9
[0m15:04:39.200938 [debug] [MainThread]: running dbt with arguments {'empty': 'False', 'debug': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'introspect': 'True', 'indirect_selection': 'eager', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'printer_width': '80', 'version_check': 'True', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'target_path': 'None', 'log_format': 'default', 'profiles_dir': '.', 'log_path': '/workdir/transforms/01_mpg/logs', 'static_parser': 'True', 'use_colors': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'no_print': 'None', 'invocation_command': 'dbt build --profiles-dir . --target local'}
[0m15:04:39.614140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '22a4ac5c-0807-4463-a29e-9eb825d0ad9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb41da20fd0>]}
[0m15:04:39.767070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '22a4ac5c-0807-4463-a29e-9eb825d0ad9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb41c3f6730>]}
[0m15:04:39.769190 [info ] [MainThread]: Registered adapter: clickhouse=1.8.6
[0m15:04:40.074617 [debug] [MainThread]: checksum: 134c0f7b96382cc6938697739bc32fb1adc530b177e30f60cebddf61dbd7e979, vars: {}, profile: , target: local, version: 1.8.9
[0m15:04:40.412866 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m15:04:40.413951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '22a4ac5c-0807-4463-a29e-9eb825d0ad9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb41c40f760>]}
[0m15:04:44.332900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '22a4ac5c-0807-4463-a29e-9eb825d0ad9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb41958a130>]}
[0m15:04:44.672896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '22a4ac5c-0807-4463-a29e-9eb825d0ad9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb419624730>]}
[0m15:04:44.674161 [info ] [MainThread]: Found 2 models, 1 source, 471 macros
[0m15:04:44.678040 [info ] [MainThread]: 
[0m15:04:44.679849 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m15:04:44.693948 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m15:04:44.695054 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m15:04:44.726033 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:04:44.741968 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:04:48.214340 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m15:04:48.355690 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m15:04:48.459108 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.24 seconds
[0m15:04:48.597162 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.24 seconds
[0m15:04:48.600587 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__clean)
[0m15:04:48.601574 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__mart)
[0m15:04:48.617216 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list__clean"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'clean'
      

  ...
[0m15:04:48.625407 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__mart: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list__mart"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'mart'
      

  ...
[0m15:04:48.865205 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.24 seconds
[0m15:04:48.873793 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.24 seconds
[0m15:04:48.876438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22a4ac5c-0807-4463-a29e-9eb825d0ad9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb4193b5f70>]}
[0m15:04:48.877921 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m15:04:48.878915 [info ] [MainThread]: 
[0m15:04:48.898553 [debug] [Thread-1  ]: Began running node model.ex_01_mpg.mpg_standardized
[0m15:04:48.899766 [info ] [Thread-1  ]: 1 of 2 START sql table model `clean`.`mpg_standardized` ........................ [RUN]
[0m15:04:48.900914 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.ex_01_mpg.mpg_standardized'
[0m15:04:48.901692 [debug] [Thread-1  ]: Began compiling node model.ex_01_mpg.mpg_standardized
[0m15:04:48.925761 [debug] [Thread-1  ]: Writing injected SQL for node "model.ex_01_mpg.mpg_standardized"
[0m15:04:48.927768 [debug] [Thread-1  ]: Began executing node model.ex_01_mpg.mpg_standardized
[0m15:04:48.985653 [debug] [Thread-1  ]: Creating new relation mpg_standardized
[0m15:04:49.055054 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m15:04:51.772777 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.mpg_standardized"} */

            

    
        create table `clean`.`mpg_standardized`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

-- Source columns are already Nullable with correct types.
-- Keep them as-is to preserve nullability and avoid insert errors.

select
  toFloat64OrNull(mpg)          as mpg,
  toInt64OrNull(cylinders)      as cylinders,
  toFloat64OrNull(displacement) as displacement,
  toFloat64OrNull(horsepower)   as horsepower,
  toInt64OrNull(weight)         as weight,
  toFloat64OrNull(acceleration) as acceleration,
  toInt64OrNull(model_year)     as model_year,
  nullIf(origin, '?')           as origin,
  nullIf(name, '?')             as make
from `raw`.`autompg___cars`
          )
        
        ...
[0m15:04:52.030510 [debug] [Thread-1  ]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.mpg_standardized"} */

            

    
        create table `clean`.`mpg_standardized`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

-- Source columns are already Nullable with correct types.
-- Keep them as-is to preserve nullability and avoid insert errors.

select
  toFloat64OrNull(mpg)          as mpg,
  toInt64OrNull(cylinders)      as cylinders,
  toFloat64OrNull(displacement) as displacement,
  toFloat64OrNull(horsepower)   as horsepower,
  toInt64OrNull(weight)         as weight,
  toFloat64OrNull(acceleration) as acceleration,
  toInt64OrNull(model_year)     as model_year,
  nullIf(origin, '?')           as origin,
  nullIf(name, '?')             as make
from `raw`.`autompg___cars`
          )
        
        
[0m15:04:52.038868 [debug] [Thread-1  ]: Database Error in model mpg_standardized (models/clean/mpg_standardized.sql)
  HTTPDriver for http://54.87.106.52:8123 received ClickHouse error code 60
   Code: 60. DB::Exception: Table raw.autompg___cars does not exist. (UNKNOWN_TABLE) (version 23.12.6.19 (official build))
[0m15:04:52.044225 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22a4ac5c-0807-4463-a29e-9eb825d0ad9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb418738100>]}
[0m15:04:52.046729 [error] [Thread-1  ]: 1 of 2 ERROR creating sql table model `clean`.`mpg_standardized` ............... [[31mERROR[0m in 3.14s]
[0m15:04:52.049778 [debug] [Thread-1  ]: Finished running node model.ex_01_mpg.mpg_standardized
[0m15:04:52.054480 [debug] [Thread-3  ]: Began running node model.ex_01_mpg.cylinders_by_origin
[0m15:04:52.056312 [info ] [Thread-3  ]: 2 of 2 SKIP relation mart.cylinders_by_origin .................................. [[33mSKIP[0m]
[0m15:04:52.057856 [debug] [Thread-3  ]: Finished running node model.ex_01_mpg.cylinders_by_origin
[0m15:04:52.062115 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:04:52.063497 [debug] [MainThread]: Connection 'list__clean' was left open.
[0m15:04:52.064851 [debug] [MainThread]: On list__clean: Close
[0m15:04:52.065751 [debug] [MainThread]: Connection 'list__mart' was left open.
[0m15:04:52.066925 [debug] [MainThread]: On list__mart: Close
[0m15:04:52.068024 [debug] [MainThread]: Connection 'model.ex_01_mpg.mpg_standardized' was left open.
[0m15:04:52.069203 [debug] [MainThread]: On model.ex_01_mpg.mpg_standardized: Close
[0m15:04:52.070609 [info ] [MainThread]: 
[0m15:04:52.071915 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 7.39 seconds (7.39s).
[0m15:04:52.074352 [debug] [MainThread]: Command end result
[0m15:04:52.141814 [info ] [MainThread]: 
[0m15:04:52.142903 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:04:52.143844 [info ] [MainThread]: 
[0m15:04:52.144848 [error] [MainThread]:   Database Error in model mpg_standardized (models/clean/mpg_standardized.sql)
  HTTPDriver for http://54.87.106.52:8123 received ClickHouse error code 60
   Code: 60. DB::Exception: Table raw.autompg___cars does not exist. (UNKNOWN_TABLE) (version 23.12.6.19 (official build))
[0m15:04:52.145703 [info ] [MainThread]: 
[0m15:04:52.146905 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m15:04:52.149220 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 13.082366, "process_in_blocks": "19264", "process_kernel_time": 0.978927, "process_mem_max_rss": "115072", "process_out_blocks": "10464", "process_user_time": 10.204092}
[0m15:04:52.150384 [debug] [MainThread]: Command `dbt build` failed at 15:04:52.150069 after 13.08 seconds
[0m15:04:52.151280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb41e47b310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb41af56340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb41da20fd0>]}
[0m15:04:52.153569 [debug] [MainThread]: Flushing usage events
[0m15:07:30.170737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747459a6b310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7474566d3be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7474566d3a90>]}


============================== 15:07:30.182776 | e4a47e31-46ae-4d76-9945-661ca3b2446e ==============================
[0m15:07:30.182776 [info ] [MainThread]: Running with dbt=1.8.9
[0m15:07:30.184018 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '.', 'partial_parse': 'True', 'write_json': 'True', 'warn_error': 'None', 'printer_width': '80', 'log_format': 'default', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'introspect': 'True', 'quiet': 'False', 'debug': 'False', 'cache_selected_only': 'False', 'use_colors': 'True', 'target_path': 'None', 'version_check': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': '/workdir/transforms/01_mpg/logs', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_cache_events': 'False', 'invocation_command': 'dbt build --profiles-dir . --target local', 'static_parser': 'True'}
[0m15:07:30.578284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e4a47e31-46ae-4d76-9945-661ca3b2446e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747456617490>]}
[0m15:07:30.696197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e4a47e31-46ae-4d76-9945-661ca3b2446e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7474566b0dc0>]}
[0m15:07:30.697710 [info ] [MainThread]: Registered adapter: clickhouse=1.8.6
[0m15:07:30.916014 [debug] [MainThread]: checksum: 134c0f7b96382cc6938697739bc32fb1adc530b177e30f60cebddf61dbd7e979, vars: {}, profile: , target: local, version: 1.8.9
[0m15:07:31.155265 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m15:07:31.156580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e4a47e31-46ae-4d76-9945-661ca3b2446e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7474561559d0>]}
[0m15:07:34.500431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e4a47e31-46ae-4d76-9945-661ca3b2446e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747454b80130>]}
[0m15:07:34.772687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e4a47e31-46ae-4d76-9945-661ca3b2446e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747454a9e1f0>]}
[0m15:07:34.773687 [info ] [MainThread]: Found 2 models, 1 source, 471 macros
[0m15:07:34.777122 [info ] [MainThread]: 
[0m15:07:34.778619 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m15:07:34.796066 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m15:07:34.797154 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m15:07:34.827770 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:07:34.822806 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:07:35.159932 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m15:07:35.164780 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m15:07:35.166273 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m15:07:35.171295 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m15:07:35.203973 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__clean)
[0m15:07:35.205050 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__mart)
[0m15:07:35.221910 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list__clean"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'clean'
      

  ...
[0m15:07:35.227426 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__mart: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list__mart"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'mart'
      

  ...
[0m15:07:35.235356 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m15:07:35.237421 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m15:07:35.256388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e4a47e31-46ae-4d76-9945-661ca3b2446e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74745464ca00>]}
[0m15:07:35.257707 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m15:07:35.258763 [info ] [MainThread]: 
[0m15:07:35.275355 [debug] [Thread-1  ]: Began running node model.ex_01_mpg.mpg_standardized
[0m15:07:35.276642 [info ] [Thread-1  ]: 1 of 2 START sql table model `clean`.`mpg_standardized` ........................ [RUN]
[0m15:07:35.277845 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.ex_01_mpg.mpg_standardized'
[0m15:07:35.278713 [debug] [Thread-1  ]: Began compiling node model.ex_01_mpg.mpg_standardized
[0m15:07:35.299704 [debug] [Thread-1  ]: Writing injected SQL for node "model.ex_01_mpg.mpg_standardized"
[0m15:07:35.301041 [debug] [Thread-1  ]: Began executing node model.ex_01_mpg.mpg_standardized
[0m15:07:35.380315 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m15:07:35.445873 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.mpg_standardized"} */

    drop table if exists `clean`.`mpg_standardized__dbt_backup` 
  ...
[0m15:07:35.450108 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m15:07:35.518761 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.mpg_standardized"} */

            

    
        create table `clean`.`mpg_standardized__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

-- Source columns are already Nullable with correct types.
-- Keep them as-is to preserve nullability and avoid insert errors.

select
  toFloat64OrNull(mpg)          as mpg,
  toInt64OrNull(cylinders)      as cylinders,
  toFloat64OrNull(displacement) as displacement,
  toFloat64OrNull(horsepower)   as horsepower,
  toInt64OrNull(weight)         as weight,
  toFloat64OrNull(acceleration) as acceleration,
  toInt64OrNull(model_year)     as model_year,
  nullIf(origin, '?')           as origin,
  nullIf(name, '?')             as make
from `raw`.`autompg___cars`
          )
        
        ...
[0m15:07:35.548146 [debug] [Thread-1  ]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.mpg_standardized"} */

            

    
        create table `clean`.`mpg_standardized__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

-- Source columns are already Nullable with correct types.
-- Keep them as-is to preserve nullability and avoid insert errors.

select
  toFloat64OrNull(mpg)          as mpg,
  toInt64OrNull(cylinders)      as cylinders,
  toFloat64OrNull(displacement) as displacement,
  toFloat64OrNull(horsepower)   as horsepower,
  toInt64OrNull(weight)         as weight,
  toFloat64OrNull(acceleration) as acceleration,
  toInt64OrNull(model_year)     as model_year,
  nullIf(origin, '?')           as origin,
  nullIf(name, '?')             as make
from `raw`.`autompg___cars`
          )
        
        
[0m15:07:35.553415 [debug] [Thread-1  ]: Database Error in model mpg_standardized (models/clean/mpg_standardized.sql)
  HTTPDriver for http://clickhouse:8123 received ClickHouse error code 43
   Code: 43. DB::Exception: Illegal type Float64 of first argument of function toFloat64OrNull. Conversion functions with postfix 'OrZero' or 'OrNull' should take String argument: While processing toFloat64OrNull(mpg) AS mpg, toInt64OrNull(cylinders) AS cylinders, toFloat64OrNull(displacement) AS displacement, toFloat64OrNull(horsepower) AS horsepower, toInt64OrNull(weight) AS weight, toFloat64OrNull(acceleration) AS acceleration, toInt64OrNull(model_year) AS model_year, nullIf(origin, '?') AS origin, nullIf(name, '?') AS make. (ILLEGAL_TYPE_OF_ARGUMENT) (version 23.12.6.19 (official build))
[0m15:07:35.556777 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4a47e31-46ae-4d76-9945-661ca3b2446e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747454747c70>]}
[0m15:07:35.558750 [error] [Thread-1  ]: 1 of 2 ERROR creating sql table model `clean`.`mpg_standardized` ............... [[31mERROR[0m in 0.28s]
[0m15:07:35.560321 [debug] [Thread-1  ]: Finished running node model.ex_01_mpg.mpg_standardized
[0m15:07:35.562389 [debug] [Thread-3  ]: Began running node model.ex_01_mpg.cylinders_by_origin
[0m15:07:35.563950 [info ] [Thread-3  ]: 2 of 2 SKIP relation mart.cylinders_by_origin .................................. [[33mSKIP[0m]
[0m15:07:35.565562 [debug] [Thread-3  ]: Finished running node model.ex_01_mpg.cylinders_by_origin
[0m15:07:35.567997 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:07:35.568715 [debug] [MainThread]: Connection 'list__clean' was left open.
[0m15:07:35.569300 [debug] [MainThread]: On list__clean: Close
[0m15:07:35.569947 [debug] [MainThread]: Connection 'list__mart' was left open.
[0m15:07:35.570644 [debug] [MainThread]: On list__mart: Close
[0m15:07:35.571499 [debug] [MainThread]: Connection 'model.ex_01_mpg.mpg_standardized' was left open.
[0m15:07:35.572012 [debug] [MainThread]: On model.ex_01_mpg.mpg_standardized: Close
[0m15:07:35.572883 [info ] [MainThread]: 
[0m15:07:35.573661 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.79 seconds (0.79s).
[0m15:07:35.575642 [debug] [MainThread]: Command end result
[0m15:07:35.664739 [info ] [MainThread]: 
[0m15:07:35.666156 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:07:35.667823 [info ] [MainThread]: 
[0m15:07:35.669285 [error] [MainThread]:   Database Error in model mpg_standardized (models/clean/mpg_standardized.sql)
  HTTPDriver for http://clickhouse:8123 received ClickHouse error code 43
   Code: 43. DB::Exception: Illegal type Float64 of first argument of function toFloat64OrNull. Conversion functions with postfix 'OrZero' or 'OrNull' should take String argument: While processing toFloat64OrNull(mpg) AS mpg, toInt64OrNull(cylinders) AS cylinders, toFloat64OrNull(displacement) AS displacement, toFloat64OrNull(horsepower) AS horsepower, toInt64OrNull(weight) AS weight, toFloat64OrNull(acceleration) AS acceleration, toInt64OrNull(model_year) AS model_year, nullIf(origin, '?') AS origin, nullIf(name, '?') AS make. (ILLEGAL_TYPE_OF_ARGUMENT) (version 23.12.6.19 (official build))
[0m15:07:35.670468 [info ] [MainThread]: 
[0m15:07:35.671572 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m15:07:35.673916 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 5.631135, "process_in_blocks": "19128", "process_kernel_time": 0.824312, "process_mem_max_rss": "115384", "process_out_blocks": "10456", "process_user_time": 9.298249}
[0m15:07:35.675339 [debug] [MainThread]: Command `dbt build` failed at 15:07:35.674973 after 5.63 seconds
[0m15:07:35.676482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747459a6b310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747457a08430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747454b1e4c0>]}
[0m15:07:35.677634 [debug] [MainThread]: Flushing usage events
[0m15:09:42.946328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1e57454310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1e540a4a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1e540a4940>]}


============================== 15:09:42.957984 | 13f005ef-bd73-487c-a4e2-121a3ccb6f6a ==============================
[0m15:09:42.957984 [info ] [MainThread]: Running with dbt=1.8.9
[0m15:09:42.959334 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'cache_selected_only': 'False', 'debug': 'False', 'target_path': 'None', 'warn_error': 'None', 'static_parser': 'True', 'log_path': '/workdir/transforms/01_mpg/logs', 'indirect_selection': 'eager', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'printer_width': '80', 'partial_parse': 'True', 'profiles_dir': '.', 'log_format': 'default', 'version_check': 'True', 'no_print': 'None', 'invocation_command': 'dbt build --profiles-dir . --target local', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_cache_events': 'False', 'use_colors': 'True', 'fail_fast': 'False', 'use_experimental_parser': 'False'}
[0m15:09:43.368710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '13f005ef-bd73-487c-a4e2-121a3ccb6f6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1e53f10a30>]}
[0m15:09:43.532278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '13f005ef-bd73-487c-a4e2-121a3ccb6f6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1e54098640>]}
[0m15:09:43.534392 [info ] [MainThread]: Registered adapter: clickhouse=1.8.6
[0m15:09:43.788163 [debug] [MainThread]: checksum: 134c0f7b96382cc6938697739bc32fb1adc530b177e30f60cebddf61dbd7e979, vars: {}, profile: , target: local, version: 1.8.9
[0m15:09:44.093503 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:09:44.094623 [debug] [MainThread]: Partial parsing: updated file: ex_01_mpg://models/clean/mpg_standardized.sql
[0m15:09:44.728298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '13f005ef-bd73-487c-a4e2-121a3ccb6f6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1e52654130>]}
[0m15:09:45.057767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '13f005ef-bd73-487c-a4e2-121a3ccb6f6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1e52516d30>]}
[0m15:09:45.058840 [info ] [MainThread]: Found 2 models, 1 source, 471 macros
[0m15:09:45.062543 [info ] [MainThread]: 
[0m15:09:45.064184 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m15:09:45.079371 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m15:09:45.080721 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m15:09:45.119834 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:09:45.127697 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:09:45.462035 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m15:09:45.466912 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m15:09:45.468398 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m15:09:45.472545 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m15:09:45.583915 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__mart)
[0m15:09:45.585047 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__clean)
[0m15:09:45.600676 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__mart: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list__mart"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'mart'
      

  ...
[0m15:09:45.607796 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list__clean"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'clean'
      

  ...
[0m15:09:45.616179 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m15:09:45.617745 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m15:09:45.639516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13f005ef-bd73-487c-a4e2-121a3ccb6f6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1e52078a30>]}
[0m15:09:45.641279 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m15:09:45.642469 [info ] [MainThread]: 
[0m15:09:45.665059 [debug] [Thread-1  ]: Began running node model.ex_01_mpg.mpg_standardized
[0m15:09:45.666809 [info ] [Thread-1  ]: 1 of 2 START sql table model `clean`.`mpg_standardized` ........................ [RUN]
[0m15:09:45.667887 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list__mart, now model.ex_01_mpg.mpg_standardized)
[0m15:09:45.668912 [debug] [Thread-1  ]: Began compiling node model.ex_01_mpg.mpg_standardized
[0m15:09:45.690167 [debug] [Thread-1  ]: Writing injected SQL for node "model.ex_01_mpg.mpg_standardized"
[0m15:09:45.691557 [debug] [Thread-1  ]: Began executing node model.ex_01_mpg.mpg_standardized
[0m15:09:45.818447 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.mpg_standardized"} */

            

    
        create table `clean`.`mpg_standardized__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

-- Source columns are already Nullable with correct types.
-- Keep them as-is to preserve nullability and avoid insert errors.

select
  cast(nullIf(mpg, '?') as Float64)          as mpg,
  cast(nullIf(cylinders, '?') as Int64)      as cylinders,
  cast(nullIf(displacement, '?') as Float64) as displacement,
  cast(nullIf(horsepower, '?') as Float64)   as horsepower,
  cast(nullIf(weight, '?') as Int64)         as weight,
  cast(nullIf(acceleration, '?') as Float64) as acceleration,
  cast(nullIf(model_year, '?') as Int64)     as model_year,
  nullIf(origin, '?')                        as origin,
  nullIf(name, '?')                          as make
from `raw`.`autompg___cars`
          )
        
        ...
[0m15:09:45.837416 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m15:09:45.858591 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.mpg_standardized"} */

    select name, type from system.columns where table = 'mpg_standardized__dbt_backup'
    
      and database = 'clean'
    
    order by position
  ...
[0m15:09:45.865042 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m15:09:45.876553 [debug] [Thread-1  ]: Writing runtime sql for node "model.ex_01_mpg.mpg_standardized"
[0m15:09:45.878826 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.mpg_standardized"} */

  
    
    
    
        
         


        insert into `clean`.`mpg_standardized__dbt_backup`
        ("mpg", "cylinders", "displacement", "horsepower", "weight", "acceleration", "model_year", "origin", "make")

-- Source columns are already Nullable with correct types.
-- Keep them as-is to preserve nullability and avoid insert errors.

select
  cast(nullIf(mpg, '?') as Float64)          as mpg,
  cast(nullIf(cylinders, '?') as Int64)      as cylinders,
  cast(nullIf(displacement, '?') as Float64) as displacement,
  cast(nullIf(horsepower, '?') as Float64)   as horsepower,
  cast(nullIf(weight, '?') as Int64)         as weight,
  cast(nullIf(acceleration, '?') as Float64) as acceleration,
  cast(nullIf(model_year, '?') as Int64)     as model_year,
  nullIf(origin, '?')                        as origin,
  nullIf(name, '?')                          as make
from `raw`.`autompg___cars`
  ...
[0m15:09:45.885800 [debug] [Thread-1  ]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.mpg_standardized"} */

  
    
    
    
        
         


        insert into `clean`.`mpg_standardized__dbt_backup`
        ("mpg", "cylinders", "displacement", "horsepower", "weight", "acceleration", "model_year", "origin", "make")

-- Source columns are already Nullable with correct types.
-- Keep them as-is to preserve nullability and avoid insert errors.

select
  cast(nullIf(mpg, '?') as Float64)          as mpg,
  cast(nullIf(cylinders, '?') as Int64)      as cylinders,
  cast(nullIf(displacement, '?') as Float64) as displacement,
  cast(nullIf(horsepower, '?') as Float64)   as horsepower,
  cast(nullIf(weight, '?') as Int64)         as weight,
  cast(nullIf(acceleration, '?') as Float64) as acceleration,
  cast(nullIf(model_year, '?') as Int64)     as model_year,
  nullIf(origin, '?')                        as origin,
  nullIf(name, '?')                          as make
from `raw`.`autompg___cars`
  
[0m15:09:45.891014 [debug] [Thread-1  ]: Database Error in model mpg_standardized (models/clean/mpg_standardized.sql)
  HTTPDriver for http://clickhouse:8123 received ClickHouse error code 53
   Code: 53. DB::Exception: Cannot convert string ? to type Float64. (TYPE_MISMATCH) (version 23.12.6.19 (official build))
  compiled code at target/run/ex_01_mpg/models/clean/mpg_standardized.sql
[0m15:09:45.894808 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13f005ef-bd73-487c-a4e2-121a3ccb6f6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1e575ea640>]}
[0m15:09:45.896787 [error] [Thread-1  ]: 1 of 2 ERROR creating sql table model `clean`.`mpg_standardized` ............... [[31mERROR[0m in 0.22s]
[0m15:09:45.898903 [debug] [Thread-1  ]: Finished running node model.ex_01_mpg.mpg_standardized
[0m15:09:45.900779 [debug] [Thread-3  ]: Began running node model.ex_01_mpg.cylinders_by_origin
[0m15:09:45.902605 [info ] [Thread-3  ]: 2 of 2 SKIP relation mart.cylinders_by_origin .................................. [[33mSKIP[0m]
[0m15:09:45.904337 [debug] [Thread-3  ]: Finished running node model.ex_01_mpg.cylinders_by_origin
[0m15:09:45.906924 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:09:45.907696 [debug] [MainThread]: Connection 'model.ex_01_mpg.mpg_standardized' was left open.
[0m15:09:45.908292 [debug] [MainThread]: On model.ex_01_mpg.mpg_standardized: Close
[0m15:09:45.908827 [debug] [MainThread]: Connection 'list__clean' was left open.
[0m15:09:45.909718 [debug] [MainThread]: On list__clean: Close
[0m15:09:45.910681 [info ] [MainThread]: 
[0m15:09:45.911621 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.85 seconds (0.85s).
[0m15:09:45.913665 [debug] [MainThread]: Command end result
[0m15:09:45.982222 [info ] [MainThread]: 
[0m15:09:45.983196 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:09:45.983865 [info ] [MainThread]: 
[0m15:09:45.984802 [error] [MainThread]:   Database Error in model mpg_standardized (models/clean/mpg_standardized.sql)
  HTTPDriver for http://clickhouse:8123 received ClickHouse error code 53
   Code: 53. DB::Exception: Cannot convert string ? to type Float64. (TYPE_MISMATCH) (version 23.12.6.19 (official build))
  compiled code at target/run/ex_01_mpg/models/clean/mpg_standardized.sql
[0m15:09:45.985478 [info ] [MainThread]: 
[0m15:09:45.986156 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m15:09:45.987815 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 3.1680892, "process_in_blocks": "0", "process_kernel_time": 0.801163, "process_mem_max_rss": "114184", "process_out_blocks": "10472", "process_user_time": 6.977718}
[0m15:09:45.988844 [debug] [MainThread]: Command `dbt build` failed at 15:09:45.988542 after 3.17 seconds
[0m15:09:45.990014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1e57454310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1e53930280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1e54bd80a0>]}
[0m15:09:45.991050 [debug] [MainThread]: Flushing usage events
[0m15:21:56.776801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74cf6c0d2310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74cf68d3ea90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74cf68d3e940>]}


============================== 15:21:56.787440 | 1af09b9b-b935-41cb-a250-580ad68d2115 ==============================
[0m15:21:56.787440 [info ] [MainThread]: Running with dbt=1.8.9
[0m15:21:56.788708 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'invocation_command': 'dbt build --profiles-dir . --target local', 'log_format': 'default', 'profiles_dir': '.', 'introspect': 'True', 'printer_width': '80', 'quiet': 'False', 'static_parser': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'cache_selected_only': 'False', 'debug': 'False', 'no_print': 'None', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True', 'log_path': '/workdir/transforms/01_mpg/logs', 'fail_fast': 'False', 'log_cache_events': 'False', 'warn_error': 'None', 'use_colors': 'True', 'write_json': 'True', 'target_path': 'None', 'empty': 'False'}
[0m15:21:57.255997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1af09b9b-b935-41cb-a250-580ad68d2115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74cf68d020d0>]}
[0m15:21:57.438294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1af09b9b-b935-41cb-a250-580ad68d2115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74cf6c2fcd90>]}
[0m15:21:57.440504 [info ] [MainThread]: Registered adapter: clickhouse=1.8.6
[0m15:21:57.667301 [debug] [MainThread]: checksum: 134c0f7b96382cc6938697739bc32fb1adc530b177e30f60cebddf61dbd7e979, vars: {}, profile: , target: local, version: 1.8.9
[0m15:21:57.951154 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:21:57.952866 [debug] [MainThread]: Partial parsing: updated file: ex_01_mpg://models/clean/mpg_standardized.sql
[0m15:21:58.589431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1af09b9b-b935-41cb-a250-580ad68d2115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74cf672e1130>]}
[0m15:21:58.871979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1af09b9b-b935-41cb-a250-580ad68d2115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74cf672f98e0>]}
[0m15:21:58.873250 [info ] [MainThread]: Found 2 models, 1 source, 471 macros
[0m15:21:58.876758 [info ] [MainThread]: 
[0m15:21:58.878671 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m15:21:58.894358 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m15:21:58.895920 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m15:21:58.929002 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:21:58.927717 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:21:59.252841 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m15:21:59.257446 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m15:21:59.274700 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m15:21:59.280423 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m15:21:59.381568 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__clean)
[0m15:21:59.382815 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__mart)
[0m15:21:59.398737 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list__clean"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'clean'
      

  ...
[0m15:21:59.404772 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__mart: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list__mart"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'mart'
      

  ...
[0m15:21:59.412942 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m15:21:59.414754 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m15:21:59.437852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1af09b9b-b935-41cb-a250-580ad68d2115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74cf6694c760>]}
[0m15:21:59.439509 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m15:21:59.440647 [info ] [MainThread]: 
[0m15:21:59.462546 [debug] [Thread-1  ]: Began running node model.ex_01_mpg.mpg_standardized
[0m15:21:59.464603 [info ] [Thread-1  ]: 1 of 2 START sql table model `clean`.`mpg_standardized` ........................ [RUN]
[0m15:21:59.466324 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list__clean, now model.ex_01_mpg.mpg_standardized)
[0m15:21:59.467909 [debug] [Thread-1  ]: Began compiling node model.ex_01_mpg.mpg_standardized
[0m15:21:59.493296 [debug] [Thread-1  ]: Writing injected SQL for node "model.ex_01_mpg.mpg_standardized"
[0m15:21:59.494851 [debug] [Thread-1  ]: Began executing node model.ex_01_mpg.mpg_standardized
[0m15:21:59.573816 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.mpg_standardized"} */

    drop table if exists `clean`.`mpg_standardized__dbt_backup` 
  ...
[0m15:21:59.578366 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m15:21:59.644256 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.mpg_standardized"} */

            

    
        create table `clean`.`mpg_standardized__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

-- Source columns are already Nullable with correct types.
-- Keep them as-is to preserve nullability and avoid insert errors.

-- models/clean/autompg_casted.sql
select
  toFloat64OrNull(nullIf(toString(mpg),          '?')) as mpg,
  toInt64OrNull  (nullIf(toString(cylinders),    '?')) as cylinders,
  toFloat64OrNull(nullIf(toString(displacement), '?')) as displacement,
  toFloat64OrNull(nullIf(toString(horsepower),   '?')) as horsepower,
  toInt64OrNull  (nullIf(toString(weight),       '?')) as weight,
  toFloat64OrNull(nullIf(toString(acceleration), '?')) as acceleration,
  toInt64OrNull  (nullIf(toString(model_year),   '?')) as model_year,
  nullIf(toString(origin), '?')                        as origin,
  nullIf(toString(name),   '?')                        as make
from `raw`.`autompg___cars`
          )
        
        ...
[0m15:21:59.667968 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m15:21:59.689121 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.mpg_standardized"} */

    select name, type from system.columns where table = 'mpg_standardized__dbt_backup'
    
      and database = 'clean'
    
    order by position
  ...
[0m15:21:59.694541 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m15:21:59.702196 [debug] [Thread-1  ]: Writing runtime sql for node "model.ex_01_mpg.mpg_standardized"
[0m15:21:59.703744 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.mpg_standardized"} */

  
    
    
    
        
         


        insert into `clean`.`mpg_standardized__dbt_backup`
        ("mpg", "cylinders", "displacement", "horsepower", "weight", "acceleration", "model_year", "origin", "make")

-- Source columns are already Nullable with correct types.
-- Keep them as-is to preserve nullability and avoid insert errors.

-- models/clean/autompg_casted.sql
select
  toFloat64OrNull(nullIf(toString(mpg),          '?')) as mpg,
  toInt64OrNull  (nullIf(toString(cylinders),    '?')) as cylinders,
  toFloat64OrNull(nullIf(toString(displacement), '?')) as displacement,
  toFloat64OrNull(nullIf(toString(horsepower),   '?')) as horsepower,
  toInt64OrNull  (nullIf(toString(weight),       '?')) as weight,
  toFloat64OrNull(nullIf(toString(acceleration), '?')) as acceleration,
  toInt64OrNull  (nullIf(toString(model_year),   '?')) as model_year,
  nullIf(toString(origin), '?')                        as origin,
  nullIf(toString(name),   '?')                        as make
from `raw`.`autompg___cars`
  ...
[0m15:21:59.712463 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m15:21:59.721909 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.mpg_standardized"} */
EXCHANGE TABLES `clean`.`mpg_standardized__dbt_backup` AND `clean`.`mpg_standardized` 
  
  ...
[0m15:21:59.725847 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m15:21:59.775492 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.mpg_standardized"} */

    drop table if exists `clean`.`mpg_standardized__dbt_backup` 
  ...
[0m15:21:59.779211 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m15:21:59.786072 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1af09b9b-b935-41cb-a250-580ad68d2115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74cf664fdaf0>]}
[0m15:21:59.787473 [info ] [Thread-1  ]: 1 of 2 OK created sql table model `clean`.`mpg_standardized` ................... [[32mOK[0m in 0.32s]
[0m15:21:59.788964 [debug] [Thread-1  ]: Finished running node model.ex_01_mpg.mpg_standardized
[0m15:21:59.790559 [debug] [Thread-3  ]: Began running node model.ex_01_mpg.cylinders_by_origin
[0m15:21:59.791751 [info ] [Thread-3  ]: 2 of 2 START sql view model `mart`.`cylinders_by_origin` ....................... [RUN]
[0m15:21:59.793082 [debug] [Thread-3  ]: Acquiring new clickhouse connection 'model.ex_01_mpg.cylinders_by_origin'
[0m15:21:59.794034 [debug] [Thread-3  ]: Began compiling node model.ex_01_mpg.cylinders_by_origin
[0m15:21:59.801849 [debug] [Thread-3  ]: Writing injected SQL for node "model.ex_01_mpg.cylinders_by_origin"
[0m15:21:59.803385 [debug] [Thread-3  ]: Began executing node model.ex_01_mpg.cylinders_by_origin
[0m15:21:59.860067 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m15:21:59.924735 [debug] [Thread-3  ]: Writing runtime sql for node "model.ex_01_mpg.cylinders_by_origin"
[0m15:21:59.926720 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */


  create view `mart`.`cylinders_by_origin__dbt_tmp` 
  
    
    
  as (
    

select
  origin,
  avg(cylinders) as avg_cylinders,
  count()        as n
from `clean`.`mpg_standardized`
group by origin
    
  )
      
      
                    -- end_of_sql
                    
                    ...
[0m15:21:59.947530 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m15:21:59.965427 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */

    drop table if exists `mart`.`cylinders_by_origin__dbt_backup` 
  
  ...
[0m15:21:59.968912 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m15:21:59.971615 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */

    rename table `mart`.`cylinders_by_origin` to `mart`.`cylinders_by_origin__dbt_backup` 
  
  ...
[0m15:21:59.974939 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m15:21:59.982042 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */

    drop table if exists `mart`.`cylinders_by_origin` 
  
  ...
[0m15:21:59.985467 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m15:21:59.988651 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */

    rename table `mart`.`cylinders_by_origin__dbt_tmp` to `mart`.`cylinders_by_origin` 
  
  ...
[0m15:21:59.992997 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m15:22:00.002759 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */

    drop table if exists `mart`.`cylinders_by_origin__dbt_backup` 
  ...
[0m15:22:00.007126 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m15:22:00.010735 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1af09b9b-b935-41cb-a250-580ad68d2115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74cf66d70df0>]}
[0m15:22:00.012790 [info ] [Thread-3  ]: 2 of 2 OK created sql view model `mart`.`cylinders_by_origin` .................. [[32mOK[0m in 0.22s]
[0m15:22:00.014454 [debug] [Thread-3  ]: Finished running node model.ex_01_mpg.cylinders_by_origin
[0m15:22:00.016890 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:22:00.017932 [debug] [MainThread]: Connection 'model.ex_01_mpg.mpg_standardized' was left open.
[0m15:22:00.018584 [debug] [MainThread]: On model.ex_01_mpg.mpg_standardized: Close
[0m15:22:00.019214 [debug] [MainThread]: Connection 'list__mart' was left open.
[0m15:22:00.019938 [debug] [MainThread]: On list__mart: Close
[0m15:22:00.020706 [debug] [MainThread]: Connection 'model.ex_01_mpg.cylinders_by_origin' was left open.
[0m15:22:00.021620 [debug] [MainThread]: On model.ex_01_mpg.cylinders_by_origin: Close
[0m15:22:00.022919 [info ] [MainThread]: 
[0m15:22:00.023679 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 1.14 seconds (1.14s).
[0m15:22:00.025620 [debug] [MainThread]: Command end result
[0m15:22:00.092571 [info ] [MainThread]: 
[0m15:22:00.093689 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:22:00.094668 [info ] [MainThread]: 
[0m15:22:00.095746 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m15:22:00.097837 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 3.4367929, "process_in_blocks": "0", "process_kernel_time": 0.806907, "process_mem_max_rss": "114068", "process_out_blocks": "10488", "process_user_time": 7.081189}
[0m15:22:00.099255 [debug] [MainThread]: Command `dbt build` succeeded at 15:22:00.098868 after 3.44 seconds
[0m15:22:00.099978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74cf6c0d2310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74cf68b284f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74cf68b28c40>]}
[0m15:22:00.100689 [debug] [MainThread]: Flushing usage events
[0m15:24:47.695807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae4e473c310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae4e13a3a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae4e13a3910>]}


============================== 15:24:47.711963 | 35d170f0-6ce1-4892-9142-e2106f8b263b ==============================
[0m15:24:47.711963 [info ] [MainThread]: Running with dbt=1.8.9
[0m15:24:47.713816 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'use_colors': 'True', 'invocation_command': 'dbt build --profiles-dir . --target local', 'write_json': 'True', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'log_path': '/workdir/transforms/01_mpg/logs', 'printer_width': '80', 'no_print': 'None', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'indirect_selection': 'eager', 'fail_fast': 'False', 'partial_parse': 'True', 'log_format': 'default', 'warn_error': 'None', 'profiles_dir': '.', 'use_experimental_parser': 'False', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'cache_selected_only': 'False', 'empty': 'False', 'version_check': 'True'}
[0m15:24:48.104056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '35d170f0-6ce1-4892-9142-e2106f8b263b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae4e12eb3d0>]}
[0m15:24:48.229932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '35d170f0-6ce1-4892-9142-e2106f8b263b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae4e13f3790>]}
[0m15:24:48.231741 [info ] [MainThread]: Registered adapter: clickhouse=1.8.6
[0m15:24:48.437312 [debug] [MainThread]: checksum: 134c0f7b96382cc6938697739bc32fb1adc530b177e30f60cebddf61dbd7e979, vars: {}, profile: , target: local, version: 1.8.9
[0m15:24:48.718813 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:24:48.720339 [debug] [MainThread]: Partial parsing: updated file: ex_01_mpg://models/clean/mpg_standardized.sql
[0m15:24:49.301668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '35d170f0-6ce1-4892-9142-e2106f8b263b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae4df94a130>]}
[0m15:24:49.649292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '35d170f0-6ce1-4892-9142-e2106f8b263b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae4df80d970>]}
[0m15:24:49.650444 [info ] [MainThread]: Found 2 models, 1 source, 471 macros
[0m15:24:49.653755 [info ] [MainThread]: 
[0m15:24:49.655574 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m15:24:49.671712 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m15:24:49.673281 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m15:24:49.703528 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:24:49.717213 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:24:50.044566 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m15:24:50.050820 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m15:24:50.053565 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m15:24:50.059527 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m15:24:50.167803 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__mart)
[0m15:24:50.168845 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__clean)
[0m15:24:50.187391 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__mart: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list__mart"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'mart'
      

  ...
[0m15:24:50.192404 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list__clean"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'clean'
      

  ...
[0m15:24:50.200351 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m15:24:50.202077 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m15:24:50.222043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '35d170f0-6ce1-4892-9142-e2106f8b263b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae4df350dc0>]}
[0m15:24:50.223440 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m15:24:50.224278 [info ] [MainThread]: 
[0m15:24:50.240586 [debug] [Thread-1  ]: Began running node model.ex_01_mpg.mpg_standardized
[0m15:24:50.242527 [info ] [Thread-1  ]: 1 of 2 START sql table model `clean`.`mpg_standardized` ........................ [RUN]
[0m15:24:50.243671 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list__mart, now model.ex_01_mpg.mpg_standardized)
[0m15:24:50.244457 [debug] [Thread-1  ]: Began compiling node model.ex_01_mpg.mpg_standardized
[0m15:24:50.265575 [debug] [Thread-1  ]: Writing injected SQL for node "model.ex_01_mpg.mpg_standardized"
[0m15:24:50.266911 [debug] [Thread-1  ]: Began executing node model.ex_01_mpg.mpg_standardized
[0m15:24:50.392211 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.mpg_standardized"} */

            

    
        create table `clean`.`mpg_standardized__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

-- Source columns are already Nullable with correct types.
-- Keep them as-is to preserve nullability and avoid insert errors.

-- models/clean/autompg_casted.sql
SELECT
  CAST(NULLIF(mpg, '?')          AS FLOAT) AS mpg,
  CAST(NULLIF(cylinders, '?')    AS INT)   AS cylinders,
  CAST(NULLIF(displacement, '?') AS FLOAT) AS displacement,
  CAST(NULLIF(horsepower, '?')   AS FLOAT) AS horsepower,
  CAST(NULLIF(weight, '?')       AS INT)   AS weight,
  CAST(NULLIF(acceleration, '?') AS FLOAT) AS acceleration,
  CAST(NULLIF(model_year, '?')   AS INT)   AS model_year,
  NULLIF(origin, '?')                       AS origin,
  NULLIF(name,   '?')                       AS make

from `raw`.`autompg___cars`
          )
        
        ...
[0m15:24:50.414854 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m15:24:50.437723 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.mpg_standardized"} */

    select name, type from system.columns where table = 'mpg_standardized__dbt_backup'
    
      and database = 'clean'
    
    order by position
  ...
[0m15:24:50.443566 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m15:24:50.453111 [debug] [Thread-1  ]: Writing runtime sql for node "model.ex_01_mpg.mpg_standardized"
[0m15:24:50.454863 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.mpg_standardized"} */

  
    
    
    
        
         


        insert into `clean`.`mpg_standardized__dbt_backup`
        ("mpg", "cylinders", "displacement", "horsepower", "weight", "acceleration", "model_year", "origin", "make")

-- Source columns are already Nullable with correct types.
-- Keep them as-is to preserve nullability and avoid insert errors.

-- models/clean/autompg_casted.sql
SELECT
  CAST(NULLIF(mpg, '?')          AS FLOAT) AS mpg,
  CAST(NULLIF(cylinders, '?')    AS INT)   AS cylinders,
  CAST(NULLIF(displacement, '?') AS FLOAT) AS displacement,
  CAST(NULLIF(horsepower, '?')   AS FLOAT) AS horsepower,
  CAST(NULLIF(weight, '?')       AS INT)   AS weight,
  CAST(NULLIF(acceleration, '?') AS FLOAT) AS acceleration,
  CAST(NULLIF(model_year, '?')   AS INT)   AS model_year,
  NULLIF(origin, '?')                       AS origin,
  NULLIF(name,   '?')                       AS make

from `raw`.`autompg___cars`
  ...
[0m15:24:50.460330 [debug] [Thread-1  ]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.mpg_standardized"} */

  
    
    
    
        
         


        insert into `clean`.`mpg_standardized__dbt_backup`
        ("mpg", "cylinders", "displacement", "horsepower", "weight", "acceleration", "model_year", "origin", "make")

-- Source columns are already Nullable with correct types.
-- Keep them as-is to preserve nullability and avoid insert errors.

-- models/clean/autompg_casted.sql
SELECT
  CAST(NULLIF(mpg, '?')          AS FLOAT) AS mpg,
  CAST(NULLIF(cylinders, '?')    AS INT)   AS cylinders,
  CAST(NULLIF(displacement, '?') AS FLOAT) AS displacement,
  CAST(NULLIF(horsepower, '?')   AS FLOAT) AS horsepower,
  CAST(NULLIF(weight, '?')       AS INT)   AS weight,
  CAST(NULLIF(acceleration, '?') AS FLOAT) AS acceleration,
  CAST(NULLIF(model_year, '?')   AS INT)   AS model_year,
  NULLIF(origin, '?')                       AS origin,
  NULLIF(name,   '?')                       AS make

from `raw`.`autompg___cars`
  
[0m15:24:50.463896 [debug] [Thread-1  ]: Database Error in model mpg_standardized (models/clean/mpg_standardized.sql)
  HTTPDriver for http://clickhouse:8123 received ClickHouse error code 53
   Code: 53. DB::Exception: Cannot convert string ? to type Float64. (TYPE_MISMATCH) (version 23.12.6.19 (official build))
  compiled code at target/run/ex_01_mpg/models/clean/mpg_standardized.sql
[0m15:24:50.467603 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35d170f0-6ce1-4892-9142-e2106f8b263b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae4e13eadc0>]}
[0m15:24:50.469535 [error] [Thread-1  ]: 1 of 2 ERROR creating sql table model `clean`.`mpg_standardized` ............... [[31mERROR[0m in 0.22s]
[0m15:24:50.471793 [debug] [Thread-1  ]: Finished running node model.ex_01_mpg.mpg_standardized
[0m15:24:50.474488 [debug] [Thread-3  ]: Began running node model.ex_01_mpg.cylinders_by_origin
[0m15:24:50.475645 [info ] [Thread-3  ]: 2 of 2 SKIP relation mart.cylinders_by_origin .................................. [[33mSKIP[0m]
[0m15:24:50.477022 [debug] [Thread-3  ]: Finished running node model.ex_01_mpg.cylinders_by_origin
[0m15:24:50.479749 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:24:50.480792 [debug] [MainThread]: Connection 'model.ex_01_mpg.mpg_standardized' was left open.
[0m15:24:50.481802 [debug] [MainThread]: On model.ex_01_mpg.mpg_standardized: Close
[0m15:24:50.482800 [debug] [MainThread]: Connection 'list__clean' was left open.
[0m15:24:50.483763 [debug] [MainThread]: On list__clean: Close
[0m15:24:50.485054 [info ] [MainThread]: 
[0m15:24:50.486193 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.83 seconds (0.83s).
[0m15:24:50.488575 [debug] [MainThread]: Command end result
[0m15:24:50.562053 [info ] [MainThread]: 
[0m15:24:50.563016 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:24:50.563813 [info ] [MainThread]: 
[0m15:24:50.565154 [error] [MainThread]:   Database Error in model mpg_standardized (models/clean/mpg_standardized.sql)
  HTTPDriver for http://clickhouse:8123 received ClickHouse error code 53
   Code: 53. DB::Exception: Cannot convert string ? to type Float64. (TYPE_MISMATCH) (version 23.12.6.19 (official build))
  compiled code at target/run/ex_01_mpg/models/clean/mpg_standardized.sql
[0m15:24:50.566299 [info ] [MainThread]: 
[0m15:24:50.567380 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m15:24:50.569639 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 2.9983177, "process_in_blocks": "0", "process_kernel_time": 0.774628, "process_mem_max_rss": "113544", "process_out_blocks": "10472", "process_user_time": 6.666801}
[0m15:24:50.571047 [debug] [MainThread]: Command `dbt build` failed at 15:24:50.570711 after 3.00 seconds
[0m15:24:50.572149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae4e473c310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae4e25e73a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae4e12eb3d0>]}
[0m15:24:50.573249 [debug] [MainThread]: Flushing usage events
[0m15:28:09.566048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78d7a4bf6310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78d7a1842b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78d7a18429d0>]}


============================== 15:28:09.579381 | 0090992f-c992-4353-b128-ab9a6a71792b ==============================
[0m15:28:09.579381 [info ] [MainThread]: Running with dbt=1.8.9
[0m15:28:09.581293 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'empty': 'False', 'profiles_dir': '.', 'invocation_command': 'dbt build --profiles-dir . --target local', 'printer_width': '80', 'static_parser': 'True', 'log_format': 'default', 'quiet': 'False', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'warn_error': 'None', 'write_json': 'True', 'no_print': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'debug': 'False', 'introspect': 'True', 'log_path': '/workdir/transforms/01_mpg/logs', 'send_anonymous_usage_stats': 'True'}
[0m15:28:09.960549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0090992f-c992-4353-b128-ab9a6a71792b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78d7a175d910>]}
[0m15:28:10.089364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0090992f-c992-4353-b128-ab9a6a71792b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78d7a177e7f0>]}
[0m15:28:10.091391 [info ] [MainThread]: Registered adapter: clickhouse=1.8.6
[0m15:28:10.326808 [debug] [MainThread]: checksum: 134c0f7b96382cc6938697739bc32fb1adc530b177e30f60cebddf61dbd7e979, vars: {}, profile: , target: local, version: 1.8.9
[0m15:28:10.609649 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:28:10.611160 [debug] [MainThread]: Partial parsing: updated file: ex_01_mpg://models/clean/mpg_standardized.sql
[0m15:28:11.175734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0090992f-c992-4353-b128-ab9a6a71792b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78d79fdf0130>]}
[0m15:28:11.440178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0090992f-c992-4353-b128-ab9a6a71792b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78d79fcac430>]}
[0m15:28:11.441402 [info ] [MainThread]: Found 2 models, 1 source, 471 macros
[0m15:28:11.445275 [info ] [MainThread]: 
[0m15:28:11.446682 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m15:28:11.464637 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m15:28:11.466264 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m15:28:11.502938 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:28:11.514557 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:28:11.855578 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m15:28:11.862030 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m15:28:11.865393 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m15:28:11.871164 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m15:28:11.989384 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__mart)
[0m15:28:12.005818 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__mart: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list__mart"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'mart'
      

  ...
[0m15:28:12.008408 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__clean)
[0m15:28:12.015091 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list__clean"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'clean'
      

  ...
[0m15:28:12.019866 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m15:28:12.037811 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m15:28:12.048021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0090992f-c992-4353-b128-ab9a6a71792b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78d79f80eb50>]}
[0m15:28:12.049613 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m15:28:12.050813 [info ] [MainThread]: 
[0m15:28:12.067100 [debug] [Thread-1  ]: Began running node model.ex_01_mpg.mpg_standardized
[0m15:28:12.068670 [info ] [Thread-1  ]: 1 of 2 START sql table model `clean`.`mpg_standardized` ........................ [RUN]
[0m15:28:12.070606 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list__mart, now model.ex_01_mpg.mpg_standardized)
[0m15:28:12.071871 [debug] [Thread-1  ]: Began compiling node model.ex_01_mpg.mpg_standardized
[0m15:28:12.094966 [debug] [Thread-1  ]: Writing injected SQL for node "model.ex_01_mpg.mpg_standardized"
[0m15:28:12.096551 [debug] [Thread-1  ]: Began executing node model.ex_01_mpg.mpg_standardized
[0m15:28:12.181071 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.mpg_standardized"} */

    drop table if exists `clean`.`mpg_standardized__dbt_backup` 
  ...
[0m15:28:12.184877 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m15:28:12.261714 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.mpg_standardized"} */

            

    
        create table `clean`.`mpg_standardized__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

-- Source columns are already Nullable with correct types.
-- Keep them as-is to preserve nullability and avoid insert errors.

-- models/clean/autompg_casted.sql
-- turn "?" -> NULL first, then cast; works reliably in ClickHouse/dbt-clickhouse
select
  case when toString(mpg)          = '?' then null else toFloat64OrNull(toString(mpg))          end as mpg,
  case when toString(cylinders)    = '?' then null else toInt64OrNull  (toString(cylinders))    end as cylinders,
  case when toString(displacement) = '?' then null else toFloat64OrNull(toString(displacement)) end as displacement,
  case when toString(horsepower)   = '?' then null else toFloat64OrNull(toString(horsepower))   end as horsepower,
  case when toString(weight)       = '?' then null else toInt64OrNull  (toString(weight))       end as weight,
  case when toString(acceleration) = '?' then null else toFloat64OrNull(toString(acceleration)) end as acceleration,
  case when toString(model_year)   = '?' then null else toInt64OrNull  (toString(model_year))   end as model_year,
  case when toString(origin)       = '?' then null else toString(origin)                         end as origin,
  case when toString(name)         = '?' then null else toString(name)                           end as make
from `raw`.`autompg___cars`
          )
        
        ...
[0m15:28:12.394659 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.13 seconds
[0m15:28:12.424441 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.mpg_standardized"} */

    select name, type from system.columns where table = 'mpg_standardized__dbt_backup'
    
      and database = 'clean'
    
    order by position
  ...
[0m15:28:12.430866 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m15:28:12.439392 [debug] [Thread-1  ]: Writing runtime sql for node "model.ex_01_mpg.mpg_standardized"
[0m15:28:12.441616 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.mpg_standardized"} */

  
    
    
    
        
         


        insert into `clean`.`mpg_standardized__dbt_backup`
        ("mpg", "cylinders", "displacement", "horsepower", "weight", "acceleration", "model_year", "origin", "make")

-- Source columns are already Nullable with correct types.
-- Keep them as-is to preserve nullability and avoid insert errors.

-- models/clean/autompg_casted.sql
-- turn "?" -> NULL first, then cast; works reliably in ClickHouse/dbt-clickhouse
select
  case when toString(mpg)          = '?' then null else toFloat64OrNull(toString(mpg))          end as mpg,
  case when toString(cylinders)    = '?' then null else toInt64OrNull  (toString(cylinders))    end as cylinders,
  case when toString(displacement) = '?' then null else toFloat64OrNull(toString(displacement)) end as displacement,
  case when toString(horsepower)   = '?' then null else toFloat64OrNull(toString(horsepower))   end as horsepower,
  case when toString(weight)       = '?' then null else toInt64OrNull  (toString(weight))       end as weight,
  case when toString(acceleration) = '?' then null else toFloat64OrNull(toString(acceleration)) end as acceleration,
  case when toString(model_year)   = '?' then null else toInt64OrNull  (toString(model_year))   end as model_year,
  case when toString(origin)       = '?' then null else toString(origin)                         end as origin,
  case when toString(name)         = '?' then null else toString(name)                           end as make
from `raw`.`autompg___cars`
  ...
[0m15:28:12.450565 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m15:28:12.463203 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.mpg_standardized"} */
EXCHANGE TABLES `clean`.`mpg_standardized__dbt_backup` AND `clean`.`mpg_standardized` 
  
  ...
[0m15:28:12.467042 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m15:28:12.532433 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.mpg_standardized"} */

    drop table if exists `clean`.`mpg_standardized__dbt_backup` 
  ...
[0m15:28:12.536795 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m15:28:12.546956 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0090992f-c992-4353-b128-ab9a6a71792b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78d79f052460>]}
[0m15:28:12.548967 [info ] [Thread-1  ]: 1 of 2 OK created sql table model `clean`.`mpg_standardized` ................... [[32mOK[0m in 0.47s]
[0m15:28:12.551427 [debug] [Thread-1  ]: Finished running node model.ex_01_mpg.mpg_standardized
[0m15:28:12.553432 [debug] [Thread-3  ]: Began running node model.ex_01_mpg.cylinders_by_origin
[0m15:28:12.554921 [info ] [Thread-3  ]: 2 of 2 START sql view model `mart`.`cylinders_by_origin` ....................... [RUN]
[0m15:28:12.556564 [debug] [Thread-3  ]: Acquiring new clickhouse connection 'model.ex_01_mpg.cylinders_by_origin'
[0m15:28:12.557557 [debug] [Thread-3  ]: Began compiling node model.ex_01_mpg.cylinders_by_origin
[0m15:28:12.568782 [debug] [Thread-3  ]: Writing injected SQL for node "model.ex_01_mpg.cylinders_by_origin"
[0m15:28:12.570665 [debug] [Thread-3  ]: Began executing node model.ex_01_mpg.cylinders_by_origin
[0m15:28:12.632985 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m15:28:12.919154 [debug] [Thread-3  ]: Writing runtime sql for node "model.ex_01_mpg.cylinders_by_origin"
[0m15:28:12.920627 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */


  create view `mart`.`cylinders_by_origin__dbt_tmp` 
  
    
    
  as (
    

select
  origin,
  avg(cylinders) as avg_cylinders,
  count()        as n
from `clean`.`mpg_standardized`
group by origin
    
  )
      
      
                    -- end_of_sql
                    
                    ...
[0m15:28:12.933325 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m15:28:12.951588 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */

    drop table if exists `mart`.`cylinders_by_origin__dbt_backup` 
  
  ...
[0m15:28:12.955867 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m15:28:12.959197 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */

    rename table `mart`.`cylinders_by_origin` to `mart`.`cylinders_by_origin__dbt_backup` 
  
  ...
[0m15:28:12.962956 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m15:28:12.971818 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */

    drop table if exists `mart`.`cylinders_by_origin` 
  
  ...
[0m15:28:12.975143 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m15:28:12.977851 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */

    rename table `mart`.`cylinders_by_origin__dbt_tmp` to `mart`.`cylinders_by_origin` 
  
  ...
[0m15:28:12.981122 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m15:28:12.991450 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */

    drop table if exists `mart`.`cylinders_by_origin__dbt_backup` 
  ...
[0m15:28:12.994714 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m15:28:12.997667 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0090992f-c992-4353-b128-ab9a6a71792b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78d7a188a1c0>]}
[0m15:28:12.999357 [info ] [Thread-3  ]: 2 of 2 OK created sql view model `mart`.`cylinders_by_origin` .................. [[32mOK[0m in 0.44s]
[0m15:28:13.001336 [debug] [Thread-3  ]: Finished running node model.ex_01_mpg.cylinders_by_origin
[0m15:28:13.003453 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:28:13.004048 [debug] [MainThread]: Connection 'model.ex_01_mpg.mpg_standardized' was left open.
[0m15:28:13.004625 [debug] [MainThread]: On model.ex_01_mpg.mpg_standardized: Close
[0m15:28:13.005227 [debug] [MainThread]: Connection 'list__clean' was left open.
[0m15:28:13.006154 [debug] [MainThread]: On list__clean: Close
[0m15:28:13.006932 [debug] [MainThread]: Connection 'model.ex_01_mpg.cylinders_by_origin' was left open.
[0m15:28:13.007805 [debug] [MainThread]: On model.ex_01_mpg.cylinders_by_origin: Close
[0m15:28:13.009165 [info ] [MainThread]: 
[0m15:28:13.010241 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 1.56 seconds (1.56s).
[0m15:28:13.013157 [debug] [MainThread]: Command end result
[0m15:28:13.086303 [info ] [MainThread]: 
[0m15:28:13.087304 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:28:13.088010 [info ] [MainThread]: 
[0m15:28:13.088743 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m15:28:13.090225 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 3.6482394, "process_in_blocks": "0", "process_kernel_time": 0.803086, "process_mem_max_rss": "114188", "process_out_blocks": "10496", "process_user_time": 7.104076}
[0m15:28:13.091091 [debug] [MainThread]: Command `dbt build` succeeded at 15:28:13.090859 after 3.65 seconds
[0m15:28:13.091924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78d7a4bf6310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78d7a2b10400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78d79e957fd0>]}
[0m15:28:13.093000 [debug] [MainThread]: Flushing usage events
[0m15:39:19.766985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d50f162de20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d50ee280490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d50ee2805e0>]}


============================== 15:39:19.779480 | a0b8b09a-edf3-46d2-959c-821a66707f62 ==============================
[0m15:39:19.779480 [info ] [MainThread]: Running with dbt=1.8.9
[0m15:39:19.780729 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'use_colors': 'True', 'cache_selected_only': 'False', 'quiet': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'printer_width': '80', 'no_print': 'None', 'static_parser': 'True', 'log_cache_events': 'False', 'invocation_command': 'dbt build --profiles-dir . --target local', 'warn_error': 'None', 'profiles_dir': '.', 'partial_parse': 'True', 'debug': 'False', 'log_path': '/workdir/transforms/01_mpg/logs', 'write_json': 'True', 'introspect': 'True', 'fail_fast': 'False', 'empty': 'False', 'log_format': 'default'}
[0m15:39:20.150436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a0b8b09a-edf3-46d2-959c-821a66707f62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d50f0ab5910>]}
[0m15:39:20.299639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a0b8b09a-edf3-46d2-959c-821a66707f62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d50ee0da7c0>]}
[0m15:39:20.301461 [info ] [MainThread]: Registered adapter: clickhouse=1.8.6
[0m15:39:20.550403 [debug] [MainThread]: checksum: 134c0f7b96382cc6938697739bc32fb1adc530b177e30f60cebddf61dbd7e979, vars: {}, profile: , target: local, version: 1.8.9
[0m15:39:20.869038 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:39:20.870362 [debug] [MainThread]: Partial parsing: updated file: ex_01_mpg://models/clean/mpg_standardized.sql
[0m15:39:21.444033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a0b8b09a-edf3-46d2-959c-821a66707f62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d50ec82b130>]}
[0m15:39:21.695206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a0b8b09a-edf3-46d2-959c-821a66707f62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d50ec6e5370>]}
[0m15:39:21.696154 [info ] [MainThread]: Found 2 models, 1 source, 471 macros
[0m15:39:21.699205 [info ] [MainThread]: 
[0m15:39:21.700706 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m15:39:21.715286 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m15:39:21.716357 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m15:39:21.744015 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:39:21.757145 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:39:22.080371 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m15:39:22.087362 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m15:39:22.188817 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m15:39:22.197955 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m15:39:22.205740 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__clean)
[0m15:39:22.207140 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__mart)
[0m15:39:22.223006 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list__clean"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'clean'
      

  ...
[0m15:39:22.227776 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__mart: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list__mart"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'mart'
      

  ...
[0m15:39:22.236353 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m15:39:22.237844 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m15:39:22.260776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a0b8b09a-edf3-46d2-959c-821a66707f62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d50ec231af0>]}
[0m15:39:22.262060 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m15:39:22.262942 [info ] [MainThread]: 
[0m15:39:22.283595 [debug] [Thread-1  ]: Began running node model.ex_01_mpg.mpg_standardized
[0m15:39:22.285493 [info ] [Thread-1  ]: 1 of 2 START sql table model `clean`.`mpg_standardized` ........................ [RUN]
[0m15:39:22.288473 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list__clean, now model.ex_01_mpg.mpg_standardized)
[0m15:39:22.290331 [debug] [Thread-1  ]: Began compiling node model.ex_01_mpg.mpg_standardized
[0m15:39:22.307390 [debug] [Thread-1  ]: Writing injected SQL for node "model.ex_01_mpg.mpg_standardized"
[0m15:39:22.308950 [debug] [Thread-1  ]: Began executing node model.ex_01_mpg.mpg_standardized
[0m15:39:22.432283 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.mpg_standardized"} */

            

    
        create table `clean`.`mpg_standardized__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

-- Source columns are already Nullable with correct types.
-- Keep them as-is to preserve nullability and avoid insert errors.

select
  mpg,            -- Nullable(Float64)
  cylinders,      -- Nullable(Int64)
  displacement,   -- Nullable(Float64)
  horsepower,     -- Nullable(Float64)
  coalesce(
        horsepower,
        avg(horsepower) over (partition by cylinders)
    ) as horsepower_imputed,
  weight,         -- Nullable(Int64)
  acceleration,   -- Nullable(Float64)
  model_year,     -- Nullable(Int64)
  origin,         -- Nullable(String)
  name as make    -- Nullable(String)
from `raw`.`autompg___cars`
          )
        
        ...
[0m15:39:22.453576 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m15:39:22.477440 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.mpg_standardized"} */

    select name, type from system.columns where table = 'mpg_standardized__dbt_backup'
    
      and database = 'clean'
    
    order by position
  ...
[0m15:39:22.483699 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m15:39:22.492351 [debug] [Thread-1  ]: Writing runtime sql for node "model.ex_01_mpg.mpg_standardized"
[0m15:39:22.494066 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.mpg_standardized"} */

  
    
    
    
        
         


        insert into `clean`.`mpg_standardized__dbt_backup`
        ("mpg", "cylinders", "displacement", "horsepower", "horsepower_imputed", "weight", "acceleration", "model_year", "origin", "make")

-- Source columns are already Nullable with correct types.
-- Keep them as-is to preserve nullability and avoid insert errors.

select
  mpg,            -- Nullable(Float64)
  cylinders,      -- Nullable(Int64)
  displacement,   -- Nullable(Float64)
  horsepower,     -- Nullable(Float64)
  coalesce(
        horsepower,
        avg(horsepower) over (partition by cylinders)
    ) as horsepower_imputed,
  weight,         -- Nullable(Int64)
  acceleration,   -- Nullable(Float64)
  model_year,     -- Nullable(Int64)
  origin,         -- Nullable(String)
  name as make    -- Nullable(String)
from `raw`.`autompg___cars`
  ...
[0m15:39:22.520207 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m15:39:22.530497 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.mpg_standardized"} */
EXCHANGE TABLES `clean`.`mpg_standardized__dbt_backup` AND `clean`.`mpg_standardized` 
  
  ...
[0m15:39:22.534417 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m15:39:22.598524 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.mpg_standardized"} */

    drop table if exists `clean`.`mpg_standardized__dbt_backup` 
  ...
[0m15:39:22.602273 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m15:39:22.611176 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0b8b09a-edf3-46d2-959c-821a66707f62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d50ec2ca910>]}
[0m15:39:22.612963 [info ] [Thread-1  ]: 1 of 2 OK created sql table model `clean`.`mpg_standardized` ................... [[32mOK[0m in 0.32s]
[0m15:39:22.614640 [debug] [Thread-1  ]: Finished running node model.ex_01_mpg.mpg_standardized
[0m15:39:22.616889 [debug] [Thread-3  ]: Began running node model.ex_01_mpg.cylinders_by_origin
[0m15:39:22.618007 [info ] [Thread-3  ]: 2 of 2 START sql view model `mart`.`cylinders_by_origin` ....................... [RUN]
[0m15:39:22.619612 [debug] [Thread-3  ]: Acquiring new clickhouse connection 'model.ex_01_mpg.cylinders_by_origin'
[0m15:39:22.620853 [debug] [Thread-3  ]: Began compiling node model.ex_01_mpg.cylinders_by_origin
[0m15:39:22.628502 [debug] [Thread-3  ]: Writing injected SQL for node "model.ex_01_mpg.cylinders_by_origin"
[0m15:39:22.630084 [debug] [Thread-3  ]: Began executing node model.ex_01_mpg.cylinders_by_origin
[0m15:39:22.697499 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m15:39:22.765434 [debug] [Thread-3  ]: Writing runtime sql for node "model.ex_01_mpg.cylinders_by_origin"
[0m15:39:22.767427 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */


  create view `mart`.`cylinders_by_origin__dbt_tmp` 
  
    
    
  as (
    

select
  origin,
  avg(cylinders) as avg_cylinders,
  count()        as n
from `clean`.`mpg_standardized`
group by origin
    
  )
      
      
                    -- end_of_sql
                    
                    ...
[0m15:39:22.777625 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m15:39:22.803502 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */

    drop table if exists `mart`.`cylinders_by_origin__dbt_backup` 
  
  ...
[0m15:39:22.812729 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m15:39:22.816811 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */

    rename table `mart`.`cylinders_by_origin` to `mart`.`cylinders_by_origin__dbt_backup` 
  
  ...
[0m15:39:22.824853 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m15:39:22.840539 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */

    drop table if exists `mart`.`cylinders_by_origin` 
  
  ...
[0m15:39:22.846819 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m15:39:22.853101 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */

    rename table `mart`.`cylinders_by_origin__dbt_tmp` to `mart`.`cylinders_by_origin` 
  
  ...
[0m15:39:22.863047 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m15:39:22.876080 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */

    drop table if exists `mart`.`cylinders_by_origin__dbt_backup` 
  ...
[0m15:39:22.883629 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m15:39:22.888707 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0b8b09a-edf3-46d2-959c-821a66707f62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d50ec2ca730>]}
[0m15:39:22.891044 [info ] [Thread-3  ]: 2 of 2 OK created sql view model `mart`.`cylinders_by_origin` .................. [[32mOK[0m in 0.27s]
[0m15:39:22.893762 [debug] [Thread-3  ]: Finished running node model.ex_01_mpg.cylinders_by_origin
[0m15:39:22.901694 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:39:22.902993 [debug] [MainThread]: Connection 'model.ex_01_mpg.mpg_standardized' was left open.
[0m15:39:22.904199 [debug] [MainThread]: On model.ex_01_mpg.mpg_standardized: Close
[0m15:39:22.905363 [debug] [MainThread]: Connection 'list__mart' was left open.
[0m15:39:22.906535 [debug] [MainThread]: On list__mart: Close
[0m15:39:22.907805 [debug] [MainThread]: Connection 'model.ex_01_mpg.cylinders_by_origin' was left open.
[0m15:39:22.908989 [debug] [MainThread]: On model.ex_01_mpg.cylinders_by_origin: Close
[0m15:39:22.910839 [info ] [MainThread]: 
[0m15:39:22.913697 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 1.21 seconds (1.21s).
[0m15:39:22.919545 [debug] [MainThread]: Command end result
[0m15:39:23.023195 [info ] [MainThread]: 
[0m15:39:23.024668 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:39:23.025836 [info ] [MainThread]: 
[0m15:39:23.027014 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m15:39:23.029796 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 3.3875275, "process_in_blocks": "0", "process_kernel_time": 0.820933, "process_mem_max_rss": "114092", "process_out_blocks": "10488", "process_user_time": 6.914438}
[0m15:39:23.031563 [debug] [MainThread]: Command `dbt build` succeeded at 15:39:23.031111 after 3.39 seconds
[0m15:39:23.032980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d50f162de20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d50eda51e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d50edf90bb0>]}
[0m15:39:23.034345 [debug] [MainThread]: Flushing usage events
[0m15:42:15.448030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c1d2184e310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c1d1e4a8af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c1d1e4a89a0>]}


============================== 15:42:15.459502 | aae55851-ed49-40fd-9f04-e05739afa03b ==============================
[0m15:42:15.459502 [info ] [MainThread]: Running with dbt=1.8.9
[0m15:42:15.460717 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'log_cache_events': 'False', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt build --profiles-dir . --target local', 'log_format': 'default', 'profiles_dir': '.', 'partial_parse': 'True', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'quiet': 'False', 'use_experimental_parser': 'False', 'log_path': '/workdir/transforms/01_mpg/logs', 'introspect': 'True', 'printer_width': '80', 'use_colors': 'True', 'debug': 'False', 'empty': 'False', 'indirect_selection': 'eager', 'version_check': 'True', 'target_path': 'None', 'write_json': 'True', 'fail_fast': 'False'}
[0m15:42:15.841567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aae55851-ed49-40fd-9f04-e05739afa03b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c1d20de9fd0>]}
[0m15:42:15.964813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aae55851-ed49-40fd-9f04-e05739afa03b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c1d1e395a90>]}
[0m15:42:15.966735 [info ] [MainThread]: Registered adapter: clickhouse=1.8.6
[0m15:42:16.190469 [debug] [MainThread]: checksum: 134c0f7b96382cc6938697739bc32fb1adc530b177e30f60cebddf61dbd7e979, vars: {}, profile: , target: local, version: 1.8.9
[0m15:42:16.470080 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:42:16.471155 [debug] [MainThread]: Partial parsing: updated file: ex_01_mpg://models/clean/mpg_standardized.sql
[0m15:42:17.031690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aae55851-ed49-40fd-9f04-e05739afa03b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c1d1ca57130>]}
[0m15:42:17.312427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aae55851-ed49-40fd-9f04-e05739afa03b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c1d1c917ac0>]}
[0m15:42:17.313469 [info ] [MainThread]: Found 2 models, 1 source, 471 macros
[0m15:42:17.316969 [info ] [MainThread]: 
[0m15:42:17.318568 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m15:42:17.335027 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m15:42:17.341457 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m15:42:17.371590 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:42:17.378211 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:42:17.707717 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m15:42:17.712362 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m15:42:17.713628 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m15:42:17.717976 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m15:42:17.840585 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__mart)
[0m15:42:17.841673 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__clean)
[0m15:42:17.857112 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__mart: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list__mart"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'mart'
      

  ...
[0m15:42:17.863677 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list__clean"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'clean'
      

  ...
[0m15:42:17.873033 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m15:42:17.875477 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m15:42:17.896030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aae55851-ed49-40fd-9f04-e05739afa03b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c1d1c8d6910>]}
[0m15:42:17.897393 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m15:42:17.898667 [info ] [MainThread]: 
[0m15:42:17.914658 [debug] [Thread-1  ]: Began running node model.ex_01_mpg.mpg_standardized
[0m15:42:17.916455 [info ] [Thread-1  ]: 1 of 2 START sql table model `clean`.`mpg_standardized` ........................ [RUN]
[0m15:42:17.917694 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list__mart, now model.ex_01_mpg.mpg_standardized)
[0m15:42:17.918634 [debug] [Thread-1  ]: Began compiling node model.ex_01_mpg.mpg_standardized
[0m15:42:17.940158 [debug] [Thread-1  ]: Writing injected SQL for node "model.ex_01_mpg.mpg_standardized"
[0m15:42:17.941521 [debug] [Thread-1  ]: Began executing node model.ex_01_mpg.mpg_standardized
[0m15:42:18.075194 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.mpg_standardized"} */

            

    
        create table `clean`.`mpg_standardized__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

-- Source columns are already Nullable with correct types.
-- Keep them as-is to preserve nullability and avoid insert errors.

select
  mpg,            -- Nullable(Float64)
  cylinders,      -- Nullable(Int64)
  displacement,   -- Nullable(Float64)
  horsepower,     -- Nullable(Float64)
  /*
  coalesce(
        horsepower,
        avg(horsepower) over (partition by cylinders)
    ) as horsepower_imputed,
  */
  weight,         -- Nullable(Int64)
  acceleration,   -- Nullable(Float64)
  model_year,     -- Nullable(Int64)
  origin,         -- Nullable(String)
  name as make    -- Nullable(String)
from `raw`.`autompg___cars`
          )
        
        ...
[0m15:42:18.092847 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m15:42:18.116687 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.mpg_standardized"} */

    select name, type from system.columns where table = 'mpg_standardized__dbt_backup'
    
      and database = 'clean'
    
    order by position
  ...
[0m15:42:18.122700 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m15:42:18.131228 [debug] [Thread-1  ]: Writing runtime sql for node "model.ex_01_mpg.mpg_standardized"
[0m15:42:18.133018 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.mpg_standardized"} */

  
    
    
    
        
         


        insert into `clean`.`mpg_standardized__dbt_backup`
        ("mpg", "cylinders", "displacement", "horsepower", "weight", "acceleration", "model_year", "origin", "make")

-- Source columns are already Nullable with correct types.
-- Keep them as-is to preserve nullability and avoid insert errors.

select
  mpg,            -- Nullable(Float64)
  cylinders,      -- Nullable(Int64)
  displacement,   -- Nullable(Float64)
  horsepower,     -- Nullable(Float64)
  /*
  coalesce(
        horsepower,
        avg(horsepower) over (partition by cylinders)
    ) as horsepower_imputed,
  */
  weight,         -- Nullable(Int64)
  acceleration,   -- Nullable(Float64)
  model_year,     -- Nullable(Int64)
  origin,         -- Nullable(String)
  name as make    -- Nullable(String)
from `raw`.`autompg___cars`
  ...
[0m15:42:18.140266 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m15:42:18.152454 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.mpg_standardized"} */
EXCHANGE TABLES `clean`.`mpg_standardized__dbt_backup` AND `clean`.`mpg_standardized` 
  
  ...
[0m15:42:18.156899 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m15:42:18.240249 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.mpg_standardized"} */

    drop table if exists `clean`.`mpg_standardized__dbt_backup` 
  ...
[0m15:42:18.245339 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m15:42:18.255720 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aae55851-ed49-40fd-9f04-e05739afa03b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c1d1c545a60>]}
[0m15:42:18.257584 [info ] [Thread-1  ]: 1 of 2 OK created sql table model `clean`.`mpg_standardized` ................... [[32mOK[0m in 0.34s]
[0m15:42:18.259868 [debug] [Thread-1  ]: Finished running node model.ex_01_mpg.mpg_standardized
[0m15:42:18.262072 [debug] [Thread-3  ]: Began running node model.ex_01_mpg.cylinders_by_origin
[0m15:42:18.263359 [info ] [Thread-3  ]: 2 of 2 START sql view model `mart`.`cylinders_by_origin` ....................... [RUN]
[0m15:42:18.265323 [debug] [Thread-3  ]: Acquiring new clickhouse connection 'model.ex_01_mpg.cylinders_by_origin'
[0m15:42:18.266901 [debug] [Thread-3  ]: Began compiling node model.ex_01_mpg.cylinders_by_origin
[0m15:42:18.277326 [debug] [Thread-3  ]: Writing injected SQL for node "model.ex_01_mpg.cylinders_by_origin"
[0m15:42:18.278967 [debug] [Thread-3  ]: Began executing node model.ex_01_mpg.cylinders_by_origin
[0m15:42:18.349167 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m15:42:18.636879 [debug] [Thread-3  ]: Writing runtime sql for node "model.ex_01_mpg.cylinders_by_origin"
[0m15:42:18.638679 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */


  create view `mart`.`cylinders_by_origin__dbt_tmp` 
  
    
    
  as (
    

select
  origin,
  avg(cylinders) as avg_cylinders,
  count()        as n
from `clean`.`mpg_standardized`
group by origin
    
  )
      
      
                    -- end_of_sql
                    
                    ...
[0m15:42:18.687181 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m15:42:18.709753 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */

    drop table if exists `mart`.`cylinders_by_origin__dbt_backup` 
  
  ...
[0m15:42:18.713541 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m15:42:18.717042 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */

    rename table `mart`.`cylinders_by_origin` to `mart`.`cylinders_by_origin__dbt_backup` 
  
  ...
[0m15:42:18.721338 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m15:42:18.730303 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */

    drop table if exists `mart`.`cylinders_by_origin` 
  
  ...
[0m15:42:18.733358 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m15:42:18.735535 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */

    rename table `mart`.`cylinders_by_origin__dbt_tmp` to `mart`.`cylinders_by_origin` 
  
  ...
[0m15:42:18.739123 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m15:42:18.747528 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */

    drop table if exists `mart`.`cylinders_by_origin__dbt_backup` 
  ...
[0m15:42:18.751207 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m15:42:18.754096 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aae55851-ed49-40fd-9f04-e05739afa03b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c1d1e14bfa0>]}
[0m15:42:18.755473 [info ] [Thread-3  ]: 2 of 2 OK created sql view model `mart`.`cylinders_by_origin` .................. [[32mOK[0m in 0.49s]
[0m15:42:18.757728 [debug] [Thread-3  ]: Finished running node model.ex_01_mpg.cylinders_by_origin
[0m15:42:18.759990 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:42:18.760845 [debug] [MainThread]: Connection 'model.ex_01_mpg.mpg_standardized' was left open.
[0m15:42:18.761705 [debug] [MainThread]: On model.ex_01_mpg.mpg_standardized: Close
[0m15:42:18.762608 [debug] [MainThread]: Connection 'list__clean' was left open.
[0m15:42:18.763159 [debug] [MainThread]: On list__clean: Close
[0m15:42:18.763724 [debug] [MainThread]: Connection 'model.ex_01_mpg.cylinders_by_origin' was left open.
[0m15:42:18.764415 [debug] [MainThread]: On model.ex_01_mpg.cylinders_by_origin: Close
[0m15:42:18.765548 [info ] [MainThread]: 
[0m15:42:18.766464 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 1.45 seconds (1.45s).
[0m15:42:18.768863 [debug] [MainThread]: Command end result
[0m15:42:18.840934 [info ] [MainThread]: 
[0m15:42:18.842281 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:42:18.843005 [info ] [MainThread]: 
[0m15:42:18.843946 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m15:42:18.845567 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 3.5258176, "process_in_blocks": "0", "process_kernel_time": 0.797307, "process_mem_max_rss": "114260", "process_out_blocks": "10488", "process_user_time": 7.242711}
[0m15:42:18.846452 [debug] [MainThread]: Command `dbt build` succeeded at 15:42:18.846214 after 3.53 seconds
[0m15:42:18.847230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c1d2184e310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c1d1dbc6280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c1d1c581bb0>]}
[0m15:42:18.847865 [debug] [MainThread]: Flushing usage events
[0m16:50:36.802716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74c2ec332310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74c2e8fa9a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74c2e8fa9940>]}


============================== 16:50:36.843344 | 08f0177e-05b4-4442-b519-453a2f76b76a ==============================
[0m16:50:36.843344 [info ] [MainThread]: Running with dbt=1.8.9
[0m16:50:36.844633 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'use_colors': 'True', 'printer_width': '80', 'fail_fast': 'False', 'partial_parse': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'target_path': 'None', 'debug': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': '/workdir/transforms/01_mpg/logs', 'write_json': 'True', 'empty': 'False', 'cache_selected_only': 'False', 'profiles_dir': '.', 'warn_error': 'None', 'invocation_command': 'dbt build --profiles-dir . --target local'}
[0m16:50:37.153323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '08f0177e-05b4-4442-b519-453a2f76b76a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74c2e8f65850>]}
[0m16:50:37.266730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '08f0177e-05b4-4442-b519-453a2f76b76a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74c2e8e7fca0>]}
[0m16:50:37.268206 [info ] [MainThread]: Registered adapter: clickhouse=1.8.6
[0m16:50:37.452454 [debug] [MainThread]: checksum: 134c0f7b96382cc6938697739bc32fb1adc530b177e30f60cebddf61dbd7e979, vars: {}, profile: , target: local, version: 1.8.9
[0m16:50:37.762672 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:50:37.763376 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:50:37.850210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08f0177e-05b4-4442-b519-453a2f76b76a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74c2e881be50>]}
[0m16:50:38.272667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '08f0177e-05b4-4442-b519-453a2f76b76a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74c2e8866370>]}
[0m16:50:38.274421 [info ] [MainThread]: Found 2 models, 1 source, 471 macros
[0m16:50:38.279835 [info ] [MainThread]: 
[0m16:50:38.281983 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m16:50:38.306057 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m16:50:38.308183 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m16:50:38.376382 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:50:38.380132 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:50:38.647676 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m16:50:38.652543 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m16:50:38.660081 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m16:50:38.664687 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m16:50:38.684537 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__mart)
[0m16:50:38.685565 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__clean)
[0m16:50:38.697403 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__mart: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list__mart"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'mart'
      

  ...
[0m16:50:38.701765 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list__clean"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'clean'
      

  ...
[0m16:50:38.711287 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m16:50:38.712971 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m16:50:38.730902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '08f0177e-05b4-4442-b519-453a2f76b76a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74c2e871dc70>]}
[0m16:50:38.731995 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m16:50:38.732679 [info ] [MainThread]: 
[0m16:50:38.746854 [debug] [Thread-1  ]: Began running node model.ex_01_mpg.mpg_standardized
[0m16:50:38.748037 [info ] [Thread-1  ]: 1 of 2 START sql table model `clean`.`mpg_standardized` ........................ [RUN]
[0m16:50:38.749207 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.ex_01_mpg.mpg_standardized'
[0m16:50:38.750111 [debug] [Thread-1  ]: Began compiling node model.ex_01_mpg.mpg_standardized
[0m16:50:38.771147 [debug] [Thread-1  ]: Writing injected SQL for node "model.ex_01_mpg.mpg_standardized"
[0m16:50:38.772456 [debug] [Thread-1  ]: Began executing node model.ex_01_mpg.mpg_standardized
[0m16:50:38.883153 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m16:50:38.948810 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.mpg_standardized"} */

            

    
        create table `clean`.`mpg_standardized__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

-- Source columns are already Nullable with correct types.
-- Keep them as-is to preserve nullability and avoid insert errors.

select
  mpg,            -- Nullable(Float64)
  cylinders,      -- Nullable(Int64)
  displacement,   -- Nullable(Float64)
  horsepower,     -- Nullable(Float64)
  /*
  coalesce(
        horsepower,
        avg(horsepower) over (partition by cylinders)
    ) as horsepower_imputed,
  */
  weight,         -- Nullable(Int64)
  acceleration,   -- Nullable(Float64)
  model_year,     -- Nullable(Int64)
  origin,         -- Nullable(String)
  name as make    -- Nullable(String)
from `raw`.`autompg___cars`
          )
        
        ...
[0m16:50:38.967159 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m16:50:38.983859 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.mpg_standardized"} */

    select name, type from system.columns where table = 'mpg_standardized__dbt_backup'
    
      and database = 'clean'
    
    order by position
  ...
[0m16:50:38.989349 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m16:50:38.996016 [debug] [Thread-1  ]: Writing runtime sql for node "model.ex_01_mpg.mpg_standardized"
[0m16:50:38.997569 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.mpg_standardized"} */

  
    
    
    
        
         


        insert into `clean`.`mpg_standardized__dbt_backup`
        ("mpg", "cylinders", "displacement", "horsepower", "weight", "acceleration", "model_year", "origin", "make")

-- Source columns are already Nullable with correct types.
-- Keep them as-is to preserve nullability and avoid insert errors.

select
  mpg,            -- Nullable(Float64)
  cylinders,      -- Nullable(Int64)
  displacement,   -- Nullable(Float64)
  horsepower,     -- Nullable(Float64)
  /*
  coalesce(
        horsepower,
        avg(horsepower) over (partition by cylinders)
    ) as horsepower_imputed,
  */
  weight,         -- Nullable(Int64)
  acceleration,   -- Nullable(Float64)
  model_year,     -- Nullable(Int64)
  origin,         -- Nullable(String)
  name as make    -- Nullable(String)
from `raw`.`autompg___cars`
  ...
[0m16:50:39.005046 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m16:50:39.014679 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.mpg_standardized"} */
EXCHANGE TABLES `clean`.`mpg_standardized__dbt_backup` AND `clean`.`mpg_standardized` 
  
  ...
[0m16:50:39.018072 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m16:50:39.140493 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.mpg_standardized"} */

    drop table if exists `clean`.`mpg_standardized__dbt_backup` 
  ...
[0m16:50:39.143889 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m16:50:39.150685 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08f0177e-05b4-4442-b519-453a2f76b76a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74c2eb8dd520>]}
[0m16:50:39.152134 [info ] [Thread-1  ]: 1 of 2 OK created sql table model `clean`.`mpg_standardized` ................... [[32mOK[0m in 0.40s]
[0m16:50:39.153624 [debug] [Thread-1  ]: Finished running node model.ex_01_mpg.mpg_standardized
[0m16:50:39.155318 [debug] [Thread-3  ]: Began running node model.ex_01_mpg.cylinders_by_origin
[0m16:50:39.156347 [info ] [Thread-3  ]: 2 of 2 START sql view model `mart`.`cylinders_by_origin` ....................... [RUN]
[0m16:50:39.157465 [debug] [Thread-3  ]: Acquiring new clickhouse connection 'model.ex_01_mpg.cylinders_by_origin'
[0m16:50:39.158295 [debug] [Thread-3  ]: Began compiling node model.ex_01_mpg.cylinders_by_origin
[0m16:50:39.164429 [debug] [Thread-3  ]: Writing injected SQL for node "model.ex_01_mpg.cylinders_by_origin"
[0m16:50:39.165672 [debug] [Thread-3  ]: Began executing node model.ex_01_mpg.cylinders_by_origin
[0m16:50:39.216734 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m16:50:39.277494 [debug] [Thread-3  ]: Writing runtime sql for node "model.ex_01_mpg.cylinders_by_origin"
[0m16:50:39.279292 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */


  create view `mart`.`cylinders_by_origin__dbt_tmp` 
  
    
    
  as (
    

select
  origin,
  avg(cylinders) as avg_cylinders,
  count()        as n
from `clean`.`mpg_standardized`
group by origin
    
  )
      
      
                    -- end_of_sql
                    
                    ...
[0m16:50:39.288573 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m16:50:39.303053 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */

    drop table if exists `mart`.`cylinders_by_origin__dbt_backup` 
  
  ...
[0m16:50:39.305994 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m16:50:39.307955 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */

    rename table `mart`.`cylinders_by_origin` to `mart`.`cylinders_by_origin__dbt_backup` 
  
  ...
[0m16:50:39.310779 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m16:50:39.317506 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */

    drop table if exists `mart`.`cylinders_by_origin` 
  
  ...
[0m16:50:39.320415 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m16:50:39.322454 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */

    rename table `mart`.`cylinders_by_origin__dbt_tmp` to `mart`.`cylinders_by_origin` 
  
  ...
[0m16:50:39.325195 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m16:50:39.331788 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */

    drop table if exists `mart`.`cylinders_by_origin__dbt_backup` 
  ...
[0m16:50:39.334819 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m16:50:39.337426 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08f0177e-05b4-4442-b519-453a2f76b76a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74c2e84ec1c0>]}
[0m16:50:39.338581 [info ] [Thread-3  ]: 2 of 2 OK created sql view model `mart`.`cylinders_by_origin` .................. [[32mOK[0m in 0.18s]
[0m16:50:39.339893 [debug] [Thread-3  ]: Finished running node model.ex_01_mpg.cylinders_by_origin
[0m16:50:39.341845 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:50:39.342429 [debug] [MainThread]: Connection 'list__mart' was left open.
[0m16:50:39.342980 [debug] [MainThread]: On list__mart: Close
[0m16:50:39.343526 [debug] [MainThread]: Connection 'list__clean' was left open.
[0m16:50:39.344027 [debug] [MainThread]: On list__clean: Close
[0m16:50:39.344553 [debug] [MainThread]: Connection 'model.ex_01_mpg.mpg_standardized' was left open.
[0m16:50:39.345082 [debug] [MainThread]: On model.ex_01_mpg.mpg_standardized: Close
[0m16:50:39.345615 [debug] [MainThread]: Connection 'model.ex_01_mpg.cylinders_by_origin' was left open.
[0m16:50:39.346115 [debug] [MainThread]: On model.ex_01_mpg.cylinders_by_origin: Close
[0m16:50:39.347035 [info ] [MainThread]: 
[0m16:50:39.347791 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 1.07 seconds (1.07s).
[0m16:50:39.349511 [debug] [MainThread]: Command end result
[0m16:50:39.403090 [info ] [MainThread]: 
[0m16:50:39.404067 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:50:39.404680 [info ] [MainThread]: 
[0m16:50:39.405300 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m16:50:39.406614 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 2.716494, "process_in_blocks": "1176", "process_kernel_time": 0.663395, "process_mem_max_rss": "111588", "process_out_blocks": "9512", "process_user_time": 5.410069}
[0m16:50:39.407397 [debug] [MainThread]: Command `dbt build` succeeded at 16:50:39.407194 after 2.72 seconds
[0m16:50:39.408339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74c2ec332310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74c2e864a100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74c2ea1b9070>]}
[0m16:50:39.409425 [debug] [MainThread]: Flushing usage events
[0m09:19:29.977543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7784f87b6310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7784f5403b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7784f5403a30>]}


============================== 09:19:29.987438 | 5541719b-e27a-486a-a8de-27661def451e ==============================
[0m09:19:29.987438 [info ] [MainThread]: Running with dbt=1.8.9
[0m09:19:29.988587 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'indirect_selection': 'eager', 'warn_error': 'None', 'version_check': 'True', 'quiet': 'False', 'empty': 'False', 'target_path': 'None', 'debug': 'False', 'invocation_command': 'dbt build --profiles-dir . --target local', 'printer_width': '80', 'log_format': 'default', 'profiles_dir': '.', 'use_colors': 'True', 'log_path': '/workdir/transforms/01_mpg/logs', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'fail_fast': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])'}
[0m09:19:30.291757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5541719b-e27a-486a-a8de-27661def451e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7784f52cc3a0>]}
[0m09:19:30.411882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5541719b-e27a-486a-a8de-27661def451e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7784f5369610>]}
[0m09:19:30.413394 [info ] [MainThread]: Registered adapter: clickhouse=1.8.6
[0m09:19:30.594048 [debug] [MainThread]: checksum: 134c0f7b96382cc6938697739bc32fb1adc530b177e30f60cebddf61dbd7e979, vars: {}, profile: , target: local, version: 1.8.9
[0m09:19:30.887163 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:19:30.887885 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:19:30.963706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5541719b-e27a-486a-a8de-27661def451e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7784f4c8cdf0>]}
[0m09:19:31.364668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5541719b-e27a-486a-a8de-27661def451e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7784f4b94b80>]}
[0m09:19:31.366394 [info ] [MainThread]: Found 2 models, 1 source, 471 macros
[0m09:19:31.371183 [info ] [MainThread]: 
[0m09:19:31.373192 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m09:19:31.411092 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m09:19:31.418807 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m09:19:31.494040 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:19:31.489622 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:19:31.805583 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m09:19:31.810843 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m09:19:31.812737 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:19:31.817964 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:19:31.842380 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__clean)
[0m09:19:31.843663 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__mart)
[0m09:19:31.856052 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list__clean"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'clean'
      

  ...
[0m09:19:31.861076 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__mart: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list__mart"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'mart'
      

  ...
[0m09:19:31.870616 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m09:19:31.872689 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m09:19:31.895924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5541719b-e27a-486a-a8de-27661def451e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7784f5369dc0>]}
[0m09:19:31.897528 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m09:19:31.898494 [info ] [MainThread]: 
[0m09:19:31.918629 [debug] [Thread-1  ]: Began running node model.ex_01_mpg.mpg_standardized
[0m09:19:31.919857 [info ] [Thread-1  ]: 1 of 2 START sql table model `clean`.`mpg_standardized` ........................ [RUN]
[0m09:19:31.921089 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.ex_01_mpg.mpg_standardized'
[0m09:19:31.921945 [debug] [Thread-1  ]: Began compiling node model.ex_01_mpg.mpg_standardized
[0m09:19:31.939595 [debug] [Thread-1  ]: Writing injected SQL for node "model.ex_01_mpg.mpg_standardized"
[0m09:19:31.940906 [debug] [Thread-1  ]: Began executing node model.ex_01_mpg.mpg_standardized
[0m09:19:32.047454 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m09:19:32.105379 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.mpg_standardized"} */

            

    
        create table `clean`.`mpg_standardized__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

-- Source columns are already Nullable with correct types.
-- Keep them as-is to preserve nullability and avoid insert errors.

select
  mpg,            -- Nullable(Float64)
  cylinders,      -- Nullable(Int64)
  displacement,   -- Nullable(Float64)
  horsepower,     -- Nullable(Float64)
  /*
  coalesce(
        horsepower,
        avg(horsepower) over (partition by cylinders)
    ) as horsepower_imputed,
  */
  weight,         -- Nullable(Int64)
  acceleration,   -- Nullable(Float64)
  model_year,     -- Nullable(Int64)
  origin,         -- Nullable(String)
  name as make    -- Nullable(String)
from `raw`.`autompg___cars`
          )
        
        ...
[0m09:19:32.120977 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m09:19:32.138191 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.mpg_standardized"} */

    select name, type from system.columns where table = 'mpg_standardized__dbt_backup'
    
      and database = 'clean'
    
    order by position
  ...
[0m09:19:32.143018 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:19:32.150989 [debug] [Thread-1  ]: Writing runtime sql for node "model.ex_01_mpg.mpg_standardized"
[0m09:19:32.152497 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.mpg_standardized"} */

  
    
    
    
        
         


        insert into `clean`.`mpg_standardized__dbt_backup`
        ("mpg", "cylinders", "displacement", "horsepower", "weight", "acceleration", "model_year", "origin", "make")

-- Source columns are already Nullable with correct types.
-- Keep them as-is to preserve nullability and avoid insert errors.

select
  mpg,            -- Nullable(Float64)
  cylinders,      -- Nullable(Int64)
  displacement,   -- Nullable(Float64)
  horsepower,     -- Nullable(Float64)
  /*
  coalesce(
        horsepower,
        avg(horsepower) over (partition by cylinders)
    ) as horsepower_imputed,
  */
  weight,         -- Nullable(Int64)
  acceleration,   -- Nullable(Float64)
  model_year,     -- Nullable(Int64)
  origin,         -- Nullable(String)
  name as make    -- Nullable(String)
from `raw`.`autompg___cars`
  ...
[0m09:19:32.160897 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m09:19:32.169753 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.mpg_standardized"} */
EXCHANGE TABLES `clean`.`mpg_standardized__dbt_backup` AND `clean`.`mpg_standardized` 
  
  ...
[0m09:19:32.173007 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:19:32.289313 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.mpg_standardized"} */

    drop table if exists `clean`.`mpg_standardized__dbt_backup` 
  ...
[0m09:19:32.292676 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:19:32.299220 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5541719b-e27a-486a-a8de-27661def451e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7784f47e4ee0>]}
[0m09:19:32.300654 [info ] [Thread-1  ]: 1 of 2 OK created sql table model `clean`.`mpg_standardized` ................... [[32mOK[0m in 0.38s]
[0m09:19:32.302228 [debug] [Thread-1  ]: Finished running node model.ex_01_mpg.mpg_standardized
[0m09:19:32.303931 [debug] [Thread-3  ]: Began running node model.ex_01_mpg.cylinders_by_origin
[0m09:19:32.305028 [info ] [Thread-3  ]: 2 of 2 START sql view model `mart`.`cylinders_by_origin` ....................... [RUN]
[0m09:19:32.306185 [debug] [Thread-3  ]: Acquiring new clickhouse connection 'model.ex_01_mpg.cylinders_by_origin'
[0m09:19:32.307111 [debug] [Thread-3  ]: Began compiling node model.ex_01_mpg.cylinders_by_origin
[0m09:19:32.313712 [debug] [Thread-3  ]: Writing injected SQL for node "model.ex_01_mpg.cylinders_by_origin"
[0m09:19:32.315085 [debug] [Thread-3  ]: Began executing node model.ex_01_mpg.cylinders_by_origin
[0m09:19:32.366076 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m09:19:32.424834 [debug] [Thread-3  ]: Writing runtime sql for node "model.ex_01_mpg.cylinders_by_origin"
[0m09:19:32.426854 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */


  create view `mart`.`cylinders_by_origin__dbt_tmp` 
  
    
    
  as (
    

select
  origin,
  avg(cylinders) as avg_cylinders,
  count()        as n
from `clean`.`mpg_standardized`
group by origin
    
  )
      
      
                    -- end_of_sql
                    
                    ...
[0m09:19:32.436908 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m09:19:32.459638 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */

    drop table if exists `mart`.`cylinders_by_origin__dbt_backup` 
  
  ...
[0m09:19:32.463800 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:19:32.468884 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */

    rename table `mart`.`cylinders_by_origin` to `mart`.`cylinders_by_origin__dbt_backup` 
  
  ...
[0m09:19:32.472989 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:19:32.479368 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */

    drop table if exists `mart`.`cylinders_by_origin` 
  
  ...
[0m09:19:32.482369 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:19:32.484453 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */

    rename table `mart`.`cylinders_by_origin__dbt_tmp` to `mart`.`cylinders_by_origin` 
  
  ...
[0m09:19:32.487361 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:19:32.494056 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */

    drop table if exists `mart`.`cylinders_by_origin__dbt_backup` 
  ...
[0m09:19:32.497059 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:19:32.499678 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5541719b-e27a-486a-a8de-27661def451e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7784f47e4ee0>]}
[0m09:19:32.500899 [info ] [Thread-3  ]: 2 of 2 OK created sql view model `mart`.`cylinders_by_origin` .................. [[32mOK[0m in 0.19s]
[0m09:19:32.502203 [debug] [Thread-3  ]: Finished running node model.ex_01_mpg.cylinders_by_origin
[0m09:19:32.504460 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:19:32.505327 [debug] [MainThread]: Connection 'list__clean' was left open.
[0m09:19:32.506185 [debug] [MainThread]: On list__clean: Close
[0m09:19:32.507001 [debug] [MainThread]: Connection 'list__mart' was left open.
[0m09:19:32.507838 [debug] [MainThread]: On list__mart: Close
[0m09:19:32.508680 [debug] [MainThread]: Connection 'model.ex_01_mpg.mpg_standardized' was left open.
[0m09:19:32.509535 [debug] [MainThread]: On model.ex_01_mpg.mpg_standardized: Close
[0m09:19:32.510327 [debug] [MainThread]: Connection 'model.ex_01_mpg.cylinders_by_origin' was left open.
[0m09:19:32.511125 [debug] [MainThread]: On model.ex_01_mpg.cylinders_by_origin: Close
[0m09:19:32.512589 [info ] [MainThread]: 
[0m09:19:32.513626 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 1.14 seconds (1.14s).
[0m09:19:32.516445 [debug] [MainThread]: Command end result
[0m09:19:32.583350 [info ] [MainThread]: 
[0m09:19:32.584334 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:19:32.584951 [info ] [MainThread]: 
[0m09:19:32.585671 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m09:19:32.587005 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 2.7343135, "process_in_blocks": "72", "process_kernel_time": 0.636494, "process_mem_max_rss": "111432", "process_out_blocks": "9512", "process_user_time": 5.346753}
[0m09:19:32.587777 [debug] [MainThread]: Command `dbt build` succeeded at 09:19:32.587581 after 2.74 seconds
[0m09:19:32.588423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7784f87b6310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7784f5f22760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7784f5369610>]}
[0m09:19:32.589039 [debug] [MainThread]: Flushing usage events
[0m09:19:49.189806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76712a5f0310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767127251b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7671272519d0>]}


============================== 09:19:49.199960 | 9585bed5-a783-4a2b-abdc-56317c924289 ==============================
[0m09:19:49.199960 [info ] [MainThread]: Running with dbt=1.8.9
[0m09:19:49.201208 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_format': 'default', 'invocation_command': 'dbt build --profiles-dir .', 'use_colors': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'cache_selected_only': 'False', 'profiles_dir': '.', 'target_path': 'None', 'no_print': 'None', 'fail_fast': 'False', 'printer_width': '80', 'partial_parse': 'True', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'log_path': '/workdir/transforms/01_mpg/logs', 'empty': 'False'}
[0m09:19:49.493886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9585bed5-a783-4a2b-abdc-56317c924289', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76712a7dc1f0>]}
[0m09:19:49.591996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9585bed5-a783-4a2b-abdc-56317c924289', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76712730c070>]}
[0m09:19:49.593481 [info ] [MainThread]: Registered adapter: clickhouse=1.8.6
[0m09:19:49.759876 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m09:19:49.960104 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m09:19:49.961045 [debug] [MainThread]: previous checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, current checksum: 134c0f7b96382cc6938697739bc32fb1adc530b177e30f60cebddf61dbd7e979
[0m09:19:49.961792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9585bed5-a783-4a2b-abdc-56317c924289', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7671285890a0>]}
[0m09:19:52.634520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9585bed5-a783-4a2b-abdc-56317c924289', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767125700130>]}
[0m09:19:52.847419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9585bed5-a783-4a2b-abdc-56317c924289', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7671255e13a0>]}
[0m09:19:52.848335 [info ] [MainThread]: Found 2 models, 1 source, 471 macros
[0m09:19:52.851070 [info ] [MainThread]: 
[0m09:19:52.852082 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m09:19:52.866008 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m09:19:52.867314 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m09:19:52.887794 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:19:52.891683 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:19:53.148580 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m09:19:53.154125 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:19:53.155373 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m09:19:53.159309 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:19:53.182332 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__clean)
[0m09:19:53.183374 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__mart)
[0m09:19:53.195649 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list__clean"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'clean'
      

  ...
[0m09:19:53.199826 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__mart: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list__mart"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'mart'
      

  ...
[0m09:19:53.205917 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m09:19:53.207250 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m09:19:53.222070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9585bed5-a783-4a2b-abdc-56317c924289', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7671272096a0>]}
[0m09:19:53.223098 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m09:19:53.223764 [info ] [MainThread]: 
[0m09:19:53.236600 [debug] [Thread-1  ]: Began running node model.ex_01_mpg.mpg_standardized
[0m09:19:53.237819 [info ] [Thread-1  ]: 1 of 2 START sql table model `clean`.`mpg_standardized` ........................ [RUN]
[0m09:19:53.238947 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.ex_01_mpg.mpg_standardized'
[0m09:19:53.239703 [debug] [Thread-1  ]: Began compiling node model.ex_01_mpg.mpg_standardized
[0m09:19:53.256610 [debug] [Thread-1  ]: Writing injected SQL for node "model.ex_01_mpg.mpg_standardized"
[0m09:19:53.257874 [debug] [Thread-1  ]: Began executing node model.ex_01_mpg.mpg_standardized
[0m09:19:53.359140 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m09:19:53.419440 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.mpg_standardized"} */

            

    
        create table `clean`.`mpg_standardized__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

-- Source columns are already Nullable with correct types.
-- Keep them as-is to preserve nullability and avoid insert errors.

select
  mpg,            -- Nullable(Float64)
  cylinders,      -- Nullable(Int64)
  displacement,   -- Nullable(Float64)
  horsepower,     -- Nullable(Float64)
  /*
  coalesce(
        horsepower,
        avg(horsepower) over (partition by cylinders)
    ) as horsepower_imputed,
  */
  weight,         -- Nullable(Int64)
  acceleration,   -- Nullable(Float64)
  model_year,     -- Nullable(Int64)
  origin,         -- Nullable(String)
  name as make    -- Nullable(String)
from `raw`.`autompg___cars`
          )
        
        ...
[0m09:19:53.438338 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m09:19:53.460511 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.mpg_standardized"} */

    select name, type from system.columns where table = 'mpg_standardized__dbt_backup'
    
      and database = 'clean'
    
    order by position
  ...
[0m09:19:53.468837 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m09:19:53.476606 [debug] [Thread-1  ]: Writing runtime sql for node "model.ex_01_mpg.mpg_standardized"
[0m09:19:53.478108 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.mpg_standardized"} */

  
    
    
    
        
         


        insert into `clean`.`mpg_standardized__dbt_backup`
        ("mpg", "cylinders", "displacement", "horsepower", "weight", "acceleration", "model_year", "origin", "make")

-- Source columns are already Nullable with correct types.
-- Keep them as-is to preserve nullability and avoid insert errors.

select
  mpg,            -- Nullable(Float64)
  cylinders,      -- Nullable(Int64)
  displacement,   -- Nullable(Float64)
  horsepower,     -- Nullable(Float64)
  /*
  coalesce(
        horsepower,
        avg(horsepower) over (partition by cylinders)
    ) as horsepower_imputed,
  */
  weight,         -- Nullable(Int64)
  acceleration,   -- Nullable(Float64)
  model_year,     -- Nullable(Int64)
  origin,         -- Nullable(String)
  name as make    -- Nullable(String)
from `raw`.`autompg___cars`
  ...
[0m09:19:53.487120 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m09:19:53.497600 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.mpg_standardized"} */
EXCHANGE TABLES `clean`.`mpg_standardized__dbt_backup` AND `clean`.`mpg_standardized` 
  
  ...
[0m09:19:53.502283 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:19:53.559415 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.mpg_standardized"} */

    drop table if exists `clean`.`mpg_standardized__dbt_backup` 
  ...
[0m09:19:53.563027 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:19:53.569882 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9585bed5-a783-4a2b-abdc-56317c924289', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7671249d8220>]}
[0m09:19:53.571378 [info ] [Thread-1  ]: 1 of 2 OK created sql table model `clean`.`mpg_standardized` ................... [[32mOK[0m in 0.33s]
[0m09:19:53.572854 [debug] [Thread-1  ]: Finished running node model.ex_01_mpg.mpg_standardized
[0m09:19:53.574617 [debug] [Thread-3  ]: Began running node model.ex_01_mpg.cylinders_by_origin
[0m09:19:53.575708 [info ] [Thread-3  ]: 2 of 2 START sql view model `mart`.`cylinders_by_origin` ....................... [RUN]
[0m09:19:53.577013 [debug] [Thread-3  ]: Acquiring new clickhouse connection 'model.ex_01_mpg.cylinders_by_origin'
[0m09:19:53.577985 [debug] [Thread-3  ]: Began compiling node model.ex_01_mpg.cylinders_by_origin
[0m09:19:53.584963 [debug] [Thread-3  ]: Writing injected SQL for node "model.ex_01_mpg.cylinders_by_origin"
[0m09:19:53.586408 [debug] [Thread-3  ]: Began executing node model.ex_01_mpg.cylinders_by_origin
[0m09:19:53.639715 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m09:19:53.709773 [debug] [Thread-3  ]: Writing runtime sql for node "model.ex_01_mpg.cylinders_by_origin"
[0m09:19:53.711766 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */


  create view `mart`.`cylinders_by_origin__dbt_tmp` 
  
    
    
  as (
    

select
  origin,
  avg(cylinders) as avg_cylinders,
  count()        as n
from `clean`.`mpg_standardized`
group by origin
    
  )
      
      
                    -- end_of_sql
                    
                    ...
[0m09:19:53.721964 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m09:19:53.746003 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */

    drop table if exists `mart`.`cylinders_by_origin__dbt_backup` 
  
  ...
[0m09:19:53.749061 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:19:53.751112 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */

    rename table `mart`.`cylinders_by_origin` to `mart`.`cylinders_by_origin__dbt_backup` 
  
  ...
[0m09:19:53.753890 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:19:53.760167 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */

    drop table if exists `mart`.`cylinders_by_origin` 
  
  ...
[0m09:19:53.763012 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:19:53.764991 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */

    rename table `mart`.`cylinders_by_origin__dbt_tmp` to `mart`.`cylinders_by_origin` 
  
  ...
[0m09:19:53.767827 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:19:53.774829 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */

    drop table if exists `mart`.`cylinders_by_origin__dbt_backup` 
  ...
[0m09:19:53.777877 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:19:53.780455 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9585bed5-a783-4a2b-abdc-56317c924289', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767125529f10>]}
[0m09:19:53.781607 [info ] [Thread-3  ]: 2 of 2 OK created sql view model `mart`.`cylinders_by_origin` .................. [[32mOK[0m in 0.20s]
[0m09:19:53.782931 [debug] [Thread-3  ]: Finished running node model.ex_01_mpg.cylinders_by_origin
[0m09:19:53.785199 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:19:53.786178 [debug] [MainThread]: Connection 'list__clean' was left open.
[0m09:19:53.787072 [debug] [MainThread]: On list__clean: Close
[0m09:19:53.787973 [debug] [MainThread]: Connection 'list__mart' was left open.
[0m09:19:53.788848 [debug] [MainThread]: On list__mart: Close
[0m09:19:53.789686 [debug] [MainThread]: Connection 'model.ex_01_mpg.mpg_standardized' was left open.
[0m09:19:53.790536 [debug] [MainThread]: On model.ex_01_mpg.mpg_standardized: Close
[0m09:19:53.791357 [debug] [MainThread]: Connection 'model.ex_01_mpg.cylinders_by_origin' was left open.
[0m09:19:53.792188 [debug] [MainThread]: On model.ex_01_mpg.cylinders_by_origin: Close
[0m09:19:53.793693 [info ] [MainThread]: 
[0m09:19:53.794754 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.94 seconds (0.94s).
[0m09:19:53.797626 [debug] [MainThread]: Command end result
[0m09:19:53.947519 [info ] [MainThread]: 
[0m09:19:53.948529 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:19:53.949129 [info ] [MainThread]: 
[0m09:19:53.949792 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m09:19:53.951100 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 4.886012, "process_in_blocks": "472", "process_kernel_time": 0.681454, "process_mem_max_rss": "115164", "process_out_blocks": "10488", "process_user_time": 7.572941}
[0m09:19:53.951858 [debug] [MainThread]: Command `dbt build` succeeded at 09:19:53.951664 after 4.89 seconds
[0m09:19:53.952495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76712a5f0310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767126cc02e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76712526b7f0>]}
[0m09:19:53.953089 [debug] [MainThread]: Flushing usage events
[0m09:20:07.673229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8b95ea5310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8b92af0af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8b92af09a0>]}


============================== 09:20:07.683119 | 3a58f05a-4b9e-491c-966b-6f51980380e1 ==============================
[0m09:20:07.683119 [info ] [MainThread]: Running with dbt=1.8.9
[0m09:20:07.684346 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'fail_fast': 'False', 'log_cache_events': 'False', 'target_path': 'None', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'log_format': 'default', 'quiet': 'False', 'debug': 'False', 'use_colors': 'True', 'partial_parse': 'True', 'introspect': 'True', 'warn_error': 'None', 'printer_width': '80', 'invocation_command': 'dbt build --profiles-dir . --target remote', 'profiles_dir': '.', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': '/workdir/transforms/01_mpg/logs', 'write_json': 'True', 'version_check': 'True', 'no_print': 'None'}
[0m09:20:08.017646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3a58f05a-4b9e-491c-966b-6f51980380e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8b92ab6a60>]}
[0m09:20:08.112416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3a58f05a-4b9e-491c-966b-6f51980380e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8b929ed160>]}
[0m09:20:08.113797 [info ] [MainThread]: Registered adapter: clickhouse=1.8.6
[0m09:20:08.279358 [debug] [MainThread]: checksum: 265ce5244aff672775eaff93c261d21692ed3f5650f4d9e918c76acdb0e9479a, vars: {}, profile: , target: remote, version: 1.8.9
[0m09:20:08.464198 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m09:20:08.465089 [debug] [MainThread]: previous checksum: 265ce5244aff672775eaff93c261d21692ed3f5650f4d9e918c76acdb0e9479a, current checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1
[0m09:20:08.465825 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m09:20:08.466500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3a58f05a-4b9e-491c-966b-6f51980380e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8b93e269d0>]}
[0m09:20:11.014034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3a58f05a-4b9e-491c-966b-6f51980380e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8b90f9a130>]}
[0m09:20:11.254168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3a58f05a-4b9e-491c-966b-6f51980380e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8b90e755b0>]}
[0m09:20:11.255062 [info ] [MainThread]: Found 2 models, 1 source, 471 macros
[0m09:20:11.257790 [info ] [MainThread]: 
[0m09:20:11.258785 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m09:20:11.271808 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m09:20:11.283499 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m09:20:11.293652 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:20:11.297658 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:20:14.825958 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m09:20:14.827479 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m09:20:15.078338 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.25 seconds
[0m09:20:15.080613 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.25 seconds
[0m09:20:15.120181 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__mart)
[0m09:20:15.121400 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__clean)
[0m09:20:15.133453 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__mart: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "connection_name": "list__mart"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'mart'
      

  ...
[0m09:20:15.137619 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "connection_name": "list__clean"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'clean'
      

  ...
[0m09:20:15.391058 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.25 seconds
[0m09:20:15.395930 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.26 seconds
[0m09:20:15.398456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a58f05a-4b9e-491c-966b-6f51980380e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8b92a546d0>]}
[0m09:20:15.399414 [info ] [MainThread]: Concurrency: 4 threads (target='remote')
[0m09:20:15.400036 [info ] [MainThread]: 
[0m09:20:15.413638 [debug] [Thread-1  ]: Began running node model.ex_01_mpg.mpg_standardized
[0m09:20:15.414825 [info ] [Thread-1  ]: 1 of 2 START sql table model `clean`.`mpg_standardized` ........................ [RUN]
[0m09:20:15.415950 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.ex_01_mpg.mpg_standardized'
[0m09:20:15.416761 [debug] [Thread-1  ]: Began compiling node model.ex_01_mpg.mpg_standardized
[0m09:20:15.434022 [debug] [Thread-1  ]: Writing injected SQL for node "model.ex_01_mpg.mpg_standardized"
[0m09:20:15.435367 [debug] [Thread-1  ]: Began executing node model.ex_01_mpg.mpg_standardized
[0m09:20:15.474633 [debug] [Thread-1  ]: Creating new relation mpg_standardized
[0m09:20:15.528100 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m09:20:18.551553 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_01_mpg.mpg_standardized"} */

            

    
        create table `clean`.`mpg_standardized`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

-- Source columns are already Nullable with correct types.
-- Keep them as-is to preserve nullability and avoid insert errors.

select
  mpg,            -- Nullable(Float64)
  cylinders,      -- Nullable(Int64)
  displacement,   -- Nullable(Float64)
  horsepower,     -- Nullable(Float64)
  /*
  coalesce(
        horsepower,
        avg(horsepower) over (partition by cylinders)
    ) as horsepower_imputed,
  */
  weight,         -- Nullable(Int64)
  acceleration,   -- Nullable(Float64)
  model_year,     -- Nullable(Int64)
  origin,         -- Nullable(String)
  name as make    -- Nullable(String)
from `raw`.`autompg___cars`
          )
        
        ...
[0m09:20:18.817148 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.26 seconds
[0m09:20:18.834920 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_01_mpg.mpg_standardized"} */

    select name, type from system.columns where table = 'mpg_standardized'
    
      and database = 'clean'
    
    order by position
  ...
[0m09:20:19.093954 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.26 seconds
[0m09:20:19.100622 [debug] [Thread-1  ]: Writing runtime sql for node "model.ex_01_mpg.mpg_standardized"
[0m09:20:19.102101 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_01_mpg.mpg_standardized"} */

  
    
    
    
        
         


        insert into `clean`.`mpg_standardized`
        ("mpg", "cylinders", "displacement", "horsepower", "weight", "acceleration", "model_year", "origin", "make")

-- Source columns are already Nullable with correct types.
-- Keep them as-is to preserve nullability and avoid insert errors.

select
  mpg,            -- Nullable(Float64)
  cylinders,      -- Nullable(Int64)
  displacement,   -- Nullable(Float64)
  horsepower,     -- Nullable(Float64)
  /*
  coalesce(
        horsepower,
        avg(horsepower) over (partition by cylinders)
    ) as horsepower_imputed,
  */
  weight,         -- Nullable(Int64)
  acceleration,   -- Nullable(Float64)
  model_year,     -- Nullable(Int64)
  origin,         -- Nullable(String)
  name as make    -- Nullable(String)
from `raw`.`autompg___cars`
  ...
[0m09:20:19.360024 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.26 seconds
[0m09:20:19.443089 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a58f05a-4b9e-491c-966b-6f51980380e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8b9542f820>]}
[0m09:20:19.445871 [info ] [Thread-1  ]: 1 of 2 OK created sql table model `clean`.`mpg_standardized` ................... [[32mOK[0m in 4.02s]
[0m09:20:19.449099 [debug] [Thread-1  ]: Finished running node model.ex_01_mpg.mpg_standardized
[0m09:20:19.452189 [debug] [Thread-3  ]: Began running node model.ex_01_mpg.cylinders_by_origin
[0m09:20:19.458585 [info ] [Thread-3  ]: 2 of 2 START sql view model `mart`.`cylinders_by_origin` ....................... [RUN]
[0m09:20:19.461055 [debug] [Thread-3  ]: Acquiring new clickhouse connection 'model.ex_01_mpg.cylinders_by_origin'
[0m09:20:19.463045 [debug] [Thread-3  ]: Began compiling node model.ex_01_mpg.cylinders_by_origin
[0m09:20:19.479743 [debug] [Thread-3  ]: Writing injected SQL for node "model.ex_01_mpg.cylinders_by_origin"
[0m09:20:19.482739 [debug] [Thread-3  ]: Began executing node model.ex_01_mpg.cylinders_by_origin
[0m09:20:19.534659 [debug] [Thread-3  ]: Creating new relation cylinders_by_origin
[0m09:20:19.558959 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m09:20:22.349583 [debug] [Thread-3  ]: Writing runtime sql for node "model.ex_01_mpg.cylinders_by_origin"
[0m09:20:22.351721 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */


  create view `mart`.`cylinders_by_origin` 
  
    
    
  as (
    

select
  origin,
  avg(cylinders) as avg_cylinders,
  count()        as n
from `clean`.`mpg_standardized`
group by origin
    
  )
      
      
                    -- end_of_sql
                    
                    ...
[0m09:20:22.606093 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.25 seconds
[0m09:20:22.609679 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a58f05a-4b9e-491c-966b-6f51980380e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8b8fb17a60>]}
[0m09:20:22.611251 [info ] [Thread-3  ]: 2 of 2 OK created sql view model `mart`.`cylinders_by_origin` .................. [[32mOK[0m in 3.15s]
[0m09:20:22.612684 [debug] [Thread-3  ]: Finished running node model.ex_01_mpg.cylinders_by_origin
[0m09:20:22.614720 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:20:22.615356 [debug] [MainThread]: Connection 'list__mart' was left open.
[0m09:20:22.615917 [debug] [MainThread]: On list__mart: Close
[0m09:20:22.616468 [debug] [MainThread]: Connection 'list__clean' was left open.
[0m09:20:22.617000 [debug] [MainThread]: On list__clean: Close
[0m09:20:22.617643 [debug] [MainThread]: Connection 'model.ex_01_mpg.mpg_standardized' was left open.
[0m09:20:22.618184 [debug] [MainThread]: On model.ex_01_mpg.mpg_standardized: Close
[0m09:20:22.618794 [debug] [MainThread]: Connection 'model.ex_01_mpg.cylinders_by_origin' was left open.
[0m09:20:22.619405 [debug] [MainThread]: On model.ex_01_mpg.cylinders_by_origin: Close
[0m09:20:22.620358 [info ] [MainThread]: 
[0m09:20:22.621095 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 11.36 seconds (11.36s).
[0m09:20:22.622905 [debug] [MainThread]: Command end result
[0m09:20:22.685072 [info ] [MainThread]: 
[0m09:20:22.686150 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:20:22.686840 [info ] [MainThread]: 
[0m09:20:22.687534 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m09:20:22.688935 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 15.112848, "process_in_blocks": "1032", "process_kernel_time": 0.656253, "process_mem_max_rss": "115432", "process_out_blocks": "10488", "process_user_time": 7.619336}
[0m09:20:22.689737 [debug] [MainThread]: Command `dbt build` succeeded at 09:20:22.689529 after 15.11 seconds
[0m09:20:22.690394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8b95ea5310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8b90d938b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8b90d93dc0>]}
[0m09:20:22.691039 [debug] [MainThread]: Flushing usage events
[0m09:23:13.208571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae42a1ca310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae426e1eaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae426e1e9a0>]}


============================== 09:23:13.218943 | 93dec56c-d999-4581-9202-2050bced655a ==============================
[0m09:23:13.218943 [info ] [MainThread]: Running with dbt=1.8.9
[0m09:23:13.220058 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'partial_parse': 'True', 'profiles_dir': '.', 'introspect': 'True', 'invocation_command': 'dbt build --profiles-dir . --target remote', 'cache_selected_only': 'False', 'log_path': '/workdir/transforms/01_mpg/logs', 'log_format': 'default', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'debug': 'False', 'empty': 'False', 'target_path': 'None', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'write_json': 'True', 'quiet': 'False', 'version_check': 'True', 'printer_width': '80', 'static_parser': 'True', 'indirect_selection': 'eager', 'no_print': 'None', 'fail_fast': 'False'}
[0m09:23:13.512348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '93dec56c-d999-4581-9202-2050bced655a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae42c985880>]}
[0m09:23:13.637774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '93dec56c-d999-4581-9202-2050bced655a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae426c8eaf0>]}
[0m09:23:13.639447 [info ] [MainThread]: Registered adapter: clickhouse=1.8.6
[0m09:23:13.809774 [debug] [MainThread]: checksum: 265ce5244aff672775eaff93c261d21692ed3f5650f4d9e918c76acdb0e9479a, vars: {}, profile: , target: remote, version: 1.8.9
[0m09:23:14.047022 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:23:14.047745 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:23:14.121723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '93dec56c-d999-4581-9202-2050bced655a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae4266a6df0>]}
[0m09:23:14.342449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '93dec56c-d999-4581-9202-2050bced655a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae4265afb50>]}
[0m09:23:14.343363 [info ] [MainThread]: Found 2 models, 1 source, 471 macros
[0m09:23:14.345975 [info ] [MainThread]: 
[0m09:23:14.347118 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m09:23:14.359087 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m09:23:14.360248 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m09:23:14.387270 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:23:14.396489 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:23:18.115007 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m09:23:18.379954 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.26 seconds
[0m09:23:27.442696 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m09:23:27.760134 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.32 seconds
[0m09:23:27.765393 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__clean)
[0m09:23:27.766438 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__mart)
[0m09:23:27.778784 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "connection_name": "list__clean"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'clean'
      

  ...
[0m09:23:27.783274 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__mart: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "connection_name": "list__mart"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'mart'
      

  ...
[0m09:23:28.053221 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.27 seconds
[0m09:23:29.053435 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 1.27 seconds
[0m09:23:29.058818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93dec56c-d999-4581-9202-2050bced655a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae426111490>]}
[0m09:23:29.059927 [info ] [MainThread]: Concurrency: 4 threads (target='remote')
[0m09:23:29.060665 [info ] [MainThread]: 
[0m09:23:29.076092 [debug] [Thread-1  ]: Began running node model.ex_01_mpg.mpg_standardized
[0m09:23:29.078183 [info ] [Thread-1  ]: 1 of 2 START sql table model `clean`.`mpg_standardized` ........................ [RUN]
[0m09:23:29.080280 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.ex_01_mpg.mpg_standardized'
[0m09:23:29.081974 [debug] [Thread-1  ]: Began compiling node model.ex_01_mpg.mpg_standardized
[0m09:23:29.113339 [debug] [Thread-1  ]: Writing injected SQL for node "model.ex_01_mpg.mpg_standardized"
[0m09:23:29.115291 [debug] [Thread-1  ]: Began executing node model.ex_01_mpg.mpg_standardized
[0m09:23:29.249840 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m09:23:33.978927 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_01_mpg.mpg_standardized"} */

            

    
        create table `clean`.`mpg_standardized__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

-- Source columns are already Nullable with correct types.
-- Keep them as-is to preserve nullability and avoid insert errors.

select
  mpg,            -- Nullable(Float64)
  cylinders,      -- Nullable(Int64)
  displacement,   -- Nullable(Float64)
  horsepower,     -- Nullable(Float64)
  /*
  coalesce(
        horsepower,
        avg(horsepower) over (partition by cylinders)
    ) as horsepower_imputed,
  */
  weight,         -- Nullable(Int64)
  acceleration,   -- Nullable(Float64)
  model_year,     -- Nullable(Int64)
  origin,         -- Nullable(String)
  name as make    -- Nullable(String)
from `raw`.`autompg___cars`
          )
        
        ...
[0m09:23:34.304103 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.32 seconds
[0m09:23:34.320440 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_01_mpg.mpg_standardized"} */

    select name, type from system.columns where table = 'mpg_standardized__dbt_backup'
    
      and database = 'clean'
    
    order by position
  ...
[0m09:23:35.515830 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 1.19 seconds
[0m09:23:35.522760 [debug] [Thread-1  ]: Writing runtime sql for node "model.ex_01_mpg.mpg_standardized"
[0m09:23:35.524318 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_01_mpg.mpg_standardized"} */

  
    
    
    
        
         


        insert into `clean`.`mpg_standardized__dbt_backup`
        ("mpg", "cylinders", "displacement", "horsepower", "weight", "acceleration", "model_year", "origin", "make")

-- Source columns are already Nullable with correct types.
-- Keep them as-is to preserve nullability and avoid insert errors.

select
  mpg,            -- Nullable(Float64)
  cylinders,      -- Nullable(Int64)
  displacement,   -- Nullable(Float64)
  horsepower,     -- Nullable(Float64)
  /*
  coalesce(
        horsepower,
        avg(horsepower) over (partition by cylinders)
    ) as horsepower_imputed,
  */
  weight,         -- Nullable(Int64)
  acceleration,   -- Nullable(Float64)
  model_year,     -- Nullable(Int64)
  origin,         -- Nullable(String)
  name as make    -- Nullable(String)
from `raw`.`autompg___cars`
  ...
[0m09:23:35.841749 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.32 seconds
[0m09:23:35.858930 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_01_mpg.mpg_standardized"} */
EXCHANGE TABLES `clean`.`mpg_standardized__dbt_backup` AND `clean`.`mpg_standardized` 
  
  ...
[0m09:23:36.174748 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.31 seconds
[0m09:23:36.308599 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_01_mpg.mpg_standardized"} */

    drop table if exists `clean`.`mpg_standardized__dbt_backup` 
  ...
[0m09:23:36.625645 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.32 seconds
[0m09:23:36.636116 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93dec56c-d999-4581-9202-2050bced655a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae42975d7f0>]}
[0m09:23:36.638122 [info ] [Thread-1  ]: 1 of 2 OK created sql table model `clean`.`mpg_standardized` ................... [[32mOK[0m in 7.55s]
[0m09:23:36.640383 [debug] [Thread-1  ]: Finished running node model.ex_01_mpg.mpg_standardized
[0m09:23:36.642432 [debug] [Thread-3  ]: Began running node model.ex_01_mpg.cylinders_by_origin
[0m09:23:36.643625 [info ] [Thread-3  ]: 2 of 2 START sql view model `mart`.`cylinders_by_origin` ....................... [RUN]
[0m09:23:36.644850 [debug] [Thread-3  ]: Acquiring new clickhouse connection 'model.ex_01_mpg.cylinders_by_origin'
[0m09:23:36.645813 [debug] [Thread-3  ]: Began compiling node model.ex_01_mpg.cylinders_by_origin
[0m09:23:36.652002 [debug] [Thread-3  ]: Writing injected SQL for node "model.ex_01_mpg.cylinders_by_origin"
[0m09:23:36.653382 [debug] [Thread-3  ]: Began executing node model.ex_01_mpg.cylinders_by_origin
[0m09:23:36.704668 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m09:23:44.272408 [debug] [Thread-3  ]: Writing runtime sql for node "model.ex_01_mpg.cylinders_by_origin"
[0m09:23:44.273760 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */


  create view `mart`.`cylinders_by_origin__dbt_tmp` 
  
    
    
  as (
    

select
  origin,
  avg(cylinders) as avg_cylinders,
  count()        as n
from `clean`.`mpg_standardized`
group by origin
    
  )
      
      
                    -- end_of_sql
                    
                    ...
[0m09:23:45.569285 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 1.29 seconds
[0m09:23:45.584639 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */

    drop table if exists `mart`.`cylinders_by_origin__dbt_backup` 
  
  ...
[0m09:23:45.900710 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.31 seconds
[0m09:23:45.903019 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */

    rename table `mart`.`cylinders_by_origin` to `mart`.`cylinders_by_origin__dbt_backup` 
  
  ...
[0m09:23:46.217820 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.31 seconds
[0m09:23:46.223697 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */

    drop table if exists `mart`.`cylinders_by_origin` 
  
  ...
[0m09:23:46.538835 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.31 seconds
[0m09:23:46.541073 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */

    rename table `mart`.`cylinders_by_origin__dbt_tmp` to `mart`.`cylinders_by_origin` 
  
  ...
[0m09:23:47.250741 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.71 seconds
[0m09:23:47.258787 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */

    drop table if exists `mart`.`cylinders_by_origin__dbt_backup` 
  ...
[0m09:23:48.433660 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 1.17 seconds
[0m09:23:48.436558 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93dec56c-d999-4581-9202-2050bced655a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae42975d7f0>]}
[0m09:23:48.437849 [info ] [Thread-3  ]: 2 of 2 OK created sql view model `mart`.`cylinders_by_origin` .................. [[32mOK[0m in 11.79s]
[0m09:23:48.439260 [debug] [Thread-3  ]: Finished running node model.ex_01_mpg.cylinders_by_origin
[0m09:23:48.441339 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:23:48.441995 [debug] [MainThread]: Connection 'list__clean' was left open.
[0m09:23:48.442555 [debug] [MainThread]: On list__clean: Close
[0m09:23:48.443044 [debug] [MainThread]: Connection 'list__mart' was left open.
[0m09:23:48.443551 [debug] [MainThread]: On list__mart: Close
[0m09:23:48.444122 [debug] [MainThread]: Connection 'model.ex_01_mpg.mpg_standardized' was left open.
[0m09:23:48.444626 [debug] [MainThread]: On model.ex_01_mpg.mpg_standardized: Close
[0m09:23:48.445137 [debug] [MainThread]: Connection 'model.ex_01_mpg.cylinders_by_origin' was left open.
[0m09:23:48.445763 [debug] [MainThread]: On model.ex_01_mpg.cylinders_by_origin: Close
[0m09:23:48.446729 [info ] [MainThread]: 
[0m09:23:48.447432 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 34.10 seconds (34.10s).
[0m09:23:48.449230 [debug] [MainThread]: Command end result
[0m09:23:48.503901 [info ] [MainThread]: 
[0m09:23:48.504875 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:23:48.505509 [info ] [MainThread]: 
[0m09:23:48.506317 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m09:23:48.507845 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 35.39579, "process_in_blocks": "0", "process_kernel_time": 0.659288, "process_mem_max_rss": "111440", "process_out_blocks": "9536", "process_user_time": 5.238289}
[0m09:23:48.508656 [debug] [MainThread]: Command `dbt build` succeeded at 09:23:48.508463 after 35.40 seconds
[0m09:23:48.509302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae42a1ca310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae4289741c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae42c985880>]}
[0m09:23:48.509998 [debug] [MainThread]: Flushing usage events
[0m09:26:58.144683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7b273d2310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7b24035b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7b240359d0>]}


============================== 09:26:58.160813 | fbde23a1-baa9-454a-b5be-233683ba01b6 ==============================
[0m09:26:58.160813 [info ] [MainThread]: Running with dbt=1.8.9
[0m09:26:58.162690 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'quiet': 'False', 'invocation_command': 'dbt build --profiles-dir . --target remote', 'log_format': 'default', 'log_path': '/workdir/transforms/01_mpg/logs', 'use_experimental_parser': 'False', 'introspect': 'True', 'warn_error': 'None', 'debug': 'False', 'log_cache_events': 'False', 'empty': 'False', 'fail_fast': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'no_print': 'None', 'cache_selected_only': 'False', 'profiles_dir': '.', 'target_path': 'None', 'version_check': 'True', 'write_json': 'True'}
[0m09:26:58.497623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fbde23a1-baa9-454a-b5be-233683ba01b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7b2697e3a0>]}
[0m09:26:58.615074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fbde23a1-baa9-454a-b5be-233683ba01b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7b2449d790>]}
[0m09:26:58.617112 [info ] [MainThread]: Registered adapter: clickhouse=1.8.6
[0m09:26:58.809757 [debug] [MainThread]: checksum: 265ce5244aff672775eaff93c261d21692ed3f5650f4d9e918c76acdb0e9479a, vars: {}, profile: , target: remote, version: 1.8.9
[0m09:26:59.049638 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:26:59.050363 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:26:59.125812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fbde23a1-baa9-454a-b5be-233683ba01b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7b238bbdf0>]}
[0m09:26:59.346015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fbde23a1-baa9-454a-b5be-233683ba01b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7b237c3be0>]}
[0m09:26:59.346979 [info ] [MainThread]: Found 2 models, 1 source, 471 macros
[0m09:26:59.349658 [info ] [MainThread]: 
[0m09:26:59.350815 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m09:26:59.362881 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m09:26:59.364141 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m09:26:59.392348 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:26:59.401271 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:27:02.786835 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m09:27:02.830450 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m09:27:03.029488 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.24 seconds
[0m09:27:03.073986 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.24 seconds
[0m09:27:03.077409 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__mart)
[0m09:27:03.078390 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__clean)
[0m09:27:03.089911 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__mart: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "connection_name": "list__mart"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'mart'
      

  ...
[0m09:27:03.093854 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "connection_name": "list__clean"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'clean'
      

  ...
[0m09:27:03.338426 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.24 seconds
[0m09:27:03.339703 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.24 seconds
[0m09:27:03.345220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fbde23a1-baa9-454a-b5be-233683ba01b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7b236fd1f0>]}
[0m09:27:03.346343 [info ] [MainThread]: Concurrency: 4 threads (target='remote')
[0m09:27:03.347154 [info ] [MainThread]: 
[0m09:27:03.365114 [debug] [Thread-1  ]: Began running node model.ex_01_mpg.mpg_standardized
[0m09:27:03.366421 [info ] [Thread-1  ]: 1 of 2 START sql table model `clean`.`mpg_standardized` ........................ [RUN]
[0m09:27:03.367543 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.ex_01_mpg.mpg_standardized'
[0m09:27:03.368311 [debug] [Thread-1  ]: Began compiling node model.ex_01_mpg.mpg_standardized
[0m09:27:03.385130 [debug] [Thread-1  ]: Writing injected SQL for node "model.ex_01_mpg.mpg_standardized"
[0m09:27:03.386532 [debug] [Thread-1  ]: Began executing node model.ex_01_mpg.mpg_standardized
[0m09:27:03.480644 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m09:27:06.189551 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_01_mpg.mpg_standardized"} */

            

    
        create table `clean`.`mpg_standardized__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

-- Source columns are already Nullable with correct types.
-- Keep them as-is to preserve nullability and avoid insert errors.

select
  mpg,            -- Nullable(Float64)
  cylinders,      -- Nullable(Int64)
  displacement,   -- Nullable(Float64)
  horsepower,     -- Nullable(Float64)
  /*
  coalesce(
        horsepower,
        avg(horsepower) over (partition by cylinders)
    ) as horsepower_imputed,
  */
  weight,         -- Nullable(Int64)
  acceleration,   -- Nullable(Float64)
  model_year,     -- Nullable(Int64)
  origin,         -- Nullable(String)
  name as make    -- Nullable(String)
from `raw`.`autompg___cars`
          )
        
        ...
[0m09:27:06.444377 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.25 seconds
[0m09:27:06.461825 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_01_mpg.mpg_standardized"} */

    select name, type from system.columns where table = 'mpg_standardized__dbt_backup'
    
      and database = 'clean'
    
    order by position
  ...
[0m09:27:06.705853 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.24 seconds
[0m09:27:06.712473 [debug] [Thread-1  ]: Writing runtime sql for node "model.ex_01_mpg.mpg_standardized"
[0m09:27:06.713977 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_01_mpg.mpg_standardized"} */

  
    
    
    
        
         


        insert into `clean`.`mpg_standardized__dbt_backup`
        ("mpg", "cylinders", "displacement", "horsepower", "weight", "acceleration", "model_year", "origin", "make")

-- Source columns are already Nullable with correct types.
-- Keep them as-is to preserve nullability and avoid insert errors.

select
  mpg,            -- Nullable(Float64)
  cylinders,      -- Nullable(Int64)
  displacement,   -- Nullable(Float64)
  horsepower,     -- Nullable(Float64)
  /*
  coalesce(
        horsepower,
        avg(horsepower) over (partition by cylinders)
    ) as horsepower_imputed,
  */
  weight,         -- Nullable(Int64)
  acceleration,   -- Nullable(Float64)
  model_year,     -- Nullable(Int64)
  origin,         -- Nullable(String)
  name as make    -- Nullable(String)
from `raw`.`autompg___cars`
  ...
[0m09:27:06.958306 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.24 seconds
[0m09:27:06.966938 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_01_mpg.mpg_standardized"} */
EXCHANGE TABLES `clean`.`mpg_standardized__dbt_backup` AND `clean`.`mpg_standardized` 
  
  ...
[0m09:27:07.213160 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.25 seconds
[0m09:27:07.326426 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_01_mpg.mpg_standardized"} */

    drop table if exists `clean`.`mpg_standardized__dbt_backup` 
  ...
[0m09:27:07.572884 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.25 seconds
[0m09:27:07.579313 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fbde23a1-baa9-454a-b5be-233683ba01b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7b269767f0>]}
[0m09:27:07.580605 [info ] [Thread-1  ]: 1 of 2 OK created sql table model `clean`.`mpg_standardized` ................... [[32mOK[0m in 4.21s]
[0m09:27:07.581961 [debug] [Thread-1  ]: Finished running node model.ex_01_mpg.mpg_standardized
[0m09:27:07.583458 [debug] [Thread-3  ]: Began running node model.ex_01_mpg.cylinders_by_origin
[0m09:27:07.584471 [info ] [Thread-3  ]: 2 of 2 START sql view model `mart`.`cylinders_by_origin` ....................... [RUN]
[0m09:27:07.585677 [debug] [Thread-3  ]: Acquiring new clickhouse connection 'model.ex_01_mpg.cylinders_by_origin'
[0m09:27:07.586430 [debug] [Thread-3  ]: Began compiling node model.ex_01_mpg.cylinders_by_origin
[0m09:27:07.592636 [debug] [Thread-3  ]: Writing injected SQL for node "model.ex_01_mpg.cylinders_by_origin"
[0m09:27:07.593866 [debug] [Thread-3  ]: Began executing node model.ex_01_mpg.cylinders_by_origin
[0m09:27:07.642307 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m09:27:10.346591 [debug] [Thread-3  ]: Writing runtime sql for node "model.ex_01_mpg.cylinders_by_origin"
[0m09:27:10.348716 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */


  create view `mart`.`cylinders_by_origin__dbt_tmp` 
  
    
    
  as (
    

select
  origin,
  avg(cylinders) as avg_cylinders,
  count()        as n
from `clean`.`mpg_standardized`
group by origin
    
  )
      
      
                    -- end_of_sql
                    
                    ...
[0m09:27:10.597326 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.25 seconds
[0m09:27:10.619024 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */

    drop table if exists `mart`.`cylinders_by_origin__dbt_backup` 
  
  ...
[0m09:27:10.861377 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.24 seconds
[0m09:27:10.864036 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */

    rename table `mart`.`cylinders_by_origin` to `mart`.`cylinders_by_origin__dbt_backup` 
  
  ...
[0m09:27:11.106311 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.24 seconds
[0m09:27:11.114452 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */

    drop table if exists `mart`.`cylinders_by_origin` 
  
  ...
[0m09:27:11.360473 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.24 seconds
[0m09:27:11.362681 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */

    rename table `mart`.`cylinders_by_origin__dbt_tmp` to `mart`.`cylinders_by_origin` 
  
  ...
[0m09:27:11.607842 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.24 seconds
[0m09:27:11.623707 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */

    drop table if exists `mart`.`cylinders_by_origin__dbt_backup` 
  ...
[0m09:27:11.879259 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.25 seconds
[0m09:27:11.884099 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fbde23a1-baa9-454a-b5be-233683ba01b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7b23462d60>]}
[0m09:27:11.886329 [info ] [Thread-3  ]: 2 of 2 OK created sql view model `mart`.`cylinders_by_origin` .................. [[32mOK[0m in 4.30s]
[0m09:27:11.888895 [debug] [Thread-3  ]: Finished running node model.ex_01_mpg.cylinders_by_origin
[0m09:27:11.896879 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:27:11.898260 [debug] [MainThread]: Connection 'list__mart' was left open.
[0m09:27:11.899458 [debug] [MainThread]: On list__mart: Close
[0m09:27:11.900610 [debug] [MainThread]: Connection 'list__clean' was left open.
[0m09:27:11.901787 [debug] [MainThread]: On list__clean: Close
[0m09:27:11.903087 [debug] [MainThread]: Connection 'model.ex_01_mpg.mpg_standardized' was left open.
[0m09:27:11.904333 [debug] [MainThread]: On model.ex_01_mpg.mpg_standardized: Close
[0m09:27:11.905549 [debug] [MainThread]: Connection 'model.ex_01_mpg.cylinders_by_origin' was left open.
[0m09:27:11.906802 [debug] [MainThread]: On model.ex_01_mpg.cylinders_by_origin: Close
[0m09:27:11.908907 [info ] [MainThread]: 
[0m09:27:11.910809 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 12.56 seconds (12.56s).
[0m09:27:11.915166 [debug] [MainThread]: Command end result
[0m09:27:12.027328 [info ] [MainThread]: 
[0m09:27:12.028990 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:27:12.030360 [info ] [MainThread]: 
[0m09:27:12.031802 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m09:27:12.034418 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 14.029943, "process_in_blocks": "48", "process_kernel_time": 0.697806, "process_mem_max_rss": "111412", "process_out_blocks": "9520", "process_user_time": 5.631438}
[0m09:27:12.036211 [debug] [MainThread]: Command `dbt build` succeeded at 09:27:12.035740 after 14.03 seconds
[0m09:27:12.037692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7b273d2310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7b23462d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7b2333f1f0>]}
[0m09:27:12.039122 [debug] [MainThread]: Flushing usage events
[0m04:38:19.610215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75456feca310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75456cb3db20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75456cb3d9d0>]}


============================== 04:38:19.635094 | 86b0bd29-3778-4197-8640-b2a92ffadaed ==============================
[0m04:38:19.635094 [info ] [MainThread]: Running with dbt=1.8.9
[0m04:38:19.636443 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'target_path': 'None', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'profiles_dir': '.', 'debug': 'False', 'quiet': 'False', 'invocation_command': 'dbt build --profiles-dir . --target remote', 'cache_selected_only': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'log_cache_events': 'False', 'empty': 'False', 'write_json': 'True', 'printer_width': '80', 'log_path': '/workdir/transforms/01_mpg/logs', 'use_colors': 'True', 'introspect': 'True', 'warn_error': 'None', 'static_parser': 'True', 'no_print': 'None', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])'}
[0m04:38:19.933868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '86b0bd29-3778-4197-8640-b2a92ffadaed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75456cb9da30>]}
[0m04:38:20.041396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '86b0bd29-3778-4197-8640-b2a92ffadaed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75456cb11760>]}
[0m04:38:20.042752 [info ] [MainThread]: Registered adapter: clickhouse=1.8.6
[0m04:38:20.210015 [debug] [MainThread]: checksum: 265ce5244aff672775eaff93c261d21692ed3f5650f4d9e918c76acdb0e9479a, vars: {}, profile: , target: remote, version: 1.8.9
[0m04:38:20.486849 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m04:38:20.488022 [debug] [MainThread]: Partial parsing: updated file: ex_01_mpg://models/clean/mpg_standardized.sql
[0m04:38:20.983874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86b0bd29-3778-4197-8640-b2a92ffadaed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75456b0d1130>]}
[0m04:38:21.193620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '86b0bd29-3778-4197-8640-b2a92ffadaed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75456af8d4f0>]}
[0m04:38:21.194485 [info ] [MainThread]: Found 2 models, 1 source, 471 macros
[0m04:38:21.197498 [info ] [MainThread]: 
[0m04:38:21.198653 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m04:38:21.210641 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m04:38:21.216990 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m04:38:21.237158 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:38:21.242395 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:38:24.531814 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m04:38:24.603909 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m04:38:24.769474 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.24 seconds
[0m04:38:24.855151 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.25 seconds
[0m04:38:24.867656 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__mart)
[0m04:38:24.868751 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__clean)
[0m04:38:24.888747 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__mart: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "connection_name": "list__mart"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'mart'
      

  ...
[0m04:38:24.892867 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "connection_name": "list__clean"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'clean'
      

  ...
[0m04:38:25.130914 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.24 seconds
[0m04:38:25.135042 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.24 seconds
[0m04:38:25.138792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86b0bd29-3778-4197-8640-b2a92ffadaed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75456aad5c70>]}
[0m04:38:25.139850 [info ] [MainThread]: Concurrency: 4 threads (target='remote')
[0m04:38:25.140587 [info ] [MainThread]: 
[0m04:38:25.161593 [debug] [Thread-1  ]: Began running node model.ex_01_mpg.mpg_standardized
[0m04:38:25.163180 [info ] [Thread-1  ]: 1 of 2 START sql table model `clean`.`mpg_standardized` ........................ [RUN]
[0m04:38:25.164318 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list__mart, now model.ex_01_mpg.mpg_standardized)
[0m04:38:25.165138 [debug] [Thread-1  ]: Began compiling node model.ex_01_mpg.mpg_standardized
[0m04:38:25.182312 [debug] [Thread-1  ]: Writing injected SQL for node "model.ex_01_mpg.mpg_standardized"
[0m04:38:25.183573 [debug] [Thread-1  ]: Began executing node model.ex_01_mpg.mpg_standardized
[0m04:38:25.300076 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_01_mpg.mpg_standardized"} */

            

    
        create table `clean`.`mpg_standardized__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

-- Source columns are already Nullable with correct types.
-- Keep them as-is to preserve nullability and avoid insert errors.

select
  mpg,            -- Nullable(Float64)
  cylinders,      -- Nullable(Int64)
  displacement,   -- Nullable(Float64)
  horsepower,     -- Nullable(Float64)
  weight,         -- Nullable(Int64)
  acceleration,   -- Nullable(Float64)
  model_year,     -- Nullable(Int64)
  origin,         -- Nullable(String)
  name as make    -- Nullable(String)
from `raw`.`autompg___cars`
-- where horsepower is not null
          )
        
        ...
[0m04:38:25.551635 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.25 seconds
[0m04:38:25.569227 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_01_mpg.mpg_standardized"} */

    select name, type from system.columns where table = 'mpg_standardized__dbt_backup'
    
      and database = 'clean'
    
    order by position
  ...
[0m04:38:25.810838 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.24 seconds
[0m04:38:25.821909 [debug] [Thread-1  ]: Writing runtime sql for node "model.ex_01_mpg.mpg_standardized"
[0m04:38:25.823934 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_01_mpg.mpg_standardized"} */

  
    
    
    
        
         


        insert into `clean`.`mpg_standardized__dbt_backup`
        ("mpg", "cylinders", "displacement", "horsepower", "weight", "acceleration", "model_year", "origin", "make")

-- Source columns are already Nullable with correct types.
-- Keep them as-is to preserve nullability and avoid insert errors.

select
  mpg,            -- Nullable(Float64)
  cylinders,      -- Nullable(Int64)
  displacement,   -- Nullable(Float64)
  horsepower,     -- Nullable(Float64)
  weight,         -- Nullable(Int64)
  acceleration,   -- Nullable(Float64)
  model_year,     -- Nullable(Int64)
  origin,         -- Nullable(String)
  name as make    -- Nullable(String)
from `raw`.`autompg___cars`
-- where horsepower is not null
  ...
[0m04:38:26.072979 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.25 seconds
[0m04:38:26.088875 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_01_mpg.mpg_standardized"} */
EXCHANGE TABLES `clean`.`mpg_standardized__dbt_backup` AND `clean`.`mpg_standardized` 
  
  ...
[0m04:38:26.330085 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.24 seconds
[0m04:38:26.393538 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_01_mpg.mpg_standardized"} */

    drop table if exists `clean`.`mpg_standardized__dbt_backup` 
  ...
[0m04:38:26.636220 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.24 seconds
[0m04:38:26.642481 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86b0bd29-3778-4197-8640-b2a92ffadaed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75456ab8c7f0>]}
[0m04:38:26.643738 [info ] [Thread-1  ]: 1 of 2 OK created sql table model `clean`.`mpg_standardized` ................... [[32mOK[0m in 1.48s]
[0m04:38:26.645109 [debug] [Thread-1  ]: Finished running node model.ex_01_mpg.mpg_standardized
[0m04:38:26.646686 [debug] [Thread-3  ]: Began running node model.ex_01_mpg.cylinders_by_origin
[0m04:38:26.647688 [info ] [Thread-3  ]: 2 of 2 START sql view model `mart`.`cylinders_by_origin` ....................... [RUN]
[0m04:38:26.648766 [debug] [Thread-3  ]: Acquiring new clickhouse connection 'model.ex_01_mpg.cylinders_by_origin'
[0m04:38:26.649534 [debug] [Thread-3  ]: Began compiling node model.ex_01_mpg.cylinders_by_origin
[0m04:38:26.655253 [debug] [Thread-3  ]: Writing injected SQL for node "model.ex_01_mpg.cylinders_by_origin"
[0m04:38:26.656574 [debug] [Thread-3  ]: Began executing node model.ex_01_mpg.cylinders_by_origin
[0m04:38:26.705767 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m04:38:29.375960 [debug] [Thread-3  ]: Writing runtime sql for node "model.ex_01_mpg.cylinders_by_origin"
[0m04:38:29.377569 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */


  create view `mart`.`cylinders_by_origin__dbt_tmp` 
  
    
    
  as (
    

select
  origin,
  avg(cylinders) as avg_cylinders,
  count()        as n
from `clean`.`mpg_standardized`
group by origin
    
  )
      
      
                    -- end_of_sql
                    
                    ...
[0m04:38:29.622288 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.24 seconds
[0m04:38:29.635076 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */

    drop table if exists `mart`.`cylinders_by_origin__dbt_backup` 
  
  ...
[0m04:38:29.874755 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.24 seconds
[0m04:38:29.877787 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */

    rename table `mart`.`cylinders_by_origin` to `mart`.`cylinders_by_origin__dbt_backup` 
  
  ...
[0m04:38:30.118117 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.24 seconds
[0m04:38:30.124142 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */

    drop table if exists `mart`.`cylinders_by_origin` 
  
  ...
[0m04:38:30.364458 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.24 seconds
[0m04:38:30.368076 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */

    rename table `mart`.`cylinders_by_origin__dbt_tmp` to `mart`.`cylinders_by_origin` 
  
  ...
[0m04:38:30.611673 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.24 seconds
[0m04:38:30.623140 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */

    drop table if exists `mart`.`cylinders_by_origin__dbt_backup` 
  ...
[0m04:38:30.863791 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.24 seconds
[0m04:38:30.868677 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86b0bd29-3778-4197-8640-b2a92ffadaed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75456ab92f10>]}
[0m04:38:30.870787 [info ] [Thread-3  ]: 2 of 2 OK created sql view model `mart`.`cylinders_by_origin` .................. [[32mOK[0m in 4.22s]
[0m04:38:30.873076 [debug] [Thread-3  ]: Finished running node model.ex_01_mpg.cylinders_by_origin
[0m04:38:30.875704 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:38:30.876381 [debug] [MainThread]: Connection 'model.ex_01_mpg.mpg_standardized' was left open.
[0m04:38:30.876942 [debug] [MainThread]: On model.ex_01_mpg.mpg_standardized: Close
[0m04:38:30.877488 [debug] [MainThread]: Connection 'list__clean' was left open.
[0m04:38:30.877980 [debug] [MainThread]: On list__clean: Close
[0m04:38:30.878500 [debug] [MainThread]: Connection 'model.ex_01_mpg.cylinders_by_origin' was left open.
[0m04:38:30.878991 [debug] [MainThread]: On model.ex_01_mpg.cylinders_by_origin: Close
[0m04:38:30.879820 [info ] [MainThread]: 
[0m04:38:30.880535 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 9.68 seconds (9.68s).
[0m04:38:30.882338 [debug] [MainThread]: Command end result
[0m04:38:30.982344 [info ] [MainThread]: 
[0m04:38:30.983825 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:38:30.984982 [info ] [MainThread]: 
[0m04:38:30.986184 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m04:38:30.988609 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 11.489199, "process_in_blocks": "56", "process_kernel_time": 0.646114, "process_mem_max_rss": "113896", "process_out_blocks": "10488", "process_user_time": 5.789029}
[0m04:38:30.990148 [debug] [MainThread]: Command `dbt build` succeeded at 04:38:30.989747 after 11.49 seconds
[0m04:38:30.991393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75456feca310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75456d6526d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75456d653c40>]}
[0m04:38:30.992608 [debug] [MainThread]: Flushing usage events
[0m04:40:19.932502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7146522ddd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71464ef443d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71464ef44520>]}


============================== 04:40:19.943690 | d8b49059-9890-49c1-a85e-acb5c3643533 ==============================
[0m04:40:19.943690 [info ] [MainThread]: Running with dbt=1.8.9
[0m04:40:19.944948 [debug] [MainThread]: running dbt with arguments {'empty': 'False', 'debug': 'False', 'write_json': 'True', 'version_check': 'True', 'quiet': 'False', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'invocation_command': 'dbt build --profiles-dir . --target remote', 'printer_width': '80', 'introspect': 'True', 'log_cache_events': 'False', 'log_format': 'default', 'fail_fast': 'False', 'log_path': '/workdir/transforms/01_mpg/logs', 'no_print': 'None', 'use_colors': 'True', 'target_path': 'None', 'profiles_dir': '.', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'static_parser': 'True', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'partial_parse': 'True'}
[0m04:40:20.242931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd8b49059-9890-49c1-a85e-acb5c3643533', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71464ee2ec70>]}
[0m04:40:20.338135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd8b49059-9890-49c1-a85e-acb5c3643533', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7146524d2df0>]}
[0m04:40:20.339520 [info ] [MainThread]: Registered adapter: clickhouse=1.8.6
[0m04:40:20.513429 [debug] [MainThread]: checksum: 265ce5244aff672775eaff93c261d21692ed3f5650f4d9e918c76acdb0e9479a, vars: {}, profile: , target: remote, version: 1.8.9
[0m04:40:20.732415 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m04:40:20.733477 [debug] [MainThread]: Partial parsing: updated file: ex_01_mpg://models/clean/mpg_standardized.sql
[0m04:40:21.178707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd8b49059-9890-49c1-a85e-acb5c3643533', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71464d4e6130>]}
[0m04:40:21.390857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd8b49059-9890-49c1-a85e-acb5c3643533', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71464d3a5760>]}
[0m04:40:21.391731 [info ] [MainThread]: Found 2 models, 1 source, 471 macros
[0m04:40:21.394463 [info ] [MainThread]: 
[0m04:40:21.395591 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m04:40:21.409404 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m04:40:21.410664 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m04:40:21.453096 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:40:21.458040 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:40:25.025608 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m04:40:25.153980 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m04:40:25.273666 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.25 seconds
[0m04:40:25.423427 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.27 seconds
[0m04:40:25.427119 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__mart)
[0m04:40:25.428150 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__clean)
[0m04:40:25.440731 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__mart: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "connection_name": "list__mart"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'mart'
      

  ...
[0m04:40:25.447790 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "connection_name": "list__clean"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'clean'
      

  ...
[0m04:40:25.697451 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.25 seconds
[0m04:40:25.719578 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.27 seconds
[0m04:40:25.722896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd8b49059-9890-49c1-a85e-acb5c3643533', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714653ab35e0>]}
[0m04:40:25.724283 [info ] [MainThread]: Concurrency: 4 threads (target='remote')
[0m04:40:25.725225 [info ] [MainThread]: 
[0m04:40:25.744403 [debug] [Thread-1  ]: Began running node model.ex_01_mpg.mpg_standardized
[0m04:40:25.745645 [info ] [Thread-1  ]: 1 of 2 START sql table model `clean`.`mpg_standardized` ........................ [RUN]
[0m04:40:25.746582 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list__mart, now model.ex_01_mpg.mpg_standardized)
[0m04:40:25.747339 [debug] [Thread-1  ]: Began compiling node model.ex_01_mpg.mpg_standardized
[0m04:40:25.764360 [debug] [Thread-1  ]: Writing injected SQL for node "model.ex_01_mpg.mpg_standardized"
[0m04:40:25.765613 [debug] [Thread-1  ]: Began executing node model.ex_01_mpg.mpg_standardized
[0m04:40:25.879020 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_01_mpg.mpg_standardized"} */

            

    
        create table `clean`.`mpg_standardized__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

-- Source columns are already Nullable with correct types.
-- Keep them as-is to preserve nullability and avoid insert errors.

select
  mpg,            -- Nullable(Float64)
  cylinders,      -- Nullable(Int64)
  displacement,   -- Nullable(Float64)
  horsepower,     -- Nullable(Float64)
  weight,         -- Nullable(Int64)
  acceleration,   -- Nullable(Float64)
  model_year,     -- Nullable(Int64)
  origin,         -- Nullable(String)
  name as make    -- Nullable(String)
from `raw`.`autompg___cars`
 where horsepower is not null
          )
        
        ...
[0m04:40:26.156408 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.28 seconds
[0m04:40:26.186542 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_01_mpg.mpg_standardized"} */

    select name, type from system.columns where table = 'mpg_standardized__dbt_backup'
    
      and database = 'clean'
    
    order by position
  ...
[0m04:40:26.457354 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.27 seconds
[0m04:40:26.463947 [debug] [Thread-1  ]: Writing runtime sql for node "model.ex_01_mpg.mpg_standardized"
[0m04:40:26.465407 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_01_mpg.mpg_standardized"} */

  
    
    
    
        
         


        insert into `clean`.`mpg_standardized__dbt_backup`
        ("mpg", "cylinders", "displacement", "horsepower", "weight", "acceleration", "model_year", "origin", "make")

-- Source columns are already Nullable with correct types.
-- Keep them as-is to preserve nullability and avoid insert errors.

select
  mpg,            -- Nullable(Float64)
  cylinders,      -- Nullable(Int64)
  displacement,   -- Nullable(Float64)
  horsepower,     -- Nullable(Float64)
  weight,         -- Nullable(Int64)
  acceleration,   -- Nullable(Float64)
  model_year,     -- Nullable(Int64)
  origin,         -- Nullable(String)
  name as make    -- Nullable(String)
from `raw`.`autompg___cars`
 where horsepower is not null
  ...
[0m04:40:26.735771 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.27 seconds
[0m04:40:26.751771 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_01_mpg.mpg_standardized"} */
EXCHANGE TABLES `clean`.`mpg_standardized__dbt_backup` AND `clean`.`mpg_standardized` 
  
  ...
[0m04:40:27.020520 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.27 seconds
[0m04:40:27.089556 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_01_mpg.mpg_standardized"} */

    drop table if exists `clean`.`mpg_standardized__dbt_backup` 
  ...
[0m04:40:27.358075 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.27 seconds
[0m04:40:27.368743 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8b49059-9890-49c1-a85e-acb5c3643533', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71464c6c1d00>]}
[0m04:40:27.370814 [info ] [Thread-1  ]: 1 of 2 OK created sql table model `clean`.`mpg_standardized` ................... [[32mOK[0m in 1.62s]
[0m04:40:27.372940 [debug] [Thread-1  ]: Finished running node model.ex_01_mpg.mpg_standardized
[0m04:40:27.374744 [debug] [Thread-3  ]: Began running node model.ex_01_mpg.cylinders_by_origin
[0m04:40:27.376085 [info ] [Thread-3  ]: 2 of 2 START sql view model `mart`.`cylinders_by_origin` ....................... [RUN]
[0m04:40:27.377346 [debug] [Thread-3  ]: Acquiring new clickhouse connection 'model.ex_01_mpg.cylinders_by_origin'
[0m04:40:27.378166 [debug] [Thread-3  ]: Began compiling node model.ex_01_mpg.cylinders_by_origin
[0m04:40:27.384673 [debug] [Thread-3  ]: Writing injected SQL for node "model.ex_01_mpg.cylinders_by_origin"
[0m04:40:27.386042 [debug] [Thread-3  ]: Began executing node model.ex_01_mpg.cylinders_by_origin
[0m04:40:27.437066 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m04:40:30.423126 [debug] [Thread-3  ]: Writing runtime sql for node "model.ex_01_mpg.cylinders_by_origin"
[0m04:40:30.424768 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */


  create view `mart`.`cylinders_by_origin__dbt_tmp` 
  
    
    
  as (
    

select
  origin,
  avg(cylinders) as avg_cylinders,
  count()        as n
from `clean`.`mpg_standardized`
group by origin
    
  )
      
      
                    -- end_of_sql
                    
                    ...
[0m04:40:30.696858 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.27 seconds
[0m04:40:30.710325 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */

    drop table if exists `mart`.`cylinders_by_origin__dbt_backup` 
  
  ...
[0m04:40:30.978534 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.27 seconds
[0m04:40:30.980678 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */

    rename table `mart`.`cylinders_by_origin` to `mart`.`cylinders_by_origin__dbt_backup` 
  
  ...
[0m04:40:31.248516 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.27 seconds
[0m04:40:31.254738 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */

    drop table if exists `mart`.`cylinders_by_origin` 
  
  ...
[0m04:40:31.521983 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.27 seconds
[0m04:40:31.524101 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */

    rename table `mart`.`cylinders_by_origin__dbt_tmp` to `mart`.`cylinders_by_origin` 
  
  ...
[0m04:40:31.791610 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.27 seconds
[0m04:40:31.805005 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */

    drop table if exists `mart`.`cylinders_by_origin__dbt_backup` 
  ...
[0m04:40:32.075852 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.27 seconds
[0m04:40:32.080713 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8b49059-9890-49c1-a85e-acb5c3643533', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71464e7c1700>]}
[0m04:40:32.087093 [info ] [Thread-3  ]: 2 of 2 OK created sql view model `mart`.`cylinders_by_origin` .................. [[32mOK[0m in 4.70s]
[0m04:40:32.089642 [debug] [Thread-3  ]: Finished running node model.ex_01_mpg.cylinders_by_origin
[0m04:40:32.102695 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:40:32.103891 [debug] [MainThread]: Connection 'model.ex_01_mpg.mpg_standardized' was left open.
[0m04:40:32.105038 [debug] [MainThread]: On model.ex_01_mpg.mpg_standardized: Close
[0m04:40:32.106106 [debug] [MainThread]: Connection 'list__clean' was left open.
[0m04:40:32.107177 [debug] [MainThread]: On list__clean: Close
[0m04:40:32.108214 [debug] [MainThread]: Connection 'model.ex_01_mpg.cylinders_by_origin' was left open.
[0m04:40:32.109346 [debug] [MainThread]: On model.ex_01_mpg.cylinders_by_origin: Close
[0m04:40:32.111089 [info ] [MainThread]: 
[0m04:40:32.112771 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 10.72 seconds (10.72s).
[0m04:40:32.117466 [debug] [MainThread]: Command end result
[0m04:40:32.217331 [info ] [MainThread]: 
[0m04:40:32.218845 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:40:32.220021 [info ] [MainThread]: 
[0m04:40:32.221337 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m04:40:32.223839 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 12.395374, "process_in_blocks": "456", "process_kernel_time": 0.642731, "process_mem_max_rss": "113972", "process_out_blocks": "10504", "process_user_time": 5.715615}
[0m04:40:32.225541 [debug] [MainThread]: Command `dbt build` succeeded at 04:40:32.225017 after 12.40 seconds
[0m04:40:32.226803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7146522ddd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71464e599220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71465255fb20>]}
[0m04:40:32.228058 [debug] [MainThread]: Flushing usage events
[0m04:45:54.782026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4afc8af310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4af9518b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4af9518a30>]}


============================== 04:45:54.791963 | 01fbea5a-e60e-4652-af4a-76d3122f4d96 ==============================
[0m04:45:54.791963 [info ] [MainThread]: Running with dbt=1.8.9
[0m04:45:54.793136 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'quiet': 'False', 'profiles_dir': '.', 'target_path': 'None', 'invocation_command': 'dbt build --profiles-dir . --target remote', 'fail_fast': 'False', 'introspect': 'True', 'partial_parse': 'True', 'log_format': 'default', 'version_check': 'True', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'log_path': '/workdir/transforms/01_mpg/logs', 'empty': 'False', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'cache_selected_only': 'False', 'use_colors': 'True', 'warn_error': 'None', 'printer_width': '80', 'write_json': 'True'}
[0m04:45:55.091838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '01fbea5a-e60e-4652-af4a-76d3122f4d96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4af94d0cd0>]}
[0m04:45:55.191020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '01fbea5a-e60e-4652-af4a-76d3122f4d96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4af95d80a0>]}
[0m04:45:55.192809 [info ] [MainThread]: Registered adapter: clickhouse=1.8.6
[0m04:45:55.365002 [debug] [MainThread]: checksum: 265ce5244aff672775eaff93c261d21692ed3f5650f4d9e918c76acdb0e9479a, vars: {}, profile: , target: remote, version: 1.8.9
[0m04:45:55.597113 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m04:45:55.598207 [debug] [MainThread]: Partial parsing: updated file: ex_01_mpg://models/clean/mpg_standardized.sql
[0m04:45:56.044562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '01fbea5a-e60e-4652-af4a-76d3122f4d96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4af7ac1130>]}
[0m04:45:56.265824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '01fbea5a-e60e-4652-af4a-76d3122f4d96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4af797f400>]}
[0m04:45:56.266703 [info ] [MainThread]: Found 2 models, 1 source, 471 macros
[0m04:45:56.269705 [info ] [MainThread]: 
[0m04:45:56.270861 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m04:45:56.282886 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m04:45:56.284097 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m04:45:56.332815 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:45:56.331883 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:45:59.998078 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m04:46:00.267341 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.27 seconds
[0m04:46:02.414357 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m04:46:02.707069 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.29 seconds
[0m04:46:02.711952 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__clean)
[0m04:46:02.712977 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__mart)
[0m04:46:02.725539 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "connection_name": "list__clean"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'clean'
      

  ...
[0m04:46:02.729663 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__mart: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "connection_name": "list__mart"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'mart'
      

  ...
[0m04:46:02.999149 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.27 seconds
[0m04:46:03.008373 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.28 seconds
[0m04:46:03.011785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01fbea5a-e60e-4652-af4a-76d3122f4d96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4af7456520>]}
[0m04:46:03.013254 [info ] [MainThread]: Concurrency: 4 threads (target='remote')
[0m04:46:03.014149 [info ] [MainThread]: 
[0m04:46:03.033391 [debug] [Thread-1  ]: Began running node model.ex_01_mpg.mpg_standardized
[0m04:46:03.034662 [info ] [Thread-1  ]: 1 of 2 START sql table model `clean`.`mpg_standardized` ........................ [RUN]
[0m04:46:03.035712 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list__clean, now model.ex_01_mpg.mpg_standardized)
[0m04:46:03.036482 [debug] [Thread-1  ]: Began compiling node model.ex_01_mpg.mpg_standardized
[0m04:46:03.053388 [debug] [Thread-1  ]: Writing injected SQL for node "model.ex_01_mpg.mpg_standardized"
[0m04:46:03.054641 [debug] [Thread-1  ]: Began executing node model.ex_01_mpg.mpg_standardized
[0m04:46:03.166190 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_01_mpg.mpg_standardized"} */

            

    
        create table `clean`.`mpg_standardized__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

-- Source columns are already Nullable with correct types.
-- Keep them as-is to preserve nullability and avoid insert errors.

select
  toFloat64OrNull(mpg)          as mpg,
  toInt32OrNull(cylinders)      as cylinders,
  toFloat64OrNull(displacement) as displacement,
  toFloat64OrNull(horsepower)   as horsepower,
  toInt32OrNull(weight)         as weight,
  toFloat64OrNull(acceleration) as acceleration,
  toInt32OrNull(model_year)     as model_year,
  trim(origin)                  as origin,
  trim(name)                    as make
from `raw`.`autompg___cars`
-- where horsepower is not null
          )
        
        ...
[0m04:46:03.455086 [debug] [Thread-1  ]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_01_mpg.mpg_standardized"} */

            

    
        create table `clean`.`mpg_standardized__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

-- Source columns are already Nullable with correct types.
-- Keep them as-is to preserve nullability and avoid insert errors.

select
  toFloat64OrNull(mpg)          as mpg,
  toInt32OrNull(cylinders)      as cylinders,
  toFloat64OrNull(displacement) as displacement,
  toFloat64OrNull(horsepower)   as horsepower,
  toInt32OrNull(weight)         as weight,
  toFloat64OrNull(acceleration) as acceleration,
  toInt32OrNull(model_year)     as model_year,
  trim(origin)                  as origin,
  trim(name)                    as make
from `raw`.`autompg___cars`
-- where horsepower is not null
          )
        
        
[0m04:46:03.665554 [debug] [Thread-1  ]: Database Error in model mpg_standardized (models/clean/mpg_standardized.sql)
  HTTPDriver for http://54.87.106.52:8123 received ClickHouse error code 43
   Code: 43. DB::Exception: Illegal type Float64 of first argument of function toFloat64OrNull. Conversion functions with postfix 'OrZero' or 'OrNull' should take String argument: While processing toFloat64OrNull(mpg) AS mpg, toInt32OrNull(cylinders) AS cylinders, toFloat64OrNull(displacement) AS displacement, toFloat64OrNull(horsepower) AS horsepower, toInt32OrNull(weight) AS weight, toFloat64OrNull(acceleration) AS acceleration, toInt32OrNull(model_year) AS model_year, trimBoth(origin) AS origin, trimBoth(name) AS make. (ILLEGAL_TYPE_OF_ARGUMENT) (version 23.12.6.19 (official build))
[0m04:46:03.668576 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01fbea5a-e60e-4652-af4a-76d3122f4d96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4afcaee910>]}
[0m04:46:03.669991 [error] [Thread-1  ]: 1 of 2 ERROR creating sql table model `clean`.`mpg_standardized` ............... [[31mERROR[0m in 0.63s]
[0m04:46:03.671632 [debug] [Thread-1  ]: Finished running node model.ex_01_mpg.mpg_standardized
[0m04:46:03.673448 [debug] [Thread-3  ]: Began running node model.ex_01_mpg.cylinders_by_origin
[0m04:46:03.674469 [info ] [Thread-3  ]: 2 of 2 SKIP relation mart.cylinders_by_origin .................................. [[33mSKIP[0m]
[0m04:46:03.675654 [debug] [Thread-3  ]: Finished running node model.ex_01_mpg.cylinders_by_origin
[0m04:46:03.677866 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:46:03.678580 [debug] [MainThread]: Connection 'model.ex_01_mpg.mpg_standardized' was left open.
[0m04:46:03.679142 [debug] [MainThread]: On model.ex_01_mpg.mpg_standardized: Close
[0m04:46:03.679693 [debug] [MainThread]: Connection 'list__mart' was left open.
[0m04:46:03.680223 [debug] [MainThread]: On list__mart: Close
[0m04:46:03.681025 [info ] [MainThread]: 
[0m04:46:03.681788 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 7.41 seconds (7.41s).
[0m04:46:03.683222 [debug] [MainThread]: Command end result
[0m04:46:03.736644 [info ] [MainThread]: 
[0m04:46:03.737564 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m04:46:03.738144 [info ] [MainThread]: 
[0m04:46:03.738995 [error] [MainThread]:   Database Error in model mpg_standardized (models/clean/mpg_standardized.sql)
  HTTPDriver for http://54.87.106.52:8123 received ClickHouse error code 43
   Code: 43. DB::Exception: Illegal type Float64 of first argument of function toFloat64OrNull. Conversion functions with postfix 'OrZero' or 'OrNull' should take String argument: While processing toFloat64OrNull(mpg) AS mpg, toInt32OrNull(cylinders) AS cylinders, toFloat64OrNull(displacement) AS displacement, toFloat64OrNull(horsepower) AS horsepower, toInt32OrNull(weight) AS weight, toFloat64OrNull(acceleration) AS acceleration, toInt32OrNull(model_year) AS model_year, trimBoth(origin) AS origin, trimBoth(name) AS make. (ILLEGAL_TYPE_OF_ARGUMENT) (version 23.12.6.19 (official build))
[0m04:46:03.739708 [info ] [MainThread]: 
[0m04:46:03.740350 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m04:46:03.741694 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 9.054285, "process_in_blocks": "320", "process_kernel_time": 0.675086, "process_mem_max_rss": "113984", "process_out_blocks": "10464", "process_user_time": 5.24367}
[0m04:46:03.742432 [debug] [MainThread]: Command `dbt build` failed at 04:46:03.742238 after 9.06 seconds
[0m04:46:03.743129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4afc8af310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4afa7dd910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c4afca71e20>]}
[0m04:46:03.743781 [debug] [MainThread]: Flushing usage events
[0m04:48:25.244121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723ae393f310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723ae05a4b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723ae05a4a00>]}


============================== 04:48:25.254339 | 3c6bbd47-c496-4b22-9ff2-ab00caf91e11 ==============================
[0m04:48:25.254339 [info ] [MainThread]: Running with dbt=1.8.9
[0m04:48:25.255503 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'fail_fast': 'False', 'invocation_command': 'dbt build --profiles-dir . --target remote', 'cache_selected_only': 'False', 'empty': 'False', 'log_format': 'default', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'static_parser': 'True', 'profiles_dir': '.', 'indirect_selection': 'eager', 'warn_error': 'None', 'write_json': 'True', 'log_path': '/workdir/transforms/01_mpg/logs', 'use_colors': 'True', 'quiet': 'False', 'target_path': 'None', 'no_print': 'None'}
[0m04:48:25.543323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3c6bbd47-c496-4b22-9ff2-ab00caf91e11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723ae057f160>]}
[0m04:48:25.642893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3c6bbd47-c496-4b22-9ff2-ab00caf91e11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723ae06aed60>]}
[0m04:48:25.644439 [info ] [MainThread]: Registered adapter: clickhouse=1.8.6
[0m04:48:25.836053 [debug] [MainThread]: checksum: 265ce5244aff672775eaff93c261d21692ed3f5650f4d9e918c76acdb0e9479a, vars: {}, profile: , target: remote, version: 1.8.9
[0m04:48:26.072213 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:48:26.072927 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:48:26.145887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3c6bbd47-c496-4b22-9ff2-ab00caf91e11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723adfe1d130>]}
[0m04:48:26.490127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3c6bbd47-c496-4b22-9ff2-ab00caf91e11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723adfd65280>]}
[0m04:48:26.491716 [info ] [MainThread]: Found 2 models, 1 source, 471 macros
[0m04:48:26.496453 [info ] [MainThread]: 
[0m04:48:26.498397 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m04:48:26.520996 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m04:48:26.538165 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m04:48:26.610338 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:48:26.615461 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:48:30.059620 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m04:48:30.201404 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m04:48:30.302113 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.24 seconds
[0m04:48:30.451735 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.25 seconds
[0m04:48:30.455806 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__mart)
[0m04:48:30.457190 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__clean)
[0m04:48:30.477421 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__mart: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "connection_name": "list__mart"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'mart'
      

  ...
[0m04:48:30.485466 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "connection_name": "list__clean"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'clean'
      

  ...
[0m04:48:30.734901 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.25 seconds
[0m04:48:30.742188 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.26 seconds
[0m04:48:30.747840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c6bbd47-c496-4b22-9ff2-ab00caf91e11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723adf84a7f0>]}
[0m04:48:30.749042 [info ] [MainThread]: Concurrency: 4 threads (target='remote')
[0m04:48:30.749924 [info ] [MainThread]: 
[0m04:48:30.763896 [debug] [Thread-1  ]: Began running node model.ex_01_mpg.mpg_standardized
[0m04:48:30.765327 [info ] [Thread-1  ]: 1 of 2 START sql table model `clean`.`mpg_standardized` ........................ [RUN]
[0m04:48:30.766842 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.ex_01_mpg.mpg_standardized'
[0m04:48:30.767952 [debug] [Thread-1  ]: Began compiling node model.ex_01_mpg.mpg_standardized
[0m04:48:30.785906 [debug] [Thread-1  ]: Writing injected SQL for node "model.ex_01_mpg.mpg_standardized"
[0m04:48:30.787380 [debug] [Thread-1  ]: Began executing node model.ex_01_mpg.mpg_standardized
[0m04:48:30.894214 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m04:48:33.680402 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_01_mpg.mpg_standardized"} */

            

    
        create table `clean`.`mpg_standardized__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

-- Source columns are already Nullable with correct types.
-- Keep them as-is to preserve nullability and avoid insert errors.

select
  toFloat64OrNull(mpg)          as mpg,
  toInt32OrNull(cylinders)      as cylinders,
  toFloat64OrNull(displacement) as displacement,
  toFloat64OrNull(horsepower)   as horsepower,
  toInt32OrNull(weight)         as weight,
  toFloat64OrNull(acceleration) as acceleration,
  toInt32OrNull(model_year)     as model_year,
  trim(origin)                  as origin,
  trim(name)                    as make
from `raw`.`autompg___cars`
-- where horsepower is not null
          )
        
        ...
[0m04:48:33.932438 [debug] [Thread-1  ]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_01_mpg.mpg_standardized"} */

            

    
        create table `clean`.`mpg_standardized__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

-- Source columns are already Nullable with correct types.
-- Keep them as-is to preserve nullability and avoid insert errors.

select
  toFloat64OrNull(mpg)          as mpg,
  toInt32OrNull(cylinders)      as cylinders,
  toFloat64OrNull(displacement) as displacement,
  toFloat64OrNull(horsepower)   as horsepower,
  toInt32OrNull(weight)         as weight,
  toFloat64OrNull(acceleration) as acceleration,
  toInt32OrNull(model_year)     as model_year,
  trim(origin)                  as origin,
  trim(name)                    as make
from `raw`.`autompg___cars`
-- where horsepower is not null
          )
        
        
[0m04:48:33.936659 [debug] [Thread-1  ]: Database Error in model mpg_standardized (models/clean/mpg_standardized.sql)
  HTTPDriver for http://54.87.106.52:8123 received ClickHouse error code 43
   Code: 43. DB::Exception: Illegal type Float64 of first argument of function toFloat64OrNull. Conversion functions with postfix 'OrZero' or 'OrNull' should take String argument: While processing toFloat64OrNull(mpg) AS mpg, toInt32OrNull(cylinders) AS cylinders, toFloat64OrNull(displacement) AS displacement, toFloat64OrNull(horsepower) AS horsepower, toInt32OrNull(weight) AS weight, toFloat64OrNull(acceleration) AS acceleration, toInt32OrNull(model_year) AS model_year, trimBoth(origin) AS origin, trimBoth(name) AS make. (ILLEGAL_TYPE_OF_ARGUMENT) (version 23.12.6.19 (official build))
[0m04:48:33.939284 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c6bbd47-c496-4b22-9ff2-ab00caf91e11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723adef8c790>]}
[0m04:48:33.940477 [error] [Thread-1  ]: 1 of 2 ERROR creating sql table model `clean`.`mpg_standardized` ............... [[31mERROR[0m in 3.17s]
[0m04:48:33.941904 [debug] [Thread-1  ]: Finished running node model.ex_01_mpg.mpg_standardized
[0m04:48:33.943523 [debug] [Thread-3  ]: Began running node model.ex_01_mpg.cylinders_by_origin
[0m04:48:33.944397 [info ] [Thread-3  ]: 2 of 2 SKIP relation mart.cylinders_by_origin .................................. [[33mSKIP[0m]
[0m04:48:33.945306 [debug] [Thread-3  ]: Finished running node model.ex_01_mpg.cylinders_by_origin
[0m04:48:33.947160 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:48:33.947838 [debug] [MainThread]: Connection 'list__mart' was left open.
[0m04:48:33.948394 [debug] [MainThread]: On list__mart: Close
[0m04:48:33.949049 [debug] [MainThread]: Connection 'list__clean' was left open.
[0m04:48:33.949575 [debug] [MainThread]: On list__clean: Close
[0m04:48:33.950063 [debug] [MainThread]: Connection 'model.ex_01_mpg.mpg_standardized' was left open.
[0m04:48:33.950556 [debug] [MainThread]: On model.ex_01_mpg.mpg_standardized: Close
[0m04:48:33.951352 [info ] [MainThread]: 
[0m04:48:33.951996 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 7.45 seconds (7.45s).
[0m04:48:33.953467 [debug] [MainThread]: Command end result
[0m04:48:34.074240 [info ] [MainThread]: 
[0m04:48:34.075131 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m04:48:34.075749 [info ] [MainThread]: 
[0m04:48:34.076595 [error] [MainThread]:   Database Error in model mpg_standardized (models/clean/mpg_standardized.sql)
  HTTPDriver for http://54.87.106.52:8123 received ClickHouse error code 43
   Code: 43. DB::Exception: Illegal type Float64 of first argument of function toFloat64OrNull. Conversion functions with postfix 'OrZero' or 'OrNull' should take String argument: While processing toFloat64OrNull(mpg) AS mpg, toInt32OrNull(cylinders) AS cylinders, toFloat64OrNull(displacement) AS displacement, toFloat64OrNull(horsepower) AS horsepower, toInt32OrNull(weight) AS weight, toFloat64OrNull(acceleration) AS acceleration, toInt32OrNull(model_year) AS model_year, trimBoth(origin) AS origin, trimBoth(name) AS make. (ILLEGAL_TYPE_OF_ARGUMENT) (version 23.12.6.19 (official build))
[0m04:48:34.077328 [info ] [MainThread]: 
[0m04:48:34.077978 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m04:48:34.079322 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 8.929792, "process_in_blocks": "0", "process_kernel_time": 0.637605, "process_mem_max_rss": "111164", "process_out_blocks": "9488", "process_user_time": 5.013761}
[0m04:48:34.080310 [debug] [MainThread]: Command `dbt build` failed at 04:48:34.080046 after 8.93 seconds
[0m04:48:34.080967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723ae393f310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723ae17ee1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723ae3b44070>]}
[0m04:48:34.081701 [debug] [MainThread]: Flushing usage events
[0m04:57:08.379284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74dfc96e2dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74dfc6338400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74dfc6338550>]}


============================== 04:57:08.389795 | d5f8e3f6-b6c9-4fda-ab01-10ea4829ced0 ==============================
[0m04:57:08.389795 [info ] [MainThread]: Running with dbt=1.8.9
[0m04:57:08.390985 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'indirect_selection': 'eager', 'write_json': 'True', 'printer_width': '80', 'log_cache_events': 'False', 'fail_fast': 'False', 'log_path': '/workdir/transforms/01_mpg/logs', 'quiet': 'False', 'target_path': 'None', 'use_experimental_parser': 'False', 'log_format': 'default', 'partial_parse': 'True', 'no_print': 'None', 'empty': 'False', 'version_check': 'True', 'invocation_command': 'dbt build --profiles-dir . --target remote', 'introspect': 'True', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'debug': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'profiles_dir': '.', 'use_colors': 'True'}
[0m04:57:08.714388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd5f8e3f6-b6c9-4fda-ab01-10ea4829ced0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74dfc8b71940>]}
[0m04:57:08.815926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd5f8e3f6-b6c9-4fda-ab01-10ea4829ced0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74dfc63ec220>]}
[0m04:57:08.817502 [info ] [MainThread]: Registered adapter: clickhouse=1.8.6
[0m04:57:09.003912 [debug] [MainThread]: checksum: 265ce5244aff672775eaff93c261d21692ed3f5650f4d9e918c76acdb0e9479a, vars: {}, profile: , target: remote, version: 1.8.9
[0m04:57:09.226571 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:57:09.227311 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:57:09.300476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd5f8e3f6-b6c9-4fda-ab01-10ea4829ced0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74dfc5bb6130>]}
[0m04:57:09.763277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd5f8e3f6-b6c9-4fda-ab01-10ea4829ced0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74dfc5aff1f0>]}
[0m04:57:09.764121 [info ] [MainThread]: Found 2 models, 1 source, 471 macros
[0m04:57:09.766802 [info ] [MainThread]: 
[0m04:57:09.767934 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m04:57:09.779722 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m04:57:09.780831 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m04:57:09.818217 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:57:09.820344 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:57:13.138878 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m04:57:13.186531 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m04:57:13.376587 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.24 seconds
[0m04:57:13.428184 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.24 seconds
[0m04:57:13.431504 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__clean)
[0m04:57:13.442654 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__mart)
[0m04:57:13.443668 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "connection_name": "list__clean"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'clean'
      

  ...
[0m04:57:13.447709 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__mart: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "connection_name": "list__mart"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'mart'
      

  ...
[0m04:57:13.689861 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.24 seconds
[0m04:57:13.693568 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.24 seconds
[0m04:57:13.696445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd5f8e3f6-b6c9-4fda-ab01-10ea4829ced0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74dfc5a8cf70>]}
[0m04:57:13.697397 [info ] [MainThread]: Concurrency: 4 threads (target='remote')
[0m04:57:13.698059 [info ] [MainThread]: 
[0m04:57:13.711980 [debug] [Thread-1  ]: Began running node model.ex_01_mpg.mpg_standardized
[0m04:57:13.713192 [info ] [Thread-1  ]: 1 of 2 START sql table model `clean`.`mpg_standardized` ........................ [RUN]
[0m04:57:13.714412 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.ex_01_mpg.mpg_standardized'
[0m04:57:13.715161 [debug] [Thread-1  ]: Began compiling node model.ex_01_mpg.mpg_standardized
[0m04:57:13.731865 [debug] [Thread-1  ]: Writing injected SQL for node "model.ex_01_mpg.mpg_standardized"
[0m04:57:13.733105 [debug] [Thread-1  ]: Began executing node model.ex_01_mpg.mpg_standardized
[0m04:57:13.826389 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m04:57:16.564328 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_01_mpg.mpg_standardized"} */

            

    
        create table `clean`.`mpg_standardized__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

-- Source columns are already Nullable with correct types.
-- Keep them as-is to preserve nullability and avoid insert errors.

select
  toFloat64OrNull(mpg)          as mpg,
  toInt32OrNull(cylinders)      as cylinders,
  toFloat64OrNull(displacement) as displacement,
  toFloat64OrNull(horsepower)   as horsepower,
  toInt32OrNull(weight)         as weight,
  toFloat64OrNull(acceleration) as acceleration,
  toInt32OrNull(model_year)     as model_year,
  trim(origin)                  as origin,
  trim(name)                    as make
from `raw`.`autompg___cars`
-- where horsepower is not null
          )
        
        ...
[0m04:57:16.815723 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.25 seconds
[0m04:57:16.832228 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_01_mpg.mpg_standardized"} */

    select name, type from system.columns where table = 'mpg_standardized__dbt_backup'
    
      and database = 'clean'
    
    order by position
  ...
[0m04:57:17.075744 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.24 seconds
[0m04:57:17.089071 [debug] [Thread-1  ]: Writing runtime sql for node "model.ex_01_mpg.mpg_standardized"
[0m04:57:17.091543 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_01_mpg.mpg_standardized"} */

  
    
    
    
        
         


        insert into `clean`.`mpg_standardized__dbt_backup`
        ("mpg", "cylinders", "displacement", "horsepower", "weight", "acceleration", "model_year", "origin", "make")

-- Source columns are already Nullable with correct types.
-- Keep them as-is to preserve nullability and avoid insert errors.

select
  toFloat64OrNull(mpg)          as mpg,
  toInt32OrNull(cylinders)      as cylinders,
  toFloat64OrNull(displacement) as displacement,
  toFloat64OrNull(horsepower)   as horsepower,
  toInt32OrNull(weight)         as weight,
  toFloat64OrNull(acceleration) as acceleration,
  toInt32OrNull(model_year)     as model_year,
  trim(origin)                  as origin,
  trim(name)                    as make
from `raw`.`autompg___cars`
-- where horsepower is not null
  ...
[0m04:57:17.336573 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.24 seconds
[0m04:57:17.345332 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_01_mpg.mpg_standardized"} */
EXCHANGE TABLES `clean`.`mpg_standardized__dbt_backup` AND `clean`.`mpg_standardized` 
  
  ...
[0m04:57:17.851818 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.51 seconds
[0m04:57:18.053501 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_01_mpg.mpg_standardized"} */

    drop table if exists `clean`.`mpg_standardized__dbt_backup` 
  ...
[0m04:57:18.296007 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.24 seconds
[0m04:57:18.302270 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5f8e3f6-b6c9-4fda-ab01-10ea4829ced0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74dfcbea69a0>]}
[0m04:57:18.303519 [info ] [Thread-1  ]: 1 of 2 OK created sql table model `clean`.`mpg_standardized` ................... [[32mOK[0m in 4.59s]
[0m04:57:18.304850 [debug] [Thread-1  ]: Finished running node model.ex_01_mpg.mpg_standardized
[0m04:57:18.306415 [debug] [Thread-3  ]: Began running node model.ex_01_mpg.cylinders_by_origin
[0m04:57:18.307372 [info ] [Thread-3  ]: 2 of 2 START sql view model `mart`.`cylinders_by_origin` ....................... [RUN]
[0m04:57:18.308616 [debug] [Thread-3  ]: Acquiring new clickhouse connection 'model.ex_01_mpg.cylinders_by_origin'
[0m04:57:18.309471 [debug] [Thread-3  ]: Began compiling node model.ex_01_mpg.cylinders_by_origin
[0m04:57:18.315446 [debug] [Thread-3  ]: Writing injected SQL for node "model.ex_01_mpg.cylinders_by_origin"
[0m04:57:18.316587 [debug] [Thread-3  ]: Began executing node model.ex_01_mpg.cylinders_by_origin
[0m04:57:18.366891 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m04:57:21.048089 [debug] [Thread-3  ]: Writing runtime sql for node "model.ex_01_mpg.cylinders_by_origin"
[0m04:57:21.049551 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */


  create view `mart`.`cylinders_by_origin__dbt_tmp` 
  
    
    
  as (
    

select
  origin,
  avg(cylinders) as avg_cylinders,
  count()        as n
from `clean`.`mpg_standardized`
group by origin
    
  )
      
      
                    -- end_of_sql
                    
                    ...
[0m04:57:21.295488 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.24 seconds
[0m04:57:21.308023 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */

    drop table if exists `mart`.`cylinders_by_origin__dbt_backup` 
  
  ...
[0m04:57:21.548884 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.24 seconds
[0m04:57:21.551027 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */

    rename table `mart`.`cylinders_by_origin` to `mart`.`cylinders_by_origin__dbt_backup` 
  
  ...
[0m04:57:21.792395 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.24 seconds
[0m04:57:21.806373 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */

    drop table if exists `mart`.`cylinders_by_origin` 
  
  ...
[0m04:57:22.048706 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.24 seconds
[0m04:57:22.052366 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */

    rename table `mart`.`cylinders_by_origin__dbt_tmp` to `mart`.`cylinders_by_origin` 
  
  ...
[0m04:57:22.294427 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.24 seconds
[0m04:57:22.306342 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */

    drop table if exists `mart`.`cylinders_by_origin__dbt_backup` 
  ...
[0m04:57:22.548479 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.24 seconds
[0m04:57:22.551204 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5f8e3f6-b6c9-4fda-ab01-10ea4829ced0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74dfc61b7fd0>]}
[0m04:57:22.552458 [info ] [Thread-3  ]: 2 of 2 OK created sql view model `mart`.`cylinders_by_origin` .................. [[32mOK[0m in 4.24s]
[0m04:57:22.553845 [debug] [Thread-3  ]: Finished running node model.ex_01_mpg.cylinders_by_origin
[0m04:57:22.555926 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:57:22.556530 [debug] [MainThread]: Connection 'list__clean' was left open.
[0m04:57:22.557067 [debug] [MainThread]: On list__clean: Close
[0m04:57:22.557589 [debug] [MainThread]: Connection 'list__mart' was left open.
[0m04:57:22.558064 [debug] [MainThread]: On list__mart: Close
[0m04:57:22.558538 [debug] [MainThread]: Connection 'model.ex_01_mpg.mpg_standardized' was left open.
[0m04:57:22.559030 [debug] [MainThread]: On model.ex_01_mpg.mpg_standardized: Close
[0m04:57:22.559510 [debug] [MainThread]: Connection 'model.ex_01_mpg.cylinders_by_origin' was left open.
[0m04:57:22.560019 [debug] [MainThread]: On model.ex_01_mpg.cylinders_by_origin: Close
[0m04:57:22.561027 [info ] [MainThread]: 
[0m04:57:22.561791 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 12.79 seconds (12.79s).
[0m04:57:22.563612 [debug] [MainThread]: Command end result
[0m04:57:22.625506 [info ] [MainThread]: 
[0m04:57:22.626513 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:57:22.627150 [info ] [MainThread]: 
[0m04:57:22.627896 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m04:57:22.629566 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 14.356609, "process_in_blocks": "976", "process_kernel_time": 0.640396, "process_mem_max_rss": "111264", "process_out_blocks": "9512", "process_user_time": 5.217084}
[0m04:57:22.630462 [debug] [MainThread]: Command `dbt build` succeeded at 04:57:22.630151 after 14.36 seconds
[0m04:57:22.631595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74dfc96e2dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74dfc563e310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74dfc755a490>]}
[0m04:57:22.632334 [debug] [MainThread]: Flushing usage events
[0m04:59:14.595363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74690a124310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746906d85b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746906d85a00>]}


============================== 04:59:14.605605 | 58982088-d5d1-4347-9152-1448b80b4045 ==============================
[0m04:59:14.605605 [info ] [MainThread]: Running with dbt=1.8.9
[0m04:59:14.606732 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'log_path': '/workdir/transforms/01_mpg/logs', 'indirect_selection': 'eager', 'invocation_command': 'dbt build --profiles-dir . --target remote', 'target_path': 'None', 'cache_selected_only': 'False', 'log_format': 'default', 'version_check': 'True', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'profiles_dir': '.', 'empty': 'False', 'debug': 'False', 'static_parser': 'True', 'write_json': 'True', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'fail_fast': 'False', 'partial_parse': 'True', 'no_print': 'None', 'quiet': 'False'}
[0m04:59:14.961321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '58982088-d5d1-4347-9152-1448b80b4045', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7469096c2ca0>]}
[0m04:59:15.071760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '58982088-d5d1-4347-9152-1448b80b4045', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74690789e670>]}
[0m04:59:15.073175 [info ] [MainThread]: Registered adapter: clickhouse=1.8.6
[0m04:59:15.271627 [debug] [MainThread]: checksum: 265ce5244aff672775eaff93c261d21692ed3f5650f4d9e918c76acdb0e9479a, vars: {}, profile: , target: remote, version: 1.8.9
[0m04:59:15.493792 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m04:59:15.494845 [debug] [MainThread]: Partial parsing: updated file: ex_01_mpg://models/clean/mpg_standardized.sql
[0m04:59:15.922111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '58982088-d5d1-4347-9152-1448b80b4045', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746905331130>]}
[0m04:59:16.163696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '58982088-d5d1-4347-9152-1448b80b4045', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7469051ec220>]}
[0m04:59:16.164975 [info ] [MainThread]: Found 2 models, 1 source, 471 macros
[0m04:59:16.167989 [info ] [MainThread]: 
[0m04:59:16.169262 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m04:59:16.181924 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m04:59:16.182997 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m04:59:16.230317 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:59:16.231170 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:59:19.806869 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m04:59:20.065856 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.26 seconds
[0m04:59:25.172158 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m04:59:25.448388 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.27 seconds
[0m04:59:25.453443 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__mart)
[0m04:59:25.454781 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__clean)
[0m04:59:25.471139 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__mart: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "connection_name": "list__mart"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'mart'
      

  ...
[0m04:59:25.476183 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "connection_name": "list__clean"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'clean'
      

  ...
[0m04:59:25.743895 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.27 seconds
[0m04:59:25.755345 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.28 seconds
[0m04:59:25.758490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '58982088-d5d1-4347-9152-1448b80b4045', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746904d50130>]}
[0m04:59:25.759427 [info ] [MainThread]: Concurrency: 4 threads (target='remote')
[0m04:59:25.760070 [info ] [MainThread]: 
[0m04:59:25.772761 [debug] [Thread-1  ]: Began running node model.ex_01_mpg.mpg_standardized
[0m04:59:25.773994 [info ] [Thread-1  ]: 1 of 2 START sql table model `clean`.`mpg_standardized` ........................ [RUN]
[0m04:59:25.774879 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list__mart, now model.ex_01_mpg.mpg_standardized)
[0m04:59:25.775602 [debug] [Thread-1  ]: Began compiling node model.ex_01_mpg.mpg_standardized
[0m04:59:25.791988 [debug] [Thread-1  ]: Writing injected SQL for node "model.ex_01_mpg.mpg_standardized"
[0m04:59:25.793282 [debug] [Thread-1  ]: Began executing node model.ex_01_mpg.mpg_standardized
[0m04:59:25.893722 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_01_mpg.mpg_standardized"} */

            

    
        create table `clean`.`mpg_standardized__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

-- Source columns are already Nullable with correct types.
-- Keep them as-is to preserve nullability and avoid insert errors.

select
  toFloat64OrNull(mpg)          as mpg,
  toInt32OrNull(cylinders)      as cylinders,
  toFloat64OrNull(displacement) as displacement,
  toFloat64OrNull(horsepower)   as horsepower,
  toInt32OrNull(weight)         as weight,
  toFloat64OrNull(acceleration) as acceleration,
  toInt32OrNull(model_year)     as model_year,
  trim(origin)                  as origin,
  trim(name)                    as make
from `raw`.`autompg___cars`
where horsepower is not null
          )
        
        ...
[0m04:59:26.178078 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.28 seconds
[0m04:59:26.194634 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_01_mpg.mpg_standardized"} */

    select name, type from system.columns where table = 'mpg_standardized__dbt_backup'
    
      and database = 'clean'
    
    order by position
  ...
[0m04:59:26.470532 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.27 seconds
[0m04:59:26.477348 [debug] [Thread-1  ]: Writing runtime sql for node "model.ex_01_mpg.mpg_standardized"
[0m04:59:26.478705 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_01_mpg.mpg_standardized"} */

  
    
    
    
        
         


        insert into `clean`.`mpg_standardized__dbt_backup`
        ("mpg", "cylinders", "displacement", "horsepower", "weight", "acceleration", "model_year", "origin", "make")

-- Source columns are already Nullable with correct types.
-- Keep them as-is to preserve nullability and avoid insert errors.

select
  toFloat64OrNull(mpg)          as mpg,
  toInt32OrNull(cylinders)      as cylinders,
  toFloat64OrNull(displacement) as displacement,
  toFloat64OrNull(horsepower)   as horsepower,
  toInt32OrNull(weight)         as weight,
  toFloat64OrNull(acceleration) as acceleration,
  toInt32OrNull(model_year)     as model_year,
  trim(origin)                  as origin,
  trim(name)                    as make
from `raw`.`autompg___cars`
where horsepower is not null
  ...
[0m04:59:26.756771 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.28 seconds
[0m04:59:26.772806 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_01_mpg.mpg_standardized"} */
EXCHANGE TABLES `clean`.`mpg_standardized__dbt_backup` AND `clean`.`mpg_standardized` 
  
  ...
[0m04:59:27.048814 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.27 seconds
[0m04:59:27.098099 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_01_mpg.mpg_standardized"} */

    drop table if exists `clean`.`mpg_standardized__dbt_backup` 
  ...
[0m04:59:27.373455 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.27 seconds
[0m04:59:27.380195 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58982088-d5d1-4347-9152-1448b80b4045', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74690451d4f0>]}
[0m04:59:27.381602 [info ] [Thread-1  ]: 1 of 2 OK created sql table model `clean`.`mpg_standardized` ................... [[32mOK[0m in 1.60s]
[0m04:59:27.382996 [debug] [Thread-1  ]: Finished running node model.ex_01_mpg.mpg_standardized
[0m04:59:27.384384 [debug] [Thread-3  ]: Began running node model.ex_01_mpg.cylinders_by_origin
[0m04:59:27.385571 [info ] [Thread-3  ]: 2 of 2 START sql view model `mart`.`cylinders_by_origin` ....................... [RUN]
[0m04:59:27.386810 [debug] [Thread-3  ]: Acquiring new clickhouse connection 'model.ex_01_mpg.cylinders_by_origin'
[0m04:59:27.387569 [debug] [Thread-3  ]: Began compiling node model.ex_01_mpg.cylinders_by_origin
[0m04:59:27.393573 [debug] [Thread-3  ]: Writing injected SQL for node "model.ex_01_mpg.cylinders_by_origin"
[0m04:59:27.394783 [debug] [Thread-3  ]: Began executing node model.ex_01_mpg.cylinders_by_origin
[0m04:59:27.443179 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m04:59:30.764211 [debug] [Thread-3  ]: Writing runtime sql for node "model.ex_01_mpg.cylinders_by_origin"
[0m04:59:30.765812 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */


  create view `mart`.`cylinders_by_origin__dbt_tmp` 
  
    
    
  as (
    

select
  origin,
  avg(cylinders) as avg_cylinders,
  count()        as n
from `clean`.`mpg_standardized`
group by origin
    
  )
      
      
                    -- end_of_sql
                    
                    ...
[0m04:59:31.046802 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.28 seconds
[0m04:59:31.071088 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */

    drop table if exists `mart`.`cylinders_by_origin__dbt_backup` 
  
  ...
[0m04:59:31.347048 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.27 seconds
[0m04:59:31.350734 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */

    rename table `mart`.`cylinders_by_origin` to `mart`.`cylinders_by_origin__dbt_backup` 
  
  ...
[0m04:59:32.369224 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 1.02 seconds
[0m04:59:32.379320 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */

    drop table if exists `mart`.`cylinders_by_origin` 
  
  ...
[0m04:59:32.654970 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.27 seconds
[0m04:59:32.657112 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */

    rename table `mart`.`cylinders_by_origin__dbt_tmp` to `mart`.`cylinders_by_origin` 
  
  ...
[0m04:59:33.680720 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 1.02 seconds
[0m04:59:33.687710 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */

    drop table if exists `mart`.`cylinders_by_origin__dbt_backup` 
  ...
[0m04:59:33.962012 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.27 seconds
[0m04:59:33.964614 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58982088-d5d1-4347-9152-1448b80b4045', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7469044c1c40>]}
[0m04:59:33.965750 [info ] [Thread-3  ]: 2 of 2 OK created sql view model `mart`.`cylinders_by_origin` .................. [[32mOK[0m in 6.58s]
[0m04:59:33.967546 [debug] [Thread-3  ]: Finished running node model.ex_01_mpg.cylinders_by_origin
[0m04:59:33.969868 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:59:33.970742 [debug] [MainThread]: Connection 'model.ex_01_mpg.mpg_standardized' was left open.
[0m04:59:33.971614 [debug] [MainThread]: On model.ex_01_mpg.mpg_standardized: Close
[0m04:59:33.972430 [debug] [MainThread]: Connection 'list__clean' was left open.
[0m04:59:33.973245 [debug] [MainThread]: On list__clean: Close
[0m04:59:33.974040 [debug] [MainThread]: Connection 'model.ex_01_mpg.cylinders_by_origin' was left open.
[0m04:59:33.974867 [debug] [MainThread]: On model.ex_01_mpg.cylinders_by_origin: Close
[0m04:59:33.976219 [info ] [MainThread]: 
[0m04:59:33.977255 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 17.81 seconds (17.81s).
[0m04:59:33.980068 [debug] [MainThread]: Command end result
[0m04:59:34.046841 [info ] [MainThread]: 
[0m04:59:34.048122 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:59:34.049298 [info ] [MainThread]: 
[0m04:59:34.049960 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m04:59:34.051404 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 19.555983, "process_in_blocks": "0", "process_kernel_time": 0.694831, "process_mem_max_rss": "114080", "process_out_blocks": "10496", "process_user_time": 5.719614}
[0m04:59:34.052289 [debug] [MainThread]: Command `dbt build` succeeded at 04:59:34.052039 after 19.56 seconds
[0m04:59:34.053000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74690a124310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74690804dd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74690886aca0>]}
[0m04:59:34.053704 [debug] [MainThread]: Flushing usage events
[0m05:00:27.600178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73769378a310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7376903edaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7376903ed9a0>]}


============================== 05:00:27.609784 | 94fc8902-cdd5-41b6-99cc-e65e346c4911 ==============================
[0m05:00:27.609784 [info ] [MainThread]: Running with dbt=1.8.9
[0m05:00:27.610936 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '.', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'introspect': 'True', 'quiet': 'False', 'no_print': 'None', 'invocation_command': 'dbt build --profiles-dir . --target remote', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_format': 'default', 'write_json': 'True', 'log_path': '/workdir/transforms/01_mpg/logs', 'target_path': 'None', 'empty': 'False', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'log_cache_events': 'False', 'static_parser': 'True', 'indirect_selection': 'eager', 'use_colors': 'True', 'debug': 'False', 'version_check': 'True'}
[0m05:00:27.929961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '94fc8902-cdd5-41b6-99cc-e65e346c4911', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737695f4c880>]}
[0m05:00:28.038686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '94fc8902-cdd5-41b6-99cc-e65e346c4911', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737690259af0>]}
[0m05:00:28.040012 [info ] [MainThread]: Registered adapter: clickhouse=1.8.6
[0m05:00:28.213186 [debug] [MainThread]: checksum: 265ce5244aff672775eaff93c261d21692ed3f5650f4d9e918c76acdb0e9479a, vars: {}, profile: , target: remote, version: 1.8.9
[0m05:00:28.437607 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:00:28.438296 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:00:28.512007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '94fc8902-cdd5-41b6-99cc-e65e346c4911', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73768fc74df0>]}
[0m05:00:28.738244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '94fc8902-cdd5-41b6-99cc-e65e346c4911', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73768fb7cb50>]}
[0m05:00:28.739131 [info ] [MainThread]: Found 2 models, 1 source, 471 macros
[0m05:00:28.741805 [info ] [MainThread]: 
[0m05:00:28.742931 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m05:00:28.755359 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m05:00:28.756437 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m05:00:28.778864 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:00:28.783827 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:00:32.118011 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m05:00:32.155630 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m05:00:32.357609 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.24 seconds
[0m05:00:32.397500 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.24 seconds
[0m05:00:32.402759 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__mart)
[0m05:00:32.404072 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__clean)
[0m05:00:32.419787 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__mart: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "connection_name": "list__mart"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'mart'
      

  ...
[0m05:00:32.424061 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "connection_name": "list__clean"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'clean'
      

  ...
[0m05:00:32.664423 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.24 seconds
[0m05:00:32.668798 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.24 seconds
[0m05:00:32.673330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '94fc8902-cdd5-41b6-99cc-e65e346c4911', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73768ef42fa0>]}
[0m05:00:32.674279 [info ] [MainThread]: Concurrency: 4 threads (target='remote')
[0m05:00:32.674900 [info ] [MainThread]: 
[0m05:00:32.688600 [debug] [Thread-1  ]: Began running node model.ex_01_mpg.mpg_standardized
[0m05:00:32.689733 [info ] [Thread-1  ]: 1 of 2 START sql table model `clean`.`mpg_standardized` ........................ [RUN]
[0m05:00:32.690886 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.ex_01_mpg.mpg_standardized'
[0m05:00:32.691699 [debug] [Thread-1  ]: Began compiling node model.ex_01_mpg.mpg_standardized
[0m05:00:32.710016 [debug] [Thread-1  ]: Writing injected SQL for node "model.ex_01_mpg.mpg_standardized"
[0m05:00:32.711250 [debug] [Thread-1  ]: Began executing node model.ex_01_mpg.mpg_standardized
[0m05:00:32.804176 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m05:00:35.709757 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_01_mpg.mpg_standardized"} */

            

    
        create table `clean`.`mpg_standardized__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

-- Source columns are already Nullable with correct types.
-- Keep them as-is to preserve nullability and avoid insert errors.

select
  toFloat64OrNull(mpg)          as mpg,
  toInt32OrNull(cylinders)      as cylinders,
  toFloat64OrNull(displacement) as displacement,
  toFloat64OrNull(horsepower)   as horsepower,
  toInt32OrNull(weight)         as weight,
  toFloat64OrNull(acceleration) as acceleration,
  toInt32OrNull(model_year)     as model_year,
  trim(origin)                  as origin,
  trim(name)                    as make
from `raw`.`autompg___cars`
where horsepower is not null
          )
        
        ...
[0m05:00:35.960994 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.25 seconds
[0m05:00:35.977696 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_01_mpg.mpg_standardized"} */

    select name, type from system.columns where table = 'mpg_standardized__dbt_backup'
    
      and database = 'clean'
    
    order by position
  ...
[0m05:00:36.218819 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.24 seconds
[0m05:00:36.225315 [debug] [Thread-1  ]: Writing runtime sql for node "model.ex_01_mpg.mpg_standardized"
[0m05:00:36.226826 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_01_mpg.mpg_standardized"} */

  
    
    
    
        
         


        insert into `clean`.`mpg_standardized__dbt_backup`
        ("mpg", "cylinders", "displacement", "horsepower", "weight", "acceleration", "model_year", "origin", "make")

-- Source columns are already Nullable with correct types.
-- Keep them as-is to preserve nullability and avoid insert errors.

select
  toFloat64OrNull(mpg)          as mpg,
  toInt32OrNull(cylinders)      as cylinders,
  toFloat64OrNull(displacement) as displacement,
  toFloat64OrNull(horsepower)   as horsepower,
  toInt32OrNull(weight)         as weight,
  toFloat64OrNull(acceleration) as acceleration,
  toInt32OrNull(model_year)     as model_year,
  trim(origin)                  as origin,
  trim(name)                    as make
from `raw`.`autompg___cars`
where horsepower is not null
  ...
[0m05:00:36.469496 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.24 seconds
[0m05:00:36.480496 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_01_mpg.mpg_standardized"} */
EXCHANGE TABLES `clean`.`mpg_standardized__dbt_backup` AND `clean`.`mpg_standardized` 
  
  ...
[0m05:00:36.721596 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.24 seconds
[0m05:00:36.849905 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_01_mpg.mpg_standardized"} */

    drop table if exists `clean`.`mpg_standardized__dbt_backup` 
  ...
[0m05:00:37.089885 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.24 seconds
[0m05:00:37.097908 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94fc8902-cdd5-41b6-99cc-e65e346c4911', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737692d2e7f0>]}
[0m05:00:37.099333 [info ] [Thread-1  ]: 1 of 2 OK created sql table model `clean`.`mpg_standardized` ................... [[32mOK[0m in 4.40s]
[0m05:00:37.100685 [debug] [Thread-1  ]: Finished running node model.ex_01_mpg.mpg_standardized
[0m05:00:37.102218 [debug] [Thread-3  ]: Began running node model.ex_01_mpg.cylinders_by_origin
[0m05:00:37.103258 [info ] [Thread-3  ]: 2 of 2 START sql view model `mart`.`cylinders_by_origin` ....................... [RUN]
[0m05:00:37.104430 [debug] [Thread-3  ]: Acquiring new clickhouse connection 'model.ex_01_mpg.cylinders_by_origin'
[0m05:00:37.105182 [debug] [Thread-3  ]: Began compiling node model.ex_01_mpg.cylinders_by_origin
[0m05:00:37.111562 [debug] [Thread-3  ]: Writing injected SQL for node "model.ex_01_mpg.cylinders_by_origin"
[0m05:00:37.112796 [debug] [Thread-3  ]: Began executing node model.ex_01_mpg.cylinders_by_origin
[0m05:00:37.162840 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m05:00:39.834335 [debug] [Thread-3  ]: Writing runtime sql for node "model.ex_01_mpg.cylinders_by_origin"
[0m05:00:39.835759 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */


  create view `mart`.`cylinders_by_origin__dbt_tmp` 
  
    
    
  as (
    

select
  origin,
  avg(cylinders) as avg_cylinders,
  count()        as n
from `clean`.`mpg_standardized`
group by origin
    
  )
      
      
                    -- end_of_sql
                    
                    ...
[0m05:00:40.079282 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.24 seconds
[0m05:00:40.092036 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */

    drop table if exists `mart`.`cylinders_by_origin__dbt_backup` 
  
  ...
[0m05:00:40.331528 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.24 seconds
[0m05:00:40.333791 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */

    rename table `mart`.`cylinders_by_origin` to `mart`.`cylinders_by_origin__dbt_backup` 
  
  ...
[0m05:00:40.581444 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.25 seconds
[0m05:00:40.588897 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */

    drop table if exists `mart`.`cylinders_by_origin` 
  
  ...
[0m05:00:40.828294 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.24 seconds
[0m05:00:40.830448 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */

    rename table `mart`.`cylinders_by_origin__dbt_tmp` to `mart`.`cylinders_by_origin` 
  
  ...
[0m05:00:41.069675 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.24 seconds
[0m05:00:41.076374 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */

    drop table if exists `mart`.`cylinders_by_origin__dbt_backup` 
  ...
[0m05:00:41.317359 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.24 seconds
[0m05:00:41.319968 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94fc8902-cdd5-41b6-99cc-e65e346c4911', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73768eeee8e0>]}
[0m05:00:41.321090 [info ] [Thread-3  ]: 2 of 2 OK created sql view model `mart`.`cylinders_by_origin` .................. [[32mOK[0m in 4.22s]
[0m05:00:41.322595 [debug] [Thread-3  ]: Finished running node model.ex_01_mpg.cylinders_by_origin
[0m05:00:41.324772 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:00:41.325326 [debug] [MainThread]: Connection 'list__mart' was left open.
[0m05:00:41.325840 [debug] [MainThread]: On list__mart: Close
[0m05:00:41.326334 [debug] [MainThread]: Connection 'list__clean' was left open.
[0m05:00:41.326825 [debug] [MainThread]: On list__clean: Close
[0m05:00:41.327311 [debug] [MainThread]: Connection 'model.ex_01_mpg.mpg_standardized' was left open.
[0m05:00:41.327792 [debug] [MainThread]: On model.ex_01_mpg.mpg_standardized: Close
[0m05:00:41.328266 [debug] [MainThread]: Connection 'model.ex_01_mpg.cylinders_by_origin' was left open.
[0m05:00:41.328837 [debug] [MainThread]: On model.ex_01_mpg.cylinders_by_origin: Close
[0m05:00:41.329761 [info ] [MainThread]: 
[0m05:00:41.330444 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 12.59 seconds (12.59s).
[0m05:00:41.332177 [debug] [MainThread]: Command end result
[0m05:00:41.388759 [info ] [MainThread]: 
[0m05:00:41.389687 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:00:41.390336 [info ] [MainThread]: 
[0m05:00:41.390934 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m05:00:41.392368 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 13.886416, "process_in_blocks": "0", "process_kernel_time": 0.651191, "process_mem_max_rss": "111260", "process_out_blocks": "9512", "process_user_time": 5.289554}
[0m05:00:41.393183 [debug] [MainThread]: Command `dbt build` succeeded at 05:00:41.392972 after 13.89 seconds
[0m05:00:41.393827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73769378a310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73768ef42fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73768fcb27c0>]}
[0m05:00:41.394438 [debug] [MainThread]: Flushing usage events
[0m05:10:46.151696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bca5055f310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bca4d1c0af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bca4d1c09a0>]}


============================== 05:10:46.161983 | eba9b1aa-21f2-48d0-b62a-d34e18a9b39a ==============================
[0m05:10:46.161983 [info ] [MainThread]: Running with dbt=1.8.9
[0m05:10:46.163161 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'introspect': 'True', 'use_colors': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'profiles_dir': '.', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'empty': 'False', 'quiet': 'False', 'log_path': '/workdir/transforms/01_mpg/logs', 'static_parser': 'True', 'write_json': 'True', 'log_cache_events': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'cache_selected_only': 'False', 'invocation_command': 'dbt build --profiles-dir . --target remote', 'target_path': 'None'}
[0m05:10:46.467863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eba9b1aa-21f2-48d0-b62a-d34e18a9b39a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bca52d25880>]}
[0m05:10:46.566455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eba9b1aa-21f2-48d0-b62a-d34e18a9b39a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bca4d030af0>]}
[0m05:10:46.567801 [info ] [MainThread]: Registered adapter: clickhouse=1.8.6
[0m05:10:46.754140 [debug] [MainThread]: checksum: 265ce5244aff672775eaff93c261d21692ed3f5650f4d9e918c76acdb0e9479a, vars: {}, profile: , target: remote, version: 1.8.9
[0m05:10:46.993464 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m05:10:46.994536 [debug] [MainThread]: Partial parsing: updated file: ex_01_mpg://models/clean/mpg_standardized.sql
[0m05:10:47.444229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eba9b1aa-21f2-48d0-b62a-d34e18a9b39a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bca4b765130>]}
[0m05:10:47.689805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eba9b1aa-21f2-48d0-b62a-d34e18a9b39a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bca4b625250>]}
[0m05:10:47.690750 [info ] [MainThread]: Found 2 models, 1 source, 471 macros
[0m05:10:47.693643 [info ] [MainThread]: 
[0m05:10:47.694816 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m05:10:47.706758 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m05:10:47.707881 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m05:10:47.732036 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:10:47.741696 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:10:50.978470 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m05:10:51.191434 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m05:10:51.216795 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.24 seconds
[0m05:10:51.437915 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.25 seconds
[0m05:10:51.442201 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__clean)
[0m05:10:51.443207 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__mart)
[0m05:10:51.454627 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "connection_name": "list__clean"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'clean'
      

  ...
[0m05:10:51.458612 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__mart: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "connection_name": "list__mart"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'mart'
      

  ...
[0m05:10:51.694794 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.23 seconds
[0m05:10:51.708540 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.25 seconds
[0m05:10:51.711676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eba9b1aa-21f2-48d0-b62a-d34e18a9b39a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bca4cafddf0>]}
[0m05:10:51.712561 [info ] [MainThread]: Concurrency: 4 threads (target='remote')
[0m05:10:51.713245 [info ] [MainThread]: 
[0m05:10:51.729400 [debug] [Thread-1  ]: Began running node model.ex_01_mpg.mpg_standardized
[0m05:10:51.730620 [info ] [Thread-1  ]: 1 of 2 START sql table model `clean`.`mpg_standardized` ........................ [RUN]
[0m05:10:51.731532 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list__clean, now model.ex_01_mpg.mpg_standardized)
[0m05:10:51.732253 [debug] [Thread-1  ]: Began compiling node model.ex_01_mpg.mpg_standardized
[0m05:10:51.749334 [debug] [Thread-1  ]: Writing injected SQL for node "model.ex_01_mpg.mpg_standardized"
[0m05:10:51.750631 [debug] [Thread-1  ]: Began executing node model.ex_01_mpg.mpg_standardized
[0m05:10:51.855816 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_01_mpg.mpg_standardized"} */

            

    
        create table `clean`.`mpg_standardized__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

-- Source columns are already Nullable with correct types.
-- Keep them as-is to preserve nullability and avoid insert errors.

select
  toFloat64OrNull(mpg)          as mpg,
  toInt32OrNull(cylinders)      as cylinders,
  toFloat64OrNull(displacement) as displacement,
  toFloat64OrNull(horsepower)   as horsepower,
  toInt32OrNull(weight)         as weight,
  toFloat64OrNull(acceleration) as acceleration,
  toInt32OrNull(model_year)     as model_year,
  trim(origin)                  as origin,
  trim(name)                    as make
from `raw`.`autompg___cars`
where horsepower is not null
  and isFinite(horsepower)
          )
        
        ...
[0m05:10:52.113550 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.26 seconds
[0m05:10:52.129750 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_01_mpg.mpg_standardized"} */

    select name, type from system.columns where table = 'mpg_standardized__dbt_backup'
    
      and database = 'clean'
    
    order by position
  ...
[0m05:10:52.381923 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.25 seconds
[0m05:10:52.388557 [debug] [Thread-1  ]: Writing runtime sql for node "model.ex_01_mpg.mpg_standardized"
[0m05:10:52.390111 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_01_mpg.mpg_standardized"} */

  
    
    
    
        
         


        insert into `clean`.`mpg_standardized__dbt_backup`
        ("mpg", "cylinders", "displacement", "horsepower", "weight", "acceleration", "model_year", "origin", "make")

-- Source columns are already Nullable with correct types.
-- Keep them as-is to preserve nullability and avoid insert errors.

select
  toFloat64OrNull(mpg)          as mpg,
  toInt32OrNull(cylinders)      as cylinders,
  toFloat64OrNull(displacement) as displacement,
  toFloat64OrNull(horsepower)   as horsepower,
  toInt32OrNull(weight)         as weight,
  toFloat64OrNull(acceleration) as acceleration,
  toInt32OrNull(model_year)     as model_year,
  trim(origin)                  as origin,
  trim(name)                    as make
from `raw`.`autompg___cars`
where horsepower is not null
  and isFinite(horsepower)
  ...
[0m05:10:52.639080 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.25 seconds
[0m05:10:52.647818 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_01_mpg.mpg_standardized"} */
EXCHANGE TABLES `clean`.`mpg_standardized__dbt_backup` AND `clean`.`mpg_standardized` 
  
  ...
[0m05:10:52.896265 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.25 seconds
[0m05:10:52.955700 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_01_mpg.mpg_standardized"} */

    drop table if exists `clean`.`mpg_standardized__dbt_backup` 
  ...
[0m05:10:53.202388 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.25 seconds
[0m05:10:53.209122 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eba9b1aa-21f2-48d0-b62a-d34e18a9b39a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bca4a944eb0>]}
[0m05:10:53.210491 [info ] [Thread-1  ]: 1 of 2 OK created sql table model `clean`.`mpg_standardized` ................... [[32mOK[0m in 1.48s]
[0m05:10:53.212011 [debug] [Thread-1  ]: Finished running node model.ex_01_mpg.mpg_standardized
[0m05:10:53.213414 [debug] [Thread-3  ]: Began running node model.ex_01_mpg.cylinders_by_origin
[0m05:10:53.214703 [info ] [Thread-3  ]: 2 of 2 START sql view model `mart`.`cylinders_by_origin` ....................... [RUN]
[0m05:10:53.215927 [debug] [Thread-3  ]: Acquiring new clickhouse connection 'model.ex_01_mpg.cylinders_by_origin'
[0m05:10:53.216824 [debug] [Thread-3  ]: Began compiling node model.ex_01_mpg.cylinders_by_origin
[0m05:10:53.223492 [debug] [Thread-3  ]: Writing injected SQL for node "model.ex_01_mpg.cylinders_by_origin"
[0m05:10:53.224940 [debug] [Thread-3  ]: Began executing node model.ex_01_mpg.cylinders_by_origin
[0m05:10:53.279513 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m05:10:56.052764 [debug] [Thread-3  ]: Writing runtime sql for node "model.ex_01_mpg.cylinders_by_origin"
[0m05:10:56.054269 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */


  create view `mart`.`cylinders_by_origin__dbt_tmp` 
  
    
    
  as (
    

select
  origin,
  avg(cylinders) as avg_cylinders,
  count()        as n
from `clean`.`mpg_standardized`
group by origin
    
  )
      
      
                    -- end_of_sql
                    
                    ...
[0m05:10:56.306468 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.25 seconds
[0m05:10:56.330116 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */

    drop table if exists `mart`.`cylinders_by_origin__dbt_backup` 
  
  ...
[0m05:10:56.577214 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.25 seconds
[0m05:10:56.580895 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */

    rename table `mart`.`cylinders_by_origin` to `mart`.`cylinders_by_origin__dbt_backup` 
  
  ...
[0m05:10:56.827404 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.25 seconds
[0m05:10:56.834566 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */

    drop table if exists `mart`.`cylinders_by_origin` 
  
  ...
[0m05:10:57.080554 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.24 seconds
[0m05:10:57.082662 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */

    rename table `mart`.`cylinders_by_origin__dbt_tmp` to `mart`.`cylinders_by_origin` 
  
  ...
[0m05:10:57.333848 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.25 seconds
[0m05:10:57.348714 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "remote", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */

    drop table if exists `mart`.`cylinders_by_origin__dbt_backup` 
  ...
[0m05:10:57.599407 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.25 seconds
[0m05:10:57.602124 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eba9b1aa-21f2-48d0-b62a-d34e18a9b39a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bca4a944c70>]}
[0m05:10:57.603272 [info ] [Thread-3  ]: 2 of 2 OK created sql view model `mart`.`cylinders_by_origin` .................. [[32mOK[0m in 4.39s]
[0m05:10:57.604726 [debug] [Thread-3  ]: Finished running node model.ex_01_mpg.cylinders_by_origin
[0m05:10:57.606695 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:10:57.607278 [debug] [MainThread]: Connection 'model.ex_01_mpg.mpg_standardized' was left open.
[0m05:10:57.607819 [debug] [MainThread]: On model.ex_01_mpg.mpg_standardized: Close
[0m05:10:57.608355 [debug] [MainThread]: Connection 'list__mart' was left open.
[0m05:10:57.608856 [debug] [MainThread]: On list__mart: Close
[0m05:10:57.609388 [debug] [MainThread]: Connection 'model.ex_01_mpg.cylinders_by_origin' was left open.
[0m05:10:57.609894 [debug] [MainThread]: On model.ex_01_mpg.cylinders_by_origin: Close
[0m05:10:57.610787 [info ] [MainThread]: 
[0m05:10:57.611523 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 9.92 seconds (9.92s).
[0m05:10:57.613331 [debug] [MainThread]: Command end result
[0m05:10:57.665045 [info ] [MainThread]: 
[0m05:10:57.665912 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:10:57.666529 [info ] [MainThread]: 
[0m05:10:57.667139 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m05:10:57.668527 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 11.616769, "process_in_blocks": "0", "process_kernel_time": 0.660989, "process_mem_max_rss": "114384", "process_out_blocks": "10488", "process_user_time": 5.523912}
[0m05:10:57.669285 [debug] [MainThread]: Command `dbt build` succeeded at 05:10:57.669083 after 11.62 seconds
[0m05:10:57.669897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bca5055f310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bca4b5a5520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bca4ea521c0>]}
[0m05:10:57.670500 [debug] [MainThread]: Flushing usage events
[0m05:31:05.170216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aa95c38c310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aa958feaaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aa958fea9a0>]}


============================== 05:31:05.179909 | e29606fc-9793-40db-a9c5-d9565f3c3943 ==============================
[0m05:31:05.179909 [info ] [MainThread]: Running with dbt=1.8.9
[0m05:31:05.181036 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '.', 'invocation_command': 'dbt build --profiles-dir . --target local', 'partial_parse': 'True', 'debug': 'False', 'warn_error': 'None', 'write_json': 'True', 'introspect': 'True', 'log_path': '/workdir/transforms/01_mpg/logs', 'static_parser': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'no_print': 'None', 'use_colors': 'True', 'version_check': 'True', 'empty': 'False', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_cache_events': 'False', 'quiet': 'False'}
[0m05:31:05.473219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e29606fc-9793-40db-a9c5-d9565f3c3943', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aa95b92f3a0>]}
[0m05:31:05.575783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e29606fc-9793-40db-a9c5-d9565f3c3943', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aa9590ea910>]}
[0m05:31:05.577122 [info ] [MainThread]: Registered adapter: clickhouse=1.8.6
[0m05:31:05.743327 [debug] [MainThread]: checksum: 134c0f7b96382cc6938697739bc32fb1adc530b177e30f60cebddf61dbd7e979, vars: {}, profile: , target: local, version: 1.8.9
[0m05:31:05.933894 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m05:31:05.934828 [debug] [MainThread]: previous checksum: 134c0f7b96382cc6938697739bc32fb1adc530b177e30f60cebddf61dbd7e979, current checksum: 265ce5244aff672775eaff93c261d21692ed3f5650f4d9e918c76acdb0e9479a
[0m05:31:05.935439 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m05:31:05.936070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e29606fc-9793-40db-a9c5-d9565f3c3943', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aa95a3246a0>]}
[0m05:31:08.139843 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.ex_01_mpg.cylinders_by_origin_myk' (models/mart/cylinders_by_origin_myk.sql) depends on a node named 'mpg_standardized' which was not found
[0m05:31:08.141574 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 3.0658424, "process_in_blocks": "8", "process_kernel_time": 0.551583, "process_mem_max_rss": "100492", "process_out_blocks": "6616", "process_user_time": 6.247282}
[0m05:31:08.142421 [debug] [MainThread]: Command `dbt build` failed at 05:31:08.142193 after 3.07 seconds
[0m05:31:08.143070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aa95c38c310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aa9575e5d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aa9589fed30>]}
[0m05:31:08.143715 [debug] [MainThread]: Flushing usage events
[0m05:33:13.052360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8f2e171310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8f2add9b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8f2add9a00>]}


============================== 05:33:13.062291 | 2f45e745-ed2b-45ae-9e73-179233d4393f ==============================
[0m05:33:13.062291 [info ] [MainThread]: Running with dbt=1.8.9
[0m05:33:13.063414 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'partial_parse': 'True', 'no_print': 'None', 'static_parser': 'True', 'version_check': 'True', 'quiet': 'False', 'empty': 'False', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'fail_fast': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'profiles_dir': '.', 'warn_error': 'None', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build --profiles-dir . --target local', 'printer_width': '80', 'use_experimental_parser': 'False', 'use_colors': 'True', 'write_json': 'True', 'log_cache_events': 'False', 'log_path': '/workdir/transforms/01_mpg/logs'}
[0m05:33:13.477101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2f45e745-ed2b-45ae-9e73-179233d4393f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8f2acd29a0>]}
[0m05:33:13.657499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2f45e745-ed2b-45ae-9e73-179233d4393f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8f2aee4e50>]}
[0m05:33:13.659767 [info ] [MainThread]: Registered adapter: clickhouse=1.8.6
[0m05:33:13.945701 [debug] [MainThread]: checksum: 134c0f7b96382cc6938697739bc32fb1adc530b177e30f60cebddf61dbd7e979, vars: {}, profile: , target: local, version: 1.8.9
[0m05:33:14.140992 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m05:33:14.141828 [debug] [MainThread]: previous checksum: 134c0f7b96382cc6938697739bc32fb1adc530b177e30f60cebddf61dbd7e979, current checksum: 265ce5244aff672775eaff93c261d21692ed3f5650f4d9e918c76acdb0e9479a
[0m05:33:14.142481 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m05:33:14.143161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2f45e745-ed2b-45ae-9e73-179233d4393f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8f2c10d5b0>]}
[0m05:33:16.579303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2f45e745-ed2b-45ae-9e73-179233d4393f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8f29285130>]}
[0m05:33:17.703143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2f45e745-ed2b-45ae-9e73-179233d4393f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8f29322220>]}
[0m05:33:17.704507 [info ] [MainThread]: Found 2 models, 1 source, 471 macros
[0m05:33:17.708640 [info ] [MainThread]: 
[0m05:33:17.710111 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m05:33:17.731089 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m05:33:17.732146 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m05:33:17.752427 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:33:17.758652 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:33:18.021665 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m05:33:18.026673 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m05:33:18.028774 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m05:33:18.040127 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m05:33:18.057870 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__mart)
[0m05:33:18.058843 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__clean)
[0m05:33:18.076340 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__mart: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list__mart"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'mart'
      

  ...
[0m05:33:18.081766 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list__clean"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'clean'
      

  ...
[0m05:33:18.088584 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m05:33:18.092075 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m05:33:18.104791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f45e745-ed2b-45ae-9e73-179233d4393f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8f28b57190>]}
[0m05:33:18.105797 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m05:33:18.106461 [info ] [MainThread]: 
[0m05:33:18.119590 [debug] [Thread-1  ]: Began running node model.ex_01_mpg.mpg_standardized_myk
[0m05:33:18.120738 [info ] [Thread-1  ]: 1 of 2 START sql table model `clean`.`mpg_standardized_myk` .................... [RUN]
[0m05:33:18.121860 [debug] [Thread-1  ]: Acquiring new clickhouse connection 'model.ex_01_mpg.mpg_standardized_myk'
[0m05:33:18.122618 [debug] [Thread-1  ]: Began compiling node model.ex_01_mpg.mpg_standardized_myk
[0m05:33:18.139804 [debug] [Thread-1  ]: Writing injected SQL for node "model.ex_01_mpg.mpg_standardized_myk"
[0m05:33:18.140939 [debug] [Thread-1  ]: Began executing node model.ex_01_mpg.mpg_standardized_myk
[0m05:33:18.179768 [debug] [Thread-1  ]: Creating new relation mpg_standardized_myk
[0m05:33:18.234530 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m05:33:18.304047 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized_myk: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.mpg_standardized_myk"} */

            

    
        create table `clean`.`mpg_standardized_myk`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

-- Source columns are already Nullable with correct types.
-- Keep them as-is to preserve nullability and avoid insert errors.

select
  toFloat64OrNull(mpg)          as mpg,
  toInt32OrNull(cylinders)      as cylinders,
  toFloat64OrNull(displacement) as displacement,
  toFloat64OrNull(horsepower)   as horsepower,
  toInt32OrNull(weight)         as weight,
  toFloat64OrNull(acceleration) as acceleration,
  toInt32OrNull(model_year)     as model_year,
  trim(origin)                  as origin,
  trim(name)                    as make
from `raw`.`autompg___cars`
where horsepower is not null
  and isFinite(horsepower)
          )
        
        ...
[0m05:33:18.320424 [debug] [Thread-1  ]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.mpg_standardized_myk"} */

            

    
        create table `clean`.`mpg_standardized_myk`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

-- Source columns are already Nullable with correct types.
-- Keep them as-is to preserve nullability and avoid insert errors.

select
  toFloat64OrNull(mpg)          as mpg,
  toInt32OrNull(cylinders)      as cylinders,
  toFloat64OrNull(displacement) as displacement,
  toFloat64OrNull(horsepower)   as horsepower,
  toInt32OrNull(weight)         as weight,
  toFloat64OrNull(acceleration) as acceleration,
  toInt32OrNull(model_year)     as model_year,
  trim(origin)                  as origin,
  trim(name)                    as make
from `raw`.`autompg___cars`
where horsepower is not null
  and isFinite(horsepower)
          )
        
        
[0m05:33:18.327728 [debug] [Thread-1  ]: Database Error in model mpg_standardized_myk (models/clean/mpg_standardized_myk.sql)
  HTTPDriver for http://clickhouse:8123 received ClickHouse error code 43
   Code: 43. DB::Exception: Illegal type Float64 of first argument of function toFloat64OrNull. Conversion functions with postfix 'OrZero' or 'OrNull' should take String argument: While processing ((toFloat64OrNull(horsepower) AS horsepower) IS NOT NULL) AND isFinite(horsepower). (ILLEGAL_TYPE_OF_ARGUMENT) (version 23.12.6.19 (official build))
[0m05:33:18.332135 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f45e745-ed2b-45ae-9e73-179233d4393f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8f284e9700>]}
[0m05:33:18.333974 [error] [Thread-1  ]: 1 of 2 ERROR creating sql table model `clean`.`mpg_standardized_myk` ........... [[31mERROR[0m in 0.21s]
[0m05:33:18.336138 [debug] [Thread-1  ]: Finished running node model.ex_01_mpg.mpg_standardized_myk
[0m05:33:18.338101 [debug] [Thread-3  ]: Began running node model.ex_01_mpg.cylinders_by_origin_myk
[0m05:33:18.338981 [info ] [Thread-3  ]: 2 of 2 SKIP relation mart.cylinders_by_origin_myk .............................. [[33mSKIP[0m]
[0m05:33:18.339987 [debug] [Thread-3  ]: Finished running node model.ex_01_mpg.cylinders_by_origin_myk
[0m05:33:18.341937 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:33:18.342528 [debug] [MainThread]: Connection 'list__mart' was left open.
[0m05:33:18.343051 [debug] [MainThread]: On list__mart: Close
[0m05:33:18.343582 [debug] [MainThread]: Connection 'list__clean' was left open.
[0m05:33:18.344089 [debug] [MainThread]: On list__clean: Close
[0m05:33:18.344629 [debug] [MainThread]: Connection 'model.ex_01_mpg.mpg_standardized_myk' was left open.
[0m05:33:18.345129 [debug] [MainThread]: On model.ex_01_mpg.mpg_standardized_myk: Close
[0m05:33:18.345970 [info ] [MainThread]: 
[0m05:33:18.346661 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.64 seconds (0.64s).
[0m05:33:18.348100 [debug] [MainThread]: Command end result
[0m05:33:18.400891 [info ] [MainThread]: 
[0m05:33:18.401895 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m05:33:18.402530 [info ] [MainThread]: 
[0m05:33:18.403401 [error] [MainThread]:   Database Error in model mpg_standardized_myk (models/clean/mpg_standardized_myk.sql)
  HTTPDriver for http://clickhouse:8123 received ClickHouse error code 43
   Code: 43. DB::Exception: Illegal type Float64 of first argument of function toFloat64OrNull. Conversion functions with postfix 'OrZero' or 'OrNull' should take String argument: While processing ((toFloat64OrNull(horsepower) AS horsepower) IS NOT NULL) AND isFinite(horsepower). (ILLEGAL_TYPE_OF_ARGUMENT) (version 23.12.6.19 (official build))
[0m05:33:18.404069 [info ] [MainThread]: 
[0m05:33:18.404794 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m05:33:18.406226 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 5.45023, "process_in_blocks": "40", "process_kernel_time": 0.639032, "process_mem_max_rss": "115292", "process_out_blocks": "10456", "process_user_time": 7.50438}
[0m05:33:18.407054 [debug] [MainThread]: Command `dbt build` failed at 05:33:18.406861 after 5.45 seconds
[0m05:33:18.407764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8f2e171310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8f2acd29a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e8f2913cc70>]}
[0m05:33:18.408466 [debug] [MainThread]: Flushing usage events
[0m05:33:51.693126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5a4ccc3310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5a49924b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5a49924a30>]}


============================== 05:33:51.702890 | ff126753-76f0-40ca-bc60-b2369942de80 ==============================
[0m05:33:51.702890 [info ] [MainThread]: Running with dbt=1.8.9
[0m05:33:51.704057 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'static_parser': 'True', 'debug': 'False', 'target_path': 'None', 'quiet': 'False', 'write_json': 'True', 'version_check': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'partial_parse': 'True', 'profiles_dir': '.', 'invocation_command': 'dbt build --profiles-dir . --target local', 'log_path': '/workdir/transforms/01_mpg/logs', 'indirect_selection': 'eager', 'log_format': 'default', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'printer_width': '80', 'log_cache_events': 'False'}
[0m05:33:52.034062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ff126753-76f0-40ca-bc60-b2369942de80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5a4c264ca0>]}
[0m05:33:52.216701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ff126753-76f0-40ca-bc60-b2369942de80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5a49a269d0>]}
[0m05:33:52.218916 [info ] [MainThread]: Registered adapter: clickhouse=1.8.6
[0m05:33:52.485531 [debug] [MainThread]: checksum: 134c0f7b96382cc6938697739bc32fb1adc530b177e30f60cebddf61dbd7e979, vars: {}, profile: , target: local, version: 1.8.9
[0m05:33:52.745936 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m05:33:52.747031 [debug] [MainThread]: Partial parsing: updated file: ex_01_mpg://models/clean/mpg_standardized_myk.sql
[0m05:33:53.045525 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.ex_01_mpg.mpg_standardized_myk' (models/clean/mpg_standardized_myk.sql) depends on a source named 'raw.autompg___cars_myk' which was not found
[0m05:33:53.047379 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 1.4484131, "process_in_blocks": "0", "process_kernel_time": 0.561164, "process_mem_max_rss": "99912", "process_out_blocks": "6616", "process_user_time": 4.519323}
[0m05:33:53.048542 [debug] [MainThread]: Command `dbt build` failed at 05:33:53.048254 after 1.45 seconds
[0m05:33:53.049503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5a4ccc3310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5a498de340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5a4cc0ce50>]}
[0m05:33:53.050365 [debug] [MainThread]: Flushing usage events
[0m05:35:52.862557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7125c340c310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7125c0069af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7125c00699a0>]}


============================== 05:35:52.872322 | 9854d7b6-6d0e-49f3-bd97-53f7eb5ac290 ==============================
[0m05:35:52.872322 [info ] [MainThread]: Running with dbt=1.8.9
[0m05:35:52.873410 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'profiles_dir': '.', 'printer_width': '80', 'log_format': 'default', 'warn_error': 'None', 'log_cache_events': 'False', 'log_path': '/workdir/transforms/01_mpg/logs', 'use_experimental_parser': 'False', 'no_print': 'None', 'target_path': 'None', 'use_colors': 'True', 'indirect_selection': 'eager', 'write_json': 'True', 'empty': 'False', 'cache_selected_only': 'False', 'quiet': 'False', 'static_parser': 'True', 'invocation_command': 'dbt build --profiles-dir . --target local', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'debug': 'False', 'partial_parse': 'True'}
[0m05:35:53.159229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9854d7b6-6d0e-49f3-bd97-53f7eb5ac290', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7125c29b63a0>]}
[0m05:35:53.256171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9854d7b6-6d0e-49f3-bd97-53f7eb5ac290', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7125c0169910>]}
[0m05:35:53.257683 [info ] [MainThread]: Registered adapter: clickhouse=1.8.6
[0m05:35:53.463900 [debug] [MainThread]: checksum: 134c0f7b96382cc6938697739bc32fb1adc530b177e30f60cebddf61dbd7e979, vars: {}, profile: , target: local, version: 1.8.9
[0m05:35:53.689506 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m05:35:53.690595 [debug] [MainThread]: Partial parsing: updated file: ex_01_mpg://models/clean/mpg_standardized_myk.sql
[0m05:35:54.004898 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.ex_01_mpg.mpg_standardized_myk' (models/clean/mpg_standardized_myk.sql) depends on a source named 'raw.autompg___cars_myk' which was not found
[0m05:35:54.007763 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 1.2417657, "process_in_blocks": "0", "process_kernel_time": 0.533695, "process_mem_max_rss": "99752", "process_out_blocks": "6616", "process_user_time": 4.372509}
[0m05:35:54.010485 [debug] [MainThread]: Command `dbt build` failed at 05:35:54.009708 after 1.24 seconds
[0m05:35:54.012817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7125c340c310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7125c33664c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7125c3371760>]}
[0m05:35:54.014868 [debug] [MainThread]: Flushing usage events
[0m05:37:11.926275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8978d7310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89453c490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89453c5e0>]}


============================== 05:37:11.936491 | ef6df7a7-73b0-4033-ac0b-098fb0b2f3ba ==============================
[0m05:37:11.936491 [info ] [MainThread]: Running with dbt=1.8.9
[0m05:37:11.937636 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'partial_parse': 'True', 'warn_error': 'None', 'empty': 'False', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'use_experimental_parser': 'False', 'profiles_dir': '.', 'printer_width': '80', 'log_cache_events': 'False', 'no_print': 'None', 'introspect': 'True', 'use_colors': 'True', 'static_parser': 'True', 'log_path': '/workdir/transforms/01_mpg/logs', 'cache_selected_only': 'False', 'quiet': 'False', 'version_check': 'True', 'log_format': 'default', 'indirect_selection': 'eager', 'target_path': 'None', 'invocation_command': 'dbt build --profiles-dir . --target local'}
[0m05:37:12.256305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ef6df7a7-73b0-4033-ac0b-098fb0b2f3ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8944439a0>]}
[0m05:37:12.370867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ef6df7a7-73b0-4033-ac0b-098fb0b2f3ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa894514760>]}
[0m05:37:12.372356 [info ] [MainThread]: Registered adapter: clickhouse=1.8.6
[0m05:37:12.549389 [debug] [MainThread]: checksum: 134c0f7b96382cc6938697739bc32fb1adc530b177e30f60cebddf61dbd7e979, vars: {}, profile: , target: local, version: 1.8.9
[0m05:37:12.779295 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m05:37:12.780497 [debug] [MainThread]: Partial parsing: updated file: ex_01_mpg://models/sources.yml
[0m05:37:12.781077 [debug] [MainThread]: Partial parsing: updated file: ex_01_mpg://models/clean/mpg_standardized_myk.sql
[0m05:37:13.444578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ef6df7a7-73b0-4033-ac0b-098fb0b2f3ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8927faee0>]}
[0m05:37:13.683632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ef6df7a7-73b0-4033-ac0b-098fb0b2f3ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa892752d60>]}
[0m05:37:13.684508 [info ] [MainThread]: Found 2 models, 1 source, 471 macros
[0m05:37:13.687231 [info ] [MainThread]: 
[0m05:37:13.688450 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m05:37:13.700811 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m05:37:13.712163 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m05:37:13.721161 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:37:13.726072 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:37:14.060382 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m05:37:14.064015 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m05:37:14.065500 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m05:37:14.070085 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m05:37:14.092099 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__mart)
[0m05:37:14.093161 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__clean)
[0m05:37:14.104685 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__mart: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list__mart"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'mart'
      

  ...
[0m05:37:14.108574 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list__clean"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'clean'
      

  ...
[0m05:37:14.114904 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m05:37:14.123964 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m05:37:14.133626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef6df7a7-73b0-4033-ac0b-098fb0b2f3ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89253a040>]}
[0m05:37:14.134664 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m05:37:14.135325 [info ] [MainThread]: 
[0m05:37:14.148440 [debug] [Thread-1  ]: Began running node model.ex_01_mpg.mpg_standardized_myk
[0m05:37:14.149600 [info ] [Thread-1  ]: 1 of 2 START sql table model `clean`.`mpg_standardized_myk` .................... [RUN]
[0m05:37:14.150506 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list__mart, now model.ex_01_mpg.mpg_standardized_myk)
[0m05:37:14.151309 [debug] [Thread-1  ]: Began compiling node model.ex_01_mpg.mpg_standardized_myk
[0m05:37:14.169169 [debug] [Thread-1  ]: Writing injected SQL for node "model.ex_01_mpg.mpg_standardized_myk"
[0m05:37:14.170470 [debug] [Thread-1  ]: Began executing node model.ex_01_mpg.mpg_standardized_myk
[0m05:37:14.210818 [debug] [Thread-1  ]: Creating new relation mpg_standardized_myk
[0m05:37:14.262065 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized_myk: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.mpg_standardized_myk"} */

            

    
        create table `clean`.`mpg_standardized_myk`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

-- Source columns are already Nullable with correct types.
-- Keep them as-is to preserve nullability and avoid insert errors.

select
  toFloat64OrNull(mpg)          as mpg,
  toInt32OrNull(cylinders)      as cylinders,
  toFloat64OrNull(displacement) as displacement,
  toFloat64OrNull(horsepower)   as horsepower,
  toInt32OrNull(weight)         as weight,
  toFloat64OrNull(acceleration) as acceleration,
  toInt32OrNull(model_year)     as model_year,
  trim(origin)                  as origin,
  trim(name)                    as make
from `raw`.`autompg___cars_myk`
where horsepower is not null
  and isFinite(horsepower)
          )
        
        ...
[0m05:37:14.283896 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m05:37:14.300130 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized_myk: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.mpg_standardized_myk"} */

    select name, type from system.columns where table = 'mpg_standardized_myk'
    
      and database = 'clean'
    
    order by position
  ...
[0m05:37:14.304962 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m05:37:14.311437 [debug] [Thread-1  ]: Writing runtime sql for node "model.ex_01_mpg.mpg_standardized_myk"
[0m05:37:14.312696 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized_myk: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.mpg_standardized_myk"} */

  
    
    
    
        
         


        insert into `clean`.`mpg_standardized_myk`
        ("mpg", "cylinders", "displacement", "horsepower", "weight", "acceleration", "model_year", "origin", "make")

-- Source columns are already Nullable with correct types.
-- Keep them as-is to preserve nullability and avoid insert errors.

select
  toFloat64OrNull(mpg)          as mpg,
  toInt32OrNull(cylinders)      as cylinders,
  toFloat64OrNull(displacement) as displacement,
  toFloat64OrNull(horsepower)   as horsepower,
  toInt32OrNull(weight)         as weight,
  toFloat64OrNull(acceleration) as acceleration,
  toInt32OrNull(model_year)     as model_year,
  trim(origin)                  as origin,
  trim(name)                    as make
from `raw`.`autompg___cars_myk`
where horsepower is not null
  and isFinite(horsepower)
  ...
[0m05:37:14.319102 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m05:37:14.360711 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef6df7a7-73b0-4033-ac0b-098fb0b2f3ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8926c5760>]}
[0m05:37:14.362082 [info ] [Thread-1  ]: 1 of 2 OK created sql table model `clean`.`mpg_standardized_myk` ............... [[32mOK[0m in 0.21s]
[0m05:37:14.363912 [debug] [Thread-1  ]: Finished running node model.ex_01_mpg.mpg_standardized_myk
[0m05:37:14.365612 [debug] [Thread-3  ]: Began running node model.ex_01_mpg.cylinders_by_origin_myk
[0m05:37:14.366885 [info ] [Thread-3  ]: 2 of 2 START sql view model `mart`.`cylinders_by_origin_myk` ................... [RUN]
[0m05:37:14.368111 [debug] [Thread-3  ]: Acquiring new clickhouse connection 'model.ex_01_mpg.cylinders_by_origin_myk'
[0m05:37:14.368899 [debug] [Thread-3  ]: Began compiling node model.ex_01_mpg.cylinders_by_origin_myk
[0m05:37:14.374866 [debug] [Thread-3  ]: Writing injected SQL for node "model.ex_01_mpg.cylinders_by_origin_myk"
[0m05:37:14.375971 [debug] [Thread-3  ]: Began executing node model.ex_01_mpg.cylinders_by_origin_myk
[0m05:37:14.403446 [debug] [Thread-3  ]: Creating new relation cylinders_by_origin_myk
[0m05:37:14.418391 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m05:37:14.482576 [debug] [Thread-3  ]: Writing runtime sql for node "model.ex_01_mpg.cylinders_by_origin_myk"
[0m05:37:14.483817 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin_myk: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.cylinders_by_origin_myk"} */


  create view `mart`.`cylinders_by_origin_myk` 
  
    
    
  as (
    

select
  origin,
  avg(cylinders) as avg_cylinders,
  count()        as n
from `clean`.`mpg_standardized_myk`
group by origin
    
  )
      
      
                    -- end_of_sql
                    
                    ...
[0m05:37:14.493964 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m05:37:14.497311 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef6df7a7-73b0-4033-ac0b-098fb0b2f3ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89576e520>]}
[0m05:37:14.498557 [info ] [Thread-3  ]: 2 of 2 OK created sql view model `mart`.`cylinders_by_origin_myk` .............. [[32mOK[0m in 0.13s]
[0m05:37:14.500091 [debug] [Thread-3  ]: Finished running node model.ex_01_mpg.cylinders_by_origin_myk
[0m05:37:14.502675 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:37:14.503478 [debug] [MainThread]: Connection 'model.ex_01_mpg.mpg_standardized_myk' was left open.
[0m05:37:14.504411 [debug] [MainThread]: On model.ex_01_mpg.mpg_standardized_myk: Close
[0m05:37:14.505187 [debug] [MainThread]: Connection 'list__clean' was left open.
[0m05:37:14.505887 [debug] [MainThread]: On list__clean: Close
[0m05:37:14.506656 [debug] [MainThread]: Connection 'model.ex_01_mpg.cylinders_by_origin_myk' was left open.
[0m05:37:14.507355 [debug] [MainThread]: On model.ex_01_mpg.cylinders_by_origin_myk: Close
[0m05:37:14.508571 [info ] [MainThread]: 
[0m05:37:14.509451 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.82 seconds (0.82s).
[0m05:37:14.511759 [debug] [MainThread]: Command end result
[0m05:37:14.575587 [info ] [MainThread]: 
[0m05:37:14.576601 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:37:14.577257 [info ] [MainThread]: 
[0m05:37:14.577959 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m05:37:14.579486 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 2.7517333, "process_in_blocks": "0", "process_kernel_time": 0.652541, "process_mem_max_rss": "114544", "process_out_blocks": "10480", "process_user_time": 5.759948}
[0m05:37:14.580291 [debug] [MainThread]: Command `dbt build` succeeded at 05:37:14.580073 after 2.75 seconds
[0m05:37:14.580957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8978d7310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8957fe910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8944fbb50>]}
[0m05:37:14.581592 [debug] [MainThread]: Flushing usage events
[0m08:59:05.495798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b11e95e310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b11b5bfbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b11b5bfa60>]}


============================== 08:59:05.505981 | f40e8302-1c27-44d2-b187-ee658e06c448 ==============================
[0m08:59:05.505981 [info ] [MainThread]: Running with dbt=1.8.9
[0m08:59:05.507100 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'debug': 'False', 'static_parser': 'True', 'printer_width': '80', 'quiet': 'False', 'log_path': '/workdir/transforms/01_mpg/logs', 'version_check': 'True', 'log_cache_events': 'False', 'profiles_dir': '.', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'use_experimental_parser': 'False', 'introspect': 'True', 'write_json': 'True', 'invocation_command': 'dbt build --profiles-dir . --target local', 'warn_error': 'None', 'no_print': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'empty': 'False', 'log_format': 'default'}
[0m08:59:05.798793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f40e8302-1c27-44d2-b187-ee658e06c448', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b11df033a0>]}
[0m08:59:05.897829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f40e8302-1c27-44d2-b187-ee658e06c448', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b11d46c220>]}
[0m08:59:05.899221 [info ] [MainThread]: Registered adapter: clickhouse=1.8.6
[0m08:59:06.066309 [debug] [MainThread]: checksum: 134c0f7b96382cc6938697739bc32fb1adc530b177e30f60cebddf61dbd7e979, vars: {}, profile: , target: local, version: 1.8.9
[0m08:59:06.289918 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 2 files added, 1 files changed.
[0m08:59:06.290853 [debug] [MainThread]: Partial parsing: added file: ex_01_mpg://models/clean/mpg_standardized.sql
[0m08:59:06.291454 [debug] [MainThread]: Partial parsing: added file: ex_01_mpg://models/mart/cylinders_by_origin.sql
[0m08:59:06.292173 [debug] [MainThread]: Partial parsing: updated file: ex_01_mpg://models/sources.yml
[0m08:59:06.292742 [debug] [MainThread]: Partial parsing: deleted file: ex_01_mpg://models/clean/mpg_standardized_myk.sql
[0m08:59:06.293293 [debug] [MainThread]: Partial parsing: deleted file: ex_01_mpg://models/mart/cylinders_by_origin_myk.sql
[0m08:59:06.891816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f40e8302-1c27-44d2-b187-ee658e06c448', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b119885ee0>]}
[0m08:59:07.106561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f40e8302-1c27-44d2-b187-ee658e06c448', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b1197dd880>]}
[0m08:59:07.107494 [info ] [MainThread]: Found 2 models, 1 source, 471 macros
[0m08:59:07.110371 [info ] [MainThread]: 
[0m08:59:07.111581 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m08:59:07.123773 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m08:59:07.124946 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m08:59:07.167299 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:59:07.173426 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:59:07.536813 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m08:59:07.539035 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m08:59:07.541305 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:59:07.542460 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:59:07.566485 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__mart)
[0m08:59:07.578200 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__clean)
[0m08:59:07.579517 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__mart: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list__mart"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'mart'
      

  ...
[0m08:59:07.584142 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list__clean"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'clean'
      

  ...
[0m08:59:07.592067 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m08:59:07.593568 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m08:59:07.610877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f40e8302-1c27-44d2-b187-ee658e06c448', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b119368cd0>]}
[0m08:59:07.611857 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m08:59:07.612450 [info ] [MainThread]: 
[0m08:59:07.626229 [debug] [Thread-1  ]: Began running node model.ex_01_mpg.mpg_standardized
[0m08:59:07.627410 [info ] [Thread-1  ]: 1 of 2 START sql table model `clean`.`mpg_standardized` ........................ [RUN]
[0m08:59:07.628301 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list__mart, now model.ex_01_mpg.mpg_standardized)
[0m08:59:07.628999 [debug] [Thread-1  ]: Began compiling node model.ex_01_mpg.mpg_standardized
[0m08:59:07.646267 [debug] [Thread-1  ]: Writing injected SQL for node "model.ex_01_mpg.mpg_standardized"
[0m08:59:07.647583 [debug] [Thread-1  ]: Began executing node model.ex_01_mpg.mpg_standardized
[0m08:59:07.743698 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.mpg_standardized"} */

            

    
        create table `clean`.`mpg_standardized__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

-- Source columns are already Nullable with correct types.
-- Keep them as-is to preserve nullability and avoid insert errors.

select
  toFloat64(mpg)          as mpg,
  toInt32OrNull(cylinders)      as cylinders,
  toFloat64OrNull(displacement) as displacement,
  toFloat64OrNull(horsepower)   as horsepower,
  toInt32OrNull(weight)         as weight,
  toFloat64OrNull(acceleration) as acceleration,
  toInt32OrNull(model_year)     as model_year,
  trim(origin)                  as origin,
  trim(name)                    as make
from `raw`.`autompg___cars`
where horsepower is not null
  and isFinite(horsepower)
          )
        
        ...
[0m08:59:07.748339 [debug] [Thread-1  ]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.mpg_standardized"} */

            

    
        create table `clean`.`mpg_standardized__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

-- Source columns are already Nullable with correct types.
-- Keep them as-is to preserve nullability and avoid insert errors.

select
  toFloat64(mpg)          as mpg,
  toInt32OrNull(cylinders)      as cylinders,
  toFloat64OrNull(displacement) as displacement,
  toFloat64OrNull(horsepower)   as horsepower,
  toInt32OrNull(weight)         as weight,
  toFloat64OrNull(acceleration) as acceleration,
  toInt32OrNull(model_year)     as model_year,
  trim(origin)                  as origin,
  trim(name)                    as make
from `raw`.`autompg___cars`
where horsepower is not null
  and isFinite(horsepower)
          )
        
        
[0m08:59:07.758761 [debug] [Thread-1  ]: Database Error in model mpg_standardized (models/clean/mpg_standardized.sql)
  HTTPDriver for http://clickhouse:8123 received ClickHouse error code 43
   Code: 43. DB::Exception: Illegal type Float64 of first argument of function toFloat64OrNull. Conversion functions with postfix 'OrZero' or 'OrNull' should take String argument: While processing ((toFloat64OrNull(horsepower) AS horsepower) IS NOT NULL) AND isFinite(horsepower). (ILLEGAL_TYPE_OF_ARGUMENT) (version 23.12.6.19 (official build))
[0m08:59:07.761498 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f40e8302-1c27-44d2-b187-ee658e06c448', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b11dd08a60>]}
[0m08:59:07.762697 [error] [Thread-1  ]: 1 of 2 ERROR creating sql table model `clean`.`mpg_standardized` ............... [[31mERROR[0m in 0.13s]
[0m08:59:07.764061 [debug] [Thread-1  ]: Finished running node model.ex_01_mpg.mpg_standardized
[0m08:59:07.765505 [debug] [Thread-3  ]: Began running node model.ex_01_mpg.cylinders_by_origin
[0m08:59:07.766444 [info ] [Thread-3  ]: 2 of 2 SKIP relation mart.cylinders_by_origin .................................. [[33mSKIP[0m]
[0m08:59:07.767561 [debug] [Thread-3  ]: Finished running node model.ex_01_mpg.cylinders_by_origin
[0m08:59:07.769371 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:59:07.769938 [debug] [MainThread]: Connection 'model.ex_01_mpg.mpg_standardized' was left open.
[0m08:59:07.770482 [debug] [MainThread]: On model.ex_01_mpg.mpg_standardized: Close
[0m08:59:07.770963 [debug] [MainThread]: Connection 'list__clean' was left open.
[0m08:59:07.771459 [debug] [MainThread]: On list__clean: Close
[0m08:59:07.772219 [info ] [MainThread]: 
[0m08:59:07.772890 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.66 seconds (0.66s).
[0m08:59:07.774695 [debug] [MainThread]: Command end result
[0m08:59:07.831010 [info ] [MainThread]: 
[0m08:59:07.831903 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:59:07.832511 [info ] [MainThread]: 
[0m08:59:07.833345 [error] [MainThread]:   Database Error in model mpg_standardized (models/clean/mpg_standardized.sql)
  HTTPDriver for http://clickhouse:8123 received ClickHouse error code 43
   Code: 43. DB::Exception: Illegal type Float64 of first argument of function toFloat64OrNull. Conversion functions with postfix 'OrZero' or 'OrNull' should take String argument: While processing ((toFloat64OrNull(horsepower) AS horsepower) IS NOT NULL) AND isFinite(horsepower). (ILLEGAL_TYPE_OF_ARGUMENT) (version 23.12.6.19 (official build))
[0m08:59:07.833993 [info ] [MainThread]: 
[0m08:59:07.834654 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m08:59:07.835984 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 2.4412987, "process_in_blocks": "1312", "process_kernel_time": 0.6246, "process_mem_max_rss": "114792", "process_out_blocks": "10464", "process_user_time": 5.439524}
[0m08:59:07.836737 [debug] [MainThread]: Command `dbt build` failed at 08:59:07.836546 after 2.44 seconds
[0m08:59:07.837440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b11e95e310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b11df033a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b1197dd880>]}
[0m08:59:07.838042 [debug] [MainThread]: Flushing usage events
[0m09:01:13.861465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7995403a2310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79953d007ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79953d007970>]}


============================== 09:01:13.872084 | f172287e-ea25-473d-ba6c-f198561d176c ==============================
[0m09:01:13.872084 [info ] [MainThread]: Running with dbt=1.8.9
[0m09:01:13.873418 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'log_cache_events': 'False', 'write_json': 'True', 'log_path': '/workdir/transforms/01_mpg/logs', 'partial_parse': 'True', 'printer_width': '80', 'fail_fast': 'False', 'profiles_dir': '.', 'static_parser': 'True', 'use_colors': 'True', 'no_print': 'None', 'invocation_command': 'dbt build --profiles-dir . --target local', 'warn_error': 'None', 'quiet': 'False', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'log_format': 'default', 'use_experimental_parser': 'False', 'debug': 'False', 'target_path': 'None'}
[0m09:01:14.170591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f172287e-ea25-473d-ba6c-f198561d176c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79953ce88370>]}
[0m09:01:14.266614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f172287e-ea25-473d-ba6c-f198561d176c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7995405bd040>]}
[0m09:01:14.267946 [info ] [MainThread]: Registered adapter: clickhouse=1.8.6
[0m09:01:14.457161 [debug] [MainThread]: checksum: 134c0f7b96382cc6938697739bc32fb1adc530b177e30f60cebddf61dbd7e979, vars: {}, profile: , target: local, version: 1.8.9
[0m09:01:14.679284 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:01:14.680318 [debug] [MainThread]: Partial parsing: updated file: ex_01_mpg://models/clean/mpg_standardized.sql
[0m09:01:14.969311 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.ex_01_mpg.mpg_standardized' (models/clean/mpg_standardized.sql) depends on a source named 'raw.autompg___cars_myk' which was not found
[0m09:01:14.971052 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 1.204959, "process_in_blocks": "0", "process_kernel_time": 0.584628, "process_mem_max_rss": "100172", "process_out_blocks": "6608", "process_user_time": 4.45417}
[0m09:01:14.972046 [debug] [MainThread]: Command `dbt build` failed at 09:01:14.971788 after 1.21 seconds
[0m09:01:14.972878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7995403a2310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7995402f8ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79953cd18d00>]}
[0m09:01:14.973745 [debug] [MainThread]: Flushing usage events
[0m09:01:36.543301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79675dc6b310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79675a8c8b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79675a8c89d0>]}


============================== 09:01:36.552913 | 55a2c5e9-ce69-48c8-9fad-6f40f3858d9d ==============================
[0m09:01:36.552913 [info ] [MainThread]: Running with dbt=1.8.9
[0m09:01:36.554092 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt build --profiles-dir . --target local', 'static_parser': 'True', 'log_format': 'default', 'write_json': 'True', 'no_print': 'None', 'use_experimental_parser': 'False', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'log_cache_events': 'False', 'empty': 'False', 'version_check': 'True', 'indirect_selection': 'eager', 'log_path': '/workdir/transforms/01_mpg/logs', 'profiles_dir': '.', 'partial_parse': 'True', 'cache_selected_only': 'False', 'debug': 'False', 'fail_fast': 'False', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'quiet': 'False', 'use_colors': 'True'}
[0m09:01:36.876136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '55a2c5e9-ce69-48c8-9fad-6f40f3858d9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79675a7e3910>]}
[0m09:01:36.995005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '55a2c5e9-ce69-48c8-9fad-6f40f3858d9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79675a8047f0>]}
[0m09:01:36.996464 [info ] [MainThread]: Registered adapter: clickhouse=1.8.6
[0m09:01:37.203157 [debug] [MainThread]: checksum: 134c0f7b96382cc6938697739bc32fb1adc530b177e30f60cebddf61dbd7e979, vars: {}, profile: , target: local, version: 1.8.9
[0m09:01:37.434584 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m09:01:37.435922 [debug] [MainThread]: Partial parsing: updated file: ex_01_mpg://models/sources.yml
[0m09:01:37.436618 [debug] [MainThread]: Partial parsing: updated file: ex_01_mpg://models/clean/mpg_standardized.sql
[0m09:01:38.055342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '55a2c5e9-ce69-48c8-9fad-6f40f3858d9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x796758b93ee0>]}
[0m09:01:38.294498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '55a2c5e9-ce69-48c8-9fad-6f40f3858d9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x796758aecd00>]}
[0m09:01:38.295416 [info ] [MainThread]: Found 2 models, 1 source, 471 macros
[0m09:01:38.298103 [info ] [MainThread]: 
[0m09:01:38.299281 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m09:01:38.310945 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m09:01:38.311968 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m09:01:38.330941 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:01:38.335832 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:01:38.792361 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m09:01:38.805255 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m09:01:38.807527 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m09:01:38.820559 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m09:01:38.857955 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__mart)
[0m09:01:38.859964 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__clean)
[0m09:01:38.899981 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__mart: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list__mart"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'mart'
      

  ...
[0m09:01:38.901760 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list__clean"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'clean'
      

  ...
[0m09:01:38.916032 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m09:01:38.927053 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m09:01:38.955656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55a2c5e9-ce69-48c8-9fad-6f40f3858d9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7967586b8ee0>]}
[0m09:01:38.957429 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m09:01:38.958615 [info ] [MainThread]: 
[0m09:01:38.988903 [debug] [Thread-1  ]: Began running node model.ex_01_mpg.mpg_standardized
[0m09:01:38.996395 [info ] [Thread-1  ]: 1 of 2 START sql table model `clean`.`mpg_standardized` ........................ [RUN]
[0m09:01:38.998558 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list__mart, now model.ex_01_mpg.mpg_standardized)
[0m09:01:39.000212 [debug] [Thread-1  ]: Began compiling node model.ex_01_mpg.mpg_standardized
[0m09:01:39.032694 [debug] [Thread-1  ]: Writing injected SQL for node "model.ex_01_mpg.mpg_standardized"
[0m09:01:39.035242 [debug] [Thread-1  ]: Began executing node model.ex_01_mpg.mpg_standardized
[0m09:01:39.208935 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.mpg_standardized"} */

            

    
        create table `clean`.`mpg_standardized__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

-- Source columns are already Nullable with correct types.
-- Keep them as-is to preserve nullability and avoid insert errors.

select
  toFloat64(mpg)          as mpg,
  toInt32OrNull(cylinders)      as cylinders,
  toFloat64OrNull(displacement) as displacement,
  toFloat64OrNull(horsepower)   as horsepower,
  toInt32OrNull(weight)         as weight,
  toFloat64OrNull(acceleration) as acceleration,
  toInt32OrNull(model_year)     as model_year,
  trim(origin)                  as origin,
  trim(name)                    as make
from `raw`.`autompg___cars_myk`
where horsepower is not null
  and isFinite(horsepower)
          )
        
        ...
[0m09:01:39.227582 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m09:01:39.244984 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.mpg_standardized"} */

    select name, type from system.columns where table = 'mpg_standardized__dbt_backup'
    
      and database = 'clean'
    
    order by position
  ...
[0m09:01:39.250811 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:01:39.257556 [debug] [Thread-1  ]: Writing runtime sql for node "model.ex_01_mpg.mpg_standardized"
[0m09:01:39.259003 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.mpg_standardized"} */

  
    
    
    
        
         


        insert into `clean`.`mpg_standardized__dbt_backup`
        ("mpg", "cylinders", "displacement", "horsepower", "weight", "acceleration", "model_year", "origin", "make")

-- Source columns are already Nullable with correct types.
-- Keep them as-is to preserve nullability and avoid insert errors.

select
  toFloat64(mpg)          as mpg,
  toInt32OrNull(cylinders)      as cylinders,
  toFloat64OrNull(displacement) as displacement,
  toFloat64OrNull(horsepower)   as horsepower,
  toInt32OrNull(weight)         as weight,
  toFloat64OrNull(acceleration) as acceleration,
  toInt32OrNull(model_year)     as model_year,
  trim(origin)                  as origin,
  trim(name)                    as make
from `raw`.`autompg___cars_myk`
where horsepower is not null
  and isFinite(horsepower)
  ...
[0m09:01:39.266512 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m09:01:39.275312 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.mpg_standardized"} */
EXCHANGE TABLES `clean`.`mpg_standardized__dbt_backup` AND `clean`.`mpg_standardized` 
  
  ...
[0m09:01:39.278511 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:01:39.325346 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.mpg_standardized"} */

    drop table if exists `clean`.`mpg_standardized__dbt_backup` 
  ...
[0m09:01:39.328632 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:01:39.334793 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55a2c5e9-ce69-48c8-9fad-6f40f3858d9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7967586b8ee0>]}
[0m09:01:39.336044 [info ] [Thread-1  ]: 1 of 2 OK created sql table model `clean`.`mpg_standardized` ................... [[32mOK[0m in 0.34s]
[0m09:01:39.337517 [debug] [Thread-1  ]: Finished running node model.ex_01_mpg.mpg_standardized
[0m09:01:39.339028 [debug] [Thread-3  ]: Began running node model.ex_01_mpg.cylinders_by_origin
[0m09:01:39.339995 [info ] [Thread-3  ]: 2 of 2 START sql view model `mart`.`cylinders_by_origin` ....................... [RUN]
[0m09:01:39.341048 [debug] [Thread-3  ]: Acquiring new clickhouse connection 'model.ex_01_mpg.cylinders_by_origin'
[0m09:01:39.341824 [debug] [Thread-3  ]: Began compiling node model.ex_01_mpg.cylinders_by_origin
[0m09:01:39.349082 [debug] [Thread-3  ]: Writing injected SQL for node "model.ex_01_mpg.cylinders_by_origin"
[0m09:01:39.350299 [debug] [Thread-3  ]: Began executing node model.ex_01_mpg.cylinders_by_origin
[0m09:01:39.399100 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m09:01:39.457401 [debug] [Thread-3  ]: Writing runtime sql for node "model.ex_01_mpg.cylinders_by_origin"
[0m09:01:39.459271 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */


  create view `mart`.`cylinders_by_origin__dbt_tmp` 
  
    
    
  as (
    

select
  origin,
  avg(cylinders) as avg_cylinders,
  count()        as n
from `clean`.`mpg_standardized`
group by origin
    
  )
      
      
                    -- end_of_sql
                    
                    ...
[0m09:01:39.468328 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m09:01:39.482811 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */

    drop table if exists `mart`.`cylinders_by_origin__dbt_backup` 
  
  ...
[0m09:01:39.486043 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:01:39.488217 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */

    rename table `mart`.`cylinders_by_origin` to `mart`.`cylinders_by_origin__dbt_backup` 
  
  ...
[0m09:01:39.491566 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:01:39.498329 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */

    drop table if exists `mart`.`cylinders_by_origin` 
  
  ...
[0m09:01:39.501711 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:01:39.504489 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */

    rename table `mart`.`cylinders_by_origin__dbt_tmp` to `mart`.`cylinders_by_origin` 
  
  ...
[0m09:01:39.508857 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:01:39.520151 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */

    drop table if exists `mart`.`cylinders_by_origin__dbt_backup` 
  ...
[0m09:01:39.524543 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:01:39.528822 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55a2c5e9-ce69-48c8-9fad-6f40f3858d9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79675baf0d90>]}
[0m09:01:39.530125 [info ] [Thread-3  ]: 2 of 2 OK created sql view model `mart`.`cylinders_by_origin` .................. [[32mOK[0m in 0.19s]
[0m09:01:39.531814 [debug] [Thread-3  ]: Finished running node model.ex_01_mpg.cylinders_by_origin
[0m09:01:39.534862 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:01:39.535940 [debug] [MainThread]: Connection 'model.ex_01_mpg.mpg_standardized' was left open.
[0m09:01:39.537393 [debug] [MainThread]: On model.ex_01_mpg.mpg_standardized: Close
[0m09:01:39.538641 [debug] [MainThread]: Connection 'list__clean' was left open.
[0m09:01:39.539637 [debug] [MainThread]: On list__clean: Close
[0m09:01:39.540501 [debug] [MainThread]: Connection 'model.ex_01_mpg.cylinders_by_origin' was left open.
[0m09:01:39.541334 [debug] [MainThread]: On model.ex_01_mpg.cylinders_by_origin: Close
[0m09:01:39.542910 [info ] [MainThread]: 
[0m09:01:39.544203 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 1.24 seconds (1.24s).
[0m09:01:39.547513 [debug] [MainThread]: Command end result
[0m09:01:39.602667 [info ] [MainThread]: 
[0m09:01:39.603622 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:01:39.604401 [info ] [MainThread]: 
[0m09:01:39.605085 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m09:01:39.606492 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 3.157528, "process_in_blocks": "0", "process_kernel_time": 0.63216, "process_mem_max_rss": "114568", "process_out_blocks": "10480", "process_user_time": 5.944509}
[0m09:01:39.607282 [debug] [MainThread]: Command `dbt build` succeeded at 09:01:39.607069 after 3.16 seconds
[0m09:01:39.607928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79675dc6b310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x796758723b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7967586d6c40>]}
[0m09:01:39.608564 [debug] [MainThread]: Flushing usage events
[0m09:02:23.348304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a2129716310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a2126370b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a2126370a30>]}


============================== 09:02:23.380204 | 80e31955-dd32-4da3-a210-714226038671 ==============================
[0m09:02:23.380204 [info ] [MainThread]: Running with dbt=1.8.9
[0m09:02:23.381544 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'introspect': 'True', 'use_colors': 'True', 'no_print': 'None', 'write_json': 'True', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'use_experimental_parser': 'False', 'empty': 'False', 'log_path': '/workdir/transforms/01_mpg/logs', 'printer_width': '80', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'indirect_selection': 'eager', 'warn_error': 'None', 'invocation_command': 'dbt build --profiles-dir . --target local', 'quiet': 'False', 'log_cache_events': 'False', 'version_check': 'True', 'partial_parse': 'True', 'profiles_dir': '.', 'target_path': 'None'}
[0m09:02:23.690223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '80e31955-dd32-4da3-a210-714226038671', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a2128cb4ca0>]}
[0m09:02:23.788105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '80e31955-dd32-4da3-a210-714226038671', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a212646a9d0>]}
[0m09:02:23.789474 [info ] [MainThread]: Registered adapter: clickhouse=1.8.6
[0m09:02:23.962097 [debug] [MainThread]: checksum: 134c0f7b96382cc6938697739bc32fb1adc530b177e30f60cebddf61dbd7e979, vars: {}, profile: , target: local, version: 1.8.9
[0m09:02:24.191862 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:02:24.192876 [debug] [MainThread]: Partial parsing: updated file: ex_01_mpg://models/clean/mpg_standardized.sql
[0m09:02:24.638997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '80e31955-dd32-4da3-a210-714226038671', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a212491e130>]}
[0m09:02:24.862301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '80e31955-dd32-4da3-a210-714226038671', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a21247d8130>]}
[0m09:02:24.863156 [info ] [MainThread]: Found 2 models, 1 source, 471 macros
[0m09:02:24.866082 [info ] [MainThread]: 
[0m09:02:24.867225 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m09:02:24.879049 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m09:02:24.880092 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m09:02:24.905571 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:02:24.915585 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:02:25.182764 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m09:02:25.187727 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:02:25.189770 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m09:02:25.193459 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:02:25.284654 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__mart)
[0m09:02:25.285949 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__clean)
[0m09:02:25.311090 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__mart: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list__mart"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'mart'
      

  ...
[0m09:02:25.313485 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list__clean"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'clean'
      

  ...
[0m09:02:25.320384 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m09:02:25.329531 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m09:02:25.338149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80e31955-dd32-4da3-a210-714226038671', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a212432cb50>]}
[0m09:02:25.339177 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m09:02:25.339886 [info ] [MainThread]: 
[0m09:02:25.353413 [debug] [Thread-1  ]: Began running node model.ex_01_mpg.mpg_standardized
[0m09:02:25.354542 [info ] [Thread-1  ]: 1 of 2 START sql table model `clean`.`mpg_standardized` ........................ [RUN]
[0m09:02:25.355454 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list__mart, now model.ex_01_mpg.mpg_standardized)
[0m09:02:25.356158 [debug] [Thread-1  ]: Began compiling node model.ex_01_mpg.mpg_standardized
[0m09:02:25.372634 [debug] [Thread-1  ]: Writing injected SQL for node "model.ex_01_mpg.mpg_standardized"
[0m09:02:25.373928 [debug] [Thread-1  ]: Began executing node model.ex_01_mpg.mpg_standardized
[0m09:02:25.471804 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.mpg_standardized"} */

            

    
        create table `clean`.`mpg_standardized__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

-- Source columns are already Nullable with correct types.
-- Keep them as-is to preserve nullability and avoid insert errors.

select
  toFloat64(mpg)          as mpg,
  toInt32(cylinders)      as cylinders,
  toFloat64(displacement) as displacement,
  toFloat64OrNull(horsepower)   as horsepower,
  toInt32(weight)         as weight,
  toFloat64(acceleration) as acceleration,
  toInt32(model_year)     as model_year,
  trim(origin)                  as origin,
  trim(name)                    as make
from `raw`.`autompg___cars_myk`
where horsepower is not null
  and isFinite(horsepower)
          )
        
        ...
[0m09:02:25.489515 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m09:02:25.511547 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.mpg_standardized"} */

    select name, type from system.columns where table = 'mpg_standardized__dbt_backup'
    
      and database = 'clean'
    
    order by position
  ...
[0m09:02:25.517059 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:02:25.523870 [debug] [Thread-1  ]: Writing runtime sql for node "model.ex_01_mpg.mpg_standardized"
[0m09:02:25.525262 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.mpg_standardized"} */

  
    
    
    
        
         


        insert into `clean`.`mpg_standardized__dbt_backup`
        ("mpg", "cylinders", "displacement", "horsepower", "weight", "acceleration", "model_year", "origin", "make")

-- Source columns are already Nullable with correct types.
-- Keep them as-is to preserve nullability and avoid insert errors.

select
  toFloat64(mpg)          as mpg,
  toInt32(cylinders)      as cylinders,
  toFloat64(displacement) as displacement,
  toFloat64OrNull(horsepower)   as horsepower,
  toInt32(weight)         as weight,
  toFloat64(acceleration) as acceleration,
  toInt32(model_year)     as model_year,
  trim(origin)                  as origin,
  trim(name)                    as make
from `raw`.`autompg___cars_myk`
where horsepower is not null
  and isFinite(horsepower)
  ...
[0m09:02:25.532625 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m09:02:25.541927 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.mpg_standardized"} */
EXCHANGE TABLES `clean`.`mpg_standardized__dbt_backup` AND `clean`.`mpg_standardized` 
  
  ...
[0m09:02:25.545183 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:02:25.596051 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.mpg_standardized"} */

    drop table if exists `clean`.`mpg_standardized__dbt_backup` 
  ...
[0m09:02:25.599479 [debug] [Thread-1  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:02:25.605947 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80e31955-dd32-4da3-a210-714226038671', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a2123c23580>]}
[0m09:02:25.607250 [info ] [Thread-1  ]: 1 of 2 OK created sql table model `clean`.`mpg_standardized` ................... [[32mOK[0m in 0.25s]
[0m09:02:25.608612 [debug] [Thread-1  ]: Finished running node model.ex_01_mpg.mpg_standardized
[0m09:02:25.610123 [debug] [Thread-3  ]: Began running node model.ex_01_mpg.cylinders_by_origin
[0m09:02:25.611124 [info ] [Thread-3  ]: 2 of 2 START sql view model `mart`.`cylinders_by_origin` ....................... [RUN]
[0m09:02:25.612224 [debug] [Thread-3  ]: Acquiring new clickhouse connection 'model.ex_01_mpg.cylinders_by_origin'
[0m09:02:25.613035 [debug] [Thread-3  ]: Began compiling node model.ex_01_mpg.cylinders_by_origin
[0m09:02:25.618940 [debug] [Thread-3  ]: Writing injected SQL for node "model.ex_01_mpg.cylinders_by_origin"
[0m09:02:25.620161 [debug] [Thread-3  ]: Began executing node model.ex_01_mpg.cylinders_by_origin
[0m09:02:25.671219 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m09:02:25.726005 [debug] [Thread-3  ]: Writing runtime sql for node "model.ex_01_mpg.cylinders_by_origin"
[0m09:02:25.727327 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */


  create view `mart`.`cylinders_by_origin__dbt_tmp` 
  
    
    
  as (
    

select
  origin,
  avg(cylinders) as avg_cylinders,
  count()        as n
from `clean`.`mpg_standardized`
group by origin
    
  )
      
      
                    -- end_of_sql
                    
                    ...
[0m09:02:25.736063 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m09:02:25.748872 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */

    drop table if exists `mart`.`cylinders_by_origin__dbt_backup` 
  
  ...
[0m09:02:25.751800 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:02:25.753826 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */

    rename table `mart`.`cylinders_by_origin` to `mart`.`cylinders_by_origin__dbt_backup` 
  
  ...
[0m09:02:25.756572 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:02:25.762664 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */

    drop table if exists `mart`.`cylinders_by_origin` 
  
  ...
[0m09:02:25.765573 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:02:25.767620 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */

    rename table `mart`.`cylinders_by_origin__dbt_tmp` to `mart`.`cylinders_by_origin` 
  
  ...
[0m09:02:25.770688 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:02:25.777368 [debug] [Thread-3  ]: dbt_clickhouse adapter: On model.ex_01_mpg.cylinders_by_origin: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.cylinders_by_origin"} */

    drop table if exists `mart`.`cylinders_by_origin__dbt_backup` 
  ...
[0m09:02:25.780357 [debug] [Thread-3  ]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:02:25.782948 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80e31955-dd32-4da3-a210-714226038671', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a21242ab4c0>]}
[0m09:02:25.784085 [info ] [Thread-3  ]: 2 of 2 OK created sql view model `mart`.`cylinders_by_origin` .................. [[32mOK[0m in 0.17s]
[0m09:02:25.785554 [debug] [Thread-3  ]: Finished running node model.ex_01_mpg.cylinders_by_origin
[0m09:02:25.787485 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:02:25.788057 [debug] [MainThread]: Connection 'model.ex_01_mpg.mpg_standardized' was left open.
[0m09:02:25.788627 [debug] [MainThread]: On model.ex_01_mpg.mpg_standardized: Close
[0m09:02:25.789137 [debug] [MainThread]: Connection 'list__clean' was left open.
[0m09:02:25.789669 [debug] [MainThread]: On list__clean: Close
[0m09:02:25.790163 [debug] [MainThread]: Connection 'model.ex_01_mpg.cylinders_by_origin' was left open.
[0m09:02:25.790699 [debug] [MainThread]: On model.ex_01_mpg.cylinders_by_origin: Close
[0m09:02:25.791537 [info ] [MainThread]: 
[0m09:02:25.792240 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.92 seconds (0.92s).
[0m09:02:25.793953 [debug] [MainThread]: Command end result
[0m09:02:25.848558 [info ] [MainThread]: 
[0m09:02:25.849475 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:02:25.850085 [info ] [MainThread]: 
[0m09:02:25.850773 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m09:02:25.852500 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 2.6108758, "process_in_blocks": "1432", "process_kernel_time": 0.643114, "process_mem_max_rss": "114156", "process_out_blocks": "10488", "process_user_time": 5.648002}
[0m09:02:25.853280 [debug] [MainThread]: Command `dbt build` succeeded at 09:02:25.853065 after 2.61 seconds
[0m09:02:25.853904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a2129716310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a212762a190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a212763b220>]}
[0m09:02:25.854532 [debug] [MainThread]: Flushing usage events
[0m20:21:17.907161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b8561e7310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b852e33c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b852e33af0>]}


============================== 20:21:17.916725 | e621214e-f57c-47d5-b42a-a742e62049b2 ==============================
[0m20:21:17.916725 [info ] [MainThread]: Running with dbt=1.8.9
[0m20:21:17.917822 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt docs serve --profiles-dir . --target local --host 0.0.0.0 --port 8080', 'debug': 'False', 'profiles_dir': '.', 'use_experimental_parser': 'False', 'warn_error': 'None', 'introspect': 'True', 'use_colors': 'True', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_cache_events': 'False', 'log_format': 'default', 'cache_selected_only': 'False', 'version_check': 'True', 'write_json': 'True', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'partial_parse': 'True', 'indirect_selection': 'eager', 'target_path': 'None', 'log_path': '/workdir/transforms/01_mpg/logs'}
[0m20:21:18.246477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e621214e-f57c-47d5-b42a-a742e62049b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b85577a3a0>]}
[0m20:21:18.356954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e621214e-f57c-47d5-b42a-a742e62049b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b852d1bbe0>]}
[0m20:21:43.222146 [error] [MainThread]: Encountered an error:

[0m20:21:43.514805 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/lib/python3.9/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt/cli/main.py", line 303, in docs_serve
    results = task.run()
  File "/usr/local/lib/python3.9/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/usr/local/lib/python3.9/socketserver.py", line 232, in serve_forever
    ready = selector.select(poll_interval)
  File "/usr/local/lib/python3.9/selectors.py", line 416, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt

[0m20:21:43.516621 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 25.725277, "process_in_blocks": "4352", "process_kernel_time": 0.51611, "process_mem_max_rss": "95272", "process_out_blocks": "9744", "process_user_time": 3.899282}
[0m20:21:43.517840 [debug] [MainThread]: Command `dbt docs serve` failed at 20:21:43.517564 after 25.73 seconds
[0m20:21:43.518689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b8561e7310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b852adf280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b85292f790>]}
[0m20:21:43.519481 [debug] [MainThread]: Flushing usage events
[0m20:21:57.990967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77773d8aa310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77773a5043a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77773a504430>]}


============================== 20:21:58.000683 | 1ee5117f-5552-48f0-a3f3-77005b76e8f3 ==============================
[0m20:21:58.000683 [info ] [MainThread]: Running with dbt=1.8.9
[0m20:21:58.001959 [debug] [MainThread]: running dbt with arguments {'profiles_dir': 'transforms/01_mpg', 'invocation_command': 'dbt docs serve --project-dir transforms/01_mpg --profiles-dir transforms/01_mpg --target local --host 0.0.0.0 --port 8080', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'version_check': 'True', 'fail_fast': 'False', 'cache_selected_only': 'False', 'log_path': 'transforms/01_mpg/logs', 'target_path': 'None', 'debug': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'static_parser': 'True', 'introspect': 'True', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'use_colors': 'True', 'log_format': 'default', 'write_json': 'True', 'no_print': 'None', 'log_cache_events': 'False'}
[0m20:21:58.293756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1ee5117f-5552-48f0-a3f3-77005b76e8f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77773ce45fd0>]}
[0m20:21:58.392270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1ee5117f-5552-48f0-a3f3-77005b76e8f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77773a4b9af0>]}
[0m20:22:25.352193 [error] [MainThread]: Encountered an error:

[0m20:22:25.355195 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/lib/python3.9/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt/cli/main.py", line 303, in docs_serve
    results = task.run()
  File "/usr/local/lib/python3.9/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/usr/local/lib/python3.9/socketserver.py", line 237, in serve_forever
    self._handle_request_noblock()
  File "/usr/local/lib/python3.9/socketserver.py", line 316, in _handle_request_noblock
    self.process_request(request, client_address)
  File "/usr/local/lib/python3.9/socketserver.py", line 347, in process_request
    self.finish_request(request, client_address)
  File "/usr/local/lib/python3.9/socketserver.py", line 360, in finish_request
    self.RequestHandlerClass(request, client_address, self)
  File "/usr/local/lib/python3.9/http/server.py", line 668, in __init__
    super().__init__(*args, **kwargs)
  File "/usr/local/lib/python3.9/socketserver.py", line 747, in __init__
    self.handle()
  File "/usr/local/lib/python3.9/http/server.py", line 433, in handle
    self.handle_one_request()
  File "/usr/local/lib/python3.9/http/server.py", line 401, in handle_one_request
    self.raw_requestline = self.rfile.readline(65537)
  File "/usr/local/lib/python3.9/socket.py", line 716, in readinto
    return self._sock.recv_into(b)
KeyboardInterrupt

[0m20:22:25.356931 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 27.46037, "process_in_blocks": "0", "process_kernel_time": 0.504336, "process_mem_max_rss": "95324", "process_out_blocks": "9744", "process_user_time": 3.965507}
[0m20:22:25.357975 [debug] [MainThread]: Command `dbt docs serve` failed at 20:22:25.357714 after 27.46 seconds
[0m20:22:25.358886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77773d8aa310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77773a3570a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77773a357550>]}
[0m20:22:25.359737 [debug] [MainThread]: Flushing usage events
[0m20:23:21.798418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2881516310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e287e1814c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e287e181610>]}


============================== 20:23:21.808002 | 973c8a65-3c6f-41d9-a569-067a4f152a1d ==============================
[0m20:23:21.808002 [info ] [MainThread]: Running with dbt=1.8.9
[0m20:23:21.809167 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'version_check': 'True', 'empty': 'None', 'log_path': '/workdir/transforms/01_mpg/logs', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'static_parser': 'True', 'debug': 'False', 'partial_parse': 'True', 'warn_error': 'None', 'write_json': 'True', 'log_format': 'default', 'use_colors': 'True', 'printer_width': '80', 'invocation_command': 'dbt docs generate --profiles-dir . --target local', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'profiles_dir': '.', 'fail_fast': 'False', 'introspect': 'True', 'target_path': 'None', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])'}
[0m20:23:22.114468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '973c8a65-3c6f-41d9-a569-067a4f152a1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e287e150be0>]}
[0m20:23:22.209141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '973c8a65-3c6f-41d9-a569-067a4f152a1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e287e0780d0>]}
[0m20:23:22.210914 [info ] [MainThread]: Registered adapter: clickhouse=1.8.6
[0m20:23:22.392796 [debug] [MainThread]: checksum: 134c0f7b96382cc6938697739bc32fb1adc530b177e30f60cebddf61dbd7e979, vars: {}, profile: , target: local, version: 1.8.9
[0m20:23:22.777651 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m20:23:22.779937 [debug] [MainThread]: Partial parsing: updated file: ex_01_mpg://models/sources.yml
[0m20:23:22.781395 [debug] [MainThread]: Partial parsing: updated file: ex_01_mpg://models/clean/mpg_standardized.sql
[0m20:23:23.484286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '973c8a65-3c6f-41d9-a569-067a4f152a1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e287c440130>]}
[0m20:23:23.519650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '973c8a65-3c6f-41d9-a569-067a4f152a1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e287c4b4a00>]}
[0m20:23:23.520535 [info ] [MainThread]: Found 2 models, 1 source, 471 macros
[0m20:23:23.521250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '973c8a65-3c6f-41d9-a569-067a4f152a1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e287c4b4ac0>]}
[0m20:23:23.524708 [info ] [MainThread]: 
[0m20:23:23.526357 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m20:23:23.528148 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list__clean'
[0m20:23:23.529073 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list__mart'
[0m20:23:23.556669 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:23:23.565813 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:23:23.885228 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list__clean"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'clean'
      

  ...
[0m20:23:23.889776 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__mart: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list__mart"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'mart'
      

  ...
[0m20:23:23.892553 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m20:23:23.899097 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m20:23:24.015405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '973c8a65-3c6f-41d9-a569-067a4f152a1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e287c5609a0>]}
[0m20:23:24.016393 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m20:23:24.017049 [info ] [MainThread]: 
[0m20:23:24.031980 [debug] [Thread-1  ]: Began running node model.ex_01_mpg.mpg_standardized
[0m20:23:24.033213 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list__clean, now model.ex_01_mpg.mpg_standardized)
[0m20:23:24.034090 [debug] [Thread-1  ]: Began compiling node model.ex_01_mpg.mpg_standardized
[0m20:23:24.051646 [debug] [Thread-1  ]: Writing injected SQL for node "model.ex_01_mpg.mpg_standardized"
[0m20:23:24.052920 [debug] [Thread-1  ]: Began executing node model.ex_01_mpg.mpg_standardized
[0m20:23:24.054502 [debug] [Thread-1  ]: Finished running node model.ex_01_mpg.mpg_standardized
[0m20:23:24.056067 [debug] [Thread-3  ]: Began running node model.ex_01_mpg.cylinders_by_origin
[0m20:23:24.057093 [debug] [Thread-3  ]: Acquiring new clickhouse connection 'model.ex_01_mpg.cylinders_by_origin'
[0m20:23:24.057870 [debug] [Thread-3  ]: Began compiling node model.ex_01_mpg.cylinders_by_origin
[0m20:23:24.063516 [debug] [Thread-3  ]: Writing injected SQL for node "model.ex_01_mpg.cylinders_by_origin"
[0m20:23:24.064800 [debug] [Thread-3  ]: Began executing node model.ex_01_mpg.cylinders_by_origin
[0m20:23:24.066580 [debug] [Thread-3  ]: Finished running node model.ex_01_mpg.cylinders_by_origin
[0m20:23:24.068316 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:23:24.068861 [debug] [MainThread]: Connection 'model.ex_01_mpg.mpg_standardized' was left open.
[0m20:23:24.069410 [debug] [MainThread]: On model.ex_01_mpg.mpg_standardized: Close
[0m20:23:24.069899 [debug] [MainThread]: Connection 'list__mart' was left open.
[0m20:23:24.070408 [debug] [MainThread]: On list__mart: Close
[0m20:23:24.070867 [debug] [MainThread]: Connection 'model.ex_01_mpg.cylinders_by_origin' was properly closed.
[0m20:23:24.072609 [debug] [MainThread]: Command end result
[0m20:23:24.247081 [debug] [MainThread]: Acquiring new clickhouse connection 'generate_catalog'
[0m20:23:24.247719 [info ] [MainThread]: Building catalog
[0m20:23:24.260419 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:23:24.323403 [debug] [MainThread]: dbt_clickhouse adapter: On generate_catalog: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "generate_catalog"} */
select
      '' as table_database,
      columns.database as table_schema,
      columns.table as table_name,
      if(tables.engine not in ('MaterializedView', 'View'), 'table', 'view') as table_type,
      nullIf(tables.comment, '') as table_comment,
      columns.name as column_name,
      columns.position as column_index,
      columns.type as column_type,
      nullIf(columns.comment, '') as column_comment,
      null as table_owner
    from system.columns as columns
    join system.tables as tables on tables.database = columns.database and tables.name = columns.table
    where database != 'system' and
    (columns.database = 'clean' or columns.database = 'mart' or columns.database = 'raw')
    order by columns.database, columns.table, columns.position...
[0m20:23:24.342667 [debug] [MainThread]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m20:23:24.472695 [info ] [MainThread]: Catalog written to /workdir/transforms/01_mpg/target/catalog.json
[0m20:23:24.474275 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 2.7696035, "process_in_blocks": "6480", "process_kernel_time": 0.697906, "process_mem_max_rss": "113788", "process_out_blocks": "13416", "process_user_time": 5.374277}
[0m20:23:24.475167 [debug] [MainThread]: Command `dbt docs generate` succeeded at 20:23:24.474960 after 2.77 seconds
[0m20:23:24.475757 [debug] [MainThread]: Connection 'generate_catalog' was left open.
[0m20:23:24.476312 [debug] [MainThread]: On generate_catalog: Close
[0m20:23:24.477141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2881516310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e287c4ae670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e287c554100>]}
[0m20:23:24.477857 [debug] [MainThread]: Flushing usage events
[0m20:23:34.445010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa53e308310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa53af48cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa53af48b80>]}


============================== 20:23:34.455329 | 4a688cef-2a7f-4f10-af56-3b19582ce9bd ==============================
[0m20:23:34.455329 [info ] [MainThread]: Running with dbt=1.8.9
[0m20:23:34.456652 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'version_check': 'True', 'invocation_command': 'dbt docs serve --profiles-dir . --target local --host 0.0.0.0 --port 8080', 'profiles_dir': '.', 'target_path': 'None', 'empty': 'None', 'partial_parse': 'True', 'cache_selected_only': 'False', 'introspect': 'True', 'use_experimental_parser': 'False', 'warn_error': 'None', 'use_colors': 'True', 'static_parser': 'True', 'write_json': 'True', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'log_path': '/workdir/transforms/01_mpg/logs', 'quiet': 'False', 'indirect_selection': 'eager'}
[0m20:23:34.776820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4a688cef-2a7f-4f10-af56-3b19582ce9bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa53ae31580>]}
[0m20:23:34.873300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4a688cef-2a7f-4f10-af56-3b19582ce9bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa53b3b6820>]}
[0m20:25:16.488365 [error] [MainThread]: Encountered an error:

[0m20:25:16.492653 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/lib/python3.9/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt/cli/main.py", line 303, in docs_serve
    results = task.run()
  File "/usr/local/lib/python3.9/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/usr/local/lib/python3.9/socketserver.py", line 237, in serve_forever
    self._handle_request_noblock()
  File "/usr/local/lib/python3.9/socketserver.py", line 316, in _handle_request_noblock
    self.process_request(request, client_address)
  File "/usr/local/lib/python3.9/socketserver.py", line 347, in process_request
    self.finish_request(request, client_address)
  File "/usr/local/lib/python3.9/socketserver.py", line 360, in finish_request
    self.RequestHandlerClass(request, client_address, self)
  File "/usr/local/lib/python3.9/http/server.py", line 668, in __init__
    super().__init__(*args, **kwargs)
  File "/usr/local/lib/python3.9/socketserver.py", line 747, in __init__
    self.handle()
  File "/usr/local/lib/python3.9/http/server.py", line 433, in handle
    self.handle_one_request()
  File "/usr/local/lib/python3.9/http/server.py", line 401, in handle_one_request
    self.raw_requestline = self.rfile.readline(65537)
  File "/usr/local/lib/python3.9/socket.py", line 716, in readinto
    return self._sock.recv_into(b)
KeyboardInterrupt

[0m20:25:16.495391 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 102.151886, "process_in_blocks": "0", "process_kernel_time": 0.514146, "process_mem_max_rss": "95024", "process_out_blocks": "9736", "process_user_time": 3.668021}
[0m20:25:16.496905 [debug] [MainThread]: Command `dbt docs serve` failed at 20:25:16.496605 after 102.15 seconds
[0m20:25:16.497813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa53e308310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa53abe2d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa53abe2e20>]}
[0m20:25:16.498656 [debug] [MainThread]: Flushing usage events
[0m20:28:02.344603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5e81472310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5e7e0d3b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5e7e0d3a30>]}


============================== 20:28:02.354145 | 93985561-0b0b-4516-a391-5430bfd95aac ==============================
[0m20:28:02.354145 [info ] [MainThread]: Running with dbt=1.8.9
[0m20:28:02.355338 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'no_print': 'None', 'write_json': 'True', 'version_check': 'True', 'quiet': 'False', 'log_path': '/workdir/transforms/01_mpg/logs', 'log_cache_events': 'False', 'invocation_command': 'dbt docs generate --profiles-dir . --target local --select resource_type:source,resource_type:model', 'partial_parse': 'True', 'warn_error': 'None', 'log_format': 'default', 'profiles_dir': '.', 'debug': 'False', 'empty': 'None', 'target_path': 'None', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'use_colors': 'True', 'introspect': 'True', 'static_parser': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])'}
[0m20:28:02.644676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '93985561-0b0b-4516-a391-5430bfd95aac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5e7e0980a0>]}
[0m20:28:02.741738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '93985561-0b0b-4516-a391-5430bfd95aac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5e7dfc27f0>]}
[0m20:28:02.743128 [info ] [MainThread]: Registered adapter: clickhouse=1.8.6
[0m20:28:02.930482 [debug] [MainThread]: checksum: 134c0f7b96382cc6938697739bc32fb1adc530b177e30f60cebddf61dbd7e979, vars: {}, profile: , target: local, version: 1.8.9
[0m20:28:03.168371 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:28:03.169058 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:28:03.246888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '93985561-0b0b-4516-a391-5430bfd95aac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5e7d959df0>]}
[0m20:28:03.716490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '93985561-0b0b-4516-a391-5430bfd95aac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5e7d8c0e50>]}
[0m20:28:03.717423 [info ] [MainThread]: Found 2 models, 1 source, 471 macros
[0m20:28:03.718276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93985561-0b0b-4516-a391-5430bfd95aac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5e7d8c0d90>]}
[0m20:28:03.719445 [warn ] [MainThread]: The selection criterion 'resource_type:source,resource_type:model' does not match any enabled nodes
[0m20:28:03.721084 [info ] [MainThread]: 
[0m20:28:03.721903 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m20:28:03.725578 [debug] [MainThread]: Command end result
[0m20:28:03.906464 [debug] [MainThread]: Acquiring new clickhouse connection 'generate_catalog'
[0m20:28:03.907142 [info ] [MainThread]: Building catalog
[0m20:28:03.908142 [warn ] [MainThread]: The selection criterion 'resource_type:source,resource_type:model' does not match any enabled nodes
[0m20:28:03.950478 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:28:04.191754 [debug] [MainThread]: dbt_clickhouse adapter: On generate_catalog: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "generate_catalog"} */
select
      '' as table_database,
      columns.database as table_schema,
      columns.table as table_name,
      if(tables.engine not in ('MaterializedView', 'View'), 'table', 'view') as table_type,
      nullIf(tables.comment, '') as table_comment,
      columns.name as column_name,
      columns.position as column_index,
      columns.type as column_type,
      nullIf(columns.comment, '') as column_comment,
      null as table_owner
    from system.columns as columns
    join system.tables as tables on tables.database = columns.database and tables.name = columns.table
    where database != 'system' and
    (columns.database = 'clean' or columns.database = 'mart' or columns.database = 'raw')
    order by columns.database, columns.table, columns.position...
[0m20:28:04.213740 [debug] [MainThread]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m20:28:04.326926 [info ] [MainThread]: Catalog written to /workdir/transforms/01_mpg/target/catalog.json
[0m20:28:04.328691 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 2.0759108, "process_in_blocks": "0", "process_kernel_time": 0.664557, "process_mem_max_rss": "107424", "process_out_blocks": "12360", "process_user_time": 4.72685}
[0m20:28:04.329582 [debug] [MainThread]: Command `dbt docs generate` succeeded at 20:28:04.329353 after 2.08 seconds
[0m20:28:04.330228 [debug] [MainThread]: Connection 'generate_catalog' was left open.
[0m20:28:04.330797 [debug] [MainThread]: On generate_catalog: Close
[0m20:28:04.331431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5e81472310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5e7d92ba30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5e7dfc27f0>]}
[0m20:28:04.332041 [debug] [MainThread]: Flushing usage events
[0m20:28:39.083415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71bedffd9e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71bedcc414f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71bedcc41640>]}


============================== 20:28:39.093181 | b18ac47a-a52b-4577-ac63-08ea990dc13c ==============================
[0m20:28:39.093181 [info ] [MainThread]: Running with dbt=1.8.9
[0m20:28:39.094360 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'debug': 'False', 'target_path': 'None', 'quiet': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'partial_parse': 'True', 'write_json': 'True', 'use_colors': 'True', 'profiles_dir': '.', 'invocation_command': 'dbt docs generate --profiles-dir . --target local', 'empty': 'None', 'indirect_selection': 'eager', 'log_path': '/workdir/transforms/01_mpg/logs', 'printer_width': '80', 'warn_error': 'None', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'static_parser': 'True'}
[0m20:28:39.392346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b18ac47a-a52b-4577-ac63-08ea990dc13c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71bedf476910>]}
[0m20:28:39.505290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b18ac47a-a52b-4577-ac63-08ea990dc13c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71bedcc146d0>]}
[0m20:28:39.506727 [info ] [MainThread]: Registered adapter: clickhouse=1.8.6
[0m20:28:39.679028 [debug] [MainThread]: checksum: 134c0f7b96382cc6938697739bc32fb1adc530b177e30f60cebddf61dbd7e979, vars: {}, profile: , target: local, version: 1.8.9
[0m20:28:39.974224 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:28:39.975402 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:28:40.114130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b18ac47a-a52b-4577-ac63-08ea990dc13c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71bedc447df0>]}
[0m20:28:40.185178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b18ac47a-a52b-4577-ac63-08ea990dc13c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71bedc3f9e50>]}
[0m20:28:40.187111 [info ] [MainThread]: Found 2 models, 1 source, 471 macros
[0m20:28:40.188525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b18ac47a-a52b-4577-ac63-08ea990dc13c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71bedc3f9d90>]}
[0m20:28:40.193070 [info ] [MainThread]: 
[0m20:28:40.195241 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m20:28:40.202074 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list__clean'
[0m20:28:40.220223 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list__mart'
[0m20:28:40.300801 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:28:40.302517 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:28:40.630582 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__mart: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list__mart"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'mart'
      

  ...
[0m20:28:40.636155 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list__clean"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'clean'
      

  ...
[0m20:28:40.637674 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m20:28:40.645346 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m20:28:40.677086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b18ac47a-a52b-4577-ac63-08ea990dc13c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71bedc3f9df0>]}
[0m20:28:40.678170 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m20:28:40.678810 [info ] [MainThread]: 
[0m20:28:40.692354 [debug] [Thread-1  ]: Began running node model.ex_01_mpg.mpg_standardized
[0m20:28:40.693378 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list__mart, now model.ex_01_mpg.mpg_standardized)
[0m20:28:40.694079 [debug] [Thread-1  ]: Began compiling node model.ex_01_mpg.mpg_standardized
[0m20:28:40.711436 [debug] [Thread-1  ]: Writing injected SQL for node "model.ex_01_mpg.mpg_standardized"
[0m20:28:40.712693 [debug] [Thread-1  ]: Began executing node model.ex_01_mpg.mpg_standardized
[0m20:28:40.714147 [debug] [Thread-1  ]: Finished running node model.ex_01_mpg.mpg_standardized
[0m20:28:40.715779 [debug] [Thread-3  ]: Began running node model.ex_01_mpg.cylinders_by_origin
[0m20:28:40.717386 [debug] [Thread-3  ]: Acquiring new clickhouse connection 'model.ex_01_mpg.cylinders_by_origin'
[0m20:28:40.718208 [debug] [Thread-3  ]: Began compiling node model.ex_01_mpg.cylinders_by_origin
[0m20:28:40.724062 [debug] [Thread-3  ]: Writing injected SQL for node "model.ex_01_mpg.cylinders_by_origin"
[0m20:28:40.725301 [debug] [Thread-3  ]: Began executing node model.ex_01_mpg.cylinders_by_origin
[0m20:28:40.726774 [debug] [Thread-3  ]: Finished running node model.ex_01_mpg.cylinders_by_origin
[0m20:28:40.728336 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:28:40.728902 [debug] [MainThread]: Connection 'list__clean' was left open.
[0m20:28:40.729459 [debug] [MainThread]: On list__clean: Close
[0m20:28:40.729933 [debug] [MainThread]: Connection 'model.ex_01_mpg.mpg_standardized' was left open.
[0m20:28:40.730452 [debug] [MainThread]: On model.ex_01_mpg.mpg_standardized: Close
[0m20:28:40.730904 [debug] [MainThread]: Connection 'model.ex_01_mpg.cylinders_by_origin' was properly closed.
[0m20:28:40.732670 [debug] [MainThread]: Command end result
[0m20:28:40.953110 [debug] [MainThread]: Acquiring new clickhouse connection 'generate_catalog'
[0m20:28:40.953996 [info ] [MainThread]: Building catalog
[0m20:28:40.967967 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:28:41.038960 [debug] [MainThread]: dbt_clickhouse adapter: On generate_catalog: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "generate_catalog"} */
select
      '' as table_database,
      columns.database as table_schema,
      columns.table as table_name,
      if(tables.engine not in ('MaterializedView', 'View'), 'table', 'view') as table_type,
      nullIf(tables.comment, '') as table_comment,
      columns.name as column_name,
      columns.position as column_index,
      columns.type as column_type,
      nullIf(columns.comment, '') as column_comment,
      null as table_owner
    from system.columns as columns
    join system.tables as tables on tables.database = columns.database and tables.name = columns.table
    where database != 'system' and
    (columns.database = 'raw' or columns.database = 'mart' or columns.database = 'clean')
    order by columns.database, columns.table, columns.position...
[0m20:28:41.065373 [debug] [MainThread]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m20:28:41.255791 [info ] [MainThread]: Catalog written to /workdir/transforms/01_mpg/target/catalog.json
[0m20:28:41.257449 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 2.2809627, "process_in_blocks": "8", "process_kernel_time": 0.656476, "process_mem_max_rss": "108644", "process_out_blocks": "12448", "process_user_time": 5.05497}
[0m20:28:41.258318 [debug] [MainThread]: Command `dbt docs generate` succeeded at 20:28:41.258107 after 2.28 seconds
[0m20:28:41.258960 [debug] [MainThread]: Connection 'generate_catalog' was left open.
[0m20:28:41.259524 [debug] [MainThread]: On generate_catalog: Close
[0m20:28:41.260176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71bedffd9e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71bedc8d3520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71bedc682400>]}
[0m20:28:41.260808 [debug] [MainThread]: Flushing usage events
[0m20:29:03.221029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x782f5a416310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x782f57067d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x782f57067bb0>]}


============================== 20:29:03.230724 | b15c6353-10dc-4519-b7ad-7eb2b8d6467b ==============================
[0m20:29:03.230724 [info ] [MainThread]: Running with dbt=1.8.9
[0m20:29:03.231864 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'write_json': 'True', 'quiet': 'False', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs serve --profiles-dir . --target local --host 0.0.0.0 --port 8080', 'log_path': '/workdir/transforms/01_mpg/logs', 'printer_width': '80', 'log_format': 'default', 'empty': 'None', 'profiles_dir': '.', 'debug': 'False', 'indirect_selection': 'eager', 'warn_error': 'None', 'no_print': 'None', 'introspect': 'True', 'use_experimental_parser': 'False'}
[0m20:29:03.530444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b15c6353-10dc-4519-b7ad-7eb2b8d6467b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x782f570c9730>]}
[0m20:29:03.631143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b15c6353-10dc-4519-b7ad-7eb2b8d6467b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x782f56ede490>]}
[0m20:30:15.124847 [error] [MainThread]: Encountered an error:

[0m20:30:15.130498 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/lib/python3.9/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt/cli/main.py", line 303, in docs_serve
    results = task.run()
  File "/usr/local/lib/python3.9/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/usr/local/lib/python3.9/socketserver.py", line 237, in serve_forever
    self._handle_request_noblock()
  File "/usr/local/lib/python3.9/socketserver.py", line 316, in _handle_request_noblock
    self.process_request(request, client_address)
  File "/usr/local/lib/python3.9/socketserver.py", line 347, in process_request
    self.finish_request(request, client_address)
  File "/usr/local/lib/python3.9/socketserver.py", line 360, in finish_request
    self.RequestHandlerClass(request, client_address, self)
  File "/usr/local/lib/python3.9/http/server.py", line 668, in __init__
    super().__init__(*args, **kwargs)
  File "/usr/local/lib/python3.9/socketserver.py", line 747, in __init__
    self.handle()
  File "/usr/local/lib/python3.9/http/server.py", line 433, in handle
    self.handle_one_request()
  File "/usr/local/lib/python3.9/http/server.py", line 401, in handle_one_request
    self.raw_requestline = self.rfile.readline(65537)
  File "/usr/local/lib/python3.9/socket.py", line 716, in readinto
    return self._sock.recv_into(b)
KeyboardInterrupt

[0m20:30:15.133843 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 72.00927, "process_in_blocks": "0", "process_kernel_time": 0.512378, "process_mem_max_rss": "95504", "process_out_blocks": "9744", "process_user_time": 3.882293}
[0m20:30:15.136013 [debug] [MainThread]: Command `dbt docs serve` failed at 20:30:15.135465 after 72.01 seconds
[0m20:30:15.138046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x782f5a416310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x782f56d0ea90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x782f56bec1c0>]}
[0m20:30:15.139697 [debug] [MainThread]: Flushing usage events
[0m20:32:47.165251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790c01822310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790bfe478b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790bfe478a00>]}


============================== 20:32:47.174820 | bcec04ec-86c1-421c-8583-404808c60749 ==============================
[0m20:32:47.174820 [info ] [MainThread]: Running with dbt=1.8.9
[0m20:32:47.175932 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'empty': 'False', 'fail_fast': 'False', 'invocation_command': 'dbt build --profiles-dir . --target local', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'use_colors': 'True', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '.', 'log_path': '/workdir/transforms/01_mpg/logs', 'quiet': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'static_parser': 'True', 'log_format': 'default', 'cache_selected_only': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'target_path': 'None', 'warn_error': 'None', 'introspect': 'True', 'log_cache_events': 'False', 'version_check': 'True', 'write_json': 'True'}
[0m20:32:47.459915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bcec04ec-86c1-421c-8583-404808c60749', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790bfe3bf340>]}
[0m20:32:47.556011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bcec04ec-86c1-421c-8583-404808c60749', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790bfe4423a0>]}
[0m20:32:47.557409 [info ] [MainThread]: Registered adapter: clickhouse=1.8.6
[0m20:32:47.741015 [debug] [MainThread]: checksum: 134c0f7b96382cc6938697739bc32fb1adc530b177e30f60cebddf61dbd7e979, vars: {}, profile: , target: local, version: 1.8.9
[0m20:32:47.963512 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:32:47.964852 [debug] [MainThread]: Partial parsing: updated file: ex_01_mpg://models/sources.yml
[0m20:32:48.759876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bcec04ec-86c1-421c-8583-404808c60749', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790bfc741130>]}
[0m20:32:48.979891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bcec04ec-86c1-421c-8583-404808c60749', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790bfc695970>]}
[0m20:32:48.980800 [info ] [MainThread]: Found 2 models, 1 source, 471 macros
[0m20:32:48.983557 [info ] [MainThread]: 
[0m20:32:48.984678 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m20:32:48.996847 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m20:32:48.997928 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m20:32:49.028142 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:32:49.032619 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:32:49.362530 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m20:32:49.366784 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m20:32:49.367963 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m20:32:49.375702 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m20:32:49.395042 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__clean)
[0m20:32:49.396129 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__mart)
[0m20:32:49.408671 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list__clean"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'clean'
      

  ...
[0m20:32:49.412673 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__mart: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list__mart"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'mart'
      

  ...
[0m20:32:49.418576 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m20:32:49.425947 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m20:32:49.435908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bcec04ec-86c1-421c-8583-404808c60749', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790bfc62a370>]}
[0m20:32:49.436938 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m20:32:49.437628 [info ] [MainThread]: 
[0m20:32:49.450754 [debug] [Thread-1  ]: Began running node model.ex_01_mpg.mpg_standardized
[0m20:32:49.451906 [info ] [Thread-1  ]: 1 of 2 START sql table model `clean`.`mpg_standardized` ........................ [RUN]
[0m20:32:49.452798 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list__clean, now model.ex_01_mpg.mpg_standardized)
[0m20:32:49.453517 [debug] [Thread-1  ]: Began compiling node model.ex_01_mpg.mpg_standardized
[0m20:32:49.470559 [debug] [Thread-1  ]: Writing injected SQL for node "model.ex_01_mpg.mpg_standardized"
[0m20:32:49.471799 [debug] [Thread-1  ]: Began executing node model.ex_01_mpg.mpg_standardized
[0m20:32:49.569072 [debug] [Thread-1  ]: dbt_clickhouse adapter: On model.ex_01_mpg.mpg_standardized: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.mpg_standardized"} */

            

    
        create table `clean`.`mpg_standardized__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

-- Source columns are already Nullable with correct types.
-- Keep them as-is to preserve nullability and avoid insert errors.

select
  toFloat64(mpg)          as mpg,
  toInt32(cylinders)      as cylinders,
  toFloat64(displacement) as displacement,
  toFloat64OrNull(horsepower)   as horsepower,
  toInt32(weight)         as weight,
  toFloat64(acceleration) as acceleration,
  toInt32(model_year)     as model_year,
  trim(origin)                  as origin,
  trim(name)                    as make
from `raw`.`autompg___cars`
-- where horsepower is not null
  -- and isFinite(horsepower)
          )
        
        ...
[0m20:32:49.574995 [debug] [Thread-1  ]: dbt_clickhouse adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "node_id": "model.ex_01_mpg.mpg_standardized"} */

            

    
        create table `clean`.`mpg_standardized__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            

-- Source columns are already Nullable with correct types.
-- Keep them as-is to preserve nullability and avoid insert errors.

select
  toFloat64(mpg)          as mpg,
  toInt32(cylinders)      as cylinders,
  toFloat64(displacement) as displacement,
  toFloat64OrNull(horsepower)   as horsepower,
  toInt32(weight)         as weight,
  toFloat64(acceleration) as acceleration,
  toInt32(model_year)     as model_year,
  trim(origin)                  as origin,
  trim(name)                    as make
from `raw`.`autompg___cars`
-- where horsepower is not null
  -- and isFinite(horsepower)
          )
        
        
[0m20:32:49.585179 [debug] [Thread-1  ]: Database Error in model mpg_standardized (models/clean/mpg_standardized.sql)
  HTTPDriver for http://clickhouse:8123 received ClickHouse error code 43
   Code: 43. DB::Exception: Illegal type Float64 of first argument of function toFloat64OrNull. Conversion functions with postfix 'OrZero' or 'OrNull' should take String argument: While processing toFloat64(mpg) AS mpg, toInt32(cylinders) AS cylinders, toFloat64(displacement) AS displacement, toFloat64OrNull(horsepower) AS horsepower, toInt32(weight) AS weight, toFloat64(acceleration) AS acceleration, toInt32(model_year) AS model_year, trimBoth(origin) AS origin, trimBoth(name) AS make. (ILLEGAL_TYPE_OF_ARGUMENT) (version 23.12.6.19 (official build))
[0m20:32:49.587948 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bcec04ec-86c1-421c-8583-404808c60749', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790bfdcf74f0>]}
[0m20:32:49.589141 [error] [Thread-1  ]: 1 of 2 ERROR creating sql table model `clean`.`mpg_standardized` ............... [[31mERROR[0m in 0.13s]
[0m20:32:49.590587 [debug] [Thread-1  ]: Finished running node model.ex_01_mpg.mpg_standardized
[0m20:32:49.592075 [debug] [Thread-3  ]: Began running node model.ex_01_mpg.cylinders_by_origin
[0m20:32:49.592975 [info ] [Thread-3  ]: 2 of 2 SKIP relation mart.cylinders_by_origin .................................. [[33mSKIP[0m]
[0m20:32:49.593969 [debug] [Thread-3  ]: Finished running node model.ex_01_mpg.cylinders_by_origin
[0m20:32:49.595813 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:32:49.596410 [debug] [MainThread]: Connection 'model.ex_01_mpg.mpg_standardized' was left open.
[0m20:32:49.596968 [debug] [MainThread]: On model.ex_01_mpg.mpg_standardized: Close
[0m20:32:49.597506 [debug] [MainThread]: Connection 'list__mart' was left open.
[0m20:32:49.598026 [debug] [MainThread]: On list__mart: Close
[0m20:32:49.598877 [info ] [MainThread]: 
[0m20:32:49.599661 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.61 seconds (0.61s).
[0m20:32:49.601252 [debug] [MainThread]: Command end result
[0m20:32:49.659147 [info ] [MainThread]: 
[0m20:32:49.660140 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:32:49.660774 [info ] [MainThread]: 
[0m20:32:49.661615 [error] [MainThread]:   Database Error in model mpg_standardized (models/clean/mpg_standardized.sql)
  HTTPDriver for http://clickhouse:8123 received ClickHouse error code 43
   Code: 43. DB::Exception: Illegal type Float64 of first argument of function toFloat64OrNull. Conversion functions with postfix 'OrZero' or 'OrNull' should take String argument: While processing toFloat64(mpg) AS mpg, toInt32(cylinders) AS cylinders, toFloat64(displacement) AS displacement, toFloat64OrNull(horsepower) AS horsepower, toInt32(weight) AS weight, toFloat64(acceleration) AS acceleration, toInt32(model_year) AS model_year, trimBoth(origin) AS origin, trimBoth(name) AS make. (ILLEGAL_TYPE_OF_ARGUMENT) (version 23.12.6.19 (official build))
[0m20:32:49.662269 [info ] [MainThread]: 
[0m20:32:49.662879 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m20:32:49.664203 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 2.593437, "process_in_blocks": "1832", "process_kernel_time": 0.606935, "process_mem_max_rss": "114784", "process_out_blocks": "10456", "process_user_time": 5.427421}
[0m20:32:49.665129 [debug] [MainThread]: Command `dbt build` failed at 20:32:49.664825 after 2.59 seconds
[0m20:32:49.666064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790c01822310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790bfe3bf340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790bfc6959a0>]}
[0m20:32:49.666714 [debug] [MainThread]: Flushing usage events
[0m20:33:55.605126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ca919f2310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ca8e653b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ca8e6539d0>]}


============================== 20:33:55.614621 | a5e87d60-5a58-4016-846a-ab6509ea3920 ==============================
[0m20:33:55.614621 [info ] [MainThread]: Running with dbt=1.8.9
[0m20:33:55.615752 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'fail_fast': 'False', 'debug': 'False', 'version_check': 'True', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'partial_parse': 'True', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'log_path': '/workdir/transforms/01_mpg/logs', 'warn_error': 'None', 'use_experimental_parser': 'False', 'target_path': 'None', 'invocation_command': 'dbt docs generate --profiles-dir . --target local', 'empty': 'None', 'cache_selected_only': 'False', 'no_print': 'None', 'static_parser': 'True', 'use_colors': 'True', 'introspect': 'True', 'profiles_dir': '.', 'quiet': 'False'}
[0m20:33:55.905887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a5e87d60-5a58-4016-846a-ab6509ea3920', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ca90f92ca0>]}
[0m20:33:56.008946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a5e87d60-5a58-4016-846a-ab6509ea3920', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ca8e519d90>]}
[0m20:33:56.010317 [info ] [MainThread]: Registered adapter: clickhouse=1.8.6
[0m20:33:56.179548 [debug] [MainThread]: checksum: 134c0f7b96382cc6938697739bc32fb1adc530b177e30f60cebddf61dbd7e979, vars: {}, profile: , target: local, version: 1.8.9
[0m20:33:56.411120 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:33:56.411780 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:33:56.487549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a5e87d60-5a58-4016-846a-ab6509ea3920', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ca8de5ce50>]}
[0m20:33:56.517094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a5e87d60-5a58-4016-846a-ab6509ea3920', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ca8de0ceb0>]}
[0m20:33:56.517955 [info ] [MainThread]: Found 2 models, 1 source, 471 macros
[0m20:33:56.518600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5e87d60-5a58-4016-846a-ab6509ea3920', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ca8de0cdf0>]}
[0m20:33:56.520994 [info ] [MainThread]: 
[0m20:33:56.522064 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m20:33:56.523544 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list__mart'
[0m20:33:56.524668 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list__clean'
[0m20:33:56.565601 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:33:56.569109 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:33:56.836418 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list__clean"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'clean'
      

  ...
[0m20:33:56.840596 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__mart: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list__mart"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'mart'
      

  ...
[0m20:33:56.843786 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m20:33:56.847144 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m20:33:56.882957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5e87d60-5a58-4016-846a-ab6509ea3920', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ca8de2db50>]}
[0m20:33:56.884036 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m20:33:56.884775 [info ] [MainThread]: 
[0m20:33:56.897622 [debug] [Thread-1  ]: Began running node model.ex_01_mpg.mpg_standardized
[0m20:33:56.898613 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list__clean, now model.ex_01_mpg.mpg_standardized)
[0m20:33:56.899321 [debug] [Thread-1  ]: Began compiling node model.ex_01_mpg.mpg_standardized
[0m20:33:56.915747 [debug] [Thread-1  ]: Writing injected SQL for node "model.ex_01_mpg.mpg_standardized"
[0m20:33:56.916957 [debug] [Thread-1  ]: Began executing node model.ex_01_mpg.mpg_standardized
[0m20:33:56.918403 [debug] [Thread-1  ]: Finished running node model.ex_01_mpg.mpg_standardized
[0m20:33:56.920037 [debug] [Thread-3  ]: Began running node model.ex_01_mpg.cylinders_by_origin
[0m20:33:56.920994 [debug] [Thread-3  ]: Acquiring new clickhouse connection 'model.ex_01_mpg.cylinders_by_origin'
[0m20:33:56.921735 [debug] [Thread-3  ]: Began compiling node model.ex_01_mpg.cylinders_by_origin
[0m20:33:56.927149 [debug] [Thread-3  ]: Writing injected SQL for node "model.ex_01_mpg.cylinders_by_origin"
[0m20:33:56.928356 [debug] [Thread-3  ]: Began executing node model.ex_01_mpg.cylinders_by_origin
[0m20:33:56.929685 [debug] [Thread-3  ]: Finished running node model.ex_01_mpg.cylinders_by_origin
[0m20:33:56.931368 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:33:56.931941 [debug] [MainThread]: Connection 'list__mart' was left open.
[0m20:33:56.932518 [debug] [MainThread]: On list__mart: Close
[0m20:33:56.932999 [debug] [MainThread]: Connection 'model.ex_01_mpg.mpg_standardized' was left open.
[0m20:33:56.933553 [debug] [MainThread]: On model.ex_01_mpg.mpg_standardized: Close
[0m20:33:56.934014 [debug] [MainThread]: Connection 'model.ex_01_mpg.cylinders_by_origin' was properly closed.
[0m20:33:56.935806 [debug] [MainThread]: Command end result
[0m20:33:57.115068 [debug] [MainThread]: Acquiring new clickhouse connection 'generate_catalog'
[0m20:33:57.115757 [info ] [MainThread]: Building catalog
[0m20:33:57.128333 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:33:57.184980 [debug] [MainThread]: dbt_clickhouse adapter: On generate_catalog: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "generate_catalog"} */
select
      '' as table_database,
      columns.database as table_schema,
      columns.table as table_name,
      if(tables.engine not in ('MaterializedView', 'View'), 'table', 'view') as table_type,
      nullIf(tables.comment, '') as table_comment,
      columns.name as column_name,
      columns.position as column_index,
      columns.type as column_type,
      nullIf(columns.comment, '') as column_comment,
      null as table_owner
    from system.columns as columns
    join system.tables as tables on tables.database = columns.database and tables.name = columns.table
    where database != 'system' and
    (columns.database = 'mart' or columns.database = 'raw' or columns.database = 'clean')
    order by columns.database, columns.table, columns.position...
[0m20:33:57.221644 [debug] [MainThread]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m20:33:57.431157 [info ] [MainThread]: Catalog written to /workdir/transforms/01_mpg/target/catalog.json
[0m20:33:57.432772 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 1.9231273, "process_in_blocks": "0", "process_kernel_time": 0.596537, "process_mem_max_rss": "108528", "process_out_blocks": "12440", "process_user_time": 4.868223}
[0m20:33:57.433720 [debug] [MainThread]: Command `dbt docs generate` succeeded at 20:33:57.433453 after 1.92 seconds
[0m20:33:57.434356 [debug] [MainThread]: Connection 'generate_catalog' was left open.
[0m20:33:57.434980 [debug] [MainThread]: On generate_catalog: Close
[0m20:33:57.435727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ca919f2310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ca8de2fb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ca8d7dedc0>]}
[0m20:33:57.436408 [debug] [MainThread]: Flushing usage events
[0m20:34:04.932161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c44dcfc0310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c44d9c1e340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c44d9c1e490>]}


============================== 20:34:04.942277 | a1c28965-2b35-4554-a920-023b4926cb42 ==============================
[0m20:34:04.942277 [info ] [MainThread]: Running with dbt=1.8.9
[0m20:34:04.943483 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'use_experimental_parser': 'False', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'profiles_dir': '.', 'use_colors': 'True', 'empty': 'None', 'log_path': '/workdir/transforms/01_mpg/logs', 'partial_parse': 'True', 'introspect': 'True', 'invocation_command': 'dbt docs serve --profiles-dir . --target local --host 0.0.0.0 --port 8080', 'write_json': 'True', 'static_parser': 'True', 'warn_error': 'None', 'log_format': 'default', 'log_cache_events': 'False', 'no_print': 'None', 'indirect_selection': 'eager', 'debug': 'False', 'version_check': 'True', 'cache_selected_only': 'False'}
[0m20:34:05.229976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a1c28965-2b35-4554-a920-023b4926cb42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c44dc55db80>]}
[0m20:34:05.329251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a1c28965-2b35-4554-a920-023b4926cb42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c44da06c7f0>]}
[0m00:23:18.857879 [error] [MainThread]: Encountered an error:

[0m00:23:19.078484 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/lib/python3.9/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.9/site-packages/dbt/cli/main.py", line 303, in docs_serve
    results = task.run()
  File "/usr/local/lib/python3.9/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/usr/local/lib/python3.9/socketserver.py", line 237, in serve_forever
    self._handle_request_noblock()
  File "/usr/local/lib/python3.9/socketserver.py", line 316, in _handle_request_noblock
    self.process_request(request, client_address)
  File "/usr/local/lib/python3.9/socketserver.py", line 347, in process_request
    self.finish_request(request, client_address)
  File "/usr/local/lib/python3.9/socketserver.py", line 360, in finish_request
    self.RequestHandlerClass(request, client_address, self)
  File "/usr/local/lib/python3.9/http/server.py", line 668, in __init__
    super().__init__(*args, **kwargs)
  File "/usr/local/lib/python3.9/socketserver.py", line 747, in __init__
    self.handle()
  File "/usr/local/lib/python3.9/http/server.py", line 433, in handle
    self.handle_one_request()
  File "/usr/local/lib/python3.9/http/server.py", line 401, in handle_one_request
    self.raw_requestline = self.rfile.readline(65537)
  File "/usr/local/lib/python3.9/socket.py", line 716, in readinto
    return self._sock.recv_into(b)
KeyboardInterrupt

[0m00:23:19.080958 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 13754.242, "process_in_blocks": "344", "process_kernel_time": 0.48153, "process_mem_max_rss": "95208", "process_out_blocks": "9736", "process_user_time": 3.942159}
[0m00:23:19.082024 [debug] [MainThread]: Command `dbt docs serve` failed at 00:23:19.081751 after 13754.24 seconds
[0m00:23:19.082846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c44dcfc0310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c44d98c33d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c44d97a3130>]}
[0m00:23:19.083616 [debug] [MainThread]: Flushing usage events
[0m00:24:12.678677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72eecf95f310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72eecc5c5490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72eecc5c55e0>]}


============================== 00:24:12.688870 | fe5d6148-2cee-42d6-b0a2-83f9f522a955 ==============================
[0m00:24:12.688870 [info ] [MainThread]: Running with dbt=1.8.9
[0m00:24:12.689989 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'partial_parse': 'True', 'warn_error': 'None', 'log_format': 'default', 'profiles_dir': '.', 'write_json': 'True', 'quiet': 'False', 'introspect': 'True', 'fail_fast': 'False', 'invocation_command': 'dbt docs generate --profiles-dir . --target local --static', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'printer_width': '80', 'log_path': '/workdir/transforms/01_mpg/logs', 'debug': 'False', 'empty': 'None', 'use_experimental_parser': 'False', 'use_colors': 'True', 'target_path': 'None'}
[0m00:24:12.990488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fe5d6148-2cee-42d6-b0a2-83f9f522a955', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72eecc6cf880>]}
[0m00:24:13.095396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fe5d6148-2cee-42d6-b0a2-83f9f522a955', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72eecc4c37c0>]}
[0m00:24:13.097478 [info ] [MainThread]: Registered adapter: clickhouse=1.8.6
[0m00:24:13.279654 [debug] [MainThread]: checksum: 134c0f7b96382cc6938697739bc32fb1adc530b177e30f60cebddf61dbd7e979, vars: {}, profile: , target: local, version: 1.8.9
[0m00:24:13.603616 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:24:13.604639 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:24:13.684302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fe5d6148-2cee-42d6-b0a2-83f9f522a955', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72eecbdcddc0>]}
[0m00:24:13.733292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fe5d6148-2cee-42d6-b0a2-83f9f522a955', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72eecbd7fe20>]}
[0m00:24:13.734183 [info ] [MainThread]: Found 2 models, 1 source, 471 macros
[0m00:24:13.734881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe5d6148-2cee-42d6-b0a2-83f9f522a955', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72eecbd7fd60>]}
[0m00:24:13.737391 [info ] [MainThread]: 
[0m00:24:13.738696 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m00:24:13.740447 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list__clean'
[0m00:24:13.741502 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list__mart'
[0m00:24:13.782347 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:24:13.787665 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:24:14.124839 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__clean: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list__clean"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'clean'
      

  ...
[0m00:24:14.131741 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__mart: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "list__mart"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'mart'
      

  ...
[0m00:24:14.133100 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m00:24:14.140387 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m00:24:14.190173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe5d6148-2cee-42d6-b0a2-83f9f522a955', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72eecbd9d040>]}
[0m00:24:14.191690 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m00:24:14.192688 [info ] [MainThread]: 
[0m00:24:14.207120 [debug] [Thread-1  ]: Began running node model.ex_01_mpg.mpg_standardized
[0m00:24:14.208179 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list__clean, now model.ex_01_mpg.mpg_standardized)
[0m00:24:14.208996 [debug] [Thread-1  ]: Began compiling node model.ex_01_mpg.mpg_standardized
[0m00:24:14.226605 [debug] [Thread-1  ]: Writing injected SQL for node "model.ex_01_mpg.mpg_standardized"
[0m00:24:14.227895 [debug] [Thread-1  ]: Began executing node model.ex_01_mpg.mpg_standardized
[0m00:24:14.229474 [debug] [Thread-1  ]: Finished running node model.ex_01_mpg.mpg_standardized
[0m00:24:14.230965 [debug] [Thread-3  ]: Began running node model.ex_01_mpg.cylinders_by_origin
[0m00:24:14.232297 [debug] [Thread-3  ]: Acquiring new clickhouse connection 'model.ex_01_mpg.cylinders_by_origin'
[0m00:24:14.233071 [debug] [Thread-3  ]: Began compiling node model.ex_01_mpg.cylinders_by_origin
[0m00:24:14.238826 [debug] [Thread-3  ]: Writing injected SQL for node "model.ex_01_mpg.cylinders_by_origin"
[0m00:24:14.240111 [debug] [Thread-3  ]: Began executing node model.ex_01_mpg.cylinders_by_origin
[0m00:24:14.241590 [debug] [Thread-3  ]: Finished running node model.ex_01_mpg.cylinders_by_origin
[0m00:24:14.243320 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:24:14.244254 [debug] [MainThread]: Connection 'model.ex_01_mpg.mpg_standardized' was left open.
[0m00:24:14.245087 [debug] [MainThread]: On model.ex_01_mpg.mpg_standardized: Close
[0m00:24:14.245915 [debug] [MainThread]: Connection 'list__mart' was left open.
[0m00:24:14.246768 [debug] [MainThread]: On list__mart: Close
[0m00:24:14.247548 [debug] [MainThread]: Connection 'model.ex_01_mpg.cylinders_by_origin' was properly closed.
[0m00:24:14.250501 [debug] [MainThread]: Command end result
[0m00:24:14.460674 [debug] [MainThread]: Acquiring new clickhouse connection 'generate_catalog'
[0m00:24:14.461374 [info ] [MainThread]: Building catalog
[0m00:24:14.473798 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:24:14.533224 [debug] [MainThread]: dbt_clickhouse adapter: On generate_catalog: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "clickhouse_ftw", "target_name": "local", "connection_name": "generate_catalog"} */
select
      '' as table_database,
      columns.database as table_schema,
      columns.table as table_name,
      if(tables.engine not in ('MaterializedView', 'View'), 'table', 'view') as table_type,
      nullIf(tables.comment, '') as table_comment,
      columns.name as column_name,
      columns.position as column_index,
      columns.type as column_type,
      nullIf(columns.comment, '') as column_comment,
      null as table_owner
    from system.columns as columns
    join system.tables as tables on tables.database = columns.database and tables.name = columns.table
    where database != 'system' and
    (columns.database = 'mart' or columns.database = 'raw' or columns.database = 'clean')
    order by columns.database, columns.table, columns.position...
[0m00:24:14.551285 [debug] [MainThread]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m00:24:14.765496 [info ] [MainThread]: Catalog written to /workdir/transforms/01_mpg/target/catalog.json
[0m00:24:14.767621 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 2.1991792, "process_in_blocks": "44624", "process_kernel_time": 0.778691, "process_mem_max_rss": "115852", "process_out_blocks": "16368", "process_user_time": 5.088118}
[0m00:24:14.768540 [debug] [MainThread]: Command `dbt docs generate` succeeded at 00:24:14.768323 after 2.20 seconds
[0m00:24:14.769158 [debug] [MainThread]: Connection 'generate_catalog' was left open.
[0m00:24:14.769710 [debug] [MainThread]: On generate_catalog: Close
[0m00:24:14.770378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72eecf95f310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72eeceb9bc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72eecc008460>]}
[0m00:24:14.770960 [debug] [MainThread]: Flushing usage events
